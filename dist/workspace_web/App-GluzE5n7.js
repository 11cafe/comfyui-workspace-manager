var ol=Object.defineProperty;var sl=(t,e,n)=>e in t?ol(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ke=(t,e,n)=>(sl(t,typeof e!="symbol"?e+"":e,n),n);import{u as al,a as il,r as b,c as ll,b as et,m as Fe,d as Rt,f as Q,j as m,B as Ke,e as cl,g as J,h as pe,o as Je,i as Ot,k as ot,I as Mr,l as Wn,n as Yr,p as xe,q as va,s as ul,t as dl,v as fl,w as Rr,x as pl,y as hl,z as ml,A as yl,C as vl,D as ts,E as ga,F as ns,G as wa,H as gl,J as wl,K as bl,P as ba,M as Tr,L as rs,N as Lr,O as os,Q as ss,R as as,S as is,_ as Wr,T as xl,U as xa,V as ls}from"./input.js";import{app as ge}from"/scripts/app.js";import{api as Rs}from"/scripts/api.js";function kl(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}function ka(t){var e;return kl(t)&&(e=t.ownerDocument)!=null?e:document}function _l(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var El=_l();function Cl(t){const e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function _a(t){const{theme:e}=al(),n=il();return b.useMemo(()=>ll(e.direction,{...n,...t}),[t,e.direction,n])}var Sl=Object.defineProperty,jl=(t,e,n)=>e in t?Sl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_e=(t,e,n)=>(jl(t,typeof e!="symbol"?e+"":e,n),n);function Ts(t){return t.sort((e,n)=>{const r=e.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var Dl=t=>typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE;function Ls(t,e,n){let r=t+1;return n&&r>=e&&(r=0),r}function Ws(t,e,n){let r=t-1;return n&&r<0&&(r=e),r}var po=typeof window<"u"?b.useLayoutEffect:b.useEffect,yr=t=>t,Ol=class{constructor(){_e(this,"descendants",new Map),_e(this,"register",t=>{if(t!=null)return Dl(t)?this.registerNode(t):e=>{this.registerNode(e,t)}}),_e(this,"unregister",t=>{this.descendants.delete(t);const e=Ts(Array.from(this.descendants.keys()));this.assignIndex(e)}),_e(this,"destroy",()=>{this.descendants.clear()}),_e(this,"assignIndex",t=>{this.descendants.forEach(e=>{const n=t.indexOf(e.node);e.index=n,e.node.dataset.index=e.index.toString()})}),_e(this,"count",()=>this.descendants.size),_e(this,"enabledCount",()=>this.enabledValues().length),_e(this,"values",()=>Array.from(this.descendants.values()).sort((e,n)=>e.index-n.index)),_e(this,"enabledValues",()=>this.values().filter(t=>!t.disabled)),_e(this,"item",t=>{if(this.count()!==0)return this.values()[t]}),_e(this,"enabledItem",t=>{if(this.enabledCount()!==0)return this.enabledValues()[t]}),_e(this,"first",()=>this.item(0)),_e(this,"firstEnabled",()=>this.enabledItem(0)),_e(this,"last",()=>this.item(this.descendants.size-1)),_e(this,"lastEnabled",()=>{const t=this.enabledValues().length-1;return this.enabledItem(t)}),_e(this,"indexOf",t=>{var e,n;return t&&(n=(e=this.descendants.get(t))==null?void 0:e.index)!=null?n:-1}),_e(this,"enabledIndexOf",t=>t==null?-1:this.enabledValues().findIndex(e=>e.node.isSameNode(t))),_e(this,"next",(t,e=!0)=>{const n=Ls(t,this.count(),e);return this.item(n)}),_e(this,"nextEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=Ls(r,this.enabledCount(),e);return this.enabledItem(o)}),_e(this,"prev",(t,e=!0)=>{const n=Ws(t,this.count()-1,e);return this.item(n)}),_e(this,"prevEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=Ws(r,this.enabledCount()-1,e);return this.enabledItem(o)}),_e(this,"registerNode",(t,e)=>{if(!t||this.descendants.has(t))return;const n=Array.from(this.descendants.keys()).concat(t),r=Ts(n);e!=null&&e.disabled&&(e.disabled=!!e.disabled);const o={node:t,index:-1,...e};this.descendants.set(t,o),this.assignIndex(r)})}};function Il(){const t=b.useRef(new Ol);return po(()=>()=>t.current.destroy()),t.current}var[Pl,Ea]=et({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function Nl(t){const e=Ea(),[n,r]=b.useState(-1),o=b.useRef(null);po(()=>()=>{o.current&&e.unregister(o.current)},[]),po(()=>{if(!o.current)return;const a=Number(o.current.dataset.index);n!=a&&!Number.isNaN(a)&&r(a)});const s=yr(t?e.register(t):e.register);return{descendants:e,index:n,enabledIndex:e.enabledIndexOf(o.current),register:Fe(s,o)}}function Ca(){return[yr(Pl),()=>yr(Ea()),()=>Il(),o=>Nl(o)]}function Sa(t){const{value:e,defaultValue:n,onChange:r,shouldUpdate:o=(f,p)=>f!==p}=t,s=Rt(r),a=Rt(o),[i,l]=b.useState(n),c=e!==void 0,u=c?e:i,d=Rt(f=>{const y=typeof f=="function"?f(u):f;a(u,y)&&(c||l(y),s(y))},[c,s,u,a]);return[u,d]}function cs(t){return b.Children.toArray(t).filter(e=>b.isValidElement(e))}var on=Q((t,e)=>{const{icon:n,children:r,isRound:o,"aria-label":s,...a}=t,i=n||r,l=b.isValidElement(i)?b.cloneElement(i,{"aria-hidden":!0,focusable:!1}):null;return m.jsx(Ke,{padding:"0",borderRadius:o?"full":void 0,ref:e,"aria-label":s,...a,children:l})});on.displayName="IconButton";var[Al,ja]=cl("Card"),Fl=Q(function(e,n){const{className:r,...o}=e,s=ja();return m.jsx(J.div,{ref:n,className:pe("chakra-card__body",r),__css:s.body,...o})}),Ml=Q(function(e,n){const{className:r,...o}=e,s=ja();return m.jsx(J.div,{ref:n,className:pe("chakra-card__header",r),__css:s.header,...o})}),Rl=Q(function(e,n){const{className:r,children:o,direction:s="column",justify:a,align:i,...l}=Je(e),c=Ot("Card",e);return m.jsx(J.div,{ref:n,className:pe("chakra-card",r),__css:{display:"flex",flexDirection:s,justifyContent:a,alignItems:i,position:"relative",minWidth:0,wordWrap:"break-word",...c.container},...l,children:m.jsx(Al,{value:c,children:o})})}),[Tl,Da]=et({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[Ll,dn]=et({strict:!1,name:"FormControlContext"});function Wl(t){const{id:e,isRequired:n,isInvalid:r,isDisabled:o,isReadOnly:s,...a}=t,i=b.useId(),l=e||`field-${i}`,c=`${l}-label`,u=`${l}-feedback`,d=`${l}-helptext`,[f,p]=b.useState(!1),[y,h]=b.useState(!1),[v,w]=b.useState(!1),g=b.useCallback((k={},D=null)=>({id:d,...k,ref:Fe(D,j=>{j&&h(!0)})}),[d]),x=b.useCallback((k={},D=null)=>({...k,ref:D,"data-focus":ot(v),"data-disabled":ot(o),"data-invalid":ot(r),"data-readonly":ot(s),id:k.id!==void 0?k.id:c,htmlFor:k.htmlFor!==void 0?k.htmlFor:l}),[l,o,v,r,s,c]),E=b.useCallback((k={},D=null)=>({id:u,...k,ref:Fe(D,j=>{j&&p(!0)}),"aria-live":"polite"}),[u]),S=b.useCallback((k={},D=null)=>({...k,...a,ref:D,role:"group","data-focus":ot(v),"data-disabled":ot(o),"data-invalid":ot(r),"data-readonly":ot(s)}),[a,o,v,r,s]),C=b.useCallback((k={},D=null)=>({...k,ref:D,role:"presentation","aria-hidden":!0,children:k.children||"*"}),[]);return{isRequired:!!n,isInvalid:!!r,isReadOnly:!!s,isDisabled:!!o,isFocused:!!v,onFocus:()=>w(!0),onBlur:()=>w(!1),hasFeedbackText:f,setHasFeedbackText:p,hasHelpText:y,setHasHelpText:h,id:l,labelId:c,feedbackId:u,helpTextId:d,htmlProps:a,getHelpTextProps:g,getErrorMessageProps:E,getRootProps:S,getLabelProps:x,getRequiredIndicatorProps:C}}var Br=Q(function(e,n){const r=Ot("Form",e),o=Je(e),{getRootProps:s,htmlProps:a,...i}=Wl(o),l=pe("chakra-form-control",e.className);return m.jsx(Ll,{value:i,children:m.jsx(Tl,{value:r,children:m.jsx(J.div,{...s({},n),className:l,__css:r.container})})})});Br.displayName="FormControl";var Bl=Q(function(e,n){const r=dn(),o=Da(),s=pe("chakra-form__helper-text",e.className);return m.jsx(J.div,{...r==null?void 0:r.getHelpTextProps(e,n),__css:o.helperText,className:s})});Bl.displayName="FormHelperText";var[$l,Kl]=et({name:"FormErrorStylesContext",errorMessage:`useFormErrorStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormError />" `}),$r=Q((t,e)=>{const n=Ot("FormError",t),r=Je(t),o=dn();return o!=null&&o.isInvalid?m.jsx($l,{value:n,children:m.jsx(J.div,{...o==null?void 0:o.getErrorMessageProps(r,e),className:pe("chakra-form__error-message",t.className),__css:{display:"flex",alignItems:"center",...n.text}})}):null});$r.displayName="FormErrorMessage";var Ul=Q((t,e)=>{const n=Kl(),r=dn();if(!(r!=null&&r.isInvalid))return null;const o=pe("chakra-form__error-icon",t.className);return m.jsx(Mr,{ref:e,"aria-hidden":!0,...t,__css:n.icon,className:o,children:m.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})});Ul.displayName="FormErrorIcon";var Kr=Q(function(e,n){var r;const o=Wn("FormLabel",e),s=Je(e),{className:a,children:i,requiredIndicator:l=m.jsx(Oa,{}),optionalIndicator:c=null,...u}=s,d=dn(),f=(r=d==null?void 0:d.getLabelProps(u,n))!=null?r:{ref:n,...u};return m.jsxs(J.label,{...f,className:pe("chakra-form__label",s.className),__css:{display:"block",textAlign:"start",...o},children:[i,d!=null&&d.isRequired?l:c]})});Kr.displayName="FormLabel";var Oa=Q(function(e,n){const r=dn(),o=Da();if(!(r!=null&&r.isRequired))return null;const s=pe("chakra-form__required-indicator",e.className);return m.jsx(J.span,{...r==null?void 0:r.getRequiredIndicatorProps(e,n),__css:o.requiredIndicator,className:s})});Oa.displayName="RequiredIndicator";function zl(t){const{isDisabled:e,isInvalid:n,isReadOnly:r,isRequired:o,...s}=ql(t);return{...s,disabled:e,readOnly:r,required:o,"aria-invalid":Yr(n),"aria-required":Yr(o),"aria-readonly":Yr(r)}}function ql(t){var e,n,r;const o=dn(),{id:s,disabled:a,readOnly:i,required:l,isRequired:c,isInvalid:u,isReadOnly:d,isDisabled:f,onFocus:p,onBlur:y,...h}=t,v=t["aria-describedby"]?[t["aria-describedby"]]:[];return o!=null&&o.hasFeedbackText&&(o!=null&&o.isInvalid)&&v.push(o.feedbackId),o!=null&&o.hasHelpText&&v.push(o.helpTextId),{...h,"aria-describedby":v.join(" ")||void 0,id:s??(o==null?void 0:o.id),isDisabled:(e=a??f)!=null?e:o==null?void 0:o.isDisabled,isReadOnly:(n=i??d)!=null?n:o==null?void 0:o.isReadOnly,isRequired:(r=l??c)!=null?r:o==null?void 0:o.isRequired,isInvalid:u??(o==null?void 0:o.isInvalid),onFocus:xe(o==null?void 0:o.onFocus,p),onBlur:xe(o==null?void 0:o.onBlur,y)}}function en(t,e,n,r){const o=Rt(n);return b.useEffect(()=>{const s=typeof t=="function"?t():t??document;if(!(!n||!s))return s.addEventListener(e,o,r),()=>{s.removeEventListener(e,o,r)}},[e,t,r,o,n]),()=>{const s=typeof t=="function"?t():t??document;s==null||s.removeEventListener(e,o,r)}}function Vl(t){return"current"in t}var Ia=()=>typeof window<"u";function Hl(){var t;const e=navigator.userAgentData;return(t=e==null?void 0:e.platform)!=null?t:navigator.platform}var Jl=t=>Ia()&&t.test(navigator.vendor),Gl=t=>Ia()&&t.test(Hl()),Yl=()=>Gl(/mac|iphone|ipad|ipod/i),Xl=()=>Yl()&&Jl(/apple/i);function Zl(t){const{ref:e,elements:n,enabled:r}=t,o=()=>{var s,a;return(a=(s=e.current)==null?void 0:s.ownerDocument)!=null?a:document};en(o,"pointerdown",s=>{if(!Xl()||!r)return;const a=s.target,l=(n??[e]).some(c=>{const u=Vl(c)?c.current:c;return(u==null?void 0:u.contains(a))||u===a});o().activeElement!==a&&l&&(s.preventDefault(),a.focus())})}var Pa={exports:{}},Ql="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ec=Ql,tc=ec;function Na(){}function Aa(){}Aa.resetWarningCache=Na;var nc=function(){function t(r,o,s,a,i,l){if(l!==tc){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Aa,resetWarningCache:Na};return n.PropTypes=n,n};Pa.exports=nc();var rc=Pa.exports;const Nt=va(rc);function oc(t){const e=t.ownerDocument.defaultView||window,{overflow:n,overflowX:r,overflowY:o}=e.getComputedStyle(t);return/auto|scroll|overlay|hidden/.test(n+o+r)}function sc(t){return t.localName==="html"?t:t.assignedSlot||t.parentElement||t.ownerDocument.documentElement}function Fa(t){return["html","body","#document"].includes(t.localName)?t.ownerDocument.body:ul(t)&&oc(t)?t:Fa(sc(t))}var ac=El?b.useLayoutEffect:b.useEffect;function ho(t,e=[]){const n=b.useRef(t);return ac(()=>{n.current=t}),b.useCallback((...r)=>{var o;return(o=n.current)==null?void 0:o.call(n,...r)},e)}function ic(t){const{ref:e,handler:n,enabled:r=!0}=t,o=ho(n),a=b.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;b.useEffect(()=>{if(!r)return;const i=d=>{Xr(d,e)&&(a.isPointerDown=!0)},l=d=>{if(a.ignoreEmulatedMouseEvents){a.ignoreEmulatedMouseEvents=!1;return}a.isPointerDown&&n&&Xr(d,e)&&(a.isPointerDown=!1,o(d))},c=d=>{a.ignoreEmulatedMouseEvents=!0,n&&a.isPointerDown&&Xr(d,e)&&(a.isPointerDown=!1,o(d))},u=ka(e.current);return u.addEventListener("mousedown",i,!0),u.addEventListener("mouseup",l,!0),u.addEventListener("touchstart",i,!0),u.addEventListener("touchend",c,!0),()=>{u.removeEventListener("mousedown",i,!0),u.removeEventListener("mouseup",l,!0),u.removeEventListener("touchstart",i,!0),u.removeEventListener("touchend",c,!0)}},[n,e,o,a,r])}function Xr(t,e){var n;const r=t.target;return r&&!ka(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function lc(t,e){const n=b.useId();return b.useMemo(()=>t||[e,n].filter(Boolean).join("-"),[t,e,n])}function cc(t,e){const n=t!==void 0;return[n,n&&typeof t<"u"?t:e]}function uc(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=ho(n),a=ho(e),[i,l]=b.useState(t.defaultIsOpen||!1),[c,u]=cc(r,i),d=lc(o,"disclosure"),f=b.useCallback(()=>{c||l(!1),a==null||a()},[c,a]),p=b.useCallback(()=>{c||l(!0),s==null||s()},[c,s]),y=b.useCallback(()=>{(u?f:p)()},[u,p,f]);return{isOpen:!!u,onOpen:p,onClose:f,onToggle:y,isControlled:c,getButtonProps:(h={})=>({...h,"aria-expanded":u,"aria-controls":d,onClick:dl(h.onClick,y)}),getDisclosureProps:(h={})=>({...h,hidden:!u,id:d})}}var Bn=Q(function(e,n){const{htmlSize:r,...o}=e,s=Ot("Input",o),a=Je(o),i=zl(a),l=pe("chakra-input",e.className);return m.jsx(J.input,{size:r,...i,__css:s.field,ref:n,className:l})});Bn.displayName="Input";Bn.id="Input";var Ma=Q(function(e,n){const r=Wn("Link",e),{className:o,isExternal:s,...a}=Je(e);return m.jsx(J.a,{target:s?"_blank":void 0,rel:s?"noopener":void 0,ref:n,className:pe("chakra-link",o),...a,__css:r})});Ma.displayName="Link";var dc=Object.freeze(["base","sm","md","lg","xl","2xl"]);function fc(t,e){return Array.isArray(t)?t.map(n=>n===null?null:e(n)):fl(t)?Object.keys(t).reduce((n,r)=>(n[r]=e(t[r]),n),{}):t!=null?e(t):null}function nh(t,e=dc){const n={};return t.forEach((r,o)=>{const s=e[o];r!=null&&(n[s]=r)}),n}var Tt=Q(function(e,n){const r=Wn("Text",e),{className:o,align:s,decoration:a,casing:i,...l}=Je(e),c=Cl({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return m.jsx(J.p,{ref:n,className:pe("chakra-text",e.className),...c,...l,__css:r})});Tt.displayName="Text";var mo=t=>m.jsx(J.div,{className:"chakra-stack__divider",...t,__css:{...t.__css,borderWidth:0,alignSelf:"stretch",borderColor:"inherit",width:"auto",height:"auto"}});mo.displayName="StackDivider";var Ra=t=>m.jsx(J.div,{className:"chakra-stack__item",...t,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...t.__css}});Ra.displayName="StackItem";function pc(t){const{spacing:e,direction:n}=t,r={column:{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":fc(n,o=>r[o])}}var xn=Q((t,e)=>{const{isInline:n,direction:r,align:o,justify:s,spacing:a="0.5rem",wrap:i,children:l,divider:c,className:u,shouldWrapChildren:d,...f}=t,p=n?"row":r??"column",y=b.useMemo(()=>pc({spacing:a,direction:p}),[a,p]),h=!!c,v=!d&&!h,w=b.useMemo(()=>{const x=cs(l);return v?x:x.map((E,S)=>{const C=typeof E.key<"u"?E.key:S,k=S+1===x.length,j=d?m.jsx(Ra,{children:E},C):E;if(!h)return j;const A=b.cloneElement(c,{__css:y}),F=k?null:A;return m.jsxs(b.Fragment,{children:[j,F]},C)})},[c,y,h,v,d,l]),g=pe("chakra-stack",u);return m.jsx(J.div,{ref:e,display:"flex",alignItems:o,justifyContent:s,flexDirection:p,flexWrap:i,gap:h?void 0:a,className:g,...f,children:w})});xn.displayName="Stack";var Ct=Q((t,e)=>m.jsx(xn,{align:"center",...t,direction:"row",ref:e}));Ct.displayName="HStack";var Ta=Q(function(e,n){const r=Wn("Heading",e),{className:o,...s}=Je(e);return m.jsx(J.h2,{ref:n,className:pe("chakra-heading",e.className),...s,__css:r})});Ta.displayName="Heading";var ht=J("div");ht.displayName="Box";var La=Q(function(e,n){const{size:r,centerContent:o=!0,...s}=e,a=o?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return m.jsx(ht,{ref:n,boxSize:r,__css:{...a,flexShrink:0,flexGrow:0},...s})});La.displayName="Square";var hc=Q(function(e,n){const{size:r,...o}=e;return m.jsx(La,{size:r,ref:n,borderRadius:"9999px",...o})});hc.displayName="Circle";var rr=Q(function(e,n){const{direction:r,align:o,justify:s,wrap:a,basis:i,grow:l,shrink:c,...u}=e,d={display:"flex",flexDirection:r,alignItems:o,justifyContent:s,flexWrap:a,flexBasis:i,flexGrow:l,flexShrink:c};return m.jsx(J.div,{ref:n,__css:d,...u})});rr.displayName="Flex";function mc(t){const{key:e}=t;return e.length===1||e.length>1&&/[^a-zA-Z0-9]/.test(e)}function yc(t={}){const{timeout:e=300,preventDefault:n=()=>!0}=t,[r,o]=b.useState([]),s=b.useRef(),a=()=>{s.current&&(clearTimeout(s.current),s.current=null)},i=()=>{a(),s.current=setTimeout(()=>{o([]),s.current=null},e)};b.useEffect(()=>a,[]);function l(c){return u=>{if(u.key==="Backspace"){const d=[...r];d.pop(),o(d);return}if(mc(u)){const d=r.concat(u.key);n(u)&&(u.preventDefault(),u.stopPropagation()),o(d),c(d.join("")),i()}}}return l}function vc(t,e,n,r){if(e==null)return r;if(!r)return t.find(a=>n(a).toLowerCase().startsWith(e.toLowerCase()));const o=t.filter(s=>n(s).toLowerCase().startsWith(e.toLowerCase()));if(o.length>0){let s;return o.includes(r)?(s=o.indexOf(r)+1,s===o.length&&(s=0),o[s]):(s=t.indexOf(o[0]),t[s])}return r}function gc(){const t=b.useRef(new Map),e=t.current,n=b.useCallback((o,s,a,i)=>{t.current.set(a,{type:s,el:o,options:i}),o.addEventListener(s,a,i)},[]),r=b.useCallback((o,s,a,i)=>{o.removeEventListener(s,a,i),t.current.delete(a)},[]);return b.useEffect(()=>()=>{e.forEach((o,s)=>{r(o.el,o.type,s,o.options)})},[r,e]),{add:n,remove:r}}function Zr(t){const e=t.target,{tagName:n,isContentEditable:r}=e;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function Wa(t={}){const{ref:e,isDisabled:n,isFocusable:r,clickOnEnter:o=!0,clickOnSpace:s=!0,onMouseDown:a,onMouseUp:i,onClick:l,onKeyDown:c,onKeyUp:u,tabIndex:d,onMouseOver:f,onMouseLeave:p,...y}=t,[h,v]=b.useState(!0),[w,g]=b.useState(!1),x=gc(),E=I=>{I&&I.tagName!=="BUTTON"&&v(!1)},S=h?d:d||0,C=n&&!r,k=b.useCallback(I=>{if(n){I.stopPropagation(),I.preventDefault();return}I.currentTarget.focus(),l==null||l(I)},[n,l]),D=b.useCallback(I=>{w&&Zr(I)&&(I.preventDefault(),I.stopPropagation(),g(!1),x.remove(document,"keyup",D,!1))},[w,x]),j=b.useCallback(I=>{if(c==null||c(I),n||I.defaultPrevented||I.metaKey||!Zr(I.nativeEvent)||h)return;const Z=o&&I.key==="Enter";s&&I.key===" "&&(I.preventDefault(),g(!0)),Z&&(I.preventDefault(),I.currentTarget.click()),x.add(document,"keyup",D,!1)},[n,h,c,o,s,x,D]),A=b.useCallback(I=>{if(u==null||u(I),n||I.defaultPrevented||I.metaKey||!Zr(I.nativeEvent)||h)return;s&&I.key===" "&&(I.preventDefault(),g(!1),I.currentTarget.click())},[s,h,n,u]),F=b.useCallback(I=>{I.button===0&&(g(!1),x.remove(document,"mouseup",F,!1))},[x]),q=b.useCallback(I=>{if(I.button!==0)return;if(n){I.stopPropagation(),I.preventDefault();return}h||g(!0),I.currentTarget.focus({preventScroll:!0}),x.add(document,"mouseup",F,!1),a==null||a(I)},[n,h,a,x,F]),$=b.useCallback(I=>{I.button===0&&(h||g(!1),i==null||i(I))},[i,h]),K=b.useCallback(I=>{if(n){I.preventDefault();return}f==null||f(I)},[n,f]),le=b.useCallback(I=>{w&&(I.preventDefault(),g(!1)),p==null||p(I)},[w,p]),z=Fe(e,E);return h?{...y,ref:z,type:"button","aria-disabled":C?void 0:n,disabled:C,onClick:k,onMouseDown:a,onMouseUp:i,onKeyUp:u,onKeyDown:c,onMouseOver:f,onMouseLeave:p}:{...y,ref:z,role:"button","data-active":ot(w),"aria-disabled":n?"true":void 0,tabIndex:C?void 0:S,onClick:k,onMouseDown:q,onMouseUp:$,onKeyUp:A,onKeyDown:j,onMouseOver:K,onMouseLeave:le}}function wc(t){const e=t.current;if(!e)return!1;const n=ml(e);return!n||e.contains(n)?!1:!!yl(n)}function Ba(t,e){const{shouldFocus:n,visible:r,focusRef:o}=e,s=n&&!r;Rr(()=>{if(!s||wc(t))return;const a=(o==null?void 0:o.current)||t.current;let i;if(a)return i=requestAnimationFrame(()=>{a.focus({preventScroll:!0})}),()=>{cancelAnimationFrame(i)}},[s,t,o])}var bc={preventScroll:!0,shouldFocus:!1};function xc(t,e=bc){const{focusRef:n,preventScroll:r,shouldFocus:o,visible:s}=e,a=kc(t)?t.current:t,i=o&&s,l=b.useRef(i),c=b.useRef(s);pl(()=>{!c.current&&s&&(l.current=i),c.current=s},[s,i]);const u=b.useCallback(()=>{if(!(!s||!a||!l.current)&&(l.current=!1,!a.contains(document.activeElement)))if(n!=null&&n.current)requestAnimationFrame(()=>{var d;(d=n.current)==null||d.focus({preventScroll:r})});else{const d=hl(a);d.length>0&&requestAnimationFrame(()=>{d[0].focus({preventScroll:r})})}},[s,r,a,n]);Rr(()=>{u()},[u]),en(a,"transitionend",u)}function kc(t){return"current"in t}var Gt=(t,e)=>({var:t,varRef:e?`var(${t}, ${e})`:`var(${t})`}),je={arrowShadowColor:Gt("--popper-arrow-shadow-color"),arrowSize:Gt("--popper-arrow-size","8px"),arrowSizeHalf:Gt("--popper-arrow-size-half"),arrowBg:Gt("--popper-arrow-bg"),transformOrigin:Gt("--popper-transform-origin"),arrowOffset:Gt("--popper-arrow-offset")};function _c(t){if(t.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}var Ec={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},Cc=t=>Ec[t],Bs={scroll:!0,resize:!0};function Sc(t){let e;return typeof t=="object"?e={enabled:!0,options:{...Bs,...t}}:e={enabled:t,options:Bs},e}var jc={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`},effect:({state:t})=>()=>{const e=t.elements.reference;t.elements.popper.style.width=`${e.offsetWidth}px`}},Dc={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:t})=>{$s(t)},effect:({state:t})=>()=>{$s(t)}},$s=t=>{t.elements.popper.style.setProperty(je.transformOrigin.var,Cc(t.placement))},Oc={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:t})=>{Ic(t)}},Ic=t=>{var e;if(!t.placement)return;const n=Pc(t.placement);if((e=t.elements)!=null&&e.arrow&&n){Object.assign(t.elements.arrow.style,{[n.property]:n.value,width:je.arrowSize.varRef,height:je.arrowSize.varRef,zIndex:-1});const r={[je.arrowSizeHalf.var]:`calc(${je.arrowSize.varRef} / 2 - 1px)`,[je.arrowOffset.var]:`calc(${je.arrowSizeHalf.varRef} * -1)`};for(const o in r)t.elements.arrow.style.setProperty(o,r[o])}},Pc=t=>{if(t.startsWith("top"))return{property:"bottom",value:je.arrowOffset.varRef};if(t.startsWith("bottom"))return{property:"top",value:je.arrowOffset.varRef};if(t.startsWith("left"))return{property:"right",value:je.arrowOffset.varRef};if(t.startsWith("right"))return{property:"left",value:je.arrowOffset.varRef}},Nc={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:t})=>{Ks(t)},effect:({state:t})=>()=>{Ks(t)}},Ks=t=>{if(!t.elements.arrow)return;const e=t.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!e)return;const n=_c(t.placement);n&&e.style.setProperty("--popper-arrow-default-shadow",n),Object.assign(e.style,{transform:"rotate(45deg)",background:je.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},Ac={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},Fc={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function Mc(t,e="ltr"){var n,r;const o=((n=Ac[t])==null?void 0:n[e])||t;return e==="ltr"?o:(r=Fc[t])!=null?r:o}var Ue="top",Ze="bottom",Qe="right",ze="left",us="auto",$n=[Ue,Ze,Qe,ze],sn="start",On="end",Rc="clippingParents",$a="viewport",yn="popper",Tc="reference",Us=$n.reduce(function(t,e){return t.concat([e+"-"+sn,e+"-"+On])},[]),Ka=[].concat($n,[us]).reduce(function(t,e){return t.concat([e,e+"-"+sn,e+"-"+On])},[]),Lc="beforeRead",Wc="read",Bc="afterRead",$c="beforeMain",Kc="main",Uc="afterMain",zc="beforeWrite",qc="write",Vc="afterWrite",Hc=[Lc,Wc,Bc,$c,Kc,Uc,zc,qc,Vc];function it(t){return t?(t.nodeName||"").toLowerCase():null}function Ve(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function zt(t){var e=Ve(t).Element;return t instanceof e||t instanceof Element}function Xe(t){var e=Ve(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function ds(t){if(typeof ShadowRoot>"u")return!1;var e=Ve(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Jc(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},o=e.attributes[n]||{},s=e.elements[n];!Xe(s)||!it(s)||(Object.assign(s.style,r),Object.keys(o).forEach(function(a){var i=o[a];i===!1?s.removeAttribute(a):s.setAttribute(a,i===!0?"":i)}))})}function Gc(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var o=e.elements[r],s=e.attributes[r]||{},a=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),i=a.reduce(function(l,c){return l[c]="",l},{});!Xe(o)||!it(o)||(Object.assign(o.style,i),Object.keys(s).forEach(function(l){o.removeAttribute(l)}))})}}const Yc={name:"applyStyles",enabled:!0,phase:"write",fn:Jc,effect:Gc,requires:["computeStyles"]};function at(t){return t.split("-")[0]}var Lt=Math.max,vr=Math.min,an=Math.round;function yo(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ua(){return!/^((?!chrome|android).)*safari/i.test(yo())}function ln(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),o=1,s=1;e&&Xe(t)&&(o=t.offsetWidth>0&&an(r.width)/t.offsetWidth||1,s=t.offsetHeight>0&&an(r.height)/t.offsetHeight||1);var a=zt(t)?Ve(t):window,i=a.visualViewport,l=!Ua()&&n,c=(r.left+(l&&i?i.offsetLeft:0))/o,u=(r.top+(l&&i?i.offsetTop:0))/s,d=r.width/o,f=r.height/s;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c,x:c,y:u}}function fs(t){var e=ln(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function za(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&ds(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function vt(t){return Ve(t).getComputedStyle(t)}function Xc(t){return["table","td","th"].indexOf(it(t))>=0}function It(t){return((zt(t)?t.ownerDocument:t.document)||window.document).documentElement}function Ur(t){return it(t)==="html"?t:t.assignedSlot||t.parentNode||(ds(t)?t.host:null)||It(t)}function zs(t){return!Xe(t)||vt(t).position==="fixed"?null:t.offsetParent}function Zc(t){var e=/firefox/i.test(yo()),n=/Trident/i.test(yo());if(n&&Xe(t)){var r=vt(t);if(r.position==="fixed")return null}var o=Ur(t);for(ds(o)&&(o=o.host);Xe(o)&&["html","body"].indexOf(it(o))<0;){var s=vt(o);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return o;o=o.parentNode}return null}function Kn(t){for(var e=Ve(t),n=zs(t);n&&Xc(n)&&vt(n).position==="static";)n=zs(n);return n&&(it(n)==="html"||it(n)==="body"&&vt(n).position==="static")?e:n||Zc(t)||e}function ps(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function kn(t,e,n){return Lt(t,vr(e,n))}function Qc(t,e,n){var r=kn(t,e,n);return r>n?n:r}function qa(){return{top:0,right:0,bottom:0,left:0}}function Va(t){return Object.assign({},qa(),t)}function Ha(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var eu=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,Va(typeof e!="number"?e:Ha(e,$n))};function tu(t){var e,n=t.state,r=t.name,o=t.options,s=n.elements.arrow,a=n.modifiersData.popperOffsets,i=at(n.placement),l=ps(i),c=[ze,Qe].indexOf(i)>=0,u=c?"height":"width";if(!(!s||!a)){var d=eu(o.padding,n),f=fs(s),p=l==="y"?Ue:ze,y=l==="y"?Ze:Qe,h=n.rects.reference[u]+n.rects.reference[l]-a[l]-n.rects.popper[u],v=a[l]-n.rects.reference[l],w=Kn(s),g=w?l==="y"?w.clientHeight||0:w.clientWidth||0:0,x=h/2-v/2,E=d[p],S=g-f[u]-d[y],C=g/2-f[u]/2+x,k=kn(E,C,S),D=l;n.modifiersData[r]=(e={},e[D]=k,e.centerOffset=k-C,e)}}function nu(t){var e=t.state,n=t.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||za(e.elements.popper,o)&&(e.elements.arrow=o))}const ru={name:"arrow",enabled:!0,phase:"main",fn:tu,effect:nu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function cn(t){return t.split("-")[1]}var ou={top:"auto",right:"auto",bottom:"auto",left:"auto"};function su(t,e){var n=t.x,r=t.y,o=e.devicePixelRatio||1;return{x:an(n*o)/o||0,y:an(r*o)/o||0}}function qs(t){var e,n=t.popper,r=t.popperRect,o=t.placement,s=t.variation,a=t.offsets,i=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,f=a.x,p=f===void 0?0:f,y=a.y,h=y===void 0?0:y,v=typeof u=="function"?u({x:p,y:h}):{x:p,y:h};p=v.x,h=v.y;var w=a.hasOwnProperty("x"),g=a.hasOwnProperty("y"),x=ze,E=Ue,S=window;if(c){var C=Kn(n),k="clientHeight",D="clientWidth";if(C===Ve(n)&&(C=It(n),vt(C).position!=="static"&&i==="absolute"&&(k="scrollHeight",D="scrollWidth")),C=C,o===Ue||(o===ze||o===Qe)&&s===On){E=Ze;var j=d&&C===S&&S.visualViewport?S.visualViewport.height:C[k];h-=j-r.height,h*=l?1:-1}if(o===ze||(o===Ue||o===Ze)&&s===On){x=Qe;var A=d&&C===S&&S.visualViewport?S.visualViewport.width:C[D];p-=A-r.width,p*=l?1:-1}}var F=Object.assign({position:i},c&&ou),q=u===!0?su({x:p,y:h},Ve(n)):{x:p,y:h};if(p=q.x,h=q.y,l){var $;return Object.assign({},F,($={},$[E]=g?"0":"",$[x]=w?"0":"",$.transform=(S.devicePixelRatio||1)<=1?"translate("+p+"px, "+h+"px)":"translate3d("+p+"px, "+h+"px, 0)",$))}return Object.assign({},F,(e={},e[E]=g?h+"px":"",e[x]=w?p+"px":"",e.transform="",e))}function au(t){var e=t.state,n=t.options,r=n.gpuAcceleration,o=r===void 0?!0:r,s=n.adaptive,a=s===void 0?!0:s,i=n.roundOffsets,l=i===void 0?!0:i,c={placement:at(e.placement),variation:cn(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,qs(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,qs(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const iu={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:au,data:{}};var Hn={passive:!0};function lu(t){var e=t.state,n=t.instance,r=t.options,o=r.scroll,s=o===void 0?!0:o,a=r.resize,i=a===void 0?!0:a,l=Ve(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",n.update,Hn)}),i&&l.addEventListener("resize",n.update,Hn),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",n.update,Hn)}),i&&l.removeEventListener("resize",n.update,Hn)}}const cu={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:lu,data:{}};var uu={left:"right",right:"left",bottom:"top",top:"bottom"};function or(t){return t.replace(/left|right|bottom|top/g,function(e){return uu[e]})}var du={start:"end",end:"start"};function Vs(t){return t.replace(/start|end/g,function(e){return du[e]})}function hs(t){var e=Ve(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function ms(t){return ln(It(t)).left+hs(t).scrollLeft}function fu(t,e){var n=Ve(t),r=It(t),o=n.visualViewport,s=r.clientWidth,a=r.clientHeight,i=0,l=0;if(o){s=o.width,a=o.height;var c=Ua();(c||!c&&e==="fixed")&&(i=o.offsetLeft,l=o.offsetTop)}return{width:s,height:a,x:i+ms(t),y:l}}function pu(t){var e,n=It(t),r=hs(t),o=(e=t.ownerDocument)==null?void 0:e.body,s=Lt(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=Lt(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),i=-r.scrollLeft+ms(t),l=-r.scrollTop;return vt(o||n).direction==="rtl"&&(i+=Lt(n.clientWidth,o?o.clientWidth:0)-s),{width:s,height:a,x:i,y:l}}function ys(t){var e=vt(t),n=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Ja(t){return["html","body","#document"].indexOf(it(t))>=0?t.ownerDocument.body:Xe(t)&&ys(t)?t:Ja(Ur(t))}function _n(t,e){var n;e===void 0&&(e=[]);var r=Ja(t),o=r===((n=t.ownerDocument)==null?void 0:n.body),s=Ve(r),a=o?[s].concat(s.visualViewport||[],ys(r)?r:[]):r,i=e.concat(a);return o?i:i.concat(_n(Ur(a)))}function vo(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function hu(t,e){var n=ln(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function Hs(t,e,n){return e===$a?vo(fu(t,n)):zt(e)?hu(e,n):vo(pu(It(t)))}function mu(t){var e=_n(Ur(t)),n=["absolute","fixed"].indexOf(vt(t).position)>=0,r=n&&Xe(t)?Kn(t):t;return zt(r)?e.filter(function(o){return zt(o)&&za(o,r)&&it(o)!=="body"}):[]}function yu(t,e,n,r){var o=e==="clippingParents"?mu(t):[].concat(e),s=[].concat(o,[n]),a=s[0],i=s.reduce(function(l,c){var u=Hs(t,c,r);return l.top=Lt(u.top,l.top),l.right=vr(u.right,l.right),l.bottom=vr(u.bottom,l.bottom),l.left=Lt(u.left,l.left),l},Hs(t,a,r));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}function Ga(t){var e=t.reference,n=t.element,r=t.placement,o=r?at(r):null,s=r?cn(r):null,a=e.x+e.width/2-n.width/2,i=e.y+e.height/2-n.height/2,l;switch(o){case Ue:l={x:a,y:e.y-n.height};break;case Ze:l={x:a,y:e.y+e.height};break;case Qe:l={x:e.x+e.width,y:i};break;case ze:l={x:e.x-n.width,y:i};break;default:l={x:e.x,y:e.y}}var c=o?ps(o):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case sn:l[c]=l[c]-(e[u]/2-n[u]/2);break;case On:l[c]=l[c]+(e[u]/2-n[u]/2);break}}return l}function In(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=r===void 0?t.placement:r,s=n.strategy,a=s===void 0?t.strategy:s,i=n.boundary,l=i===void 0?Rc:i,c=n.rootBoundary,u=c===void 0?$a:c,d=n.elementContext,f=d===void 0?yn:d,p=n.altBoundary,y=p===void 0?!1:p,h=n.padding,v=h===void 0?0:h,w=Va(typeof v!="number"?v:Ha(v,$n)),g=f===yn?Tc:yn,x=t.rects.popper,E=t.elements[y?g:f],S=yu(zt(E)?E:E.contextElement||It(t.elements.popper),l,u,a),C=ln(t.elements.reference),k=Ga({reference:C,element:x,strategy:"absolute",placement:o}),D=vo(Object.assign({},x,k)),j=f===yn?D:C,A={top:S.top-j.top+w.top,bottom:j.bottom-S.bottom+w.bottom,left:S.left-j.left+w.left,right:j.right-S.right+w.right},F=t.modifiersData.offset;if(f===yn&&F){var q=F[o];Object.keys(A).forEach(function($){var K=[Qe,Ze].indexOf($)>=0?1:-1,le=[Ue,Ze].indexOf($)>=0?"y":"x";A[$]+=q[le]*K})}return A}function vu(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=n.boundary,s=n.rootBoundary,a=n.padding,i=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?Ka:l,u=cn(r),d=u?i?Us:Us.filter(function(y){return cn(y)===u}):$n,f=d.filter(function(y){return c.indexOf(y)>=0});f.length===0&&(f=d);var p=f.reduce(function(y,h){return y[h]=In(t,{placement:h,boundary:o,rootBoundary:s,padding:a})[at(h)],y},{});return Object.keys(p).sort(function(y,h){return p[y]-p[h]})}function gu(t){if(at(t)===us)return[];var e=or(t);return[Vs(t),e,Vs(e)]}function wu(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var o=n.mainAxis,s=o===void 0?!0:o,a=n.altAxis,i=a===void 0?!0:a,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,f=n.altBoundary,p=n.flipVariations,y=p===void 0?!0:p,h=n.allowedAutoPlacements,v=e.options.placement,w=at(v),g=w===v,x=l||(g||!y?[or(v)]:gu(v)),E=[v].concat(x).reduce(function(se,_){return se.concat(at(_)===us?vu(e,{placement:_,boundary:u,rootBoundary:d,padding:c,flipVariations:y,allowedAutoPlacements:h}):_)},[]),S=e.rects.reference,C=e.rects.popper,k=new Map,D=!0,j=E[0],A=0;A<E.length;A++){var F=E[A],q=at(F),$=cn(F)===sn,K=[Ue,Ze].indexOf(q)>=0,le=K?"width":"height",z=In(e,{placement:F,boundary:u,rootBoundary:d,altBoundary:f,padding:c}),I=K?$?Qe:ze:$?Ze:Ue;S[le]>C[le]&&(I=or(I));var Z=or(I),oe=[];if(s&&oe.push(z[q]<=0),i&&oe.push(z[I]<=0,z[Z]<=0),oe.every(function(se){return se})){j=F,D=!1;break}k.set(F,oe)}if(D)for(var he=y?3:1,be=function(_){var N=E.find(function(M){var L=k.get(M);if(L)return L.slice(0,_).every(function(X){return X})});if(N)return j=N,"break"},Ee=he;Ee>0;Ee--){var ce=be(Ee);if(ce==="break")break}e.placement!==j&&(e.modifiersData[r]._skip=!0,e.placement=j,e.reset=!0)}}const bu={name:"flip",enabled:!0,phase:"main",fn:wu,requiresIfExists:["offset"],data:{_skip:!1}};function Js(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function Gs(t){return[Ue,Qe,Ze,ze].some(function(e){return t[e]>=0})}function xu(t){var e=t.state,n=t.name,r=e.rects.reference,o=e.rects.popper,s=e.modifiersData.preventOverflow,a=In(e,{elementContext:"reference"}),i=In(e,{altBoundary:!0}),l=Js(a,r),c=Js(i,o,s),u=Gs(l),d=Gs(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const ku={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:xu};function _u(t,e,n){var r=at(t),o=[ze,Ue].indexOf(r)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,a=s[0],i=s[1];return a=a||0,i=(i||0)*o,[ze,Qe].indexOf(r)>=0?{x:i,y:a}:{x:a,y:i}}function Eu(t){var e=t.state,n=t.options,r=t.name,o=n.offset,s=o===void 0?[0,0]:o,a=Ka.reduce(function(u,d){return u[d]=_u(d,e.rects,s),u},{}),i=a[e.placement],l=i.x,c=i.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=a}const Cu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Eu};function Su(t){var e=t.state,n=t.name;e.modifiersData[n]=Ga({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const ju={name:"popperOffsets",enabled:!0,phase:"read",fn:Su,data:{}};function Du(t){return t==="x"?"y":"x"}function Ou(t){var e=t.state,n=t.options,r=t.name,o=n.mainAxis,s=o===void 0?!0:o,a=n.altAxis,i=a===void 0?!1:a,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,f=n.tether,p=f===void 0?!0:f,y=n.tetherOffset,h=y===void 0?0:y,v=In(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),w=at(e.placement),g=cn(e.placement),x=!g,E=ps(w),S=Du(E),C=e.modifiersData.popperOffsets,k=e.rects.reference,D=e.rects.popper,j=typeof h=="function"?h(Object.assign({},e.rects,{placement:e.placement})):h,A=typeof j=="number"?{mainAxis:j,altAxis:j}:Object.assign({mainAxis:0,altAxis:0},j),F=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,q={x:0,y:0};if(C){if(s){var $,K=E==="y"?Ue:ze,le=E==="y"?Ze:Qe,z=E==="y"?"height":"width",I=C[E],Z=I+v[K],oe=I-v[le],he=p?-D[z]/2:0,be=g===sn?k[z]:D[z],Ee=g===sn?-D[z]:-k[z],ce=e.elements.arrow,se=p&&ce?fs(ce):{width:0,height:0},_=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:qa(),N=_[K],M=_[le],L=kn(0,k[z],se[z]),X=x?k[z]/2-he-L-N-A.mainAxis:be-L-N-A.mainAxis,G=x?-k[z]/2+he+L+M+A.mainAxis:Ee+L+M+A.mainAxis,ae=e.elements.arrow&&Kn(e.elements.arrow),V=ae?E==="y"?ae.clientTop||0:ae.clientLeft||0:0,W=($=F==null?void 0:F[E])!=null?$:0,ee=I+X-W-V,T=I+G-W,te=kn(p?vr(Z,ee):Z,I,p?Lt(oe,T):oe);C[E]=te,q[E]=te-I}if(i){var ne,ie=E==="x"?Ue:ze,Ie=E==="x"?Ze:Qe,Y=C[S],de=S==="y"?"height":"width",Ce=Y+v[ie],$e=Y-v[Ie],ue=[Ue,ze].indexOf(w)!==-1,Se=(ne=F==null?void 0:F[S])!=null?ne:0,ve=ue?Ce:Y-k[de]-D[de]-Se+A.altAxis,tt=ue?Y+k[de]+D[de]-Se-A.altAxis:$e,Ge=p&&ue?Qc(ve,Y,tt):kn(p?ve:Ce,Y,p?tt:$e);C[S]=Ge,q[S]=Ge-Y}e.modifiersData[r]=q}}const Iu={name:"preventOverflow",enabled:!0,phase:"main",fn:Ou,requiresIfExists:["offset"]};function Pu(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Nu(t){return t===Ve(t)||!Xe(t)?hs(t):Pu(t)}function Au(t){var e=t.getBoundingClientRect(),n=an(e.width)/t.offsetWidth||1,r=an(e.height)/t.offsetHeight||1;return n!==1||r!==1}function Fu(t,e,n){n===void 0&&(n=!1);var r=Xe(e),o=Xe(e)&&Au(e),s=It(e),a=ln(t,o,n),i={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((it(e)!=="body"||ys(s))&&(i=Nu(e)),Xe(e)?(l=ln(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=ms(s))),{x:a.left+i.scrollLeft-l.x,y:a.top+i.scrollTop-l.y,width:a.width,height:a.height}}function Mu(t){var e=new Map,n=new Set,r=[];t.forEach(function(s){e.set(s.name,s)});function o(s){n.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(i){if(!n.has(i)){var l=e.get(i);l&&o(l)}}),r.push(s)}return t.forEach(function(s){n.has(s.name)||o(s)}),r}function Ru(t){var e=Mu(t);return Hc.reduce(function(n,r){return n.concat(e.filter(function(o){return o.phase===r}))},[])}function Tu(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function Lu(t){var e=t.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var Ys={placement:"bottom",modifiers:[],strategy:"absolute"};function Xs(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Wu(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,o=e.defaultOptions,s=o===void 0?Ys:o;return function(i,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ys,s),modifiersData:{},elements:{reference:i,popper:l},attributes:{},styles:{}},d=[],f=!1,p={state:u,setOptions:function(w){var g=typeof w=="function"?w(u.options):w;h(),u.options=Object.assign({},s,u.options,g),u.scrollParents={reference:zt(i)?_n(i):i.contextElement?_n(i.contextElement):[],popper:_n(l)};var x=Ru(Lu([].concat(r,u.options.modifiers)));return u.orderedModifiers=x.filter(function(E){return E.enabled}),y(),p.update()},forceUpdate:function(){if(!f){var w=u.elements,g=w.reference,x=w.popper;if(Xs(g,x)){u.rects={reference:Fu(g,Kn(x),u.options.strategy==="fixed"),popper:fs(x)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(A){return u.modifiersData[A.name]=Object.assign({},A.data)});for(var E=0;E<u.orderedModifiers.length;E++){if(u.reset===!0){u.reset=!1,E=-1;continue}var S=u.orderedModifiers[E],C=S.fn,k=S.options,D=k===void 0?{}:k,j=S.name;typeof C=="function"&&(u=C({state:u,options:D,name:j,instance:p})||u)}}}},update:Tu(function(){return new Promise(function(v){p.forceUpdate(),v(u)})}),destroy:function(){h(),f=!0}};if(!Xs(i,l))return p;p.setOptions(c).then(function(v){!f&&c.onFirstUpdate&&c.onFirstUpdate(v)});function y(){u.orderedModifiers.forEach(function(v){var w=v.name,g=v.options,x=g===void 0?{}:g,E=v.effect;if(typeof E=="function"){var S=E({state:u,name:w,instance:p,options:x}),C=function(){};d.push(S||C)}})}function h(){d.forEach(function(v){return v()}),d=[]}return p}}var Bu=[cu,ju,iu,Yc,Cu,bu,Iu,ru,ku],$u=Wu({defaultModifiers:Bu});function vs(t={}){const{enabled:e=!0,modifiers:n,placement:r="bottom",strategy:o="absolute",arrowPadding:s=8,eventListeners:a=!0,offset:i,gutter:l=8,flip:c=!0,boundary:u="clippingParents",preventOverflow:d=!0,matchWidth:f,direction:p="ltr"}=t,y=b.useRef(null),h=b.useRef(null),v=b.useRef(null),w=Mc(r,p),g=b.useRef(()=>{}),x=b.useCallback(()=>{var A;!e||!y.current||!h.current||((A=g.current)==null||A.call(g),v.current=$u(y.current,h.current,{placement:w,modifiers:[Nc,Oc,Dc,{...jc,enabled:!!f},{name:"eventListeners",...Sc(a)},{name:"arrow",options:{padding:s}},{name:"offset",options:{offset:i??[0,l]}},{name:"flip",enabled:!!c,options:{padding:8}},{name:"preventOverflow",enabled:!!d,options:{boundary:u}},...n??[]],strategy:o}),v.current.forceUpdate(),g.current=v.current.destroy)},[w,e,n,f,a,s,i,l,c,d,u,o]);b.useEffect(()=>()=>{var A;!y.current&&!h.current&&((A=v.current)==null||A.destroy(),v.current=null)},[]);const E=b.useCallback(A=>{y.current=A,x()},[x]),S=b.useCallback((A={},F=null)=>({...A,ref:Fe(E,F)}),[E]),C=b.useCallback(A=>{h.current=A,x()},[x]),k=b.useCallback((A={},F=null)=>({...A,ref:Fe(C,F),style:{...A.style,position:o,minWidth:f?void 0:"max-content",inset:"0 auto auto 0"}}),[o,C,f]),D=b.useCallback((A={},F=null)=>{const{size:q,shadowColor:$,bg:K,style:le,...z}=A;return{...z,ref:F,"data-popper-arrow":"",style:Ku(A)}},[]),j=b.useCallback((A={},F=null)=>({...A,ref:F,"data-popper-arrow-inner":""}),[]);return{update(){var A;(A=v.current)==null||A.update()},forceUpdate(){var A;(A=v.current)==null||A.forceUpdate()},transformOrigin:je.transformOrigin.varRef,referenceRef:E,popperRef:C,getPopperProps:k,getArrowProps:D,getArrowInnerProps:j,getReferenceProps:S}}function Ku(t){const{size:e,shadowColor:n,bg:r,style:o}=t,s={...o,position:"absolute"};return e&&(s["--popper-arrow-size"]=e),n&&(s["--popper-arrow-shadow-color"]=n),r&&(s["--popper-arrow-bg"]=r),s}function gs(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=Rt(n),a=Rt(e),[i,l]=b.useState(t.defaultIsOpen||!1),c=r!==void 0?r:i,u=r!==void 0,d=b.useId(),f=o??`disclosure-${d}`,p=b.useCallback(()=>{u||l(!1),a==null||a()},[u,a]),y=b.useCallback(()=>{u||l(!0),s==null||s()},[u,s]),h=b.useCallback(()=>{c?p():y()},[c,y,p]);function v(g={}){return{...g,"aria-expanded":c,"aria-controls":f,onClick(x){var E;(E=g.onClick)==null||E.call(g,x),h()}}}function w(g={}){return{...g,hidden:!c,id:f}}return{isOpen:c,onOpen:y,onClose:p,onToggle:h,isControlled:u,getButtonProps:v,getDisclosureProps:w}}function Uu(t){const{ref:e,handler:n,enabled:r=!0}=t,o=Rt(n),a=b.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;b.useEffect(()=>{if(!r)return;const i=d=>{Qr(d,e)&&(a.isPointerDown=!0)},l=d=>{if(a.ignoreEmulatedMouseEvents){a.ignoreEmulatedMouseEvents=!1;return}a.isPointerDown&&n&&Qr(d,e)&&(a.isPointerDown=!1,o(d))},c=d=>{a.ignoreEmulatedMouseEvents=!0,n&&a.isPointerDown&&Qr(d,e)&&(a.isPointerDown=!1,o(d))},u=Ya(e.current);return u.addEventListener("mousedown",i,!0),u.addEventListener("mouseup",l,!0),u.addEventListener("touchstart",i,!0),u.addEventListener("touchend",c,!0),()=>{u.removeEventListener("mousedown",i,!0),u.removeEventListener("mouseup",l,!0),u.removeEventListener("touchstart",i,!0),u.removeEventListener("touchend",c,!0)}},[n,e,o,a,r])}function Qr(t,e){var n;const r=t.target;return r&&!Ya(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function Ya(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function Xa(t){const{isOpen:e,ref:n}=t,[r,o]=b.useState(e),[s,a]=b.useState(!1);return b.useEffect(()=>{s||(o(e),a(!0))},[e,s,r]),en(()=>n.current,"animationend",()=>{o(e)}),{present:!(e?!1:!r),onComplete(){var l;const c=vl(n.current),u=new c.CustomEvent("animationend",{bubbles:!0});(l=n.current)==null||l.dispatchEvent(u)}}}function ws(t){const{wasSelected:e,enabled:n,isSelected:r,mode:o="unmount"}=t;return!!(!n||r||o==="keepMounted"&&e)}var[zu,qu,Vu,Hu]=Ca(),[Ju,Un]=et({strict:!1,name:"MenuContext"});function Gu(t,...e){const n=b.useId(),r=t||n;return b.useMemo(()=>e.map(o=>`${o}-${r}`),[r,e])}function Za(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function Zs(t){return Za(t).activeElement===t}function Yu(t={}){const{id:e,closeOnSelect:n=!0,closeOnBlur:r=!0,initialFocusRef:o,autoSelect:s=!0,isLazy:a,isOpen:i,defaultIsOpen:l,onClose:c,onOpen:u,placement:d="bottom-start",lazyBehavior:f="unmount",direction:p,computePositionOnMount:y=!1,...h}=t,v=b.useRef(null),w=b.useRef(null),g=Vu(),x=b.useCallback(()=>{requestAnimationFrame(()=>{var ce;(ce=v.current)==null||ce.focus({preventScroll:!1})})},[]),E=b.useCallback(()=>{const ce=setTimeout(()=>{var se;if(o)(se=o.current)==null||se.focus();else{const _=g.firstEnabled();_&&$(_.index)}});Z.current.add(ce)},[g,o]),S=b.useCallback(()=>{const ce=setTimeout(()=>{const se=g.lastEnabled();se&&$(se.index)});Z.current.add(ce)},[g]),C=b.useCallback(()=>{u==null||u(),s?E():x()},[s,E,x,u]),{isOpen:k,onOpen:D,onClose:j,onToggle:A}=gs({isOpen:i,defaultIsOpen:l,onClose:c,onOpen:C});Uu({enabled:k&&r,ref:v,handler:ce=>{var se;(se=w.current)!=null&&se.contains(ce.target)||j()}});const F=vs({...h,enabled:k||y,placement:d,direction:p}),[q,$]=b.useState(-1);Rr(()=>{k||$(-1)},[k]),Ba(v,{focusRef:w,visible:k,shouldFocus:!0});const K=Xa({isOpen:k,ref:v}),[le,z]=Gu(e,"menu-button","menu-list"),I=b.useCallback(()=>{D(),x()},[D,x]),Z=b.useRef(new Set([]));b.useEffect(()=>{const ce=Z.current;return()=>{ce.forEach(se=>clearTimeout(se)),ce.clear()}},[]);const oe=b.useCallback(()=>{D(),E()},[E,D]),he=b.useCallback(()=>{D(),S()},[D,S]),be=b.useCallback(()=>{var ce,se;const _=Za(v.current),N=(ce=v.current)==null?void 0:ce.contains(_.activeElement);if(!(k&&!N))return;const L=(se=g.item(q))==null?void 0:se.node;L==null||L.focus({preventScroll:!0})},[k,q,g]),Ee=b.useRef(null);return{openAndFocusMenu:I,openAndFocusFirstItem:oe,openAndFocusLastItem:he,onTransitionEnd:be,unstable__animationState:K,descendants:g,popper:F,buttonId:le,menuId:z,forceUpdate:F.forceUpdate,orientation:"vertical",isOpen:k,onToggle:A,onOpen:D,onClose:j,menuRef:v,buttonRef:w,focusedIndex:q,closeOnSelect:n,closeOnBlur:r,autoSelect:s,setFocusedIndex:$,isLazy:a,lazyBehavior:f,initialFocusRef:o,rafId:Ee}}function rh(t={},e=null){const n=Un(),{onToggle:r,popper:o,openAndFocusFirstItem:s,openAndFocusLastItem:a}=n,i=b.useCallback(l=>{const c=l.key,d={Enter:s,ArrowDown:s,ArrowUp:a}[c];d&&(l.preventDefault(),l.stopPropagation(),d(l))},[s,a]);return{...t,ref:Fe(n.buttonRef,e,o.referenceRef),id:n.buttonId,"data-active":ot(n.isOpen),"aria-expanded":n.isOpen,"aria-haspopup":"menu","aria-controls":n.menuId,onClick:xe(t.onClick,r),onKeyDown:xe(t.onKeyDown,i)}}function go(t){var e;return Qu(t)&&!!((e=t==null?void 0:t.getAttribute("role"))!=null&&e.startsWith("menuitem"))}function Xu(t={},e=null){const n=Un();if(!n)throw new Error("useMenuContext: context is undefined. Seems you forgot to wrap component within <Menu>");const{focusedIndex:r,setFocusedIndex:o,menuRef:s,isOpen:a,onClose:i,menuId:l,isLazy:c,lazyBehavior:u,unstable__animationState:d}=n,f=qu(),p=yc({preventDefault:w=>w.key!==" "&&go(w.target)}),y=b.useCallback(w=>{if(!w.currentTarget.contains(w.target))return;const g=w.key,E={Tab:C=>C.preventDefault(),Escape:i,ArrowDown:()=>{const C=f.nextEnabled(r);C&&o(C.index)},ArrowUp:()=>{const C=f.prevEnabled(r);C&&o(C.index)}}[g];if(E){w.preventDefault(),E(w);return}const S=p(C=>{const k=vc(f.values(),C,D=>{var j,A;return(A=(j=D==null?void 0:D.node)==null?void 0:j.textContent)!=null?A:""},f.item(r));if(k){const D=f.indexOf(k.node);o(D)}});go(w.target)&&S(w)},[f,r,p,i,o]),h=b.useRef(!1);a&&(h.current=!0);const v=ws({wasSelected:h.current,enabled:c,mode:u,isSelected:d.present});return{...t,ref:Fe(s,e),children:v?t.children:null,tabIndex:-1,role:"menu",id:l,style:{...t.style,transformOrigin:"var(--popper-transform-origin)"},"aria-orientation":"vertical",onKeyDown:xe(t.onKeyDown,y)}}function Zu(t={}){const{popper:e,isOpen:n}=Un();return e.getPopperProps({...t,style:{visibility:n?"visible":"hidden",...t.style}})}function Qa(t={},e=null){const{onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onClick:s,onFocus:a,isDisabled:i,isFocusable:l,closeOnSelect:c,type:u,...d}=t,f=Un(),{setFocusedIndex:p,focusedIndex:y,closeOnSelect:h,onClose:v,menuRef:w,isOpen:g,menuId:x,rafId:E}=f,S=b.useRef(null),C=`${x}-menuitem-${b.useId()}`,{index:k,register:D}=Hu({disabled:i&&!l}),j=b.useCallback(I=>{n==null||n(I),!i&&p(k)},[p,k,i,n]),A=b.useCallback(I=>{r==null||r(I),S.current&&!Zs(S.current)&&j(I)},[j,r]),F=b.useCallback(I=>{o==null||o(I),!i&&p(-1)},[p,i,o]),q=b.useCallback(I=>{s==null||s(I),go(I.currentTarget)&&(c??h)&&v()},[v,s,h,c]),$=b.useCallback(I=>{a==null||a(I),p(k)},[p,a,k]),K=k===y,le=i&&!l;Rr(()=>{if(g)return K&&!le&&S.current?(E.current&&cancelAnimationFrame(E.current),E.current=requestAnimationFrame(()=>{var I;(I=S.current)==null||I.focus({preventScroll:!0}),E.current=null})):w.current&&!Zs(w.current)&&w.current.focus({preventScroll:!0}),()=>{E.current&&cancelAnimationFrame(E.current)}},[K,le,w,g]);const z=Wa({onClick:q,onFocus:$,onMouseEnter:j,onMouseMove:A,onMouseLeave:F,ref:Fe(D,S,e),isDisabled:i,isFocusable:l});return{...d,...z,type:u??z.type,id:C,role:"menuitem",tabIndex:K?0:-1}}function oh(t={},e=null){const{type:n="radio",isChecked:r,...o}=t;return{...Qa(o,e),role:`menuitem${n}`,"aria-checked":r}}function sh(t={}){const{children:e,type:n="radio",value:r,defaultValue:o,onChange:s,...a}=t,l=n==="radio"?"":[],[c,u]=Sa({defaultValue:o??l,value:r,onChange:s}),d=b.useCallback(y=>{if(n==="radio"&&typeof c=="string"&&u(y),n==="checkbox"&&Array.isArray(c)){const h=c.includes(y)?c.filter(v=>v!==y):c.concat(y);u(h)}},[c,u,n]),p=cs(e).map(y=>{if(y.type.id!=="MenuItemOption")return y;const h=w=>{var g,x;d(y.props.value),(x=(g=y.props).onClick)==null||x.call(g,w)},v=n==="radio"?y.props.value===c:c.includes(y.props.value);return b.cloneElement(y,{type:n,onClick:h,isChecked:v})});return{...a,children:p}}function Qu(t){var e;if(!ed(t))return!1;const n=(e=t.ownerDocument.defaultView)!=null?e:window;return t instanceof n.HTMLElement}function ed(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}var[td,zr]=et({name:"MenuStylesContext",errorMessage:`useMenuStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Menu />" `}),bs=t=>{const{children:e}=t,n=Ot("Menu",t),r=Je(t),{direction:o}=ts(),{descendants:s,...a}=Yu({...r,direction:o}),i=b.useMemo(()=>a,[a]),{isOpen:l,onClose:c,forceUpdate:u}=i;return m.jsx(zu,{value:s,children:m.jsx(Ju,{value:i,children:m.jsx(td,{value:n,children:ga(e,{isOpen:l,onClose:c,forceUpdate:u})})})})};bs.displayName="Menu";var ei=Q((t,e)=>{const n=zr();return m.jsx(J.span,{ref:e,...t,__css:n.command,className:"chakra-menu__command"})});ei.displayName="MenuCommand";var nd=Q((t,e)=>{const{type:n,...r}=t,o=zr(),s=r.as||n?n??void 0:"button",a=b.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...o.item}),[o.item]);return m.jsx(J.button,{ref:e,type:s,...r,__css:a})}),ti=t=>{const{className:e,children:n,...r}=t,o=zr(),s=b.Children.only(n),a=b.isValidElement(s)?b.cloneElement(s,{focusable:"false","aria-hidden":!0,className:pe("chakra-menu__icon",s.props.className)}):null,i=pe("chakra-menu__icon-wrapper",e);return m.jsx(J.span,{className:i,...r,__css:o.icon,children:a})};ti.displayName="MenuIcon";var wt=Q((t,e)=>{const{icon:n,iconSpacing:r="0.75rem",command:o,commandSpacing:s="0.75rem",children:a,...i}=t,l=Qa(i,e),u=n||o?m.jsx("span",{style:{pointerEvents:"none",flex:1},children:a}):a;return m.jsxs(nd,{...l,className:pe("chakra-menu__menuitem",l.className),children:[n&&m.jsx(ti,{fontSize:"0.8em",marginEnd:r,children:n}),u,o&&m.jsx(ei,{marginStart:s,children:o})]})});wt.displayName="MenuItem";var rd={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},od=J(ns.div),xs=Q(function(e,n){var r,o;const{rootProps:s,motionProps:a,...i}=e,{isOpen:l,onTransitionEnd:c,unstable__animationState:u}=Un(),d=Xu(i,n),f=Zu(s),p=zr();return m.jsx(J.div,{...f,__css:{zIndex:(o=e.zIndex)!=null?o:(r=p.list)==null?void 0:r.zIndex},children:m.jsx(od,{variants:rd,initial:!1,animate:l?"enter":"exit",__css:{outline:0,...p.list},...a,className:pe("chakra-menu__menu-list",d.className),...d,onUpdate:c,onAnimationComplete:wa(u.onComplete,d.onAnimationComplete)})})});xs.displayName="MenuList";var[sd,fn]=et({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[ad,qr]=et({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `});function ni(t){const e=b.Children.only(t.children),{getTriggerProps:n}=fn();return b.cloneElement(e,n(e.props,e.ref))}ni.displayName="PopoverTrigger";var Yt={click:"click",hover:"hover"};function id(t={}){const{closeOnBlur:e=!0,closeOnEsc:n=!0,initialFocusRef:r,id:o,returnFocusOnClose:s=!0,autoFocus:a=!0,arrowSize:i,arrowShadowColor:l,trigger:c=Yt.click,openDelay:u=200,closeDelay:d=200,isLazy:f,lazyBehavior:p="unmount",computePositionOnMount:y,...h}=t,{isOpen:v,onClose:w,onOpen:g,onToggle:x}=gs(t),E=b.useRef(null),S=b.useRef(null),C=b.useRef(null),k=b.useRef(!1),D=b.useRef(!1);v&&(D.current=!0);const[j,A]=b.useState(!1),[F,q]=b.useState(!1),$=b.useId(),K=o??$,[le,z,I,Z]=["popover-trigger","popover-content","popover-header","popover-body"].map(T=>`${T}-${K}`),{referenceRef:oe,getArrowProps:he,getPopperProps:be,getArrowInnerProps:Ee,forceUpdate:ce}=vs({...h,enabled:v||!!y}),se=Xa({isOpen:v,ref:C});Zl({enabled:v,ref:S}),Ba(C,{focusRef:S,visible:v,shouldFocus:s&&c===Yt.click}),xc(C,{focusRef:r,visible:v,shouldFocus:a&&c===Yt.click});const _=ws({wasSelected:D.current,enabled:f,mode:p,isSelected:se.present}),N=b.useCallback((T={},te=null)=>{const ne={...T,style:{...T.style,transformOrigin:je.transformOrigin.varRef,[je.arrowSize.var]:i?`${i}px`:void 0,[je.arrowShadowColor.var]:l},ref:Fe(C,te),children:_?T.children:null,id:z,tabIndex:-1,role:"dialog",onKeyDown:xe(T.onKeyDown,ie=>{n&&ie.key==="Escape"&&w()}),onBlur:xe(T.onBlur,ie=>{const Ie=Qs(ie),Y=eo(C.current,Ie),de=eo(S.current,Ie);v&&e&&(!Y&&!de)&&w()}),"aria-labelledby":j?I:void 0,"aria-describedby":F?Z:void 0};return c===Yt.hover&&(ne.role="tooltip",ne.onMouseEnter=xe(T.onMouseEnter,()=>{k.current=!0}),ne.onMouseLeave=xe(T.onMouseLeave,ie=>{ie.nativeEvent.relatedTarget!==null&&(k.current=!1,setTimeout(()=>w(),d))})),ne},[_,z,j,I,F,Z,c,n,w,v,e,d,l,i]),M=b.useCallback((T={},te=null)=>be({...T,style:{visibility:v?"visible":"hidden",...T.style}},te),[v,be]),L=b.useCallback((T,te=null)=>({...T,ref:Fe(te,E,oe)}),[E,oe]),X=b.useRef(),G=b.useRef(),ae=b.useCallback(T=>{E.current==null&&oe(T)},[oe]),V=b.useCallback((T={},te=null)=>{const ne={...T,ref:Fe(S,te,ae),id:le,"aria-haspopup":"dialog","aria-expanded":v,"aria-controls":z};return c===Yt.click&&(ne.onClick=xe(T.onClick,x)),c===Yt.hover&&(ne.onFocus=xe(T.onFocus,()=>{X.current===void 0&&g()}),ne.onBlur=xe(T.onBlur,ie=>{const Ie=Qs(ie),Y=!eo(C.current,Ie);v&&e&&Y&&w()}),ne.onKeyDown=xe(T.onKeyDown,ie=>{ie.key==="Escape"&&w()}),ne.onMouseEnter=xe(T.onMouseEnter,()=>{k.current=!0,X.current=window.setTimeout(()=>g(),u)}),ne.onMouseLeave=xe(T.onMouseLeave,()=>{k.current=!1,X.current&&(clearTimeout(X.current),X.current=void 0),G.current=window.setTimeout(()=>{k.current===!1&&w()},d)})),ne},[le,v,z,c,ae,x,g,e,w,u,d]);b.useEffect(()=>()=>{X.current&&clearTimeout(X.current),G.current&&clearTimeout(G.current)},[]);const W=b.useCallback((T={},te=null)=>({...T,id:I,ref:Fe(te,ne=>{A(!!ne)})}),[I]),ee=b.useCallback((T={},te=null)=>({...T,id:Z,ref:Fe(te,ne=>{q(!!ne)})}),[Z]);return{forceUpdate:ce,isOpen:v,onAnimationComplete:se.onComplete,onClose:w,getAnchorProps:L,getArrowProps:he,getArrowInnerProps:Ee,getPopoverPositionerProps:M,getPopoverProps:N,getTriggerProps:V,getHeaderProps:W,getBodyProps:ee}}function eo(t,e){return t===e||(t==null?void 0:t.contains(e))}function Qs(t){var e;const n=t.currentTarget.ownerDocument.activeElement;return(e=t.relatedTarget)!=null?e:n}function ri(t){const e=Ot("Popover",t),{children:n,...r}=Je(t),o=ts(),s=id({...r,direction:o.direction});return m.jsx(sd,{value:s,children:m.jsx(ad,{value:e,children:ga(n,{isOpen:s.isOpen,onClose:s.onClose,forceUpdate:s.forceUpdate})})})}ri.displayName="Popover";var to=(t,e)=>e?`${t}.${e}, ${e}`:void 0;function oi(t){var e;const{bg:n,bgColor:r,backgroundColor:o,shadow:s,boxShadow:a,shadowColor:i}=t,{getArrowProps:l,getArrowInnerProps:c}=fn(),u=qr(),d=(e=n??r)!=null?e:o,f=s??a;return m.jsx(J.div,{...l(),className:"chakra-popover__arrow-positioner",children:m.jsx(J.div,{className:pe("chakra-popover__arrow",t.className),...c(t),__css:{"--popper-arrow-shadow-color":to("colors",i),"--popper-arrow-bg":to("colors",d),"--popper-arrow-shadow":to("shadows",f),...u.arrow}})})}oi.displayName="PopoverArrow";var si=Q(function(e,n){const{getBodyProps:r}=fn(),o=qr();return m.jsx(J.div,{...r(e,n),className:pe("chakra-popover__body",e.className),__css:o.body})});si.displayName="PopoverBody";var ai=Q(function(e,n){const{onClose:r}=fn(),o=qr();return m.jsx(gl,{size:"sm",onClick:r,className:pe("chakra-popover__close-btn",e.className),__css:o.closeButton,ref:n,...e})});ai.displayName="PopoverCloseButton";function ld(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}var cd={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},ud=J(ns.section),ii=Q(function(e,n){const{variants:r=cd,...o}=e,{isOpen:s}=fn();return m.jsx(ud,{ref:n,variants:ld(r),initial:!1,animate:s?"enter":"exit",...o})});ii.displayName="PopoverTransition";var li=Q(function(e,n){const{rootProps:r,motionProps:o,...s}=e,{getPopoverProps:a,getPopoverPositionerProps:i,onAnimationComplete:l}=fn(),c=qr(),u={position:"relative",display:"flex",flexDirection:"column",...c.content};return m.jsx(J.div,{...i(r),__css:c.popper,className:"chakra-popover__popper",children:m.jsx(ii,{...o,...a(s,n),onAnimationComplete:wa(l,s.onAnimationComplete),className:pe("chakra-popover__content",e.className),__css:u})})});li.displayName="PopoverContent";var[dd,fd,pd,hd]=Ca();function md(t){var e;const{defaultIndex:n,onChange:r,index:o,isManual:s,isLazy:a,lazyBehavior:i="unmount",orientation:l="horizontal",direction:c="ltr",...u}=t,[d,f]=b.useState(n??0),[p,y]=Sa({defaultValue:n??0,value:o,onChange:r});b.useEffect(()=>{o!=null&&f(o)},[o]);const h=pd(),v=b.useId();return{id:`tabs-${(e=t.id)!=null?e:v}`,selectedIndex:p,focusedIndex:d,setSelectedIndex:y,setFocusedIndex:f,isManual:s,isLazy:a,lazyBehavior:i,orientation:l,descendants:h,direction:c,htmlProps:u}}var[yd,Vr]=et({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function vd(t){const{focusedIndex:e,orientation:n,direction:r}=Vr(),o=fd(),s=b.useCallback(a=>{const i=()=>{var g;const x=o.nextEnabled(e);x&&((g=x.node)==null||g.focus())},l=()=>{var g;const x=o.prevEnabled(e);x&&((g=x.node)==null||g.focus())},c=()=>{var g;const x=o.firstEnabled();x&&((g=x.node)==null||g.focus())},u=()=>{var g;const x=o.lastEnabled();x&&((g=x.node)==null||g.focus())},d=n==="horizontal",f=n==="vertical",p=a.key,y=r==="ltr"?"ArrowLeft":"ArrowRight",h=r==="ltr"?"ArrowRight":"ArrowLeft",w={[y]:()=>d&&l(),[h]:()=>d&&i(),ArrowDown:()=>f&&i(),ArrowUp:()=>f&&l(),Home:c,End:u}[p];w&&(a.preventDefault(),w(a))},[o,e,n,r]);return{...t,role:"tablist","aria-orientation":n,onKeyDown:xe(t.onKeyDown,s)}}function gd(t){const{isDisabled:e=!1,isFocusable:n=!1,...r}=t,{setSelectedIndex:o,isManual:s,id:a,setFocusedIndex:i,selectedIndex:l}=Vr(),{index:c,register:u}=hd({disabled:e&&!n}),d=c===l,f=()=>{o(c)},p=()=>{i(c),!s&&!(e&&n)&&o(c)},y=Wa({...r,ref:Fe(u,t.ref),isDisabled:e,isFocusable:n,onClick:xe(t.onClick,f)}),h="button";return{...y,id:ci(a,c),role:"tab",tabIndex:d?0:-1,type:h,"aria-selected":d,"aria-controls":ui(a,c),onFocus:e?void 0:xe(t.onFocus,p)}}var[wd,bd]=et({});function xd(t){const e=Vr(),{id:n,selectedIndex:r}=e,s=cs(t.children).map((a,i)=>b.createElement(wd,{key:i,value:{isSelected:i===r,id:ui(n,i),tabId:ci(n,i),selectedIndex:r}},a));return{...t,children:s}}function kd(t){const{children:e,...n}=t,{isLazy:r,lazyBehavior:o}=Vr(),{isSelected:s,id:a,tabId:i}=bd(),l=b.useRef(!1);s&&(l.current=!0);const c=ws({wasSelected:l.current,isSelected:s,enabled:r,mode:o});return{tabIndex:0,...n,children:c?e:null,role:"tabpanel","aria-labelledby":i,hidden:!s,id:a}}function ci(t,e){return`${t}--tab-${e}`}function ui(t,e){return`${t}--tabpanel-${e}`}var[_d,Hr]=et({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),di=Q(function(e,n){const r=Ot("Tabs",e),{children:o,className:s,...a}=Je(e),{htmlProps:i,descendants:l,...c}=md(a),u=b.useMemo(()=>c,[c]),{isFitted:d,...f}=i,p={position:"relative",...r.root};return m.jsx(dd,{value:l,children:m.jsx(yd,{value:u,children:m.jsx(_d,{value:r,children:m.jsx(J.div,{className:pe("chakra-tabs",s),ref:n,...f,__css:p,children:o})})})})});di.displayName="Tabs";var fi=Q(function(e,n){const r=vd({...e,ref:n}),s={display:"flex",...Hr().tablist};return m.jsx(J.div,{...r,className:pe("chakra-tabs__tablist",e.className),__css:s})});fi.displayName="TabList";var wo=Q(function(e,n){const r=kd({...e,ref:n}),o=Hr();return m.jsx(J.div,{outline:"0",...r,className:pe("chakra-tabs__tab-panel",e.className),__css:o.tabpanel})});wo.displayName="TabPanel";var pi=Q(function(e,n){const r=xd(e),o=Hr();return m.jsx(J.div,{...r,width:"100%",ref:n,className:pe("chakra-tabs__tab-panels",e.className),__css:o.tabpanels})});pi.displayName="TabPanels";var bo=Q(function(e,n){const r=Hr(),o=gd({...e,ref:n}),s={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...r.tab};return m.jsx(J.button,{...o,className:pe("chakra-tabs__tab",e.className),__css:s})});bo.displayName="Tab";var[Ed,hi]=et({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),mi=Q((t,e)=>{const n=Ot("Tag",t),r=Je(t),o={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...n.container};return m.jsx(Ed,{value:n,children:m.jsx(J.span,{ref:e,...r,__css:o})})});mi.displayName="Tag";var Cd=Q((t,e)=>{const n=hi();return m.jsx(J.span,{ref:e,noOfLines:1,...t,__css:n.label})});Cd.displayName="TagLabel";var Sd=Q((t,e)=>m.jsx(Mr,{ref:e,verticalAlign:"top",marginEnd:"0.5rem",...t}));Sd.displayName="TagLeftIcon";var jd=Q((t,e)=>m.jsx(Mr,{ref:e,verticalAlign:"top",marginStart:"0.5rem",...t}));jd.displayName="TagRightIcon";var yi=t=>m.jsx(Mr,{verticalAlign:"inherit",viewBox:"0 0 512 512",...t,children:m.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});yi.displayName="TagCloseIcon";var Dd=Q((t,e)=>{const{isDisabled:n,children:r,...o}=t,a={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...hi().closeButton};return m.jsx(J.button,{ref:e,"aria-label":"close",...o,type:"button",disabled:n,__css:a,children:r||m.jsx(yi,{})})});Dd.displayName="TagCloseButton";var Od={exit:{scale:.85,opacity:0,transition:{opacity:{duration:.15,easings:"easeInOut"},scale:{duration:.2,easings:"easeInOut"}}},enter:{scale:1,opacity:1,transition:{opacity:{easings:"easeOut",duration:.2},scale:{duration:.2,ease:[.175,.885,.4,1.1]}}}},xo=t=>{var e;return((e=t.current)==null?void 0:e.ownerDocument)||document},sr=t=>{var e,n;return((n=(e=t.current)==null?void 0:e.ownerDocument)==null?void 0:n.defaultView)||window};function Id(t={}){const{openDelay:e=0,closeDelay:n=0,closeOnClick:r=!0,closeOnMouseDown:o,closeOnScroll:s,closeOnPointerDown:a=o,closeOnEsc:i=!0,onOpen:l,onClose:c,placement:u,id:d,isOpen:f,defaultIsOpen:p,arrowSize:y=10,arrowShadowColor:h,arrowPadding:v,modifiers:w,isDisabled:g,gutter:x,offset:E,direction:S,...C}=t,{isOpen:k,onOpen:D,onClose:j}=gs({isOpen:f,defaultIsOpen:p,onOpen:l,onClose:c}),{referenceRef:A,getPopperProps:F,getArrowInnerProps:q,getArrowProps:$}=vs({enabled:k,placement:u,arrowPadding:v,modifiers:w,gutter:x,offset:E,direction:S}),K=b.useId(),z=`tooltip-${d??K}`,I=b.useRef(null),Z=b.useRef(),oe=b.useCallback(()=>{Z.current&&(clearTimeout(Z.current),Z.current=void 0)},[]),he=b.useRef(),be=b.useCallback(()=>{he.current&&(clearTimeout(he.current),he.current=void 0)},[]),Ee=b.useCallback(()=>{be(),j()},[j,be]),ce=Pd(I,Ee),se=b.useCallback(()=>{if(!g&&!Z.current){k&&ce();const V=sr(I);Z.current=V.setTimeout(D,e)}},[ce,g,k,D,e]),_=b.useCallback(()=>{oe();const V=sr(I);he.current=V.setTimeout(Ee,n)},[n,Ee,oe]),N=b.useCallback(()=>{k&&r&&_()},[r,_,k]),M=b.useCallback(()=>{k&&a&&_()},[a,_,k]),L=b.useCallback(V=>{k&&V.key==="Escape"&&_()},[k,_]);en(()=>xo(I),"keydown",i?L:void 0),en(()=>{if(!s)return null;const V=I.current;if(!V)return null;const W=Fa(V);return W.localName==="body"?sr(I):W},"scroll",()=>{k&&s&&Ee()},{passive:!0,capture:!0}),b.useEffect(()=>{g&&(oe(),k&&j())},[g,k,j,oe]),b.useEffect(()=>()=>{oe(),be()},[oe,be]),en(()=>I.current,"pointerleave",_);const X=b.useCallback((V={},W=null)=>({...V,ref:Fe(I,W,A),onPointerEnter:xe(V.onPointerEnter,T=>{T.pointerType!=="touch"&&se()}),onClick:xe(V.onClick,N),onPointerDown:xe(V.onPointerDown,M),onFocus:xe(V.onFocus,se),onBlur:xe(V.onBlur,_),"aria-describedby":k?z:void 0}),[se,_,M,k,z,N,A]),G=b.useCallback((V={},W=null)=>F({...V,style:{...V.style,[je.arrowSize.var]:y?`${y}px`:void 0,[je.arrowShadowColor.var]:h}},W),[F,y,h]),ae=b.useCallback((V={},W=null)=>{const ee={...V.style,position:"relative",transformOrigin:je.transformOrigin.varRef};return{ref:W,...C,...V,id:z,role:"tooltip",style:ee}},[C,z]);return{isOpen:k,show:se,hide:_,getTriggerProps:X,getTooltipProps:ae,getTooltipPositionerProps:G,getArrowProps:$,getArrowInnerProps:q}}var no="chakra-ui:close-tooltip";function Pd(t,e){return b.useEffect(()=>{const n=xo(t);return n.addEventListener(no,e),()=>n.removeEventListener(no,e)},[e,t]),()=>{const n=xo(t),r=sr(t);n.dispatchEvent(new r.CustomEvent(no))}}function Nd(t,e=[]){const n=Object.assign({},t);for(const r of e)r in n&&delete n[r];return n}function Ad(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}var Fd=J(ns.div),Wt=Q((t,e)=>{var n,r;const o=Wn("Tooltip",t),s=Je(t),a=ts(),{children:i,label:l,shouldWrapChildren:c,"aria-label":u,hasArrow:d,bg:f,portalProps:p,background:y,backgroundColor:h,bgColor:v,motionProps:w,...g}=s,x=(r=(n=y??h)!=null?n:f)!=null?r:v;if(x){o.bg=x;const F=wl(a,"colors",x);o[je.arrowBg.var]=F}const E=Id({...g,direction:a.direction}),S=typeof i=="string"||c;let C;if(S)C=m.jsx(J.span,{display:"inline-block",tabIndex:0,...E.getTriggerProps(),children:i});else{const F=b.Children.only(i);C=b.cloneElement(F,E.getTriggerProps(F.props,F.ref))}const k=!!u,D=E.getTooltipProps({},e),j=k?Nd(D,["role","id"]):D,A=Ad(D,["role","id"]);return l?m.jsxs(m.Fragment,{children:[C,m.jsx(bl,{children:E.isOpen&&m.jsx(ba,{...p,children:m.jsx(J.div,{...E.getTooltipPositionerProps(),__css:{zIndex:o.zIndex,pointerEvents:"none"},children:m.jsxs(Fd,{variants:Od,initial:"exit",animate:"enter",exit:"exit",...w,...j,__css:o,children:[l,k&&m.jsx(J.span,{srOnly:!0,...A,children:u}),d&&m.jsx(J.div,{"data-popper-arrow":!0,className:"chakra-tooltip__arrow-wrapper",children:m.jsx(J.div,{"data-popper-arrow-inner":!0,className:"chakra-tooltip__arrow",__css:{bg:o.bg}})})]})})})})]}):m.jsx(m.Fragment,{children:i})});Wt.displayName="Tooltip";let Jn;const Md=new Uint8Array(16);function Rd(){if(!Jn&&(Jn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Jn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Jn(Md)}const Ne=[];for(let t=0;t<256;++t)Ne.push((t+256).toString(16).slice(1));function Td(t,e=0){return Ne[t[e+0]]+Ne[t[e+1]]+Ne[t[e+2]]+Ne[t[e+3]]+"-"+Ne[t[e+4]]+Ne[t[e+5]]+"-"+Ne[t[e+6]]+Ne[t[e+7]]+"-"+Ne[t[e+8]]+Ne[t[e+9]]+"-"+Ne[t[e+10]]+Ne[t[e+11]]+Ne[t[e+12]]+Ne[t[e+13]]+Ne[t[e+14]]+Ne[t[e+15]]}const Ld=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ea={randomUUID:Ld};function Pn(t,e,n){if(ea.randomUUID&&!e&&!t)return ea.randomUUID();t=t||{};const r=t.random||(t.rng||Rd)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let o=0;o<16;++o)e[n+o]=r[o];return e}return Td(r)}async function Wd(t){console.warn("[workspace deprecated] getDB is deprecated",t);try{const e=await fetch(`/workspace/get_db?table=${t}`);return e.ok?await e.json():void 0}catch(e){console.error("Error fetching workspace:",e);return}}async function Bd(t,e){try{return await(await fetch("/workspace/save_db",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table:t,json:e})})).text()}catch(n){console.error("Error saving workspace:",n)}}async function vi(t,e){try{return await(await fetch("/workspace/update_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,json_str:e})})).text()}catch(n){alert("Error saving workflow .json file: "+n),console.error("Error saving workspace:",n)}}async function gi(t,e=!1){try{return await(await fetch("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,deleteEmptyFolder:e})})).text()}catch(n){console.error("Error deleting file:",n)}}async function $d(t){try{return await(await fetch("/workspace/get_system_dir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absolute_dir:t??""})})).json()}catch(e){console.error("Error getting workflows dir:",e)}}async function ah(){try{return await(await fetch("/workspace/open_workflow_file_browser",{method:"POST",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error open workflows folder:",t)}}async function ih(){try{return await(await fetch("/model_manager/get_model_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function lh(){try{return await(await fetch("/model_manager/get_folder_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}const Kd="backup",gr="workspace";let Gn=null;function Ud(){return new Promise((t,e)=>{const n=indexedDB.open("WorkspaceDB",3);n.onupgradeneeded=r=>{const o=r.target.result;o.objectStoreNames.contains(gr)||o.createObjectStore(gr,{keyPath:"id"})},n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{e(r.target.error)}})}async function zd(){try{return Gn==null&&(Gn=await Ud()),new Promise((t,e)=>{if(Gn==null)return e("indexDB is null");const o=Gn.transaction([gr],"readonly").objectStore(gr).get(Kd);o.onsuccess=()=>{o.result?t(o.result.value):t(void 0)},o.onerror=()=>e(o.error)})}catch(t){console.error("Error while reading from database:",t)}}async function qd(){try{return await zd()}catch(t){console.error("Error retrieving data from IndexedDB:",t)}}const ye=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,De=Object.keys,Re=Array.isArray;function Be(t,e){return typeof e!="object"||De(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||ye.Promise||(ye.Promise=Promise);const Nn=Object.getPrototypeOf,Vd={}.hasOwnProperty;function He(t,e){return Vd.call(t,e)}function un(t,e){typeof e=="function"&&(e=e(Nn(t))),(typeof Reflect>"u"?De:Reflect.ownKeys)(e).forEach(n=>{mt(t,n,e[n])})}const wi=Object.defineProperty;function mt(t,e,n,r){wi(t,e,Be(n&&He(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function tn(t){return{from:function(e){return t.prototype=Object.create(e.prototype),mt(t.prototype,"constructor",t),{extend:un.bind(null,t.prototype)}}}}const Hd=Object.getOwnPropertyDescriptor;function ks(t,e){let n;return Hd(t,e)||(n=Nn(t))&&ks(n,e)}const Jd=[].slice;function wr(t,e,n){return Jd.call(t,e,n)}function bi(t,e){return e(t)}function gn(t){if(!t)throw new Error("Assertion Failed")}function xi(t){ye.setImmediate?setImmediate(t):setTimeout(t,0)}function ki(t,e){return t.reduce((n,r,o)=>{var s=e(r,o);return s&&(n[s[0]]=s[1]),n},{})}function yt(t,e){if(He(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,o=e.length;r<o;++r){var s=yt(t,e[r]);n.push(s)}return n}var a=e.indexOf(".");if(a!==-1){var i=t[e.substr(0,a)];return i===void 0?void 0:yt(i,e.substr(a+1))}}function rt(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){gn(typeof n!="string"&&"length"in n);for(var r=0,o=e.length;r<o;++r)rt(t,e[r],n[r])}else{var s=e.indexOf(".");if(s!==-1){var a=e.substr(0,s),i=e.substr(s+1);if(i==="")n===void 0?Re(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=n;else{var l=t[a];l&&He(t,a)||(l=t[a]={}),rt(l,i,n)}}else n===void 0?Re(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function _i(t){var e={};for(var n in t)He(t,n)&&(e[n]=t[n]);return e}const Gd=[].concat;function Ei(t){return Gd.apply([],t)}const Ci="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ei([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>ye[t]),Yd=Ci.map(t=>ye[t]);ki(Ci,t=>[t,!0]);let xt=null;function zn(t){xt=typeof WeakMap<"u"&&new WeakMap;const e=ko(t);return xt=null,e}function ko(t){if(!t||typeof t!="object")return t;let e=xt&&xt.get(t);if(e)return e;if(Re(t)){e=[],xt&&xt.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(ko(t[n]))}else if(Yd.indexOf(t.constructor)>=0)e=t;else{const s=Nn(t);for(var o in e=s===Object.prototype?{}:Object.create(s),xt&&xt.set(t,e),t)He(t,o)&&(e[o]=ko(t[o]))}return e}const{toString:Xd}={};function _o(t){return Xd.call(t).slice(8,-1)}const Eo=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Zd=typeof Eo=="symbol"?function(t){var e;return t!=null&&(e=t[Eo])&&e.apply(t)}:function(){return null},Qt={};function dt(t){var e,n,r,o;if(arguments.length===1){if(Re(t))return t.slice();if(this===Qt&&typeof t=="string")return[t];if(o=Zd(t)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const _s=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var lt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Si(t,e){lt=t,ji=e}var ji=()=>!0;const Qd=!new Error("").stack;function Ht(){if(Qd)try{throw Ht.arguments,new Error}catch(t){return t}return new Error}function Co(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(ji).map(r=>`
`+r).join("")):""}var Di=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Es=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Di),ef={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function nn(t,e){this._e=Ht(),this.name=t,this.message=e}function Oi(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,o)=>o.indexOf(n)===r).join(`
`)}function br(t,e,n,r){this._e=Ht(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Oi(t,e)}function En(t,e){this._e=Ht(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Oi(t,e)}tn(nn).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Co(this._e,2))}},toString:function(){return this.name+": "+this.message}}),tn(br).from(nn),tn(En).from(nn);var Cs=Es.reduce((t,e)=>(t[e]=e+"Error",t),{});const tf=nn;var U=Es.reduce((t,e)=>{var n=e+"Error";function r(o,s){this._e=Ht(),this.name=n,o?typeof o=="string"?(this.message=`${o}${s?`
 `+s:""}`,this.inner=s||null):typeof o=="object"&&(this.message=`${o.name} ${o.message}`,this.inner=o):(this.message=ef[e]||n,this.inner=null)}return tn(r).from(tf),t[e]=r,t},{});U.Syntax=SyntaxError,U.Type=TypeError,U.Range=RangeError;var ta=Di.reduce((t,e)=>(t[e+"Error"]=U[e],t),{}),ar=Es.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=U[e]),t),{});function fe(){}function An(t){return t}function nf(t,e){return t==null||t===An?e:function(n){return e(t(n))}}function qt(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function rf(t,e){return t===fe?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?qt(r,this.onsuccess):r),o&&(this.onerror=this.onerror?qt(o,this.onerror):o),s!==void 0?s:n}}function of(t,e){return t===fe?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?qt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?qt(r,this.onerror):r)}}function sf(t,e){return t===fe?e:function(n){var r=t.apply(this,arguments);Be(n,r);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?qt(o,this.onsuccess):o),s&&(this.onerror=this.onerror?qt(s,this.onerror):s),r===void 0?a===void 0?void 0:a:Be(r,a)}}function af(t,e){return t===fe?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function Ss(t,e){return t===fe?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return n.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}ar.ModifyError=br,ar.DexieError=nn,ar.BulkError=En;var Fn={};const Ii=100,[So,xr,jo]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,Nn(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Nn(e),t]})(),Pi=xr&&xr.then,ir=So&&So.constructor,js=!!jo;var Do=!1,lf=jo?()=>{jo.then(Yn)}:ye.setImmediate?setImmediate.bind(null,Yn):ye.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{Yn(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(Yn,0)},Cn=function(t,e){wn.push([t,e]),kr&&(lf(),kr=!1)},Oo=!0,kr=!0,Bt=[],lr=[],Io=null,Po=An,rn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:oa,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{oa(t[0],t[1])}catch{}})}},B=rn,wn=[],$t=0,cr=[];function R(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=fe,this._lib=!1;var e=this._PSD=B;if(lt&&(this._stackHolder=Ht(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Fn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ao(this,this._value))}this._state=null,this._value=null,++e.ref,Ai(this,t)}const No={get:function(){var t=B,e=_r;function n(r,o){var s=!t.global&&(t!==B||e!==_r);const a=s&&!gt();var i=new R((l,c)=>{Ds(this,new Ni(Er(r,t,s,a),Er(o,t,s,a),l,c,t))});return lt&&Ri(i,this),i}return n.prototype=Fn,n},set:function(t){mt(this,"then",t&&t.prototype===Fn?No:{get:function(){return t},set:No.set})}};function Ni(t,e,n,r,o){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=o}function Ai(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&qn();n&&typeof n.then=="function"?Ai(t,(o,s)=>{n instanceof R?n._then(o,s):n.then(o,s)}):(t._state=!0,t._value=n,Fi(t)),r&&Vn()}},Ao.bind(null,t))}catch(n){Ao(t,n)}}function Ao(t,e){if(lr.push(e),t._state===null){var n=t._lib&&qn();e=Po(e),t._state=!1,t._value=e,lt&&e!==null&&typeof e=="object"&&!e._promise&&function(r,o,s){try{r.apply(null,s)}catch(a){o&&o(a)}}(()=>{var r=ks(e,"stack");e._promise=t,mt(e,"stack",{get:()=>Do?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){Bt.some(o=>o._value===r._value)||Bt.push(r)}(t),Fi(t),n&&Vn()}}function Fi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Ds(t,e[n]);var o=t._PSD;--o.ref||o.finalize(),$t===0&&(++$t,Cn(()=>{--$t==0&&Os()},[]))}function Ds(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++$t,Cn(cf,[n,t,e])}else t._listeners.push(e)}function cf(t,e,n){try{Io=e;var r,o=e._value;e._state?r=t(o):(lr.length&&(lr=[]),r=t(o),lr.indexOf(o)===-1&&function(s){for(var a=Bt.length;a;)if(Bt[--a]._value===s._value)return void Bt.splice(a,1)}(e)),n.resolve(r)}catch(s){n.reject(s)}finally{Io=null,--$t==0&&Os(),--n.psd.ref||n.psd.finalize()}}function Mi(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var o,s,a=t._value;a!=null?(o=a.name||"Error",s=a.message||a,r=Co(a,0)):(o=a,s=""),e.push(o+(s?": "+s:"")+r)}return lt&&((r=Co(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&Mi(t._prev,e,n)),e}function Ri(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function Yn(){qn()&&Vn()}function qn(){var t=Oo;return Oo=!1,kr=!1,t}function Vn(){var t,e,n;do for(;wn.length>0;)for(t=wn,wn=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(wn.length>0);Oo=!0,kr=!0}function Os(){var t=Bt;Bt=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=cr.slice(0),n=e.length;n;)e[--n]()}function Xn(t){return new R(Fn,!1,t)}function we(t,e){var n=B;return function(){var r=qn(),o=B;try{return jt(n,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{jt(o,!1),r&&Vn()}}}un(R.prototype,{then:No,_then:function(t,e){Ds(this,new Ni(null,null,t,e,B))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):Xn(r)):this.then(null,r=>r&&r.name===e?n(r):Xn(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),Xn(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Do=!0;var t=Mi(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Do=!1}}},timeout:function(t,e){return t<1/0?new R((n,r)=>{var o=setTimeout(()=>r(new U.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&mt(R.prototype,Symbol.toStringTag,"Dexie.Promise"),rn.env=Ti(),un(R,{all:function(){var t=dt.apply(null,arguments).map(Zn);return new R(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((o,s)=>R.resolve(o).then(a=>{t[s]=a,--r||e(t)},n))})},resolve:t=>{if(t instanceof R)return t;if(t&&typeof t.then=="function")return new R((n,r)=>{t.then(n,r)});var e=new R(Fn,!0,t);return Ri(e,Io),e},reject:Xn,race:function(){var t=dt.apply(null,arguments).map(Zn);return new R((e,n)=>{t.map(r=>R.resolve(r).then(e,n))})},PSD:{get:()=>B,set:t=>B=t},totalEchoes:{get:()=>_r},newPSD:St,usePSD:hn,scheduler:{get:()=>Cn,set:t=>{Cn=t}},rejectionMapper:{get:()=>Po,set:t=>{Po=t}},follow:(t,e)=>new R((n,r)=>St((o,s)=>{var a=B;a.unhandleds=[],a.onunhandled=s,a.finalize=qt(function(){(function(i){function l(){i(),cr.splice(cr.indexOf(l),1)}cr.push(l),++$t,Cn(()=>{--$t==0&&Os()},[])})(()=>{this.unhandleds.length===0?o():s(this.unhandleds[0])})},a.finalize),t()},e,n,r))}),ir&&(ir.allSettled&&mt(R,"allSettled",function(){const t=dt.apply(null,arguments).map(Zn);return new R(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((o,s)=>R.resolve(o).then(a=>r[s]={status:"fulfilled",value:a},a=>r[s]={status:"rejected",reason:a}).then(()=>--n||e(r)))})}),ir.any&&typeof AggregateError<"u"&&mt(R,"any",function(){const t=dt.apply(null,arguments).map(Zn);return new R((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const o=new Array(r);t.forEach((s,a)=>R.resolve(s).then(i=>e(i),i=>{o[a]=i,--r||n(new AggregateError(o))}))})}));const Me={awaits:0,echoes:0,id:0};var uf=0,ur=[],ro=0,_r=0,df=0;function St(t,e,n,r){var o=B,s=Object.create(o);s.parent=o,s.ref=0,s.global=!1,s.id=++df;var a=rn.env;s.env=js?{Promise:R,PromiseProp:{value:R,configurable:!0,writable:!0},all:R.all,race:R.race,allSettled:R.allSettled,any:R.any,resolve:R.resolve,reject:R.reject,nthen:na(a.nthen,s),gthen:na(a.gthen,s)}:{},e&&Be(s,e),++o.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var i=hn(s,t,n,r);return s.ref===0&&s.finalize(),i}function pn(){return Me.id||(Me.id=++uf),++Me.awaits,Me.echoes+=Ii,Me.id}function gt(){return!!Me.awaits&&(--Me.awaits==0&&(Me.id=0),Me.echoes=Me.awaits*Ii,!0)}function Zn(t){return Me.echoes&&t&&t.constructor===ir?(pn(),t.then(e=>(gt(),e),e=>(gt(),Pe(e)))):t}function ff(t){++_r,Me.echoes&&--Me.echoes!=0||(Me.echoes=Me.id=0),ur.push(B),jt(t,!0)}function pf(){var t=ur[ur.length-1];ur.pop(),jt(t,!1)}function jt(t,e){var n=B;if((e?!Me.echoes||ro++&&t===B:!ro||--ro&&t===B)||Li(e?ff.bind(null,t):pf),t!==B&&(B=t,n===rn&&(rn.env=Ti()),js)){var r=rn.env.Promise,o=t.env;xr.then=o.nthen,r.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(ye,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function Ti(){var t=ye.Promise;return js?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(ye,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:xr.then,gthen:t.prototype.then}:{}}function hn(t,e,n,r,o){var s=B;try{return jt(t,!0),e(n,r,o)}finally{jt(s,!1)}}function Li(t){Pi.call(So,t)}function Er(t,e,n,r){return typeof t!="function"?t:function(){var o=B;n&&pn(),jt(e,!0);try{return t.apply(this,arguments)}finally{jt(o,!1),r&&Li(gt)}}}function na(t,e){return function(n,r){return t.call(this,Er(n,e),Er(r,e))}}(""+Pi).indexOf("[native code]")===-1&&(pn=gt=fe);const ra="unhandledrejection";function oa(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,o={promise:e,reason:t};if(ye.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(ra,!0,!0),Be(r,o)):ye.CustomEvent&&Be(r=new CustomEvent(ra,{detail:o}),o),r&&ye.dispatchEvent&&(dispatchEvent(r),!ye.PromiseRejectionEvent&&ye.onunhandledrejection))try{ye.onunhandledrejection(r)}catch{}lt&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var Pe=R.reject;function Fo(t,e,n,r){if(t.idbdb&&(t._state.openComplete||B.letThrough||t._vip)){var o=t._createTransaction(e,n,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===Cs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Fo(t,e,n,r))):Pe(s)}return o._promise(e,(s,a)=>St(()=>(B.trans=o,r(s,a,o)))).then(s=>o._completion.then(()=>s))}if(t._state.openComplete)return Pe(new U.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Pe(new U.DatabaseClosed);t.open().catch(fe)}return t._state.dbReadyPromise.then(()=>Fo(t,e,n,r))}const sa="3.2.4",Mt="￿",Mo=-1/0,ct="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Wi="String expected.",Sn=[],Jr=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),hf=Jr,mf=Jr,Bi=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),Gr="__dbnames",oo="readonly",so="readwrite";function Vt(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const $i={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Qn(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=zn(e))[t],e)}class yf{_trans(e,n,r){const o=this._tx||B.trans,s=this.name;function a(l,c,u){if(!u.schema[s])throw new U.NotFound("Table "+s+" not part of transaction");return n(u.idbtrans,u)}const i=qn();try{return o&&o.db===this.db?o===B.trans?o._promise(e,a,r):St(()=>o._promise(e,a,r),{trans:o,transless:B.transless||B}):Fo(this.db,e,[this.name],a)}finally{i&&Vn()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(o=>this.hook.reading.fire(o))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(Re(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=De(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(c=>c.compound&&n.every(u=>c.keyPath.indexOf(u)>=0)&&c.keyPath.every(u=>n.indexOf(u)>=0))[0];if(r&&this.db._maxKey!==Mt)return this.where(r.name).equals(r.keyPath.map(c=>e[c]));!r&&lt&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:o}=this.schema,s=this.db._deps.indexedDB;function a(c,u){try{return s.cmp(c,u)===0}catch{return!1}}const[i,l]=n.reduce(([c,u],d)=>{const f=o[d],p=e[d];return[c||f,c||!f?Vt(u,f&&f.multi?y=>{const h=yt(y,d);return Re(h)&&h.some(v=>a(p,v))}:y=>a(p,yt(y,d))):u]},[null,null]);return i?this.where(i.name).equals(e[i.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,Re(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=r=>{if(!r)return r;const o=Object.create(e.prototype);for(var s in r)if(He(r,s))try{o[s]=r[s]}catch{}return o};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){Be(this,e)})}add(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=Qn(o)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"add",keys:n!=null?[n]:null,values:[s]})).then(a=>a.numFailures?R.reject(a.failures[0]):a.lastResult).then(a=>{if(o)try{rt(e,o,a)}catch{}return a})}update(e,n){if(typeof e!="object"||Re(e))return this.where(":id").equals(e).modify(n);{const r=yt(e,this.schema.primKey.keyPath);if(r===void 0)return Pe(new U.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?De(n).forEach(o=>{rt(e,o,n[o])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=Qn(o)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"put",values:[s],keys:n!=null?[n]:null})).then(a=>a.numFailures?R.reject(a.failures[0]):a.lastResult).then(a=>{if(o)try{rt(e,o,a)}catch{}return a})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?R.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:$i})).then(e=>e.numFailures?R.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(o=>this.hook.reading.fire(o))))}bulkAdd(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:i,keyPath:l}=this.schema.primKey;if(l&&o)throw new U.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=l&&i?e.map(Qn(l)):e;return this.core.mutate({trans:a,type:"add",keys:o,values:u,wantResults:s}).then(({numFailures:d,results:f,lastResult:p,failures:y})=>{if(d===0)return s?f:p;throw new En(`${this.name}.bulkAdd(): ${d} of ${c} operations failed`,y)})})}bulkPut(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:i,keyPath:l}=this.schema.primKey;if(l&&o)throw new U.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=l&&i?e.map(Qn(l)):e;return this.core.mutate({trans:a,type:"put",keys:o,values:u,wantResults:s}).then(({numFailures:d,results:f,lastResult:p,failures:y})=>{if(d===0)return s?f:p;throw new En(`${this.name}.bulkPut(): ${d} of ${c} operations failed`,y)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:o,failures:s})=>{if(r===0)return o;throw new En(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,s)})}}function jn(t){var e={},n=function(a,i){if(i){for(var l=arguments.length,c=new Array(l-1);--l;)c[l-1]=arguments[l];return e[a].subscribe.apply(null,c),t}if(typeof a=="string")return e[a]};n.addEventType=s;for(var r=1,o=arguments.length;r<o;++r)s(arguments[r]);return n;function s(a,i,l){if(typeof a!="object"){var c;i||(i=af),l||(l=fe);var u={subscribers:[],fire:l,subscribe:function(d){u.subscribers.indexOf(d)===-1&&(u.subscribers.push(d),u.fire=i(u.fire,d))},unsubscribe:function(d){u.subscribers=u.subscribers.filter(function(f){return f!==d}),u.fire=u.subscribers.reduce(i,l)}};return e[a]=n[a]=u,u}De(c=a).forEach(function(d){var f=c[d];if(Re(f))s(d,c[d][0],c[d][1]);else{if(f!=="asap")throw new U.InvalidArgument("Invalid event config");var p=s(d,An,function(){for(var y=arguments.length,h=new Array(y);y--;)h[y]=arguments[y];p.subscribers.forEach(function(v){xi(function(){v.apply(null,h)})})})}})}}function vn(t,e){return tn(e).from({prototype:t}),e}function Xt(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function ao(t,e){t.filter=Vt(t.filter,e)}function io(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>Vt(r(),e()):e,t.justLimit=n&&!r}function dr(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new U.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function aa(t,e,n){const r=dr(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function er(t,e,n,r){const o=t.replayFilter?Vt(t.filter,t.replayFilter()):t.filter;if(t.or){const s={},a=(i,l,c)=>{if(!o||o(l,c,f=>l.stop(f),f=>l.fail(f))){var u=l.primaryKey,d=""+u;d==="[object ArrayBuffer]"&&(d=""+new Uint8Array(u)),He(s,d)||(s[d]=!0,e(i,l,c))}};return Promise.all([t.or._iterate(a,n),ia(aa(t,r,n),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}return ia(aa(t,r,n),Vt(t.algorithm,o),e,!t.keysOnly&&t.valueMapper)}function ia(t,e,n,r){var o=we(r?(s,a,i)=>n(r(s),a,i):n);return t.then(s=>{if(s)return s.start(()=>{var a=()=>s.continue();e&&!e(s,i=>a=i,i=>{s.stop(i),a=fe},i=>{s.fail(i),a=fe})||o(s.value,s,i=>a=i),a()})})}function We(t,e){try{const n=la(t),r=la(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(o,s){const a=o.length,i=s.length,l=a<i?a:i;for(let c=0;c<l;++c)if(o[c]!==s[c])return o[c]<s[c]?-1:1;return a===i?0:a<i?-1:1}(ca(t),ca(e));case"Array":return function(o,s){const a=o.length,i=s.length,l=a<i?a:i;for(let c=0;c<l;++c){const u=We(o[c],s[c]);if(u!==0)return u}return a===i?0:a<i?-1:1}(t,e)}}catch{}return NaN}function la(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=_o(t);return n==="ArrayBuffer"?"binary":n}function ca(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class vf{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,Pe.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,Pe.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=Vt(n.algorithm,e)}_iterate(e,n){return er(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Be(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>er(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,o=r.table.core;if(Xt(r,!0))return o.count({trans:n,query:{index:dr(r,o.schema),range:r.range}}).then(a=>Math.min(a,r.limit));var s=0;return er(r,()=>(++s,!1),n,o).then(()=>s)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),o=r[0],s=r.length-1;function a(c,u){return u?a(c[r[u]],u-1):c[o]}var i=this._ctx.dir==="next"?1:-1;function l(c,u){var d=a(c,s),f=a(u,s);return d<f?-i:d>f?i:0}return this.toArray(function(c){return c.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&Xt(r,!0)&&r.limit>0){const{valueMapper:o}=r,s=dr(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:s,range:r.range}}).then(({result:a})=>o?a.map(o):a)}{const o=[];return er(r,s=>o.push(s),n,r.table.core).then(()=>o)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,Xt(n)?io(n,()=>{var r=e;return(o,s)=>r===0||(r===1?(--r,!1):(s(()=>{o.advance(r),r=0}),!1))}):io(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),io(this._ctx,()=>{var n=e;return function(r,o,s){return--n<=0&&o(s),n>=0}},!0),this}until(e,n){return ao(this._ctx,function(r,o,s){return!e(r.value)||(o(s),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return ao(this._ctx,function(o){return e(o.value)}),n=this._ctx,r=e,n.isMatch=Vt(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.key,o)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.primaryKey,o)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&Xt(n,!0)&&n.limit>0)return this._read(o=>{var s=dr(n,n.table.core.schema);return n.table.core.query({trans:o,values:!1,limit:n.limit,query:{index:s,range:n.range}})}).then(({result:o})=>o).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return ao(this._ctx,function(o){var s=o.primaryKey.toString(),a=He(r,s);return r[s]=!0,!a}),this}modify(e){var n=this._ctx;return this._write(r=>{var o;if(typeof e=="function")o=e;else{var s=De(e),a=s.length;o=function(h){for(var v=!1,w=0;w<a;++w){var g=s[w],x=e[g];yt(h,g)!==x&&(rt(h,g,x),v=!0)}return v}}const i=n.table.core,{outbound:l,extractKey:c}=i.schema.primaryKey,u=this.db._options.modifyChunkSize||200,d=[];let f=0;const p=[],y=(h,v)=>{const{failures:w,numFailures:g}=v;f+=h-g;for(let x of De(w))d.push(w[x])};return this.clone().primaryKeys().then(h=>{const v=w=>{const g=Math.min(u,h.length-w);return i.getMany({trans:r,keys:h.slice(w,w+g),cache:"immutable"}).then(x=>{const E=[],S=[],C=l?[]:null,k=[];for(let j=0;j<g;++j){const A=x[j],F={value:zn(A),primKey:h[w+j]};o.call(F,F.value,F)!==!1&&(F.value==null?k.push(h[w+j]):l||We(c(A),c(F.value))===0?(S.push(F.value),l&&C.push(h[w+j])):(k.push(h[w+j]),E.push(F.value)))}const D=Xt(n)&&n.limit===1/0&&(typeof e!="function"||e===lo)&&{index:n.index,range:n.range};return Promise.resolve(E.length>0&&i.mutate({trans:r,type:"add",values:E}).then(j=>{for(let A in j.failures)k.splice(parseInt(A),1);y(E.length,j)})).then(()=>(S.length>0||D&&typeof e=="object")&&i.mutate({trans:r,type:"put",keys:C,values:S,criteria:D,changeSpec:typeof e!="function"&&e}).then(j=>y(S.length,j))).then(()=>(k.length>0||D&&e===lo)&&i.mutate({trans:r,type:"delete",keys:k,criteria:D}).then(j=>y(k.length,j))).then(()=>h.length>w+g&&v(w+u))})};return v(0).then(()=>{if(d.length>0)throw new br("Error modifying one or more objects",d,f,p);return h.length})})})}delete(){var e=this._ctx,n=e.range;return Xt(e)&&(e.isPrimKey&&!mf||n.type===3)?this._write(r=>{const{primaryKey:o}=e.table.core.schema,s=n;return e.table.core.count({trans:r,query:{index:o,range:s}}).then(a=>e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(({failures:i,lastResult:l,results:c,numFailures:u})=>{if(u)throw new br("Could not delete some values",Object.keys(i).map(d=>i[d]),a-u);return a-u}))}):this.modify(lo)}}const lo=(t,e)=>e.value=null;function gf(t,e){return t<e?-1:t===e?0:1}function wf(t,e){return t>e?-1:t===e?0:1}function qe(t,e,n){var r=t instanceof Ui?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function Zt(t){return new t.Collection(t,()=>Ki("")).limit(0)}function bf(t,e,n,r,o,s){for(var a=Math.min(t.length,r.length),i=-1,l=0;l<a;++l){var c=e[l];if(c!==r[l])return o(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):o(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):i>=0?t.substr(0,i)+e[i]+n.substr(i+1):null;o(t[l],c)<0&&(i=l)}return a<r.length&&s==="next"?t+n.substr(t.length):a<t.length&&s==="prev"?t.substr(0,n.length):i<0?null:t.substr(0,i)+r[i]+n.substr(i+1)}function tr(t,e,n,r){var o,s,a,i,l,c,u,d=n.length;if(!n.every(h=>typeof h=="string"))return qe(t,Wi);function f(h){o=function(w){return w==="next"?g=>g.toUpperCase():g=>g.toLowerCase()}(h),s=function(w){return w==="next"?g=>g.toLowerCase():g=>g.toUpperCase()}(h),a=h==="next"?gf:wf;var v=n.map(function(w){return{lower:s(w),upper:o(w)}}).sort(function(w,g){return a(w.lower,g.lower)});i=v.map(function(w){return w.upper}),l=v.map(function(w){return w.lower}),c=h,u=h==="next"?"":r}f("next");var p=new t.Collection(t,()=>bt(i[0],l[d-1]+r));p._ondirectionchange=function(h){f(h)};var y=0;return p._addAlgorithm(function(h,v,w){var g=h.key;if(typeof g!="string")return!1;var x=s(g);if(e(x,l,y))return!0;for(var E=null,S=y;S<d;++S){var C=bf(g,x,i[S],l[S],a,c);C===null&&E===null?y=S+1:(E===null||a(E,C)>0)&&(E=C)}return v(E!==null?function(){h.continue(E+u)}:w),!1}),p}function bt(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function Ki(t){return{type:1,lower:t,upper:t}}class Ui{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,o){r=r!==!1,o=o===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||o)&&(!r||!o)?Zt(this):new this.Collection(this,()=>bt(e,n,!r,!o))}catch{return qe(this,ct)}}equals(e){return e==null?qe(this,ct):new this.Collection(this,()=>Ki(e))}above(e){return e==null?qe(this,ct):new this.Collection(this,()=>bt(e,void 0,!0))}aboveOrEqual(e){return e==null?qe(this,ct):new this.Collection(this,()=>bt(e,void 0,!1))}below(e){return e==null?qe(this,ct):new this.Collection(this,()=>bt(void 0,e,!1,!0))}belowOrEqual(e){return e==null?qe(this,ct):new this.Collection(this,()=>bt(void 0,e))}startsWith(e){return typeof e!="string"?qe(this,Wi):this.between(e,e+Mt,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):tr(this,(n,r)=>n.indexOf(r[0])===0,[e],Mt)}equalsIgnoreCase(e){return tr(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=dt.apply(Qt,arguments);return e.length===0?Zt(this):tr(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=dt.apply(Qt,arguments);return e.length===0?Zt(this):tr(this,(n,r)=>r.some(o=>n.indexOf(o)===0),e,Mt)}anyOf(){const e=dt.apply(Qt,arguments);let n=this._cmp;try{e.sort(n)}catch{return qe(this,ct)}if(e.length===0)return Zt(this);const r=new this.Collection(this,()=>bt(e[0],e[e.length-1]));r._ondirectionchange=s=>{n=s==="next"?this._ascending:this._descending,e.sort(n)};let o=0;return r._addAlgorithm((s,a,i)=>{const l=s.key;for(;n(l,e[o])>0;)if(++o,o===e.length)return a(i),!1;return n(l,e[o])===0||(a(()=>{s.continue(e[o])}),!1)}),r}notEqual(e){return this.inAnyRange([[Mo,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=dt.apply(Qt,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return qe(this,ct)}const n=e.reduce((r,o)=>r?r.concat([[r[r.length-1][1],o]]):[[Mo,o]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,o=this._ascending,s=this._descending,a=this._min,i=this._max;if(e.length===0)return Zt(this);if(!e.every(g=>g[0]!==void 0&&g[1]!==void 0&&o(g[0],g[1])<=0))return qe(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",U.InvalidArgument);const l=!n||n.includeLowers!==!1,c=n&&n.includeUppers===!0;let u,d=o;function f(g,x){return d(g[0],x[0])}try{u=e.reduce(function(g,x){let E=0,S=g.length;for(;E<S;++E){const C=g[E];if(r(x[0],C[1])<0&&r(x[1],C[0])>0){C[0]=a(C[0],x[0]),C[1]=i(C[1],x[1]);break}}return E===S&&g.push(x),g},[]),u.sort(f)}catch{return qe(this,ct)}let p=0;const y=c?g=>o(g,u[p][1])>0:g=>o(g,u[p][1])>=0,h=l?g=>s(g,u[p][0])>0:g=>s(g,u[p][0])>=0;let v=y;const w=new this.Collection(this,()=>bt(u[0][0],u[u.length-1][1],!l,!c));return w._ondirectionchange=g=>{g==="next"?(v=y,d=o):(v=h,d=s),u.sort(f)},w._addAlgorithm((g,x,E)=>{for(var S=g.key;v(S);)if(++p,p===u.length)return x(E),!1;return!!function(C){return!y(C)&&!h(C)}(S)||(this._cmp(S,u[p][1])===0||this._cmp(S,u[p][0])===0||x(()=>{d===o?g.continue(u[p][0]):g.continue(u[p][1])}),!1)}),w}startsWithAnyOf(){const e=dt.apply(Qt,arguments);return e.every(n=>typeof n=="string")?e.length===0?Zt(this):this.inAnyRange(e.map(n=>[n,n+Mt])):qe(this,"startsWithAnyOf() only works with strings")}}function st(t){return we(function(e){return Mn(e),t(e.target.error),!1})}function Mn(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const Rn="storagemutated",kt="x-storagemutated-1",Dt=jn(null,Rn);class xf{_lock(){return gn(!B.global),++this._reculock,this._reculock!==1||B.global||(B.lockOwnerFor=this),this}_unlock(){if(gn(!B.global),--this._reculock==0)for(B.global||(B.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{hn(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&B.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(gn(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new U.DatabaseClosed(r);case"MissingAPIError":throw new U.MissingAPI(r.message,r);default:throw new U.OpenFailed(r)}if(!this.active)throw new U.TransactionInactive;return gn(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=we(o=>{Mn(o),this._reject(e.error)}),e.onabort=we(o=>{Mn(o),this.active&&this._reject(new U.Abort(e.error)),this.active=!1,this.on("abort").fire(o)}),e.oncomplete=we(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Dt.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return Pe(new U.ReadOnly("Transaction is readonly"));if(!this.active)return Pe(new U.TransactionInactive);if(this._locked())return new R((s,a)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(s,a)},B])});if(r)return St(()=>{var s=new R((a,i)=>{this._lock();const l=n(a,i,this);l&&l.then&&l.then(a,i)});return s.finally(()=>this._unlock()),s._lib=!0,s});var o=new R((s,a)=>{var i=n(s,a,this);i&&i.then&&i.then(s,a)});return o._lib=!0,o}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=R.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var o=n.idbtrans.objectStore(n.storeNames[0]);(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(o.get(-1/0).onsuccess=a)})()}var s=n._waitingFor;return new R((a,i)=>{r.then(l=>n._waitingQueue.push(we(a.bind(null,l))),l=>n._waitingQueue.push(we(i.bind(null,l)))).finally(()=>{n._waitingFor===s&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new U.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(He(n,e))return n[e];const r=this.schema[e];if(!r)throw new U.NotFound("Table "+e+" not part of transaction");const o=new this.db.Table(e,r,this);return o.core=this.db.core.table(e),n[e]=o,o}}function Ro(t,e,n,r,o,s,a){return{name:t,keyPath:e,unique:n,multi:r,auto:o,compound:s,src:(n&&!a?"&":"")+(r?"*":"")+(o?"++":"")+zi(e)}}function zi(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function qi(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:ki(n,r=>[r.name,r])}}let Tn=t=>{try{return t.only([[]]),Tn=()=>[[]],[[]]}catch{return Tn=()=>Mt,Mt}};function To(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?r=>r[e]:r=>yt(r,e)}(t):e=>yt(e,t)}function ua(t){return[].slice.call(t)}let kf=0;function Dn(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function _f(t,e,n){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:c,upper:u,lowerOpen:d,upperOpen:f}=l;return c===void 0?u===void 0?null:e.upperBound(u,!!f):u===void 0?e.lowerBound(c,!!d):e.bound(c,u,!!d,!!f)}const{schema:o,hasGetAll:s}=function(l,c){const u=ua(l.objectStoreNames);return{schema:{name:l.name,tables:u.map(d=>c.objectStore(d)).map(d=>{const{keyPath:f,autoIncrement:p}=d,y=Re(f),h=f==null,v={},w={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h,compound:y,keyPath:f,autoIncrement:p,unique:!0,extractKey:To(f)},indexes:ua(d.indexNames).map(g=>d.index(g)).map(g=>{const{name:x,unique:E,multiEntry:S,keyPath:C}=g,k={name:x,compound:Re(C),keyPath:C,unique:E,multiEntry:S,extractKey:To(C)};return v[Dn(C)]=k,k}),getIndexByKeyPath:g=>v[Dn(g)]};return v[":id"]=w.primaryKey,f!=null&&(v[Dn(f)]=w.primaryKey),w})},hasGetAll:u.length>0&&"getAll"in c.objectStore(u[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),a=o.tables.map(l=>function(c){const u=c.name;return{name:u,schema:c,mutate:function({trans:d,type:f,keys:p,values:y,range:h}){return new Promise((v,w)=>{v=we(v);const g=d.objectStore(u),x=g.keyPath==null,E=f==="put"||f==="add";if(!E&&f!=="delete"&&f!=="deleteRange")throw new Error("Invalid operation type: "+f);const{length:S}=p||y||{length:1};if(p&&y&&p.length!==y.length)throw new Error("Given keys array must have same length as given values array.");if(S===0)return v({numFailures:0,failures:{},results:[],lastResult:void 0});let C;const k=[],D=[];let j=0;const A=q=>{++j,Mn(q)};if(f==="deleteRange"){if(h.type===4)return v({numFailures:j,failures:D,results:[],lastResult:void 0});h.type===3?k.push(C=g.clear()):k.push(C=g.delete(r(h)))}else{const[q,$]=E?x?[y,p]:[y,null]:[p,null];if(E)for(let K=0;K<S;++K)k.push(C=$&&$[K]!==void 0?g[f](q[K],$[K]):g[f](q[K])),C.onerror=A;else for(let K=0;K<S;++K)k.push(C=g[f](q[K])),C.onerror=A}const F=q=>{const $=q.target.result;k.forEach((K,le)=>K.error!=null&&(D[le]=K.error)),v({numFailures:j,failures:D,results:f==="delete"?p:k.map(K=>K.result),lastResult:$})};C.onerror=q=>{A(q),F(q)},C.onsuccess=F})},getMany:({trans:d,keys:f})=>new Promise((p,y)=>{p=we(p);const h=d.objectStore(u),v=f.length,w=new Array(v);let g,x=0,E=0;const S=k=>{const D=k.target;w[D._pos]=D.result,++E===x&&p(w)},C=st(y);for(let k=0;k<v;++k)f[k]!=null&&(g=h.get(f[k]),g._pos=k,g.onsuccess=S,g.onerror=C,++x);x===0&&p(w)}),get:({trans:d,key:f})=>new Promise((p,y)=>{p=we(p);const h=d.objectStore(u).get(f);h.onsuccess=v=>p(v.target.result),h.onerror=st(y)}),query:function(d){return f=>new Promise((p,y)=>{p=we(p);const{trans:h,values:v,limit:w,query:g}=f,x=w===1/0?void 0:w,{index:E,range:S}=g,C=h.objectStore(u),k=E.isPrimaryKey?C:C.index(E.name),D=r(S);if(w===0)return p({result:[]});if(d){const j=v?k.getAll(D,x):k.getAllKeys(D,x);j.onsuccess=A=>p({result:A.target.result}),j.onerror=st(y)}else{let j=0;const A=v||!("openKeyCursor"in k)?k.openCursor(D):k.openKeyCursor(D),F=[];A.onsuccess=q=>{const $=A.result;return $?(F.push(v?$.value:$.primaryKey),++j===w?p({result:F}):void $.continue()):p({result:F})},A.onerror=st(y)}})}(s),openCursor:function({trans:d,values:f,query:p,reverse:y,unique:h}){return new Promise((v,w)=>{v=we(v);const{index:g,range:x}=p,E=d.objectStore(u),S=g.isPrimaryKey?E:E.index(g.name),C=y?h?"prevunique":"prev":h?"nextunique":"next",k=f||!("openKeyCursor"in S)?S.openCursor(r(x),C):S.openKeyCursor(r(x),C);k.onerror=st(w),k.onsuccess=we(D=>{const j=k.result;if(!j)return void v(null);j.___id=++kf,j.done=!1;const A=j.continue.bind(j);let F=j.continuePrimaryKey;F&&(F=F.bind(j));const q=j.advance.bind(j),$=()=>{throw new Error("Cursor not stopped")};j.trans=d,j.stop=j.continue=j.continuePrimaryKey=j.advance=()=>{throw new Error("Cursor not started")},j.fail=we(w),j.next=function(){let K=1;return this.start(()=>K--?this.continue():this.stop()).then(()=>this)},j.start=K=>{const le=new Promise((I,Z)=>{I=we(I),k.onerror=st(Z),j.fail=Z,j.stop=oe=>{j.stop=j.continue=j.continuePrimaryKey=j.advance=$,I(oe)}}),z=()=>{if(k.result)try{K()}catch(I){j.fail(I)}else j.done=!0,j.start=()=>{throw new Error("Cursor behind last entry")},j.stop()};return k.onsuccess=we(I=>{k.onsuccess=z,z()}),j.continue=A,j.continuePrimaryKey=F,j.advance=q,z(),le},v(j)},w)})},count({query:d,trans:f}){const{index:p,range:y}=d;return new Promise((h,v)=>{const w=f.objectStore(u),g=p.isPrimaryKey?w:w.index(p.name),x=r(y),E=x?g.count(x):g.count();E.onsuccess=we(S=>h(S.target.result)),E.onerror=st(v)})}}}(l)),i={};return a.forEach(l=>i[l.name]=l),{stack:"dbcore",transaction:t.transaction.bind(t),table(l){if(!i[l])throw new Error(`Table '${l}' not found`);return i[l]},MIN_KEY:-1/0,MAX_KEY:Tn(e),schema:o}}function Lo({_novip:t},e){const n=e.db,r=function(o,s,{IDBKeyRange:a,indexedDB:i},l){return{dbcore:function(u,d){return d.reduce((f,{create:p})=>({...f,...p(f)}),u)}(_f(s,a,l),o.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(o=>{const s=o.name;t.core.schema.tables.some(a=>a.name===s)&&(o.core=t.core.table(s),t[s]instanceof t.Table&&(t[s].core=o.core))})}function Cr({_novip:t},e,n,r){n.forEach(o=>{const s=r[o];e.forEach(a=>{const i=ks(a,o);(!i||"value"in i&&i.value===void 0)&&(a===t.Transaction.prototype||a instanceof t.Transaction?mt(a,o,{get(){return this.table(o)},set(l){wi(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):a[o]=new t.Table(o,s))})})}function Wo({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function Ef(t,e){return t._cfg.version-e._cfg.version}function Cf(t,e,n,r){const o=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,o);s.create(n),s._completion.catch(r);const a=s._reject.bind(s),i=B.transless||B;St(()=>{B.trans=s,B.transless=i,e===0?(De(o).forEach(l=>{co(n,l,o[l].primKey,o[l].indexes)}),Lo(t,n),R.follow(()=>t.on.populate.fire(s)).catch(a)):function({_novip:l},c,u,d){const f=[],p=l._versions;let y=l._dbSchema=$o(l,l.idbdb,d),h=!1;const v=p.filter(g=>g._cfg.version>=c);function w(){return f.length?R.resolve(f.shift()(u.idbtrans)).then(w):R.resolve()}return v.forEach(g=>{f.push(()=>{const x=y,E=g._cfg.dbschema;Ko(l,x,d),Ko(l,E,d),y=l._dbSchema=E;const S=Vi(x,E);S.add.forEach(k=>{co(d,k[0],k[1].primKey,k[1].indexes)}),S.change.forEach(k=>{if(k.recreate)throw new U.Upgrade("Not yet support for changing primary key");{const D=d.objectStore(k.name);k.add.forEach(j=>Bo(D,j)),k.change.forEach(j=>{D.deleteIndex(j.name),Bo(D,j)}),k.del.forEach(j=>D.deleteIndex(j))}});const C=g._cfg.contentUpgrade;if(C&&g._cfg.version>c){Lo(l,d),u._memoizedTables={},h=!0;let k=_i(E);S.del.forEach(F=>{k[F]=x[F]}),Wo(l,[l.Transaction.prototype]),Cr(l,[l.Transaction.prototype],De(k),k),u.schema=k;const D=_s(C);let j;D&&pn();const A=R.follow(()=>{if(j=C(u),j&&D){var F=gt.bind(null,null);j.then(F,F)}});return j&&typeof j.then=="function"?R.resolve(j):A.then(()=>j)}}),f.push(x=>{(!h||!hf)&&function(E,S){[].slice.call(S.db.objectStoreNames).forEach(C=>E[C]==null&&S.db.deleteObjectStore(C))}(g._cfg.dbschema,x),Wo(l,[l.Transaction.prototype]),Cr(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),u.schema=l._dbSchema})}),w().then(()=>{var g,x;x=d,De(g=y).forEach(E=>{x.db.objectStoreNames.contains(E)||co(x,E,g[E].primKey,g[E].indexes)})})}(t,e,s,n).catch(a)})}function Vi(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const o=t[r],s=e[r];if(o){const a={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||o.primKey.auto!==s.primKey.auto&&!Jr)a.recreate=!0,n.change.push(a);else{const i=o.idxByName,l=s.idxByName;let c;for(c in i)l[c]||a.del.push(c);for(c in l){const u=i[c],d=l[c];u?u.src!==d.src&&a.change.push(d):a.add.push(d)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}else n.add.push([r,s])}return n}function co(t,e,n,r){const o=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(s=>Bo(o,s)),o}function Bo(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function $o(t,e,n){const r={};return wr(e.objectStoreNames,0).forEach(o=>{const s=n.objectStore(o);let a=s.keyPath;const i=Ro(zi(a),a||"",!1,!1,!!s.autoIncrement,a&&typeof a!="string",!0),l=[];for(let u=0;u<s.indexNames.length;++u){const d=s.index(s.indexNames[u]);a=d.keyPath;var c=Ro(d.name,a,!!d.unique,!!d.multiEntry,!1,a&&typeof a!="string",!1);l.push(c)}r[o]=qi(o,i,l)}),r}function Ko({_novip:t},e,n){const r=n.db.objectStoreNames;for(let o=0;o<r.length;++o){const s=r[o],a=n.objectStore(s);t._hasGetAll="getAll"in a;for(let i=0;i<a.indexNames.length;++i){const l=a.indexNames[i],c=a.index(l).keyPath,u=typeof c=="string"?c:"["+wr(c).join("+")+"]";if(e[s]){const d=e[s].idxByName[u];d&&(d.name=l,delete e[s].idxByName[u],e[s].idxByName[l]=d)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&ye.WorkerGlobalScope&&ye instanceof ye.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class Sf{_parseStoresSpec(e,n){De(e).forEach(r=>{if(e[r]!==null){var o=e[r].split(",").map((a,i)=>{const l=(a=a.trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Ro(l,c||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),Re(c),i===0)}),s=o.shift();if(s.multi)throw new U.Schema("Primary key cannot be multi-valued");o.forEach(a=>{if(a.auto)throw new U.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new U.Schema("Index must have a name and cannot be an empty string")}),n[r]=qi(r,s,o)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?Be(this._cfg.storesSource,e):e;const r=n._versions,o={};let s={};return r.forEach(a=>{Be(o,a._cfg.storesSource),s=a._cfg.dbschema={},a._parseStoresSpec(o,s)}),n._dbSchema=s,Wo(n,[n._allTables,n,n.Transaction.prototype]),Cr(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],De(s),s),n._storeNames=De(s),this}upgrade(e){return this._cfg.contentUpgrade=Ss(this._cfg.contentUpgrade||fe,e),this}}function Is(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Kt(Gr,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Ps(t){return t&&typeof t.databases=="function"}function Uo(t){return St(function(){return B.letThrough=!0,t()})}function jf(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function Df(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?Pe(e.dbOpenError):t);lt&&(e.openCanceller._stackHolder=Ht()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function o(){if(e.openCanceller!==r)throw new U.DatabaseClosed("db.open() was cancelled")}let s=e.dbReadyResolve,a=null,i=!1;return R.race([r,(typeof navigator>"u"?R.resolve():jf()).then(()=>new R((l,c)=>{if(o(),!n)throw new U.MissingAPI;const u=t.name,d=e.autoSchema?n.open(u):n.open(u,Math.round(10*t.verno));if(!d)throw new U.MissingAPI;d.onerror=st(c),d.onblocked=we(t._fireOnBlocked),d.onupgradeneeded=we(f=>{if(a=d.transaction,e.autoSchema&&!t._options.allowEmptyDB){d.onerror=Mn,a.abort(),d.result.close();const y=n.deleteDatabase(u);y.onsuccess=y.onerror=we(()=>{c(new U.NoSuchDatabase(`Database ${u} doesnt exist`))})}else{a.onerror=st(c);var p=f.oldVersion>Math.pow(2,62)?0:f.oldVersion;i=p<1,t._novip.idbdb=d.result,Cf(t,p/10,a,c)}},c),d.onsuccess=we(()=>{a=null;const f=t._novip.idbdb=d.result,p=wr(f.objectStoreNames);if(p.length>0)try{const h=f.transaction((y=p).length===1?y[0]:y,"readonly");e.autoSchema?function({_novip:v},w,g){v.verno=w.version/10;const x=v._dbSchema=$o(0,w,g);v._storeNames=wr(w.objectStoreNames,0),Cr(v,[v._allTables],De(x),x)}(t,f,h):(Ko(t,t._dbSchema,h),function(v,w){const g=Vi($o(0,v.idbdb,w),v._dbSchema);return!(g.add.length||g.change.some(x=>x.add.length||x.change.length))}(t,h)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Lo(t,h)}catch{}var y;Sn.push(t),f.onversionchange=we(h=>{e.vcFired=!0,t.on("versionchange").fire(h)}),f.onclose=we(h=>{t.on("close").fire(h)}),i&&function({indexedDB:h,IDBKeyRange:v},w){!Ps(h)&&w!==Gr&&Is(h,v).put({name:w}).catch(fe)}(t._deps,u),l()},c)}))]).then(()=>(o(),e.onReadyBeingFired=[],R.resolve(Uo(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let c=e.onReadyBeingFired.reduce(Ss,fe);return e.onReadyBeingFired=[],R.resolve(Uo(()=>c(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{a&&a.abort()}catch{}return r===e.openCanceller&&t._close(),Pe(l)}).finally(()=>{e.openComplete=!0,s()})}function zo(t){var e=s=>t.next(s),n=o(e),r=o(s=>t.throw(s));function o(s){return a=>{var i=s(a),l=i.value;return i.done?l:l&&typeof l.then=="function"?l.then(n,r):Re(l)?Promise.all(l).then(n,r):n(l)}}return o(e)()}function Of(t,e,n){var r=arguments.length;if(r<2)throw new U.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return n=o.pop(),[t,Ei(o),n]}function Hi(t,e,n,r,o){return R.resolve().then(()=>{const s=B.transless||B,a=t._createTransaction(e,n,t._dbSchema,r),i={trans:a,transless:s};if(r)a.idbtrans=r.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(d){return d.name===Cs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Hi(t,e,n,null,o))):Pe(d)}const l=_s(o);let c;l&&pn();const u=R.follow(()=>{if(c=o.call(a,a),c)if(l){var d=gt.bind(null,null);c.then(d,d)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=zo(c))},i);return(c&&typeof c.then=="function"?R.resolve(c).then(d=>a.active?d:Pe(new U.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):u.then(()=>c)).then(d=>(r&&a._resolve(),a._completion.then(()=>d))).catch(d=>(a._reject(d),Pe(d)))})}function nr(t,e,n){const r=Re(t)?t.slice():[t];for(let o=0;o<n;++o)r.push(e);return r}const If={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,o={},s=[];function a(u,d,f){const p=Dn(u),y=o[p]=o[p]||[],h=u==null?0:typeof u=="string"?1:u.length,v=d>0,w={...f,isVirtual:v,keyTail:d,keyLength:h,extractKey:To(u),unique:!v&&f.unique};return y.push(w),w.isPrimaryKey||s.push(w),h>1&&a(h===2?u[0]:u.slice(0,h-1),d+1,f),y.sort((g,x)=>g.keyTail-x.keyTail),w}const i=a(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[i];for(const u of r.indexes)a(u.keyPath,0,u);function l(u){const d=u.query.index;return d.isVirtual?{...u,query:{index:d,range:(f=u.query.range,p=d.keyTail,{type:f.type===1?2:f.type,lower:nr(f.lower,f.lowerOpen?t.MAX_KEY:t.MIN_KEY,p),lowerOpen:!0,upper:nr(f.upper,f.upperOpen?t.MIN_KEY:t.MAX_KEY,p),upperOpen:!0})}}:u;var f,p}return{...n,schema:{...r,primaryKey:i,indexes:s,getIndexByKeyPath:function(u){const d=o[Dn(u)];return d&&d[0]}},count:u=>n.count(l(u)),query:u=>n.query(l(u)),openCursor(u){const{keyTail:d,isVirtual:f,keyLength:p}=u.query.index;return f?n.openCursor(l(u)).then(y=>y&&function(h){return Object.create(h,{continue:{value:function(w){w!=null?h.continue(nr(w,u.reverse?t.MAX_KEY:t.MIN_KEY,d)):u.unique?h.continue(h.key.slice(0,p).concat(u.reverse?t.MIN_KEY:t.MAX_KEY,d)):h.continue()}},continuePrimaryKey:{value(w,g){h.continuePrimaryKey(nr(w,t.MAX_KEY,d),g)}},primaryKey:{get:()=>h.primaryKey},key:{get(){const w=h.key;return p===1?w[0]:w.slice(0,p)}},value:{get:()=>h.value}})}(y)):n.openCursor(u)}}}}}};function Ns(t,e,n,r){return n=n||{},r=r||"",De(t).forEach(o=>{if(He(e,o)){var s=t[o],a=e[o];if(typeof s=="object"&&typeof a=="object"&&s&&a){const i=_o(s);i!==_o(a)?n[r+o]=e[o]:i==="Object"?Ns(s,a,n,r+o+"."):s!==a&&(n[r+o]=e[o])}else s!==a&&(n[r+o]=e[o])}else n[r+o]=void 0}),De(e).forEach(o=>{He(t,o)||(n[r+o]=e[o])}),n}const Pf={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(s){const a=B.trans,{deleting:i,creating:l,updating:c}=a.table(e).hook;switch(s.type){case"add":if(l.fire===fe)break;return a._promise("readwrite",()=>u(s),!0);case"put":if(l.fire===fe&&c.fire===fe)break;return a._promise("readwrite",()=>u(s),!0);case"delete":if(i.fire===fe)break;return a._promise("readwrite",()=>u(s),!0);case"deleteRange":if(i.fire===fe)break;return a._promise("readwrite",()=>function(f){return d(f.trans,f.range,1e4)}(s),!0)}return n.mutate(s);function u(f){const p=B.trans,y=f.keys||function(h,v){return v.type==="delete"?v.keys:v.keys||v.values.map(h.extractKey)}(r,f);if(!y)throw new Error("Keys missing");return(f=f.type==="add"||f.type==="put"?{...f,keys:y}:{...f}).type!=="delete"&&(f.values=[...f.values]),f.keys&&(f.keys=[...f.keys]),function(h,v,w){return v.type==="add"?Promise.resolve([]):h.getMany({trans:v.trans,keys:w,cache:"immutable"})}(n,f,y).then(h=>{const v=y.map((w,g)=>{const x=h[g],E={onerror:null,onsuccess:null};if(f.type==="delete")i.fire.call(E,w,x,p);else if(f.type==="add"||x===void 0){const S=l.fire.call(E,w,f.values[g],p);w==null&&S!=null&&(w=S,f.keys[g]=w,r.outbound||rt(f.values[g],r.keyPath,w))}else{const S=Ns(x,f.values[g]),C=c.fire.call(E,S,w,x,p);if(C){const k=f.values[g];Object.keys(C).forEach(D=>{He(k,D)?k[D]=C[D]:rt(k,D,C[D])})}}return E});return n.mutate(f).then(({failures:w,results:g,numFailures:x,lastResult:E})=>{for(let S=0;S<y.length;++S){const C=g?g[S]:y[S],k=v[S];C==null?k.onerror&&k.onerror(w[S]):k.onsuccess&&k.onsuccess(f.type==="put"&&h[S]?f.values[S]:C)}return{failures:w,results:g,numFailures:x,lastResult:E}}).catch(w=>(v.forEach(g=>g.onerror&&g.onerror(w)),Promise.reject(w)))})}function d(f,p,y){return n.query({trans:f,values:!1,query:{index:r,range:p},limit:y}).then(({result:h})=>u({type:"delete",keys:h,trans:f}).then(v=>v.numFailures>0?Promise.reject(v.failures[0]):h.length<y?{failures:[],numFailures:0,lastResult:void 0}:d(f,{...p,lower:h[h.length-1],lowerOpen:!0},y)))}}}}})};function Ji(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let o=0,s=0;o<e.keys.length&&s<t.length;++o)We(e.keys[o],t[s])===0&&(r.push(n?zn(e.values[o]):e.values[o]),++s);return r.length===t.length?r:null}catch{return null}}const Nf={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const o=Ji(r.keys,r.trans._cache,r.cache==="clone");return o?R.resolve(o):n.getMany(r).then(s=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?zn(s):s},s))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function As(t){return!("from"in t)}const ut=function(t,e){if(!this){const n=new ut;return t&&"d"in t&&Be(n,t),n}Be(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function Ln(t,e,n){const r=We(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(As(t))return Be(t,{from:e,to:n,d:1});const o=t.l,s=t.r;if(We(n,t.from)<0)return o?Ln(o,e,n):t.l={from:e,to:n,d:1,l:null,r:null},da(t);if(We(e,t.to)>0)return s?Ln(s,e,n):t.r={from:e,to:n,d:1,l:null,r:null},da(t);We(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),We(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const a=!t.r;o&&!t.l&&Sr(t,o),s&&a&&Sr(t,s)}function Sr(t,e){As(e)||function n(r,{from:o,to:s,l:a,r:i}){Ln(r,o,s),a&&n(r,a),i&&n(r,i)}(t,e)}function Af(t,e){const n=qo(e);let r=n.next();if(r.done)return!1;let o=r.value;const s=qo(t);let a=s.next(o.from),i=a.value;for(;!r.done&&!a.done;){if(We(i.from,o.to)<=0&&We(i.to,o.from)>=0)return!0;We(o.from,i.from)<0?o=(r=n.next(i.from)).value:i=(a=s.next(o.from)).value}return!1}function qo(t){let e=As(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&We(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||We(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function da(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){const s=o==="r"?"l":"r",a={...t},i=t[o];t.from=i.from,t.to=i.to,t[o]=i[o],a[o]=i[s],t[s]=a,a.d=fa(a)}t.d=fa(t)}function fa({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}un(ut.prototype,{add(t){return Sr(this,t),this},addKey(t){return Ln(this,t,t),this},addKeys(t){return t.forEach(e=>Ln(this,e,e)),this},[Eo](){return qo(this)}});const Ff={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new ut(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const o=t.table(r),{schema:s}=o,{primaryKey:a}=s,{extractKey:i,outbound:l}=a,c={...o,mutate:f=>{const p=f.trans,y=p.mutatedParts||(p.mutatedParts={}),h=C=>{const k=`idb://${e}/${r}/${C}`;return y[k]||(y[k]=new ut)},v=h(""),w=h(":dels"),{type:g}=f;let[x,E]=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[[],f.values]:[];const S=f.trans._cache;return o.mutate(f).then(C=>{if(Re(x)){g!=="delete"&&(x=C.results),v.addKeys(x);const k=Ji(x,S);k||g==="add"||w.addKeys(x),(k||E)&&function(D,j,A,F){function q($){const K=D($.name||"");function le(I){return I!=null?$.extractKey(I):null}const z=I=>$.multiEntry&&Re(I)?I.forEach(Z=>K.addKey(Z)):K.addKey(I);(A||F).forEach((I,Z)=>{const oe=A&&le(A[Z]),he=F&&le(F[Z]);We(oe,he)!==0&&(oe!=null&&z(oe),he!=null&&z(he))})}j.indexes.forEach(q)}(h,s,k,E)}else if(x){const k={from:x.lower,to:x.upper};w.add(k),v.add(k)}else v.add(n),w.add(n),s.indexes.forEach(k=>h(k.name).add(n));return C})}},u=({query:{index:f,range:p}})=>{var y,h;return[f,new ut((y=p.lower)!==null&&y!==void 0?y:t.MIN_KEY,(h=p.upper)!==null&&h!==void 0?h:t.MAX_KEY)]},d={get:f=>[a,new ut(f.key)],getMany:f=>[a,new ut().addKeys(f.keys)],count:u,query:u,openCursor:u};return De(d).forEach(f=>{c[f]=function(p){const{subscr:y}=B;if(y){const h=E=>{const S=`idb://${e}/${r}/${E}`;return y[S]||(y[S]=new ut)},v=h(""),w=h(":dels"),[g,x]=d[f](p);if(h(g.name||"").add(x),!g.isPrimaryKey){if(f!=="count"){const E=f==="query"&&l&&p.values&&o.query({...p,values:!1});return o[f].apply(this,arguments).then(S=>{if(f==="query"){if(l&&p.values)return E.then(({result:k})=>(v.addKeys(k),S));const C=p.values?S.result.map(i):S.result;p.values?v.addKeys(C):w.addKeys(C)}else if(f==="openCursor"){const C=S,k=p.values;return C&&Object.create(C,{key:{get:()=>(w.addKey(C.primaryKey),C.key)},primaryKey:{get(){const D=C.primaryKey;return w.addKey(D),D}},value:{get:()=>(k&&v.addKey(C.primaryKey),C.value)}})}return S})}w.add(n)}}return o[f].apply(this,arguments)}}),c}}}};class Kt{constructor(e,n){this._middlewares={},this.verno=0;const r=Kt.dependencies;this._options=n={addons:Kt.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:o}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:fe,dbReadyPromise:null,cancelOpen:fe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;s.dbReadyPromise=new R(i=>{s.dbReadyResolve=i}),s.openCanceller=new R((i,l)=>{s.cancelOpen=l}),this._state=s,this.name=e,this.on=jn(this,"populate","blocked","versionchange","close",{ready:[Ss,fe]}),this.on.ready.subscribe=bi(this.on.ready.subscribe,i=>(l,c)=>{Kt.vip(()=>{const u=this._state;if(u.openComplete)u.dbOpenError||R.resolve().then(l),c&&i(l);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(l),c&&i(l);else{i(l);const d=this;c||i(function f(){d.on.ready.unsubscribe(l),d.on.ready.unsubscribe(f)})}})}),this.Collection=(a=this,vn(vf.prototype,function(i,l){this.db=a;let c=$i,u=null;if(l)try{c=l()}catch(y){u=y}const d=i._ctx,f=d.table,p=f.hook.reading.fire;this._ctx={table:f,index:d.index,isPrimKey:!d.index||f.schema.primKey.keyPath&&d.index===f.schema.primKey.name,range:c,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:u,or:d.or,valueMapper:p!==An?p:null}})),this.Table=function(i){return vn(yf.prototype,function(l,c,u){this.db=i,this._tx=u,this.name=l,this.schema=c,this.hook=i._allTables[l]?i._allTables[l].hook:jn(null,{creating:[rf,fe],reading:[nf,An],updating:[sf,fe],deleting:[of,fe]})})}(this),this.Transaction=function(i){return vn(xf.prototype,function(l,c,u,d,f){this.db=i,this.mode=l,this.storeNames=c,this.schema=u,this.chromeTransactionDurability=d,this.idbtrans=null,this.on=jn(this,"complete","error","abort"),this.parent=f||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new R((p,y)=>{this._resolve=p,this._reject=y}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},p=>{var y=this.active;return this.active=!1,this.on.error.fire(p),this.parent?this.parent._reject(p):y&&this.idbtrans&&this.idbtrans.abort(),Pe(p)})})}(this),this.Version=function(i){return vn(Sf.prototype,function(l){this.db=i,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(i){return vn(Ui.prototype,function(l,c,u){this.db=i,this._ctx={table:l,index:c===":id"?null:c,or:u};const d=i._deps.indexedDB;if(!d)throw new U.MissingAPI;this._cmp=this._ascending=d.cmp.bind(d),this._descending=(f,p)=>d.cmp(p,f),this._max=(f,p)=>d.cmp(f,p)>0?f:p,this._min=(f,p)=>d.cmp(f,p)<0?f:p,this._IDBKeyRange=i._deps.IDBKeyRange})}(this),this.on("versionchange",i=>{i.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",i=>{!i.newVersion||i.newVersion<i.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${i.oldVersion/10}`)}),this._maxKey=Tn(n.IDBKeyRange),this._createTransaction=(i,l,c,u)=>new this.Transaction(i,l,c,this._options.chromeTransactionDurability,u),this._fireOnBlocked=i=>{this.on("blocked").fire(i),Sn.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(i))},this.use(If),this.use(Pf),this.use(Ff),this.use(Nf),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(i=>i(this))}version(e){if(isNaN(e)||e<.1)throw new U.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new U.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(o=>o._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(Ef),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||B.letThrough||this._vip)?e():new R((n,r)=>{if(this._state.openComplete)return r(new U.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new U.DatabaseClosed);this.open().catch(fe)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:o}){o&&this.unuse({stack:e,name:o});const s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:n,level:r??10,name:o}),s.sort((a,i)=>a.level-i.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(o=>r?o.create!==r:!!n&&o.name!==n)),this}open(){return Df(this)}_close(){const e=this._state,n=Sn.indexOf(this);if(n>=0&&Sn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new R(r=>{e.dbReadyResolve=r}),e.openCanceller=new R((r,o)=>{e.cancelOpen=o})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new U.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new R((r,o)=>{const s=()=>{this.close();var a=this._deps.indexedDB.deleteDatabase(this.name);a.onsuccess=we(()=>{(function({indexedDB:i,IDBKeyRange:l},c){!Ps(i)&&c!==Gr&&Is(i,l).delete(c).catch(fe)})(this._deps,this.name),r()}),a.onerror=st(o),a.onblocked=this._fireOnBlocked};if(e)throw new U.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return De(this._allTables).map(e=>this._allTables[e])}transaction(){const e=Of.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let o=B.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);const s=e.indexOf("?")!==-1;let a,i;e=e.replace("!","").replace("?","");try{if(i=n.map(c=>{var u=c instanceof this.Table?c.name:c;if(typeof u!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return u}),e=="r"||e===oo)a=oo;else{if(e!="rw"&&e!=so)throw new U.InvalidArgument("Invalid transaction mode: "+e);a=so}if(o){if(o.mode===oo&&a===so){if(!s)throw new U.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&i.forEach(c=>{if(o&&o.storeNames.indexOf(c)===-1){if(!s)throw new U.SubTransaction("Table "+c+" not included in parent transaction.");o=null}}),s&&o&&!o.active&&(o=null)}}catch(c){return o?o._promise(null,(u,d)=>{d(c)}):Pe(c)}const l=Hi.bind(null,this,a,i,o,r);return o?o._promise(a,l,"lock"):B.trans?hn(B.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!He(this._allTables,e))throw new U.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Mf=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Rf{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[Mf](){return this}}function Gi(t,e){return De(e).forEach(n=>{Sr(t[n]||(t[n]=new ut),e[n])}),t}function Tf(t){let e,n=!1;const r=new Rf(o=>{const s=_s(t);let a=!1,i={},l={};const c={get closed(){return a},unsubscribe:()=>{a=!0,Dt.storagemutated.unsubscribe(p)}};o.start&&o.start(c);let u=!1,d=!1;function f(){return De(l).some(h=>i[h]&&Af(i[h],l[h]))}const p=h=>{Gi(i,h),f()&&y()},y=()=>{if(u||a)return;i={};const h={},v=function(w){s&&pn();const g=()=>St(t,{subscr:w,trans:null}),x=B.trans?hn(B.transless,g):g();return s&&x.then(gt,gt),x}(h);d||(Dt(Rn,p),d=!0),u=!0,Promise.resolve(v).then(w=>{n=!0,e=w,u=!1,a||(f()?y():(i={},l=h,o.next&&o.next(w)))},w=>{u=!1,n=!1,o.error&&o.error(w),c.unsubscribe()})};return y(),c});return r.hasValue=()=>n,r.getValue=()=>e,r}let Vo;try{Vo={indexedDB:ye.indexedDB||ye.mozIndexedDB||ye.webkitIndexedDB||ye.msIndexedDB,IDBKeyRange:ye.IDBKeyRange||ye.webkitIDBKeyRange}}catch{Vo={indexedDB:null,IDBKeyRange:null}}const At=Kt;function fr(t){let e=pt;try{pt=!0,Dt.storagemutated.fire(t)}finally{pt=e}}un(At,{...ar,delete:t=>new At(t,{addons:[]}).delete(),exists:t=>new At(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return Ps(e)?Promise.resolve(e.databases()).then(r=>r.map(o=>o.name).filter(o=>o!==Gr)):Is(e,n).toCollection().primaryKeys()}(At.dependencies).then(t)}catch{return Pe(new U.MissingAPI)}},defineClass:()=>function(t){Be(this,t)},ignoreTransaction:t=>B.trans?hn(B.transless,t):t(),vip:Uo,async:function(t){return function(){try{var e=zo(t.apply(this,arguments));return e&&typeof e.then=="function"?e:R.resolve(e)}catch(n){return Pe(n)}}},spawn:function(t,e,n){try{var r=zo(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:R.resolve(r)}catch(o){return Pe(o)}},currentTransaction:{get:()=>B.trans||null},waitFor:function(t,e){const n=R.resolve(typeof t=="function"?At.ignoreTransaction(t):t).timeout(e||6e4);return B.trans?B.trans.waitFor(n):n},Promise:R,debug:{get:()=>lt,set:t=>{Si(t,t==="dexie"?()=>!0:Bi)}},derive:tn,extend:Be,props:un,override:bi,Events:jn,on:Dt,liveQuery:Tf,extendObservabilitySet:Gi,getByKeyPath:yt,setByKeyPath:rt,delByKeyPath:function(t,e){typeof e=="string"?rt(t,e,void 0):"length"in e&&[].map.call(e,function(n){rt(t,n,void 0)})},shallowClone:_i,deepClone:zn,getObjectDiff:Ns,cmp:We,asap:xi,minKey:Mo,addons:[],connections:Sn,errnames:Cs,dependencies:Vo,semVer:sa,version:sa.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),At.maxKey=Tn(At.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Dt(Rn,t=>{if(!pt){let e;Jr?(e=document.createEvent("CustomEvent"),e.initCustomEvent(kt,!0,!0,t)):e=new CustomEvent(kt,{detail:t}),pt=!0,dispatchEvent(e),pt=!1}}),addEventListener(kt,({detail:t})=>{pt||fr(t)}));let pt=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(kt);typeof t.unref=="function"&&t.unref(),Dt(Rn,e=>{pt||t.postMessage(e)}),t.onmessage=e=>{e.data&&fr(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Dt(Rn,e=>{try{pt||(typeof localStorage<"u"&&localStorage.setItem(kt,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:kt,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===kt){const n=JSON.parse(e.newValue);n&&fr(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===kt&&fr(e.changedParts)})}R.rejectionMapper=function(t,e){if(!t||t instanceof nn||t instanceof TypeError||t instanceof SyntaxError||!t.name||!ta[t.name])return t;var n=new ta[t.name](e||t.message,t);return"stack"in t&&mt(n,"stack",{get:function(){return this.inner.stack}}),n},Si(lt,Bi);var pr=(t=>(t.MOVE_TO_ROOT_FOLDER="moveToRootFolder",t.DELETE="delete",t))(pr||{});const Lf="comfyui_workspace_db";class Wf extends Kt{constructor(){super(Lf);ke(this,"workflows");ke(this,"changelogs");ke(this,"media");ke(this,"folders");ke(this,"tags");ke(this,"userSettings");ke(this,"models");ke(this,"cache");ke(this,"workflowVersions");this.version(1).stores({workflows:"&id, name, parentFolderID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id"}).upgrade(n=>{}),this.version(2).stores({workflows:"&id, name, parentFolderID,cloudID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id",workflowVersions:"&id, name, workflowID,cloudID"}).upgrade(n=>{})}}const H=new Wf,Bf="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Ho=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=Bf[n[t]&63];return e};class Jt{constructor(e){ke(this,"tableName");this.tableName=e}async saveDiskDB(){const e=await H[this.tableName].toArray(),n={};e.forEach(r=>{r.id?n[r.id]=r:r.name?n[r.name]=r:console.error("TableBaseModel should have id or name")}),Bd(this.tableName,JSON.stringify(n))}async add(e){return e.id||(e.id=Ho()),e.createTime||(e.createTime=Date.now()),await H[this.tableName].add(e),await this.saveDiskDB(),e}async put(e){return await H[this.tableName].put(e),await this.saveDiskDB(),e}async bulkPut(e){await H[this.tableName].bulkPut(e),this.saveDiskDB()}async update(e,n){return await H[this.tableName].update(e,n),await this.saveDiskDB(),await this.get(e)??null}async listAll(){return await H[this.tableName].toArray()}async batchQuery(e){return await H[this.tableName].bulkGet(e)}async getRecords(){console.warn("[DEPRECATED] getRecords() call, should only be used for one-time backfill for indexdb",this.tableName);const e=await Wd(this.tableName);let n;try{n=e!=null?JSON.parse(e):null}catch{}if(n==null){const r=await qd()??"{}";n=JSON.parse(r)[this.tableName]}return n??{}}async get(e){return await H[this.tableName].get(e)}async delete(e){await H[this.tableName].delete(e),await this.saveDiskDB()}async listByIndex(e,n){return await H[this.tableName].where(e).equals(n).toArray()}}const $f=150,Or=class Or extends Jt{constructor(){super("changelogs")}static async load(){return new Or}async listByWorkflowID(e){return await H.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime")}async getLastestByWorkflowID(e){return(await this.listByWorkflowID(e))[0]}async create(e){const n=await this.getLastestByWorkflowID(e.workflowID);if(n!=null&&n.json===e.json)return null;const r={id:Pn(),json:e.json,workflowID:e.workflowID,createTime:Date.now()};return await H.changelogs.add(r),await this.saveDiskDB(),r}async deleteLogsExceedLimit(e,n=$f){const r=await H.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime"),o=r.filter(a=>a.isAutoSave===!0),s=r.filter(a=>a.isAutoSave==null||a.isAutoSave==!1);if(o.length>n){const a=o.slice(n);await H.changelogs.bulkDelete(a.map(i=>i.id)),await this.saveDiskDB()}if(s.length>n){const a=s.slice(n);await H.changelogs.bulkDelete(a.map(i=>i.id)),await this.saveDiskDB()}}};ke(Or,"TABLE_NAME","changelogs");let Jo=Or;const ch="CWM_WORKFLOWS_SORT_TYPE";var _t=(t=>(t.RECENTLY_MODIFIED="newest",t.OLDEST_MODIFIED="oldest",t.AZ="name A-Z",t.ZA="name Z-A",t))(_t||{});const uh=[{title:"Import Workflows",type:"file"},{title:"Import Folder",type:"folder"}],Yi="comfyspace_tracking",jr="workspace_info",Kf=9999999;function ft(t){return"/"+t.split("/").filter(n=>n!=="").join("/")}function Uf(t){return t.split("/").filter(n=>n!=="").join("/")}async function Ft(t){const e=await(P==null?void 0:P.getSetting("myWorkflowsDir"));return ft(`${e}/${t}`)}var Et;(t=>{async function e({parentFolderID:l,name:c}){return Uf(`${l??""}/${c}`)}t.genFolderRelPath=e;async function n({parentFolderID:l,name:c}){const u=await(P==null?void 0:P.getSetting("myWorkflowsDir"));return ft(`${u}/${l??""}/${c}`)}t.genFolderAbsPath=n;async function r(l){const c=await n(l);await fetch("/workspace/folder/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:c})})}t.createFolder=r;async function o(l,c){const u=await Ft(l),d=await Ft(c),p=await(await fetch("/workspace/folder/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folder:u,newParentPath:d})})).json();p.error&&alert("Failed to move folder: "+p.error)}t.moveFolder=o;async function s(l){const c=await Ft(l);try{return await(await fetch("/workspace/folder/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:c})})).text()}catch(u){console.error("Error deleting file:",u)}}t.deleteFolder=s;async function a(l){const c=await Ft(l);try{const d=await(await fetch("/workspace/file/count_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:c})})).json();return d.error&&console.error("Error counting files:",d.error),d.count}catch(u){console.error("Error renaming file:",u)}return null}t.genFilesCountInFolder=a;async function i(l,c){const u=await Ft(l);try{const f=await(await fetch("/workspace/folder/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absPath:u,newName:c})})).json();f.error&&alert("Failed to rename folder: "+f.error)}catch(d){console.error("Error renaming file:",d)}}t.renameFolder=i})(Et||(Et={}));async function bn(t){console.warn("saveJsonFileMyWorkflows",t);const e=await Fs(t);if(e==null)return;const n=await Ms(t);await(O==null?void 0:O.updateMetaInfo(t.id,{filePath:n??void 0}));const r=t.json,o=JSON.parse(r);o.extra[jr]={id:t.id,name:t.name},delete o.extra[Yi],await vi(e,JSON.stringify(o))}async function uo(t){if(t.name==null)return;const e=await Fs(t);e!=null&&gi(e)}async function Fs(t){let e=zf(t.name)+".json",n=t.parentFolderID;for(;n!=null;){const r=await(Te==null?void 0:Te.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??void 0}return e??null}async function dh(t){let e="",n=t;for(;n!=null;){const r=await(Te==null?void 0:Te.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??null}return e}async function Ms(t){const e=await Fs(t);let n=await(P==null?void 0:P.getSetting("myWorkflowsDir"));return n?(n.endsWith("/")||(n=n+"/"),n+e):(console.error("myWorkflowsDir is not set"),null)}async function fh(t){if(await(P==null?void 0:P.getSetting("twoWaySync")))return await Et.genFilesCountInFolder(t)??0;const n=await(O==null?void 0:O.listAll())??[],r=await(Te==null?void 0:Te.listAll())??[],o=[t];let s=0;for(;o.length>0;){const a=o.shift();if(a){for(const l of n)l.parentFolderID===a&&s++;const i=r.filter(l=>l.parentFolderID===a).map(l=>l.id);i.length&&o.push(...i)}}return s}function zf(t){return t=t.replace(/[\\/:*?"<>|]/g,"_"),t.trim()}function pa(t,e=!0,n=!1){const r=new Date(t),o=String(r.getDate()).padStart(2,"0"),s=String(r.getMonth()+1).padStart(2,"0"),a=r.getFullYear(),i=String(r.getHours()).padStart(2,"0"),l=String(r.getMinutes()).padStart(2,"0"),c=String(r.getSeconds()).padStart(2,"0"),u=`${s}-${o}-${a}`;return e?u+` ${i}:${l}`:n?u+`:${c}`:u}async function qf(t=!1){const e=await(O==null?void 0:O.listAll())??[];for(const n of e){const r=await Ms(n);n.filePath!=r&&(n.filePath!=null&&await gi(n.filePath,t),await bn(n))}}const Xi=(t,e=_t.RECENTLY_MODIFIED)=>{const n=[...t];switch(e){case _t.AZ:n.sort((r,o)=>r.name.localeCompare(o.name));break;case _t.ZA:n.sort((r,o)=>o.name.localeCompare(r.name));break;case _t.RECENTLY_MODIFIED:n.sort((r,o)=>o.updateTime-r.updateTime);break;case _t.OLDEST_MODIFIED:n.sort((r,o)=>r.updateTime-o.updateTime);break}return n};function ph(t,e){let n=JSON.parse(t);typeof structuredClone>"u"?n=JSON.parse(JSON.stringify(n)):n=structuredClone(n);let r=new LGraph;r.configure(n);const o=localStorage.getItem("litegrapheditor_clipboard"),s=document.createElement("canvas");let a=new LGraphCanvas(s,r);a.selectNodes(r._nodes),a.copyToClipboard(r._nodes);const i=ge.canvas.graph_mouse;e&&(e[0]-=15,e[1]-=15,ge.canvas.graph_mouse=e),ge.canvas.pasteFromClipboard(),ge.canvas.graph_mouse=i,o&&localStorage.setItem("litegrapheditor_clipboard",o),r=null,a=null}const Vf=async t=>{const e=await(P==null?void 0:P.getSetting("shortcuts").then(n=>n==null?void 0:n.save));return e?Hf(t,e):!1},Hf=(t,e)=>{const n=e.split("+"),r={Control:t.ctrlKey,Shift:t.shiftKey,Alt:t.altKey,Command:t.metaKey,[t.key.toUpperCase()]:!0};return n.every(o=>r[o])};function hh(t){const e=["png","jpg","jpeg","gif","bmp","webp"],n=t.split(".").pop();return n!=null&&e.includes(n)}function Jf(t){return`/workspace/view_media?filename=${t}`}function ha(){const e=window.location.hash.slice(1).split("/").find(n=>n.includes("workspaceId@"));return e?e.split("@")[1]:null}function Zi(t){const e=window.location.hash.slice(1).split("/"),n=e.findIndex(o=>o.includes("workspaceId@")),r=`workspaceId@${t}`;return n>=0?e[n]=r:e.push(r),`${e.join("/")}`}const Gf=t=>{const e=Zi(t);window.open(`${window.location.origin}/#${e}`)};async function Yf(){const t=await(O==null?void 0:O.listAll())??[];for(const e of t)try{const n=await Ms(e),r=JSON.parse(e.json);r.extra[jr]={id:e.id,name:e.name},delete r.extra[Yi],n&&await vi(n,JSON.stringify(r))}catch(n){console.error(n)}}const hr={last_node_id:9,last_link_id:9,nodes:[{id:7,type:"CLIPTextEncode",pos:[413,389],size:{0:425.27801513671875,1:180.6060791015625},flags:{},order:3,mode:0,inputs:[{name:"clip",type:"CLIP",link:5}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[6],slot_index:0}],properties:{},widgets_values:["text, watermark"]},{id:6,type:"CLIPTextEncode",pos:[415,186],size:{0:422.84503173828125,1:164.31304931640625},flags:{},order:2,mode:0,inputs:[{name:"clip",type:"CLIP",link:3}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[4],slot_index:0}],properties:{},widgets_values:["beautiful scenery nature glass bottle landscape, , purple galaxy bottle,"]},{id:5,type:"EmptyLatentImage",pos:[473,609],size:{0:315,1:106},flags:{},order:1,mode:0,outputs:[{name:"LATENT",type:"LATENT",links:[2],slot_index:0}],properties:{},widgets_values:[512,512,1]},{id:3,type:"KSampler",pos:[863,186],size:{0:315,1:262},flags:{},order:4,mode:0,inputs:[{name:"model",type:"MODEL",link:1},{name:"positive",type:"CONDITIONING",link:4},{name:"negative",type:"CONDITIONING",link:6},{name:"latent_image",type:"LATENT",link:2}],outputs:[{name:"LATENT",type:"LATENT",links:[7],slot_index:0}],properties:{},widgets_values:[0x8e7ff42ed37e,!0,20,8,"euler","normal",1]},{id:8,type:"VAEDecode",pos:[1209,188],size:{0:210,1:46},flags:{},order:5,mode:0,inputs:[{name:"samples",type:"LATENT",link:7},{name:"vae",type:"VAE",link:8}],outputs:[{name:"IMAGE",type:"IMAGE",links:[9],slot_index:0}],properties:{}},{id:9,type:"SaveImage",pos:[1451,189],size:{0:210,1:26},flags:{},order:6,mode:0,inputs:[{name:"images",type:"IMAGE",link:9}],properties:{}},{id:4,type:"CheckpointLoaderSimple",pos:[26,474],size:{0:315,1:98},flags:{},order:0,mode:0,outputs:[{name:"MODEL",type:"MODEL",links:[1],slot_index:0},{name:"CLIP",type:"CLIP",links:[3,5],slot_index:1},{name:"VAE",type:"VAE",links:[8],slot_index:2}],properties:{},widgets_values:["v1-5-pruned-emaonly.ckpt"]}],links:[[1,4,0,3,0,"MODEL"],[2,5,0,3,3,"LATENT"],[3,4,1,6,0,"CLIP"],[4,6,0,3,1,"CONDITIONING"],[5,4,1,7,0,"CLIP"],[6,7,0,3,2,"CONDITIONING"],[7,3,0,8,0,"LATENT"],[8,4,2,8,1,"VAE"],[9,8,0,9,0,"IMAGE"]],groups:[],config:{},extra:{},version:.4};var Ye;(t=>{async function e({parentFolderID:u,name:d}){const f=await(P==null?void 0:P.getSetting("myWorkflowsDir"));return ft(`${f}/${u??""}/${d}.json`)}async function n(u,d){const f=await e(u),p=await Ft(d);try{const h=await(await fetch("/workspace/file/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:f,newParentPath:p})})).json();return h.error?(alert("Error moving file: "+h.error),!1):!0}catch(y){console.error("Error deleting file:",y)}}t.moveWorkflow=n;async function r(u,d){const f=await Ft(`${d}/${u}`);try{const y=await(await fetch("/workspace/file/gen_unique_name",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:f})})).json();return y.error?(console.error("Error getting unique name:",y.error),null):y.uniqueName}catch(p){console.error("Error deleting file:",p)}return null}t.genFileUniqueName=r;async function o({parentFolderID:u,name:d},f){const p=await(P==null?void 0:P.getSetting("myWorkflowsDir")),y=ft(`${p}/${u??""}/${d}.json`);try{const v=await(await fetch("/workspace/file/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:y,newName:f})})).json();return v.error?(alert("Error moving file: "+v.error),!1):!0}catch(h){console.error("Error deleting file:",h)}}t.renameWorkflow=o;async function s(){const u=await(P==null?void 0:P.getSetting("myWorkflowsDir")),d=ft(u);try{const p=await(await fetch("/workspace/file/scan_dup_id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:d})})).json();return!0}catch(f){console.error("Error deleting file:",f)}}t.scanMyWorkflowsDupId=s;async function a(u){const d=await e(u),f=u.json,p=JSON.parse(f);p.extra[jr]={id:u.id};const h=await(await fetch("/workspace/file/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:d,json:JSON.stringify(p)})})).json();if(h.error)throw console.error("Error saving file:",h.error),alert(`"Error saving file: ${h.error}
      
      👉Please try "Save as" from "Files" dropdown menu
      `),new Error(h.error);return h}t.saveWorkflow=a;async function i(u){const d=await e(u);try{return await(await fetch("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:d,deleteEmptyFolder:!1})})).text()}catch(f){alert("Error deleting workflow .json file: "+f),console.error("Error deleting file:",f)}}t.deleteWorkflow=i;async function l({parentFolderID:u,name:d,json:f,id:p}){var g;const y=await(P==null?void 0:P.getSetting("myWorkflowsDir")),h=ft(`${y}/${u??""}`);let v=JSON.parse(f);v={...v,extra:{[jr]:{id:p}}};const w={parentFolderPath:h,name:d,json:JSON.stringify(v)};try{const E=await(await fetch("/workspace/create_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).json();return E.name&&await((g=H.workflows)==null?void 0:g.update(p,{filePath:`${h}/${d}.json`,name:E.name})),E}catch(x){return console.error(`Error creating file <${p}> at "${h}"`,x),alert(`Error creating file <${p}> at "${h}"`),{}}}t.creatWorkflow=l;async function c({parentFolderID:u,name:d,id:f}){const p=await(P==null?void 0:P.getSetting("myWorkflowsDir")),y=ft(`${p}/${u??""}/${d}.json`);try{const v=await(await fetch("/workspace/get_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:y,id:f})})).json();return v.error&&(console.error(`Error getting file <${f}> at "${y}"`,v.error),alert({message:`Error getting file <${f}> at "${y}"`,level:"error"})),v}catch(h){return console.error(`Erro finding file <${f}> at "${y}"`,h),{}}}t.getFile=c})(Ye||(Ye={}));async function Xf(t){try{return await(await fetch("/workspace/scan_my_workflows_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:ft(t)})})).json()}catch(e){return console.error("Error scan local new files:",e),[]}}async function Zf(t,e){const n=await(P==null?void 0:P.getSetting("myWorkflowsDir"));if(n==null||n==="")return alert("No Workspace saving directory found, please go to Settings."),[];const r=t??"",o=`${n}/${r}`,a=(await Xf(o)).map(async c=>{var p;const u=c.name,d=ft([o,u].join("/")),f=[r,u].join("/");return Qf(c)?{id:f,name:c.name,parentFolderID:r,type:"folder",createTime:Date.now(),updateTime:Date.now()}:{...await((p=H.workflows)==null?void 0:p.get(c.id))??{createTime:Date.now(),updateTime:Date.now()},id:c.id,filePath:d,lastSavedJson:c.json??"{}",json:c.json??"{}",name:u.replace(/\.json$/,""),parentFolderID:r,createTime:c.createTime}}),i=await Promise.all(a);H.workflows.bulkPut(i.filter(c=>!np(c)));const l=i.filter(c=>c!=null);return Xi(l,e??_t.RECENTLY_MODIFIED)}function Qf(t){return"type"in t&&t.type==="folder"}const Ir=class Ir extends Jt{constructor(){super("workflows");ke(this,"_curWorkflow",null)}get curWorkflow(){return this._curWorkflow}static async load(){return new Ir}updateCurWorkflowID(n){if(n==null){this._curWorkflow=null;return}this.get(n).then(r=>{this._curWorkflow=r??null})}updateCurWorkflow(n){this._curWorkflow=n}async latestVersionCheck(){if(this._curWorkflow){const n=await H.workflows.get(this._curWorkflow.id);return n?(n==null?void 0:n.updateTime)===this._curWorkflow.updateTime:!0}return!0}async generateUniqueName(n,r){if(await(P==null?void 0:P.getSetting("twoWaySync"))){const l=await Ye.genFileUniqueName((n??"Untitled Flow")+".json",r??"");return(l==null?void 0:l.replace(/\.json$/,""))??"Untitled Flow"}let s=n??"Untitled Flow";const i=(await this.listAll()??[]).filter(l=>l.parentFolderID==r).map(l=>l.name);if(i.includes(s)){let l=2,c=!0;for(;c;)i.includes(`${s} ${l}`)?l++:(s=`${s} ${l}`,c=!1)}return s}async createFlow(n){const{id:r,json:o,name:s}=n,a=await this.generateUniqueName(s,n.parentFolderID??void 0),i=r??Ho(),l=Date.now(),c={...n,id:i,json:o??JSON.stringify(hr),name:a,updateTime:l,createTime:l};return await H.workflows.add(c),this.saveDiskDB(),await(P==null?void 0:P.getSetting("twoWaySync"))?(await Ye.creatWorkflow(c),await this.get(c.id)):(bn(c),c)}async update(n,r){throw new Error("Method not allowed.")}async updateMetaInfo(n,r){return this._update(n,r)}async _update(n,r){await H.workflows.update(n,r);const o=await H.workflows.get(n)??null;return this._curWorkflow&&this._curWorkflow.id===n&&(this._curWorkflow=o),this.saveDiskDB(),o}async updateFolder(n,r){var i;const o=await(P==null?void 0:P.getSetting("twoWaySync")),s=await this.get(n),a=await this.updateMetaInfo(n,r);!a||!s||(o?await Ye.moveWorkflow(s,r.parentFolderID):(await bn(a),await uo(s),(a==null?void 0:a.parentFolderID)!=null&&await((i=H.folders)==null?void 0:i.update(a.parentFolderID,{updateTime:Date.now()}))))}async genLastManualSavedJson(n){const r=await(Ae==null?void 0:Ae.getLastestByWorkflowID(n));return r==null?void 0:r.json}async updateName(n,r){const o=await this.get(n);return await(P==null?void 0:P.getSetting("twoWaySync"))&&o&&await Ye.renameWorkflow(o,r.name+".json"),await this.updateMetaInfo(n,r)}async updateFlow(n,r){const o=await this.get(n,!1);if(o==null)return;const s=JSON.stringify(o.json),a=JSON.stringify(r.json);if(s===a)return;const i=await this._update(n,{updateTime:Date.now(),json:r.json});await(P==null?void 0:P.getSetting("twoWaySync"))?i&&await Ye.saveWorkflow(i):i&&await bn(i)}async batchCreateFlows(n=[],r=!1,o){const s=[];for(const a of n){const i=a.name&&r?a.name:await this.generateUniqueName(a.name,o),l=Ho(),c=Date.now(),u={id:l,name:i,json:a.json,parentFolderID:o,updateTime:c,createTime:c,tags:[]};s.push(u),await(P==null?void 0:P.getSetting("twoWaySync"))?Ye.creatWorkflow(u):await bn(u)}await H.workflows.bulkAdd(s),this.saveDiskDB()}async deleteFlow(n){const r=await this.get(n);r&&(await(P==null?void 0:P.getSetting("twoWaySync"))?await Ye.deleteWorkflow(r):uo({...r})),await H.workflows.delete(n),this.saveDiskDB()}async batchDeleteFlow(n){const r=await H.workflows.bulkGet(n);for(const o of r){if(!o)return;await(P==null?void 0:P.getSetting("twoWaySync"))?await Ye.deleteWorkflow(o):uo({...o})}await H.workflows.bulkDelete(n),this.saveDiskDB()}async listFolderContent(n,r){if(await(P==null?void 0:P.getSetting("twoWaySync")))return await Zf(n??null);const s=await this.listAll().then(l=>l.filter(c=>c.parentFolderID==n))??[],a=await(Te==null?void 0:Te.listAll().then(l=>l.filter(c=>c.parentFolderID==n)))??[],i=[...s,...a];return Xi(i,r??_t.RECENTLY_MODIFIED)}async get(n,r=!0){const o=await(P==null?void 0:P.getSetting("twoWaySync")),s=await H.workflows.get(n);if(!o||!r)return s;if(s==null)return;const a=await Ye.getFile({parentFolderID:s.parentFolderID??null,name:s.name,id:s.id});if(a.json)return{...s,json:JSON.stringify(a.json)}}};ke(Ir,"TABLE_NAME","workflows");let Go=Ir;const Pr=class Pr extends Jt{constructor(){super("folders")}static async load(){return new Pr}async create(e){const n=await this.generateUniqueName(e.name,e.parentFolderID),r=await(P==null?void 0:P.getSetting("twoWaySync")),o=await Et.genFolderRelPath({name:n,parentFolderID:e.parentFolderID??""}),s={id:r?o:Pn(),name:n,parentFolderID:e.parentFolderID??null,updateTime:Date.now(),createTime:Date.now(),type:"folder"};return r?await Et.createFolder(s):(await H.folders.add(s),this.saveDiskDB()),s}async update(e,n){if(await(P==null?void 0:P.getSetting("twoWaySync")))return"parentFolderID"in n&&await Et.moveFolder(e,n.parentFolderID??""),"name"in n&&await Et.renameFolder(e,n.name??""),null;const o=await this.get(e);if(o==null)return null;const s="name"in n&&n.name!=o.name,a="parentFolderID"in n&&n.parentFolderID!=o.parentFolderID,i={...o,...n};return n.name!=null&&(i.updateTime=Date.now()),a&&(n.name=await this.generateUniqueName(i.name,i.parentFolderID??void 0)),await H.folders.update(e,n),this.saveDiskDB(),(s||a)&&qf(!0),i}async deleteFolder(e,n=pr.DELETE){await(P==null?void 0:P.getSetting("twoWaySync"))&&await Et.deleteFolder(e);const o=await(O==null?void 0:O.listAll())??[],s=await this.listAll(),a=[e];for(;a.length>0;){const i=a.shift();if(i){for(const c of o)if(c.parentFolderID===i)switch(n){case pr.DELETE:await(O==null?void 0:O.deleteFlow(c.id));break;case pr.MOVE_TO_ROOT_FOLDER:await(O==null?void 0:O.updateFolder(c.id,{parentFolderID:void 0}));break}await H.folders.delete(i);const l=s.filter(c=>c.parentFolderID===i).map(c=>c.id);l.length&&a.push(...l)}}this.saveDiskDB()}async generateUniqueName(e,n){if(await(P==null?void 0:P.getSetting("twoWaySync")))return await Ye.genFileUniqueName(e??"New folder",n??"")??"New folder";let o=e??"New folder";const s=await this.listAll().then(a=>a.filter(i=>i.parentFolderID==n).map(i=>i.name));if(s.includes(o)){let a=2,i=!0;for(;i;)s.includes(`${o} ${a}`)?a++:(o=`${o} ${a}`,i=!1)}return o}};ke(Pr,"TABLE_NAME","folders");let Yo=Pr;class Qi extends Jt{constructor(){super("media")}async listByWorkflowID(e){return await H.media.where("workflowID").equals(e).reverse().sortBy("createTime")}async create(e){const n=e.localPath.split(".").pop();if(n==null)return null;const r={id:Pn(),localPath:e.localPath,workflowID:e.workflowID,createTime:Date.now(),format:n},o=await(O==null?void 0:O.get(e.workflowID)),s=new Set((o==null?void 0:o.mediaIDs)??[]).add(r.id);return await(O==null?void 0:O.updateMetaInfo(e.workflowID,{mediaIDs:Array.from(s),coverMediaPath:r.localPath})),H.media.add(r),this.saveDiskDB(),r}}ke(Qi,"TABLE_NAME","media");const mh=["Checkpoint","TextualInversion","Hypernetwork","LORA","Controlnet","Upscaler","VAE"],ep={Checkpoint:"checkpoints",TextualInversion:"embeddings",Hypernetwork:"hypernetworks",LORA:"loras",Controlnet:"controlnet",Upscaler:"upscale_models",VAE:"vae"};function yh(t){return t.modelVersions!==void 0}function tp(t){var e;return((e=t.files)==null?void 0:e[0])!==void 0}function vh(t,e){var r,o,s,a,i,l;if(!t)return;let n;return tp(t)?n={id:t.id,SHA256:(o=(r=t.files)==null?void 0:r[0].hashes)==null?void 0:o.SHA256,name:(s=t.files)==null?void 0:s[0].name,sizeKB:(i=(a=t.files)==null?void 0:a[0])==null?void 0:i.sizeKB}:n={id:t.id,SHA256:(l=t.hashes)==null?void 0:l[2],name:`${e} ${t.name}`},n}const Nr=class Nr extends Jt{constructor(){super("userSettings");ke(this,"defaultSettings");ke(this,"DEFAULT_USER","guest");ke(this,"_autoSave",!1);this.defaultSettings={id:this.DEFAULT_USER,topBarStyle:{top:0,left:0},modelManagerTopBarStyle:{top:0,right:0},myWorkflowsDir:"",shortcuts:{save:"Shift+S"},defaultFolders:ep,autoSave:!0,twoWaySync:!1,foldersOnTop:!1,cloudHost:"https://www.comfyspace.art",overwriteCurWorkflowWhenDroppingFileToCanvas:!1}}get autoSave(){return this._autoSave}__TEMP_OVERRIDE_ONLY_disableAutoSave(){this._autoSave&&(this._autoSave=!1,setTimeout(async()=>{this._autoSave=await this.getSetting("autoSave")??this.defaultSettings.autoSave??!0},3e3))}async getSettings(){const n=await this.get(this.DEFAULT_USER);return{...this.defaultSettings,...n}}async getSetting(n){const r=await this.get(this.DEFAULT_USER);return(r==null?void 0:r[n])??this.defaultSettings[n]}async upsert(n){const o={...await this.get(this.DEFAULT_USER)??this.defaultSettings,...n};await this.put(o),Object.hasOwn(n,"autoSave")&&n.autoSave!==void 0&&(this._autoSave=n.autoSave)}static async load(){const n=new Nr,r=await $d();return n.defaultSettings.myWorkflowsDir=`${r.dir_path}/my_workflows`,await n.getSetting("autoSave").then(o=>{n._autoSave=o??!0}),n}};ke(Nr,"TABLE_NAME","userSettings");let Xo=Nr;const Ar=class Ar extends Jt{constructor(){super("tags")}static async load(){return new Ar}};ke(Ar,"TABLE_NAME","tags");let Zo=Ar;const Fr=class Fr extends Jt{constructor(){super("workflowVersions")}static async load(){return new Fr}async listByWorkflowID(e){return await H[this.tableName].where("workflowID").equals(e).reverse().sortBy("createTime")??[]}async getLatestByWorkflowID(e){const n=await this.listByWorkflowID(e);return n!=null&&n.length?n[0]:null}};ke(Fr,"TABLE_NAME","workflowVersions");let Qo=Fr;function np(t){return"type"in t&&t.type==="folder"}let O=null,mr=null,P=null,Te=null,Ae=null,Ut=null,me=null;async function rp(){const t=async()=>{O=await Go.load()},e=async()=>{mr=await Zo.load()},n=async()=>{P=await Xo.load()},r=async()=>{Te=await Yo.load()},o=async()=>{Ae=await Jo.load()},s=async()=>{Ut=new Qi},a=async()=>{me=await Qo.load()};await Promise.all([t(),e(),n(),r(),o(),s(),a()]),localStorage.getItem("WORKSPACE_INDEXDB_BACKFILL")!=="true"&&(await op(),localStorage.setItem("WORKSPACE_INDEXDB_BACKFILL","true"))}async function op(){const t=async()=>{try{const i=await(O==null?void 0:O.getRecords());i&&await H.workflows.bulkAdd(Object.values(i))}catch(i){console.error(i)}},e=async()=>{try{const i=await(Te==null?void 0:Te.getRecords());i&&await H.folders.bulkAdd(Object.values(i))}catch(i){console.error(i)}},n=async()=>{try{const i=await(Ut==null?void 0:Ut.getRecords());i&&await H.media.bulkAdd(Object.values(i))}catch(i){console.error(i)}},r=async()=>{try{const i=await(Ae==null?void 0:Ae.getRecords());i&&await H.changelogs.bulkAdd(Object.values(i))}catch(i){console.error(i)}},o=async()=>{try{const i=await(mr==null?void 0:mr.getRecords());i&&await H.tags.bulkAdd(Object.values(i))}catch(i){console.error(i)}},s=async()=>{try{const i=P,l=await i.getRecords().then(c=>c[i.DEFAULT_USER]?c[i.DEFAULT_USER]:c);await H.userSettings.put({...i.defaultSettings,...l})}catch(i){console.error(i)}},a=async()=>{try{const i=await(me==null?void 0:me.getRecords());i&&await H.workflowVersions.bulkAdd(Object.values(i))}catch(i){console.error(i)}};await Promise.all([t(),e(),n(),r(),o(),s(),a()])}const Pt=b.createContext({curFlowID:null,loadWorkflowID:()=>{},saveCurWorkflow:()=>{},discardUnsavedChanges:async()=>{},isDirty:!1,loadNewWorkflow:()=>{},loadFilePath:()=>{},setRoute:()=>{},jsonDiff:null,compareJson:()=>{}}),gh=b.createContext({refreshFolderStamp:0,setRefreshFolderStamp:()=>{}}),fo={x:0,y:0};function sp({children:t,onDragEnd:e,dragIconId:n}){const r=b.useRef(fo),o=b.useRef(!1),[s,a]=b.useState(fo),i=d=>{var f,p,y;if(!(!(d.target instanceof Element)||!(d.target.parentNode instanceof Element))&&[(f=d.target)==null?void 0:f.id,(y=(p=d.target)==null?void 0:p.parentNode)==null?void 0:y.id].includes(n)){r.current={x:d.clientX,y:d.clientY},o.current=!0,window.addEventListener("mousemove",l),window.addEventListener("mouseup",c);const h=document.getElementsByTagName("body")[0];h.style.userSelect="none"}},l=b.useCallback(d=>{const f={x:d.clientX-r.current.x,y:d.clientY-r.current.y};a(f)},[]),c=b.useCallback(()=>{a(f=>(e(f),fo)),o.current=!1;const d=document.getElementsByTagName("body")[0];d.style.userSelect="auto",window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",c)},[e,l]),u={transform:`translate(${s.x}px, ${s.y}px)`,zIndex:o.current?1e3:1};return m.jsx("div",{style:u,onMouseDown:i,children:t})}var ap={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},ip=Object.defineProperty,lp=Object.defineProperties,cp=Object.getOwnPropertyDescriptors,Dr=Object.getOwnPropertySymbols,el=Object.prototype.hasOwnProperty,tl=Object.prototype.propertyIsEnumerable,ma=(t,e,n)=>e in t?ip(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ya=(t,e)=>{for(var n in e||(e={}))el.call(e,n)&&ma(t,n,e[n]);if(Dr)for(var n of Dr(e))tl.call(e,n)&&ma(t,n,e[n]);return t},up=(t,e)=>lp(t,cp(e)),dp=(t,e)=>{var n={};for(var r in t)el.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Dr)for(var r of Dr(t))e.indexOf(r)<0&&tl.call(t,r)&&(n[r]=t[r]);return n},Oe=(t,e,n)=>{const r=b.forwardRef((o,s)=>{var a=o,{color:i="currentColor",size:l=24,stroke:c=2,children:u}=a,d=dp(a,["color","size","stroke","children"]);return b.createElement("svg",ya(up(ya({ref:s},ap),{width:l,height:l,stroke:i,strokeWidth:c,className:`tabler-icon tabler-icon-${t}`}),d),[...n.map(([f,p])=>b.createElement(f,p)),...u||[]])});return r.propTypes={color:Nt.string,size:Nt.oneOfType([Nt.string,Nt.number]),stroke:Nt.oneOfType([Nt.string,Nt.number])},r.displayName=`${e}`,r},fp=Oe("arrow-back-up-double","IconArrowBackUpDouble",[["path",{d:"M13 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M8 14l-4 -4l4 -4",key:"svg-1"}],["path",{d:"M9 10h7a4 4 0 1 1 0 8h-1",key:"svg-2"}]]),pp=Oe("chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),hp=Oe("cloud","IconCloud",[["path",{d:"M6.657 18c-2.572 0 -4.657 -2.007 -4.657 -4.483c0 -2.475 2.085 -4.482 4.657 -4.482c.393 -1.762 1.794 -3.2 3.675 -3.773c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.913 0 3.464 1.56 3.464 3.486c0 1.927 -1.551 3.487 -3.465 3.487h-11.878",key:"svg-0"}]]),mp=Oe("copy","IconCopy",[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]]),es=Oe("device-floppy","IconDeviceFloppy",[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]]),yp=Oe("download","IconDownload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 11l5 5l5 -5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]),vp=Oe("external-link","IconExternalLink",[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]]),gp=Oe("folder","IconFolder",[["path",{d:"M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2",key:"svg-0"}]]),wp=Oe("grip-vertical","IconGripVertical",[["path",{d:"M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}],["path",{d:"M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-4"}],["path",{d:"M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-5"}]]),bp=Oe("history","IconHistory",[["path",{d:"M12 8l0 4l2 2",key:"svg-0"}],["path",{d:"M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5",key:"svg-1"}]]),xp=Oe("link","IconLink",[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]]),kp=Oe("lock","IconLock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]),_p=Oe("photo","IconPhoto",[["path",{d:"M15 8h.01",key:"svg-0"}],["path",{d:"M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z",key:"svg-1"}],["path",{d:"M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5",key:"svg-2"}],["path",{d:"M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3",key:"svg-3"}]]),Ep=Oe("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),Cp=Oe("share-2","IconShare2",[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]]),Sp=Oe("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]),jp=Oe("triangle-inverted-filled","IconTriangleInvertedFilled",[["path",{d:"M20.118 3h-16.225a2.914 2.914 0 0 0 -2.503 4.371l8.116 13.549a2.917 2.917 0 0 0 4.987 .005l8.11 -13.539a2.914 2.914 0 0 0 -2.486 -4.386z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}]]),Dp=Oe("versions","IconVersions",[["path",{d:"M10 5m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 7l0 10",key:"svg-1"}],["path",{d:"M4 8l0 8",key:"svg-2"}]]),Op=Oe("world","IconWorld",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]]),Ip=Oe("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);function Pp(t){const{promptMessage:e="Are you sure you want to delete this?",variant:n="ghost",onDelete:r,isDisabled:o=!1,tooltipText:s}=t;return m.jsx(ri,{isLazy:!0,placement:"auto",children:({onClose:a})=>m.jsxs(m.Fragment,{children:[m.jsx(ni,{children:m.jsx(ht,{children:m.jsx(Wt,{hasArrow:!0,label:s,placement:"bottom",children:m.jsx(on,{"aria-label":"Delete confirm",size:"sm",icon:m.jsx(Sp,{color:"#F56565"}),isDisabled:o,variant:n})})})}),m.jsxs(li,{children:[m.jsx(oi,{}),m.jsx(ai,{onClick:a}),m.jsxs(si,{children:[m.jsx(Tt,{mb:4,pr:4,fontWeight:600,children:e}),m.jsx(Ke,{colorScheme:"red",size:"sm",onClick:()=>{r(),a()},children:"Yes, delete"})]})]})]})})}function Np({onClose:t}){const e=_a(),{curFlowID:n,isDirty:r}=b.useContext(Pt),[o,s]=b.useState(0),[a,i]=b.useState(null),[l,c]=b.useState([]),[u,d]=b.useState([]),f=async h=>{var E;const v=await(O==null?void 0:O.get(h)),w=await(Ae==null?void 0:Ae.listByWorkflowID(h));c(w??[]);const g=w==null?void 0:w.filter(S=>S.json===(v==null?void 0:v.json)),x=(E=g==null?void 0:g[0])==null?void 0:E.id;x&&i(x)},p=async()=>{var x;const h=await(me==null?void 0:me.listByWorkflowID(n))??[];d(h);const v=JSON.stringify(ge.graph.serialize()),w=h==null?void 0:h.filter(E=>E.json===v),g=(x=w==null?void 0:w[0])==null?void 0:x.id;g&&i(g)},y=h=>{me==null||me.delete(h).then(()=>{p()})};return b.useEffect(()=>{switch(o){case 0:p();break;case 1:f(n);break}},[o]),b.useEffect(()=>(ge.canvasEl.addEventListener("click",t),()=>{ge.canvasEl.removeEventListener("click",t)}),[o]),m.jsxs(Rl,{width:400,height:"100vh",gap:0,position:"fixed",top:0,left:0,zIndex:1e3,children:[m.jsx(Ml,{pb:1,mb:0,children:m.jsxs(rr,{justifyContent:"space-between",alignItems:"center",children:[m.jsx(Ta,{size:"md",children:"Version History"}),m.jsx(on,{size:"sm",icon:m.jsx(Ip,{}),onClick:t,variant:"ghost","aria-label":"close version history"})]})}),m.jsx(Fl,{overflowY:"auto",gap:0,children:m.jsxs(di,{isFitted:!0,variant:"enclosed",onChange:s,children:[m.jsxs(fi,{mb:"1em",children:[m.jsx(bo,{children:"Versions"}),m.jsx(bo,{children:"Change History"})]}),m.jsxs(pi,{children:[m.jsx(wo,{children:m.jsx(xn,{divider:m.jsx(mo,{}),spacing:2,children:u==null?void 0:u.map(h=>m.jsxs(rr,{w:"100%",mb:1,justify:"space-between",backgroundColor:h.id===a?"teal.300":void 0,borderRadius:4,children:[m.jsxs(xn,{textAlign:"left",gap:0,children:[m.jsx(Tt,{fontWeight:"500",children:h.name??"untitled"}),m.jsxs(Tt,{color:"GrayText",fontSize:"sm",children:["Created: ",pa(h.createTime)]})]}),m.jsxs(rr,{alignItems:"center",gap:2,children:[m.jsx(Ke,{size:"sm",onClick:()=>{if(r){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}ge.loadGraphData(JSON.parse(h.json)),O==null||O.updateFlow(n,{json:h.json}),e({title:`Switched to version "${h.name}"`,status:"success",duration:3e3,isClosable:!0}),t()},children:"Load"}),m.jsx(Pp,{promptMessage:"Are you sure you want to delete this version?",onDelete:()=>{y(h.id)}})]})]},h.id))})}),m.jsxs(wo,{children:[m.jsx(Tt,{mb:4,children:"All the saved changes of this workflow"}),m.jsx(xn,{divider:m.jsx(mo,{}),spacing:2,children:l==null?void 0:l.map(h=>m.jsxs(Ke,{size:"sm",variant:"ghost",onClick:()=>{if(r){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}ge.loadGraphData(JSON.parse(h.json)),O==null||O.updateFlow(n,{json:h.json}),t()},isActive:h.id===a,children:["Saved at ",pa(h.createTime,!0)]},h.id))})]})]})]})})]})}function Ap({workflowId:t,onClose:e}){const[n,r]=b.useState(""),[o,s]=b.useState(""),a=l=>{r(l.target.value),o&&s("")},i=async()=>{const l=n.trim();if(r(l),(await(me==null?void 0:me.listByWorkflowID(t))??[]).some(u=>u.name===l))s("The name is duplicated, please modify it and submit again.");else{const u=JSON.stringify(ge.graph.serialize());await(me==null?void 0:me.add({name:n,workflowID:t,createTime:Date.now(),json:u})),e()}};return m.jsxs(Tr,{isOpen:!0,onClose:e,children:[m.jsx(rs,{}),m.jsxs(Lr,{children:[m.jsx(os,{children:"Create Version"}),m.jsx(ss,{}),m.jsx(as,{children:m.jsxs(Br,{isInvalid:!!o,children:[m.jsx(Kr,{children:"Name"}),m.jsx(Bn,{value:n,onChange:a,autoFocus:!0,onKeyUp:l=>{l.code==="Enter"&&!o&&n&&i()}}),o&&m.jsx($r,{children:o})]})}),m.jsxs(is,{children:[m.jsx(Ke,{colorScheme:"teal",mr:3,onClick:i,isDisabled:!n||!!o,children:"Create"}),m.jsx(Ke,{onClick:e,children:"Cancel"})]})]})]})}function Fp({options:t,menuButton:e,isOpen:n,onClose:r}){const o=b.useRef(null);return ic({ref:o,handler:()=>r()}),m.jsxs(ht,{position:"relative",children:[m.jsx(ht,{children:e}),n&&m.jsx(ht,{ref:o,mt:"8px",shadow:"md",p:"2",position:"absolute",zIndex:"dropdown",children:t})]})}function nl({menuButton:t,menuContent:e,onClose:n}){const r=b.useRef(),[o,s]=b.useState(!1),a=()=>{r.current=setTimeout(()=>s(!1),400)},i=()=>{s(!0),clearTimeout(r.current),r.current=void 0};return m.jsx(Fp,{isOpen:o,onClose:a,menuButton:m.jsx(ht,{"aria-label":"menu",onClick:i,onMouseEnter:i,onMouseLeave:a,children:t}),options:m.jsx(bs,{isOpen:!0,children:m.jsx(xs,{minWidth:150,zIndex:1e3,onMouseEnter:i,onMouseLeave:a,children:e})})})}var rl={exports:{}};(function(t,e){(function(n,r){t.exports=r(b)})(self,function(n){return(()=>{var r={579:(i,l,c)=>{var u=c(84);i.exports=u},84:(i,l,c)=>{c.r(l),c.d(l,{default:()=>se});var u=c(250),d=c.n(u),f=function(_){return _==="array"||Object.prototype.toString.call(_)==="[object Array]"},p=function(_){return Object.prototype.toString.call(_)==="[object Object]"},y=function(_){return _===1?{textIndent:"20px"}:{textIndent:"".concat(20*_,"px")}},h=function(_){var N=Object.prototype.toString.call(_);return(N=N.match(/(?!\[).+(?=\])/g)[0].split(" ")[1]).toLowerCase()},v=function(_){return p(_)||f(_)},w=function(_,N){return Object.prototype.toString.call(_)===Object.prototype.toString.call(N)};function g(_,N,M){return N in _?Object.defineProperty(_,N,{value:M,enumerable:!0,configurable:!0,writable:!0}):_[N]=M,_}function x(){return x=Object.assign||function(_){for(var N=1;N<arguments.length;N++){var M=arguments[N];for(var L in M)Object.prototype.hasOwnProperty.call(M,L)&&(_[L]=M[L])}return _},x.apply(this,arguments)}function E(_,N){(N==null||N>_.length)&&(N=_.length);for(var M=0,L=new Array(N);M<N;M++)L[M]=_[M];return L}function S(_){var N,M,L,X=_.name,G=_.value,ae=_.type,V=_.line,W=_.showIndex,ee=_.needComma,T=_.level,te=T===void 0?1:T,ne=_.lineType,ie=_.lastLineType,Ie=_.lastLine,Y=Ie===void 0?null:Ie,de=(M=(0,u.useState)(!0),L=2,function(ue){if(Array.isArray(ue))return ue}(M)||function(ue,Se){var ve=ue==null?null:typeof Symbol<"u"&&ue[Symbol.iterator]||ue["@@iterator"];if(ve!=null){var tt,Ge,re=[],Le=!0,nt=!1;try{for(ve=ve.call(ue);!(Le=(tt=ve.next()).done)&&(re.push(tt.value),!Se||re.length!==Se);Le=!0);}catch(mn){nt=!0,Ge=mn}finally{try{Le||ve.return==null||ve.return()}finally{if(nt)throw Ge}}return re}}(M,L)||function(ue,Se){if(ue){if(typeof ue=="string")return E(ue,Se);var ve=Object.prototype.toString.call(ue).slice(8,-1);return ve==="Object"&&ue.constructor&&(ve=ue.constructor.name),ve==="Map"||ve==="Set"?Array.from(ue):ve==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ve)?E(ue,Se):void 0}}(M,L)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),Ce=de[0],$e=de[1];return d().createElement("div",{className:"c-json-line"},d().createElement("p",{className:"c-json-p c-line-".concat(ne),onClick:function(){return $e(!Ce)},style:y(te)},d().createElement("span",{className:"c-json-mark"},V),d().createElement("span",{className:"c-of-".concat(ne)}),d().createElement("span",{className:"c-json-content"},W&&d().createElement("span",{className:"c-json-key"},X,": "),d().createElement("span",{className:"c-json-pt"},f(ae)?"[":"{")),!Ce&&d().createElement("span",{className:"c-json-pt"},f(ae)?"...]":"...}",ee?",":"")),d().createElement("div",{style:{display:Ce?"block":"none"}},G.map(function(ue,Se){return d().createElement(k,x({key:Se,level:te+1},ue))}),d().createElement("p",(g(N={className:"c-json-feet"},"className","c-json-p c-line-".concat(ne)),g(N,"style",y(te)),N),Y&&d().createElement("span",{className:"c-json-mark"},Y),ie&&d().createElement("span",{className:"c-of-".concat(ie)}),d().createElement("span",{className:"c-json-pt"},f(ae)?"]":"}",ee?",":""))))}function C(_){var N=_.name,M=_.value,L=_.line,X=_.showIndex,G=_.type,ae=_.lineType,V=_.needComma,W=_.level,ee=W===void 0?1:W;return d().createElement("p",{className:"c-json-p c-line-".concat(ae),style:y(ee)},d().createElement("span",{className:"c-json-mark"},L),d().createElement("span",{className:"c-of-".concat(ae)}),d().createElement("span",{className:"c-json-content"},X&&d().createElement("span",{className:"c-json-key"},N,": "),d().createElement("span",{className:"c-json-".concat(G)},M),d().createElement("span",{className:"c-json-comma"},V?",":"")))}function k(_){return(N=_.type)==="array"||N==="object"?d().createElement(S,_):d().createElement(C,_);var N}var D=c(379),j=c.n(D),A=c(795),F=c.n(A),q=c(569),$=c.n(q),K=c(565),le=c.n(K),z=c(216),I=c.n(z),Z=c(589),oe=c.n(Z),he=c(725),be={};function Ee(){return Ee=Object.assign||function(_){for(var N=1;N<arguments.length;N++){var M=arguments[N];for(var L in M)Object.prototype.hasOwnProperty.call(M,L)&&(_[L]=M[L])}return _},Ee.apply(this,arguments)}function ce(_,N){(N==null||N>_.length)&&(N=_.length);for(var M=0,L=new Array(N);M<N;M++)L[M]=_[M];return L}be.styleTagTransform=oe(),be.setAttributes=le(),be.insert=$().bind(null,"head"),be.domAPI=F(),be.insertStyleElement=I(),j()(he.Z,be),he.Z&&he.Z.locals&&he.Z.locals;const se=function(_){var N,M,L=_.oldData,X=_.newData,G=(N=(0,u.useState)([]),M=2,function(W){if(Array.isArray(W))return W}(N)||function(W,ee){var T=W==null?null:typeof Symbol<"u"&&W[Symbol.iterator]||W["@@iterator"];if(T!=null){var te,ne,ie=[],Ie=!0,Y=!1;try{for(T=T.call(W);!(Ie=(te=T.next()).done)&&(ie.push(te.value),!ee||ie.length!==ee);Ie=!0);}catch(de){Y=!0,ne=de}finally{try{Ie||T.return==null||T.return()}finally{if(Y)throw ne}}return ie}}(N,M)||function(W,ee){if(W){if(typeof W=="string")return ce(W,ee);var T=Object.prototype.toString.call(W).slice(8,-1);return T==="Object"&&W.constructor&&(T=W.constructor.name),T==="Map"||T==="Set"?Array.from(W):T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T)?ce(W,ee):void 0}}(N,M)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),ae=G[0],V=G[1];return(0,u.useEffect)(function(){var W,ee,T,te,ne,ie;V((T=[],te=1,ne=function Ie(Y,de){var Ce=[];if(v(Y)){var $e=h(Y)==="object",ue=Object.keys(Y),Se=ue.length;return ue.forEach(function(ve,tt){var Ge=h(Y[ve]);Ce.push({name:ve,line:te++,value:Ie(Y[ve],de),type:Ge,showIndex:$e,needComma:Se!==tt+1,lineType:de,lastLineType:de,lastLine:v(Y[ve])?te++:null})}),Ce}switch(h(Y)){case"number":case"boolean":case"regexp":return Y.toString();case"null":return"null";case"undefined":return"undefined";case"function":return" ƒ() {...}";default:return'"'.concat(Y.toString(),'"')}},ie=function(Ie,Y,de,Ce,$e){return{name:Ie,line:te++,value:ne(Y,$e),type:h(Y),showIndex:de,needComma:Ce,lineType:$e,lastLineType:$e,lastLine:v(Y)?te++:null}},w(W=L,ee=X)&&v(ee)?function Ie(Y,de,Ce){var $e=Object.keys(Y),ue=Object.keys(de),Se=p(de),ve=$e.filter(function(re){return!ue.some(function(Le){return Le===re})}),tt=$e.filter(function(re){return ue.some(function(Le){return Le===re})}),Ge=ue.filter(function(re){return!$e.some(function(Le){return Le===re})});ve.forEach(function(re,Le){var nt=!0;tt.length===0&&Ge.length===0&&Le===ve.length-1&&(nt=!1),Ce.push(ie(re,Y[re],Se,nt,"del"))}),tt.forEach(function(re,Le){var nt=!0;if(Ge.length===0&&Le===tt.length-1&&(nt=!1),Y[re]===de[re])Ce.push(ie(re,de[re],Se,nt,"none"));else if(w(Y[re],de[re]))if(v(de[re])){var mn=ie(re,f(Y[re])?[]:{},Se,nt,"none");Ce.push(mn),te-=1,Ie(Y[re],de[re],mn.value),mn.lastLine=te++}else Ce.push(ie(re,Y[re],Se,!0,"del")),Ce.push(ie(re,de[re],Se,nt,"add"));else Ce.push(ie(re,Y[re],Se,!0,"del")),Ce.push(ie(re,de[re],Se,nt,"add"))}),Ge.forEach(function(re,Le){Ce.push(ie(re,de[re],Se,Ge.length!==Le+1,"add"))})}(W,ee,T):W===ee?T.push(ie(0,ee,!1,!1,"none")):(T.push(ie(0,W,!1,!0,"del")),T.push(ie(1,ee,!1,!1,"add"))),T))},[L,X]),d().createElement("pre",{className:"c-json-view"},d().createElement("p",{className:"c-json-outter"},f(X)?"[":"{"),ae.map(function(W,ee){return d().createElement(k,Ee({key:ee},W))}),d().createElement("p",{className:"c-json-outter"},f(X)?"]":"}"))}},725:(i,l,c)=>{c.d(l,{Z:()=>y});var u=c(81),d=c.n(u),f=c(645),p=c.n(f)()(d());p.push([i.id,`.c-json-view {
  display: block;
  width: 100%;
  padding: 10px 10px 10px 40px;
  background-color: #fbfbfb;
  box-sizing: border-box;
  white-space: pre-wrap;
  word-wrap: break-word;
  overflow: hidden;
}

.c-json-line,
.c-json-p,
.c-json-feet {
  position: relative;
  text-align: left;
  padding: 0;
  margin: 0;
  padding: 2px 0;
}

.c-json-line {
  padding: 0;
}

.c-line-del {
  background-color: #ffeef0;
}

.c-line-add {
  background-color: #e6ffed;
}

.c-line-none {}

.c-of-del:after {
  content: '-';
  position: absolute;
  left: 5px;
  top: 3px;
  width: 10px;
  height: 15px;
  z-index: 5;
  text-indent: 0;
  color: #ff6f6f;
}

.c-of-add:after {
  content: '+';
  position: absolute;
  left: 5px;
  top: 3px;
  width: 10px;
  height: 15px;
  z-index: 5;
  color: #3eb93e;
  text-indent: 0;
}

.c-json-p {
  cursor: pointer;
}

.c-json-outter {
  transform: translateX(-35px);
}

.c-json-mark {
  position: absolute;
  left: -30px;
  top: 2px;
  text-indent: 0;
  font-size: 12px;
  color: #545454;
  z-index: 5;
  user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.c-json-content {
  font-size: 14px;
}

.c-json-content .c-json-key {
  font-size: 15px;
  color: #5cadff;
}

.c-json-items {
  color: #b1b1b1;
}

.c-json-comma {
  color: #5cadff;
}

.c-json-pt {
  color: #5cadff;
}

.c-json-number {
  color: #ae81ff;
}

.c-json-string {
  color: #a6e22e;
}

.c-json-null,
.c-json-boolean,
.c-json-undefined,
.c-json-regexp,
.c-json-date,
.c-json-set,
.c-json-map,
.c-json-error,
.c-json-symbol,
.c-json-function {
  background-color: #f7f7f7;
  border-radius: 3px;
  padding: 0px 2px;
  border: 1px solid #dedede;
}

.c-json-boolean {
  color: #6f73ff;
}

.c-json-null {
  color: #66d9ef;
}

.c-json-undefined {
  color: #f92672;
}

.c-json-date {
  color: #09d3ac;
}

.c-json-regexp {
  color: #2ea021;
}

.c-json-function {
  color: #a2af3d;
}

.c-json-symbol {
  color: #fd3db8;
}

.c-json-error {
  color: #afafaf;
}

.c-json-set,
.c-json-map {
  color: #f56847;
}`,""]);const y=p},645:i=>{i.exports=function(l){var c=[];return c.toString=function(){return this.map(function(u){var d="",f=u[5]!==void 0;return u[4]&&(d+="@supports (".concat(u[4],") {")),u[2]&&(d+="@media ".concat(u[2]," {")),f&&(d+="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {")),d+=l(u),f&&(d+="}"),u[2]&&(d+="}"),u[4]&&(d+="}"),d}).join("")},c.i=function(u,d,f,p,y){typeof u=="string"&&(u=[[null,u,void 0]]);var h={};if(f)for(var v=0;v<this.length;v++){var w=this[v][0];w!=null&&(h[w]=!0)}for(var g=0;g<u.length;g++){var x=[].concat(u[g]);f&&h[x[0]]||(y!==void 0&&(x[5]===void 0||(x[1]="@layer".concat(x[5].length>0?" ".concat(x[5]):""," {").concat(x[1],"}")),x[5]=y),d&&(x[2]&&(x[1]="@media ".concat(x[2]," {").concat(x[1],"}")),x[2]=d),p&&(x[4]?(x[1]="@supports (".concat(x[4],") {").concat(x[1],"}"),x[4]=p):x[4]="".concat(p)),c.push(x))}},c}},81:i=>{i.exports=function(l){return l[1]}},379:i=>{var l=[];function c(f){for(var p=-1,y=0;y<l.length;y++)if(l[y].identifier===f){p=y;break}return p}function u(f,p){for(var y={},h=[],v=0;v<f.length;v++){var w=f[v],g=p.base?w[0]+p.base:w[0],x=y[g]||0,E="".concat(g," ").concat(x);y[g]=x+1;var S=c(E),C={css:w[1],media:w[2],sourceMap:w[3],supports:w[4],layer:w[5]};if(S!==-1)l[S].references++,l[S].updater(C);else{var k=d(C,p);p.byIndex=v,l.splice(v,0,{identifier:E,updater:k,references:1})}h.push(E)}return h}function d(f,p){var y=p.domAPI(p);return y.update(f),function(h){if(h){if(h.css===f.css&&h.media===f.media&&h.sourceMap===f.sourceMap&&h.supports===f.supports&&h.layer===f.layer)return;y.update(f=h)}else y.remove()}}i.exports=function(f,p){var y=u(f=f||[],p=p||{});return function(h){h=h||[];for(var v=0;v<y.length;v++){var w=c(y[v]);l[w].references--}for(var g=u(h,p),x=0;x<y.length;x++){var E=c(y[x]);l[E].references===0&&(l[E].updater(),l.splice(E,1))}y=g}}},569:i=>{var l={};i.exports=function(c,u){var d=function(f){if(l[f]===void 0){var p=document.querySelector(f);if(window.HTMLIFrameElement&&p instanceof window.HTMLIFrameElement)try{p=p.contentDocument.head}catch{p=null}l[f]=p}return l[f]}(c);if(!d)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");d.appendChild(u)}},216:i=>{i.exports=function(l){var c=document.createElement("style");return l.setAttributes(c,l.attributes),l.insert(c,l.options),c}},565:(i,l,c)=>{i.exports=function(u){var d=c.nc;d&&u.setAttribute("nonce",d)}},795:i=>{i.exports=function(l){var c=l.insertStyleElement(l);return{update:function(u){(function(d,f,p){var y="";p.supports&&(y+="@supports (".concat(p.supports,") {")),p.media&&(y+="@media ".concat(p.media," {"));var h=p.layer!==void 0;h&&(y+="@layer".concat(p.layer.length>0?" ".concat(p.layer):""," {")),y+=p.css,h&&(y+="}"),p.media&&(y+="}"),p.supports&&(y+="}");var v=p.sourceMap;v&&typeof btoa<"u"&&(y+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(v))))," */")),f.styleTagTransform(y,d,f.options)})(c,l,u)},remove:function(){(function(u){if(u.parentNode===null)return!1;u.parentNode.removeChild(u)})(c)}}}},589:i=>{i.exports=function(l,c){if(c.styleSheet)c.styleSheet.cssText=l;else{for(;c.firstChild;)c.removeChild(c.firstChild);c.appendChild(document.createTextNode(l))}}},250:i=>{i.exports=n}},o={};function s(i){var l=o[i];if(l!==void 0)return l.exports;var c=o[i]={id:i,exports:{}};return r[i](c,c.exports,s),c.exports}s.n=i=>{var l=i&&i.__esModule?()=>i.default:()=>i;return s.d(l,{a:l}),l},s.d=(i,l)=>{for(var c in l)s.o(l,c)&&!s.o(i,c)&&Object.defineProperty(i,c,{enumerable:!0,get:l[c]})},s.o=(i,l)=>Object.prototype.hasOwnProperty.call(i,l),s.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var a=s(579);return a.default})()})})(rl);var Mp=rl.exports;const Rp=va(Mp);function Tp(){const{jsonDiff:t,compareJson:e}=b.useContext(Pt);return t==null?null:m.jsx(Tr,{isOpen:!0,onClose:()=>{e(null)},children:m.jsx(Lr,{children:m.jsx(ht,{height:"80vh",width:"90%",overflow:"scroll",children:m.jsx(Rp,{oldData:t==null?void 0:t.old,newData:t==null?void 0:t.new})})})})}const Lp=b.lazy(()=>Wr(()=>import("./ShareDialog-17qMdssr.js"),__vite__mapDeps([0,1,2])));function Wp(){const{curFlowID:t,loadWorkflowID:e,discardUnsavedChanges:n,saveCurWorkflow:r}=b.useContext(Pt),[o,s]=b.useState(!1),[a,i]=b.useState(!1),[l,c]=b.useState(!1),[u,d]=b.useState(""),[f,p]=b.useState(""),[y,h]=b.useState(),[v,w]=b.useState(""),[g,x]=b.useState(!1);b.useEffect(()=>{t&&(O==null||O.get(t).then(D=>{d((D==null?void 0:D.name)??""),h(D)})),P==null||P.getSetting("shortcuts").then(D=>{w(D==null?void 0:D.save)})},[t]);const E=D=>{d(D.target.value),f&&p("")},S=async()=>{if(!t){alert("Flow ID is required");return}const D=JSON.stringify(ge.graph.serialize()),j=await(O==null?void 0:O.createFlow({json:D,lastSavedJson:D,name:u,parentFolderID:y==null?void 0:y.parentFolderID}));j&&await e(j.id,!0),C()},C=()=>{i(!1)},k=b.useCallback(async()=>{const D=t?await(O==null?void 0:O.get(t)):null;if(!D){alert("Workspace does not exist");return}const j=new Blob([D.json],{type:"application/json"}),A=URL.createObjectURL(j),F=document.createElement("a");F.href=A,F.download=`${D.name}.json`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(A)},[t]);return m.jsxs(m.Fragment,{children:[m.jsx(nl,{menuButton:m.jsx(xl,{children:m.jsxs(Ke,{px:1,height:"29px","aria-label":"menu",size:"sm",backgroundColor:"teal.600",children:["File",m.jsx(pp,{size:20})]})}),menuContent:m.jsx(bs,{isOpen:!0,children:m.jsxs(xs,{minWidth:150,zIndex:1e3,children:[m.jsx(wt,{onClick:r,icon:m.jsx(es,{size:20}),iconSpacing:1,command:v,children:"Save"}),m.jsx(Wt,{label:"Revert workflow to your last saved version. You will lose all changes made since your last save.",children:m.jsx(wt,{onClick:n,icon:m.jsx(fp,{size:20}),iconSpacing:1,children:"Discard unsaved changes"})}),m.jsx(wt,{onClick:k,icon:m.jsx(yp,{size:20}),iconSpacing:1,children:"Download"}),m.jsx(wt,{onClick:()=>i(!0),icon:m.jsx(es,{size:20}),iconSpacing:1,children:"Save As"}),m.jsx(wt,{onClick:()=>s(!0),icon:m.jsx(Dp,{size:20}),iconSpacing:1,children:"Create Version"}),m.jsx(wt,{onClick:()=>c(!0),icon:m.jsx(bp,{size:20}),iconSpacing:1,children:"Versions History"}),m.jsx(wt,{onClick:()=>x(!0),icon:m.jsx(Cp,{size:20}),iconSpacing:1,alignItems:"center",children:m.jsxs(Ct,{children:[m.jsx("p",{children:"Share"})," ",m.jsx(mi,{size:"sm",children:"🧪🧪beta"})]})})]})})}),g&&m.jsx(Lp,{onClose:()=>x(!1)}),l&&m.jsx(Np,{onClose:()=>c(!1)}),m.jsx(Tp,{}),a&&m.jsxs(Tr,{isOpen:!0,onClose:C,children:[m.jsx(rs,{}),m.jsxs(Lr,{children:[m.jsx(os,{children:"Save As"}),m.jsx(ss,{}),m.jsx(as,{children:m.jsxs(Br,{isInvalid:!!f,children:[m.jsx(Kr,{children:"Workflow name"}),m.jsx(Bn,{value:u,onChange:E,autoFocus:!0,onKeyUp:D=>{D.code==="Enter"&&!f&&u&&S()}}),f&&m.jsx($r,{children:f})]})}),m.jsxs(is,{children:[m.jsx(Ke,{colorScheme:"teal",mr:3,onClick:S,isDisabled:!u||!!f,children:"Save"}),m.jsx(Ke,{onClick:C,children:"Cancel"})]})]})]}),o&&m.jsx(Ap,{workflowId:t,onClose:()=>s(!1)})]})}function Bp({displayName:t,updateFlowName:e,isDirty:n}){const{isOpen:r,onOpen:o,onClose:s}=uc(),{curFlowID:a}=b.useContext(Pt),[i,l]=b.useState(t),[c,u]=b.useState(""),d=()=>{l(t),o()},f=h=>{l(h.target.value),c&&u("")},p=async()=>{var h;if(a){const v=i.trim();if(l(v),t===v)return y();await(O==null?void 0:O.generateUniqueName(v,((h=O.curWorkflow)==null?void 0:h.parentFolderID)??""))!==v?u("The name is duplicated, please modify it and submit again."):(await(O==null?void 0:O.updateName(a,{name:v})),e(v),y())}},y=()=>{u(""),s()};return a==null?null:m.jsxs(Ct,{children:[m.jsx(Wt,{label:t,placement:"bottom",children:m.jsxs(Tt,{as:"div",color:"white",onClick:d,maxW:200,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:[m.jsx("div",{style:{width:8,display:"inline-block"},children:m.jsx(Tt,{as:"span",children:n&&"* "})}),t]})}),m.jsxs(Tr,{isOpen:r,onClose:y,children:[m.jsx(rs,{}),m.jsxs(Lr,{children:[m.jsx(os,{children:"Edit workflow name"}),m.jsx(ss,{}),m.jsx(as,{children:m.jsxs(Br,{isInvalid:!!c,children:[m.jsx(Kr,{children:"Workflow name"}),m.jsx(Bn,{value:i,onChange:f,autoFocus:!0,onKeyUp:h=>{h.code==="Enter"&&!c&&i&&p()}}),c&&m.jsx($r,{children:c})]})}),m.jsxs(is,{children:[m.jsx(Ke,{colorScheme:"teal",mr:3,onClick:p,isDisabled:!i||!!c,children:"Save"}),m.jsx(Ke,{onClick:y,children:"Cancel"})]})]})]})]})}function wh(t){const e=new Uint8Array(t);return window.crypto.getRandomValues(e),Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}const bh=[{label:"Private",value:"PRIVATE",icon:m.jsx(kp,{})},{label:"Unlisted, anyone with the link can view",value:"UNLISTED",icon:m.jsx(xp,{})},{label:"Public",value:"PUBLIC",icon:m.jsx(Op,{})}],xh=()=>{const t=ge.graph._nodes,e={};for(let n of t)if(n.type in LiteGraph.registered_node_types){const r=structuredClone(LiteGraph.registered_node_types[n.type].nodeData);if(r==null)continue;for(let o in r.input){const s=r.input[o];for(let a in s){const i=s[a];Array.isArray(i[0])&&(i[0]=["value_1","value_2"])}}e[n.type]=r}return e};async function $p(t){const e=t.cloudOrigin;if(!e)throw Error("cloudURL is required");return fetch(e+`/api/getWorkflow?id=${t.cloudID}`).then(n=>n.json()).then(n=>{var o;return((o=n.data)==null?void 0:o.privacy)??"PRIVATE"})}function Kp({privacy:t,showEmoji:e=!1}){let n;return t==="PRIVATE"?(n="Private",e&&(n="🔒 Private")):t==="UNLISTED"?(n="Unlisted",e&&(n="🔗 Unlisted")):t==="PUBLIC"&&(n="Public",e&&(n="🌐 Public")),m.jsx("span",{children:n})}function Up({}){const[t,e]=b.useState(),[n,r]=b.useState(),{curFlowID:o}=b.useContext(Pt);return b.useEffect(()=>{o&&(O==null||O.get(o).then(s=>{s!=null&&s.cloudID?(e(s.cloudOrigin+"/workflow/"+s.cloudID),$p(s).then(a=>{r(a)})):e(void 0)}))},[o]),t?m.jsx(m.Fragment,{children:m.jsx(nl,{menuButton:m.jsx(Ke,{onClick:()=>{window.open(t)},variant:"ghost","aria-label":"Shared",size:"xs",iconSpacing:"2px",leftIcon:m.jsx(hp,{}),height:"26px",px:1,children:n?m.jsx(Kp,{privacy:n}):"Shared"}),menuContent:m.jsxs(Ct,{width:"200px",p:1,color:"blue.400",children:[m.jsx(Ma,{href:t,noOfLines:1,isExternal:!0,children:t.replace("https://www.","")}),m.jsx(on,{size:"xs",variant:"ghost",icon:m.jsx(mp,{size:19}),"aria-label":"copy link"})]})})}):null}function zp({updatePanelPosition:t,positionStyle:e,curFlowName:n,setCurFlowName:r}){const{isDirty:o,loadNewWorkflow:s,saveCurWorkflow:a,setRoute:i,curFlowID:l}=b.useContext(Pt);return m.jsx(sp,{onDragEnd:c=>{t({top:c.y,left:c.x},!0)},dragIconId:"dragPanelIcon",children:m.jsxs(Ct,{style:{padding:2,position:"fixed",...e},justifyContent:"space-between",alignItems:"center",gap:2,draggable:!1,id:"workspaceManagerPanel",className:"workspaceManagerPanel",children:[m.jsx(Ke,{size:"sm","aria-label":"workspace folder",onClick:()=>i("recentFlows"),px:2,children:m.jsxs(Ct,{gap:1,children:[m.jsx(gp,{size:21}),m.jsx(jp,{size:8})]})}),m.jsx(Wt,{label:"New workflow",children:m.jsx(Ke,{size:"sm",variant:"outline",colorScheme:"teal","aria-label":"new workflow",onClick:()=>s(),px:2,py:2,children:m.jsx(Ct,{gap:0,children:m.jsx(Ep,{size:16,color:"white"})})})}),m.jsx(Bp,{isDirty:o,displayName:n??"",updateFlowName:c=>{r(c),requestAnimationFrame(()=>{t()})}}),l&&m.jsxs(Ct,{gap:"4px",children:[m.jsx(Wt,{label:"Open gallery",children:m.jsx(on,{onClick:()=>i("gallery"),icon:m.jsx(_p,{size:22,color:"white"}),size:"sm","aria-label":"open gallery",variant:"ghost"})}),m.jsx(Wp,{})]}),m.jsx(Up,{}),l&&o?m.jsx(Wt,{label:"Save workflow",children:m.jsx(on,{onClick:a,icon:m.jsx(es,{size:23,color:"white"}),size:"xs",paddingY:4,"aria-label":"save workspace",variant:"ghost"})}):m.jsx("div",{style:{width:1}}),m.jsx(wp,{id:"dragPanelIcon",className:"dragPanelIcon",cursor:"move",size:15,color:"#FFF"})]})})}function qp(){const{showDialog:t}=xa(),{loadWorkflowID:e}=b.useContext(Pt),n=async(o,s)=>{var c,u;const{workflow:a,version:i}=o.detail;if(!a.id||!i.id)return;const l=(c=await(O==null?void 0:O.listByIndex("cloudID",a.id)))==null?void 0:c.at(0);if(console.log("existingWorkflow",l),l)((u=await(me==null?void 0:me.listByIndex("cloudID",i.id)))==null?void 0:u.at(0))?await e(l.id):await(me==null?void 0:me.add({id:i.id,cloudID:i.id,workflowID:l.id,cloudOrigin:s,name:i.name,authorID:i.authorID,json:i.json}));else{const d=await(O==null?void 0:O.createFlow({cloudID:a.id,cloudOrigin:s,name:a.name,json:i.json,updateTime:Date.now()}));if(!d){alert("Failed to add workflow to local db");return}await(me==null?void 0:me.add({id:i.id,cloudID:i.id,workflowID:d.id,cloudOrigin:s,name:i.name,json:i.json})),await e(d.id)}},r=async o=>{const s=o.data;if(Vp(s)){const a=o.origin;t(`Open workflow "${s.detail.workflow.name}", version "${s.detail.version.name}" from ${a}`,[{label:"Open",colorScheme:"teal",onClick:()=>{n(s,a)}}])}};return b.useEffect(()=>{window.opener&&window.opener.postMessage("comfyui_workspace_manager_connected","*"),window.addEventListener("message",r)},[]),null}function Vp(t){return t.type==="workspace_open_workflow"}const Hp=ls.lazy(()=>Wr(()=>import("./RecentFilesDrawer-B74sdP_1.js"),__vite__mapDeps([3,1,4,2,5,6]))),Jp=ls.lazy(()=>Wr(()=>import("./GalleryModal-GhVpJqWk.js"),__vite__mapDeps([7,1,6,4,2,5]))),Gp=ls.lazy(()=>Wr(()=>import("./ModelManagerTopbar-rP-1MCD8.js").then(t=>t.M),__vite__mapDeps([8,1,4,2,9]))),Yp=["download_progress","download_error","model_list"];function Xp(){const[t,e]=b.useState(null),[n,r]=b.useState("root"),[o,s]=b.useState(!0),[a,i]=b.useState(null),l=b.useRef(null),[c,u]=b.useState(),[d,f]=b.useState(!1),p=b.useRef(null),{showDialog:y}=xa(),[h,v]=b.useState(!1);b.useRef(!1);const w=b.useRef(0),g=_a(),x=b.useRef("hide"),[E,S]=b.useState(null),C=b.useCallback(async()=>{if(l.current){const _=JSON.stringify(ge.graph.serialize());await Promise.all([O==null?void 0:O.updateFlow(l.current,{json:_}),Ae==null?void 0:Ae.create({workflowID:l.current,json:_})]),P!=null&&P.autoSave&&g({title:"Saved",status:"success",duration:1e3,isClosable:!0})}},[]),k=async()=>{l.current&&confirm("Are you sure you want to delete this workflow?")&&(await(O==null?void 0:O.delete(l.current)),j(null))},D=async()=>{var N,M,L;if(confirm("Are you sure you want to discard unsaved changes? This will revert current workflow to your last saved version. You will lose all changes made since your last save.")){const X=(N=O==null?void 0:O.curWorkflow)==null?void 0:N.id;if(X==null)return;let G;P!=null&&P.autoSave?G=(M=await(Ae==null?void 0:Ae.getLastestByWorkflowID(X)))==null?void 0:M.json:G=(L=await(O==null?void 0:O.get(X)))==null?void 0:L.json,G?await ge.loadGraphData(JSON.parse(G)):alert("Error: No last saved version found")}},j=_=>{const N=(_==null?void 0:_.id)??null;if(O==null||O.updateCurWorkflow(_),l.current=N,i(N),e((_==null?void 0:_.name)??""),N==null){document.title="ComfyUI",window.location.hash="",localStorage.removeItem("curFlowID");return}if(ha()){const M=Zi(N);window.location.hash=M,document.title=name+" - ComfyUI"}else localStorage.setItem("curFlowID",N),document.title="ComfyUI - "+name},A=async()=>{F(),localStorage.removeItem("workspace"),localStorage.removeItem("comfyspace");try{await rp(),await(P==null?void 0:P.getSetting("topBarStyle").then(N=>{be(N,!1)}))}catch(N){console.error("error loading db",N)}s(!1);let _=null;_=ha(),_==null&&(_=localStorage.getItem("curFlowID")),_&&K(_),localStorage.getItem("REWRITTEN_ALL_LOCAL_DISK_FILE")==="true"||(await Yf(),localStorage.setItem("REWRITTEN_ALL_LOCAL_DISK_FILE","true"))},F=()=>{Yp.forEach(_=>{Rs.addEventListener(_,()=>null)})},q=async()=>{if(l.current!=null){const _=O==null?void 0:O.curWorkflow;return!!_&&$(_)}return!1},$=_=>{if(_.json==null)return!0;const N=ge.graph.serialize()??{};let M={};try{M=_!=null&&_.json?JSON.parse(_==null?void 0:_.json):{}}catch(X){console.error("error parsing json",X)}return!(JSON.stringify(N)===JSON.stringify(M))},K=async _=>{if(ge.graph==null){console.error("app.graph is null cannot load workflow");return}const N=await(O==null?void 0:O.get(_));if(N==null){alert("Error: Workflow not found! id: "+_),j(null);return}j(N),ge.ui.dialog.close(),ge.loadGraphData(JSON.parse(N.json)),r("root")},le=_=>{S(_)},z=async(_,N=!1)=>{if(_===null){j(null),ge.graph.clear();return}if((await(P==null?void 0:P.getSetting("autoSave"))??!0)||!d||N){K(_);return}I(_)},I=async _=>{var M,L;const N=[_?{label:"Open in new tab",icon:m.jsx(vp,{}),onClick:()=>{Gf(_)}}:null,{label:"Save",colorScheme:"teal",onClick:async()=>{await C(),_&&K(_)}}];((M=O==null?void 0:O.curWorkflow)==null?void 0:M.lastSavedJson)!=null?N.push({label:"Discard",colorScheme:"red",onClick:async()=>{await D(),_&&K(_)}}):N.push({label:"Delete",colorScheme:"red",onClick:async()=>{await k(),_&&K(_)}}),y(`Please save or discard your changes to "${(L=O==null?void 0:O.curWorkflow)==null?void 0:L.name}" before leaving, or your changes will be lost.`,N)},Z=async _=>{const N=(_==null?void 0:_.json)??JSON.stringify(hr),M=await(O==null?void 0:O.createFlow({json:N,name:_==null?void 0:_.name}));M&&await z(M.id),r("root")},oe=async(_,N=!1)=>{const M=_.split("/").pop()??_;N?C():Z({name:M});const L=await fetch(Jf(_)),X=await L.blob(),G=new File([X],M,{type:L.headers.get("Content-Type")||""});await ge.handleFile(G),r("root")},he=async(_,N)=>{const M=await(O==null?void 0:O.get(_));if(M==null)return;const L=await(O==null?void 0:O.createFlow({json:M.json,lastSavedJson:M.lastSavedJson,name:N||M.name,parentFolderID:M.parentFolderID,tags:M.tags}));L&&await z(L.id)},be=b.useCallback((_,N=!1)=>{const{top:M=0,left:L=0}=c||{};let{top:X=0,left:G=0}=_??{};X+=M,G+=L;const ae=document.documentElement.clientWidth,V=document.documentElement.clientHeight,W=document.getElementById("workspaceManagerPanel"),ee=(W==null?void 0:W.offsetWidth)||392;X+36>V&&(X=V-36),G+ee>=ae&&(G=ae-ee),u({top:Math.max(0,X),left:Math.max(0,G)}),N&&(P==null||P.upsert({topBarStyle:{top:X,left:G}}))},[c]),Ee=async _=>{await Vf(_)&&C()},ce=b.useCallback(_=>{if(l.current==null)return;let N=_.filename;_.subfolder!=null&&_.subfolder!==""&&(N=_.subfolder+"/"+N),Ut==null||Ut.create({workflowID:l.current,localPath:N})},[]),se=b.useCallback(()=>{r("root")},[]);return b.useEffect(()=>{A(),v(!0),w.current=setInterval(async()=>{const G=P==null?void 0:P.autoSave,ae=await q();if(f(!!ae),!!ae&&l.current!=null&&G){const V=await(O==null?void 0:O.latestVersionCheck());if(x.current!=="disabled"&&!V)x.current="show",y(`This notification is to inform you that it appears you've opened the same workflow in multiple tabs. If all tabs are set to auto-save, this may lead to conflicts and potential data loss.

You might want to consider disabling auto-save to prevent this. We will remind you to save changes if you leave a page with unsaved work.`,[{label:"Do Not Remind Again",onClick:()=>{x.current="disabled"}},{label:"Disable Auto-Save",colorScheme:"teal",onClick:()=>{P==null||P.upsert({autoSave:!1})}}],!0);else{const W=JSON.stringify(ge.graph.serialize());W!=null&&await(O==null?void 0:O.updateFlow(l.current,{json:W}))}}},1e3),window.addEventListener("keydown",Ee);const _=document.getElementById("comfy-file-input"),N=async()=>{if(_&&_.files&&_.files.length>0){const G={id:Pn(),name:_.files[0].name,json:JSON.stringify(hr),updateTime:Date.now(),createTime:Date.now()};j(G),await(O==null?void 0:O.createFlow(G))}};_==null||_.addEventListener("change",N);const M=G=>{const ae=(P==null?void 0:P.autoSave)??!0,V=!!(O!=null&&O.curWorkflow)&&$(O==null?void 0:O.curWorkflow);!ae&&V&&(G.preventDefault(),G.returnValue="You have unsaved changes!",I())};window.addEventListener("beforeunload",M);const L=G=>{var ae,V,W,ee,T,te;(W=(V=(ae=G.detail)==null?void 0:ae.output)==null?void 0:V.images)==null||W.forEach(ne=>{ne.type==="output"&&ce(ne)}),(te=(T=(ee=G.detail)==null?void 0:ee.output)==null?void 0:T.gifs)==null||te.forEach(ne=>{ne.type==="output"&&ce(ne)})};Rs.addEventListener("executed",L);const X=async G=>{var ee,T;const ae=(T=(ee=G.dataTransfer)==null?void 0:ee.files[0])==null?void 0:T.name,V=ge.dragOverNode;if(V&&V.onDragDrop)return;if(!(await(P==null?void 0:P.getSetting("overwriteCurWorkflowWhenDroppingFileToCanvas"))??!1)&&ae){const te={id:Pn(),name:ae,json:JSON.stringify(hr),updateTime:Date.now(),createTime:Date.now()};j(te),await(O==null?void 0:O.createFlow(te))}};return ge.canvasEl.addEventListener("drop",X),()=>{window.removeEventListener("keydown",Ee),window.removeEventListener("change",N),window.removeEventListener("beforeunload",M),window.removeEventListener("executed",L),ge.canvasEl.removeEventListener("drop",X),clearInterval(w.current)}},[]),o||!c?null:m.jsx(Pt.Provider,{value:{curFlowID:a,onDuplicateWorkflow:he,loadWorkflowID:z,discardUnsavedChanges:D,saveCurWorkflow:C,isDirty:d,loadNewWorkflow:Z,loadFilePath:oe,setRoute:r,jsonDiff:E,compareJson:le},children:m.jsx("div",{ref:p,className:"workspace_manager",children:m.jsxs(ba,{containerRef:p,children:[m.jsxs(ht,{style:{position:"absolute",top:0,right:0,left:0},zIndex:Kf,draggable:!1,children:[m.jsx(zp,{curFlowName:t,setCurFlowName:e,updatePanelPosition:be,positionStyle:c}),h&&m.jsx(b.Suspense,{children:m.jsx(Gp,{})}),h&&n==="recentFlows"&&m.jsx(b.Suspense,{children:m.jsx(Hp,{onClose:se,onClickNewFlow:()=>{Z(),r("root")}})}),n==="gallery"&&m.jsx(Jp,{onclose:()=>r("root")})]}),m.jsx(qp,{})]})})})}const kh=Object.freeze(Object.defineProperty({__proto__:null,default:Xp},Symbol.toStringTag,{value:"Module"}));export{ni as $,wt as A,ht as B,yp as C,Pp as D,Ip as E,rr as F,pp as G,Ct as H,on as I,uh as J,gp as K,Te as L,ti as M,Br as N,Kr as O,$r as P,Ep as Q,gh as R,nd as S,mi as T,hr as U,fh as V,pr as W,np as X,ch as Y,zl as Z,ri as _,nh as a,li as a0,oi as a1,ai as a2,si as a3,Pt as a4,Gf as a5,vp as a6,_t as a7,Rl as a8,Kf as a9,xh as aA,$p as aB,Kp as aC,Ml as aD,kh as aE,ah as aa,Xi as ab,ph as ac,hh as ad,mp as ae,Ma as af,Ut as ag,Ta as ah,fc as ai,Cl as aj,H as ak,yh as al,vh as am,lh as an,uc as ao,ep as ap,mh as aq,ih as ar,sp as as,wp as at,ql as au,dn as av,hp as aw,bh as ax,me as ay,wh as az,dc as b,sh as c,rh as d,oh as e,fn as f,qr as g,Oe as h,Sp as i,xn as j,Tt as k,Bn as l,P as m,pa as n,dh as o,_a as p,mo as q,Wt as r,Uf as s,mr as t,zr as u,$d as v,O as w,qf as x,bs as y,xs as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["workspace_web/ShareDialog-17qMdssr.js","workspace_web/input.js","workspace_web/index-pz0vT7Or.js","workspace_web/RecentFilesDrawer-B74sdP_1.js","workspace_web/chunk-JARCRF6W-IwBcFM3i.js","workspace_web/chunk-NTCQBYKE-ZsMy4OBB.js","workspace_web/MediaPreview-EfKQfEU-.js","workspace_web/GalleryModal-GhVpJqWk.js","workspace_web/ModelManagerTopbar-rP-1MCD8.js","workspace_web/assets/ModelManagerTopbar--iv3sdjQ.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}