var jl=Object.defineProperty;var Pl=(t,e,n)=>e in t?jl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ie=(t,e,n)=>(Pl(t,typeof e!="symbol"?e+"":e,n),n);import{u as Al,a as Nl,r as P,c as Fl,b as rt,m as Me,d as Lt,f as fe,j as k,e as Na,g as de,h as _e,B as Rl,i as Te,k as Tl,o as Ye,l as Rt,n as it,I as Hr,p as Hn,q as lo,s as Oe,t as Fa,v as Ml,w as Bl,x as zl,y as qr,z as Ll,A as Wl,C as Ul,D as Kl,E as vs,F as Ra,G as gs,H as Ta,J as $l,K as Vl,L as Hl,P as Ma,M as Gr,N as ws,O as Zr,Q as bs,R as _s,S as Jr,T as xs,U as Xs,_ as yn,V as Ba,W as za,X as tr,Y as La}from"./input.js";import{app as we}from"/scripts/app.js";import{api as ql}from"/scripts/api.js";function Gl(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}function Wa(t){var e;return Gl(t)&&(e=t.ownerDocument)!=null?e:document}function Zl(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Jl=Zl();function Yl(t){const e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function Ua(t){const{theme:e}=Al(),n=Nl();return P.useMemo(()=>Fl(e.direction,{...n,...t}),[t,e.direction,n])}var Xl=Object.defineProperty,Ql=(t,e,n)=>e in t?Xl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,De=(t,e,n)=>(Ql(t,typeof e!="symbol"?e+"":e,n),n);function Qs(t){return t.sort((e,n)=>{const r=e.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var ec=t=>typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE;function ea(t,e,n){let r=t+1;return n&&r>=e&&(r=0),r}function ta(t,e,n){let r=t-1;return n&&r<0&&(r=e),r}var Io=typeof window<"u"?P.useLayoutEffect:P.useEffect,Ir=t=>t,tc=class{constructor(){De(this,"descendants",new Map),De(this,"register",t=>{if(t!=null)return ec(t)?this.registerNode(t):e=>{this.registerNode(e,t)}}),De(this,"unregister",t=>{this.descendants.delete(t);const e=Qs(Array.from(this.descendants.keys()));this.assignIndex(e)}),De(this,"destroy",()=>{this.descendants.clear()}),De(this,"assignIndex",t=>{this.descendants.forEach(e=>{const n=t.indexOf(e.node);e.index=n,e.node.dataset.index=e.index.toString()})}),De(this,"count",()=>this.descendants.size),De(this,"enabledCount",()=>this.enabledValues().length),De(this,"values",()=>Array.from(this.descendants.values()).sort((e,n)=>e.index-n.index)),De(this,"enabledValues",()=>this.values().filter(t=>!t.disabled)),De(this,"item",t=>{if(this.count()!==0)return this.values()[t]}),De(this,"enabledItem",t=>{if(this.enabledCount()!==0)return this.enabledValues()[t]}),De(this,"first",()=>this.item(0)),De(this,"firstEnabled",()=>this.enabledItem(0)),De(this,"last",()=>this.item(this.descendants.size-1)),De(this,"lastEnabled",()=>{const t=this.enabledValues().length-1;return this.enabledItem(t)}),De(this,"indexOf",t=>{var e,n;return t&&(n=(e=this.descendants.get(t))==null?void 0:e.index)!=null?n:-1}),De(this,"enabledIndexOf",t=>t==null?-1:this.enabledValues().findIndex(e=>e.node.isSameNode(t))),De(this,"next",(t,e=!0)=>{const n=ea(t,this.count(),e);return this.item(n)}),De(this,"nextEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=ea(r,this.enabledCount(),e);return this.enabledItem(o)}),De(this,"prev",(t,e=!0)=>{const n=ta(t,this.count()-1,e);return this.item(n)}),De(this,"prevEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=ta(r,this.enabledCount()-1,e);return this.enabledItem(o)}),De(this,"registerNode",(t,e)=>{if(!t||this.descendants.has(t))return;const n=Array.from(this.descendants.keys()).concat(t),r=Qs(n);e!=null&&e.disabled&&(e.disabled=!!e.disabled);const o={node:t,index:-1,...e};this.descendants.set(t,o),this.assignIndex(r)})}};function nc(){const t=P.useRef(new tc);return Io(()=>()=>t.current.destroy()),t.current}var[rc,Ka]=rt({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function oc(t){const e=Ka(),[n,r]=P.useState(-1),o=P.useRef(null);Io(()=>()=>{o.current&&e.unregister(o.current)},[]),Io(()=>{if(!o.current)return;const i=Number(o.current.dataset.index);n!=i&&!Number.isNaN(i)&&r(i)});const s=Ir(t?e.register(t):e.register);return{descendants:e,index:n,enabledIndex:e.enabledIndexOf(o.current),register:Me(s,o)}}function $a(){return[Ir(rc),()=>Ir(Ka()),()=>nc(),o=>oc(o)]}function Va(t){const{value:e,defaultValue:n,onChange:r,shouldUpdate:o=(p,h)=>p!==h}=t,s=Lt(r),i=Lt(o),[a,l]=P.useState(n),c=e!==void 0,u=c?e:a,d=Lt(p=>{const v=typeof p=="function"?p(u):p;i(u,v)&&(c||l(v),s(v))},[c,s,u,i]);return[u,d]}var Oo=fe(function(e,n){const{htmlWidth:r,htmlHeight:o,alt:s,...i}=e;return k.jsx("img",{width:r,height:o,ref:n,alt:s,...i})});Oo.displayName="NativeImage";function sc(t){const{loading:e,src:n,srcSet:r,onLoad:o,onError:s,crossOrigin:i,sizes:a,ignoreFallback:l}=t,[c,u]=P.useState("pending");P.useEffect(()=>{u(n?"loading":"pending")},[n]);const d=P.useRef(),p=P.useCallback(()=>{if(!n)return;h();const v=new Image;v.src=n,i&&(v.crossOrigin=i),r&&(v.srcset=r),a&&(v.sizes=a),e&&(v.loading=e),v.onload=f=>{h(),u("loaded"),o==null||o(f)},v.onerror=f=>{h(),u("failed"),s==null||s(f)},d.current=v},[n,i,r,a,o,s,e]),h=()=>{d.current&&(d.current.onload=null,d.current.onerror=null,d.current=null)};return Na(()=>{if(!l)return c==="loading"&&p(),()=>{h()}},[c,p,l]),l?"loaded":c}var ac=(t,e)=>t!=="loaded"&&e==="beforeLoadOrError"||t==="failed"&&e==="onError";function ic(t,e=[]){const n=Object.assign({},t);for(const r of e)r in n&&delete n[r];return n}var Ha=fe(function(e,n){const{fallbackSrc:r,fallback:o,src:s,srcSet:i,align:a,fit:l,loading:c,ignoreFallback:u,crossOrigin:d,fallbackStrategy:p="beforeLoadOrError",referrerPolicy:h,...v}=e,f=r!==void 0||o!==void 0,m=c!=null||u||!f,y=sc({...e,crossOrigin:d,ignoreFallback:m}),g=ac(y,p),_={ref:n,objectFit:l,objectPosition:a,...m?v:ic(v,["onError","onLoad"])};return g?o||k.jsx(de.img,{as:Oo,className:"chakra-image__placeholder",src:r,..._}):k.jsx(de.img,{as:Oo,src:s,srcSet:i,crossOrigin:d,loading:c,referrerPolicy:h,className:"chakra-image",..._})});Ha.displayName="Image";function ks(t){return P.Children.toArray(t).filter(e=>P.isValidElement(e))}var lc={horizontal:{"> *:first-of-type:not(:last-of-type)":{borderEndRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderStartRadius:0}},vertical:{"> *:first-of-type:not(:last-of-type)":{borderBottomRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderTopRadius:0}}},cc={horizontal:t=>({"& > *:not(style) ~ *:not(style)":{marginStart:t}}),vertical:t=>({"& > *:not(style) ~ *:not(style)":{marginTop:t}})},qa=fe(function(e,n){const{size:r,colorScheme:o,variant:s,className:i,spacing:a="0.5rem",isAttached:l,isDisabled:c,orientation:u="horizontal",...d}=e,p=_e("chakra-button__group",i),h=P.useMemo(()=>({size:r,colorScheme:o,variant:s,isDisabled:c}),[r,o,s,c]);let v={display:"inline-flex",...l?lc[u]:cc[u](a)};const f=u==="vertical";return k.jsx(Rl,{value:h,children:k.jsx(de.div,{ref:n,role:"group",__css:v,className:p,"data-attached":l?"":void 0,"data-orientation":u,flexDir:f?"column":void 0,...d})})});qa.displayName="ButtonGroup";var un=fe((t,e)=>{const{icon:n,children:r,isRound:o,"aria-label":s,...i}=t,a=n||r,l=P.isValidElement(a)?P.cloneElement(a,{"aria-hidden":!0,focusable:!1}):null;return k.jsx(Te,{padding:"0",borderRadius:o?"full":void 0,ref:e,"aria-label":s,...i,children:l})});un.displayName="IconButton";var[uc,Ga]=Tl("Card"),dc=fe(function(e,n){const{className:r,...o}=e,s=Ga();return k.jsx(de.div,{ref:n,className:_e("chakra-card__body",r),__css:s.body,...o})}),fc=fe(function(e,n){const{className:r,...o}=e,s=Ga();return k.jsx(de.div,{ref:n,className:_e("chakra-card__header",r),__css:s.header,...o})}),hc=fe(function(e,n){const{className:r,children:o,direction:s="column",justify:i,align:a,...l}=Ye(e),c=Rt("Card",e);return k.jsx(de.div,{ref:n,className:_e("chakra-card",r),__css:{display:"flex",flexDirection:s,justifyContent:i,alignItems:a,position:"relative",minWidth:0,wordWrap:"break-word",...c.container},...l,children:k.jsx(uc,{value:c,children:o})})}),[pc,Za]=rt({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[mc,vn]=rt({strict:!1,name:"FormControlContext"});function yc(t){const{id:e,isRequired:n,isInvalid:r,isDisabled:o,isReadOnly:s,...i}=t,a=P.useId(),l=e||`field-${a}`,c=`${l}-label`,u=`${l}-feedback`,d=`${l}-helptext`,[p,h]=P.useState(!1),[v,f]=P.useState(!1),[m,y]=P.useState(!1),g=P.useCallback((E={},F=null)=>({id:d,...E,ref:Me(F,I=>{I&&f(!0)})}),[d]),_=P.useCallback((E={},F=null)=>({...E,ref:F,"data-focus":it(m),"data-disabled":it(o),"data-invalid":it(r),"data-readonly":it(s),id:E.id!==void 0?E.id:c,htmlFor:E.htmlFor!==void 0?E.htmlFor:l}),[l,o,m,r,s,c]),x=P.useCallback((E={},F=null)=>({id:u,...E,ref:Me(F,I=>{I&&h(!0)}),"aria-live":"polite"}),[u]),C=P.useCallback((E={},F=null)=>({...E,...i,ref:F,role:"group","data-focus":it(m),"data-disabled":it(o),"data-invalid":it(r),"data-readonly":it(s)}),[i,o,m,r,s]),D=P.useCallback((E={},F=null)=>({...E,ref:F,role:"presentation","aria-hidden":!0,children:E.children||"*"}),[]);return{isRequired:!!n,isInvalid:!!r,isReadOnly:!!s,isDisabled:!!o,isFocused:!!m,onFocus:()=>y(!0),onBlur:()=>y(!1),hasFeedbackText:p,setHasFeedbackText:h,hasHelpText:v,setHasHelpText:f,id:l,labelId:c,feedbackId:u,helpTextId:d,htmlProps:i,getHelpTextProps:g,getErrorMessageProps:x,getRootProps:C,getLabelProps:_,getRequiredIndicatorProps:D}}var Yr=fe(function(e,n){const r=Rt("Form",e),o=Ye(e),{getRootProps:s,htmlProps:i,...a}=yc(o),l=_e("chakra-form-control",e.className);return k.jsx(mc,{value:a,children:k.jsx(pc,{value:r,children:k.jsx(de.div,{...s({},n),className:l,__css:r.container})})})});Yr.displayName="FormControl";var vc=fe(function(e,n){const r=vn(),o=Za(),s=_e("chakra-form__helper-text",e.className);return k.jsx(de.div,{...r==null?void 0:r.getHelpTextProps(e,n),__css:o.helperText,className:s})});vc.displayName="FormHelperText";var[gc,wc]=rt({name:"FormErrorStylesContext",errorMessage:`useFormErrorStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormError />" `}),Xr=fe((t,e)=>{const n=Rt("FormError",t),r=Ye(t),o=vn();return o!=null&&o.isInvalid?k.jsx(gc,{value:n,children:k.jsx(de.div,{...o==null?void 0:o.getErrorMessageProps(r,e),className:_e("chakra-form__error-message",t.className),__css:{display:"flex",alignItems:"center",...n.text}})}):null});Xr.displayName="FormErrorMessage";var bc=fe((t,e)=>{const n=wc(),r=vn();if(!(r!=null&&r.isInvalid))return null;const o=_e("chakra-form__error-icon",t.className);return k.jsx(Hr,{ref:e,"aria-hidden":!0,...t,__css:n.icon,className:o,children:k.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})});bc.displayName="FormErrorIcon";var Qr=fe(function(e,n){var r;const o=Hn("FormLabel",e),s=Ye(e),{className:i,children:a,requiredIndicator:l=k.jsx(Ja,{}),optionalIndicator:c=null,...u}=s,d=vn(),p=(r=d==null?void 0:d.getLabelProps(u,n))!=null?r:{ref:n,...u};return k.jsxs(de.label,{...p,className:_e("chakra-form__label",s.className),__css:{display:"block",textAlign:"start",...o},children:[a,d!=null&&d.isRequired?l:c]})});Qr.displayName="FormLabel";var Ja=fe(function(e,n){const r=vn(),o=Za();if(!(r!=null&&r.isRequired))return null;const s=_e("chakra-form__required-indicator",e.className);return k.jsx(de.span,{...r==null?void 0:r.getRequiredIndicatorProps(e,n),__css:o.requiredIndicator,className:s})});Ja.displayName="RequiredIndicator";function _c(t){const{isDisabled:e,isInvalid:n,isReadOnly:r,isRequired:o,...s}=xc(t);return{...s,disabled:e,readOnly:r,required:o,"aria-invalid":lo(n),"aria-required":lo(o),"aria-readonly":lo(r)}}function xc(t){var e,n,r;const o=vn(),{id:s,disabled:i,readOnly:a,required:l,isRequired:c,isInvalid:u,isReadOnly:d,isDisabled:p,onFocus:h,onBlur:v,...f}=t,m=t["aria-describedby"]?[t["aria-describedby"]]:[];return o!=null&&o.hasFeedbackText&&(o!=null&&o.isInvalid)&&m.push(o.feedbackId),o!=null&&o.hasHelpText&&m.push(o.helpTextId),{...f,"aria-describedby":m.join(" ")||void 0,id:s??(o==null?void 0:o.id),isDisabled:(e=i??p)!=null?e:o==null?void 0:o.isDisabled,isReadOnly:(n=a??d)!=null?n:o==null?void 0:o.isReadOnly,isRequired:(r=l??c)!=null?r:o==null?void 0:o.isRequired,isInvalid:u??(o==null?void 0:o.isInvalid),onFocus:Oe(o==null?void 0:o.onFocus,h),onBlur:Oe(o==null?void 0:o.onBlur,v)}}function on(t,e,n,r){const o=Lt(n);return P.useEffect(()=>{const s=typeof t=="function"?t():t??document;if(!(!n||!s))return s.addEventListener(e,o,r),()=>{s.removeEventListener(e,o,r)}},[e,t,r,o,n]),()=>{const s=typeof t=="function"?t():t??document;s==null||s.removeEventListener(e,o,r)}}function kc(t){return"current"in t}var Ya=()=>typeof window<"u";function Ec(){var t;const e=navigator.userAgentData;return(t=e==null?void 0:e.platform)!=null?t:navigator.platform}var Cc=t=>Ya()&&t.test(navigator.vendor),Sc=t=>Ya()&&t.test(Ec()),Ic=()=>Sc(/mac|iphone|ipad|ipod/i),Oc=()=>Ic()&&Cc(/apple/i);function Dc(t){const{ref:e,elements:n,enabled:r}=t,o=()=>{var s,i;return(i=(s=e.current)==null?void 0:s.ownerDocument)!=null?i:document};on(o,"pointerdown",s=>{if(!Oc()||!r)return;const i=s.target,l=(n??[e]).some(c=>{const u=kc(c)?c.current:c;return(u==null?void 0:u.contains(i))||u===i});o().activeElement!==i&&l&&(s.preventDefault(),i.focus())})}var Xa={exports:{}},jc="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Pc=jc,Ac=Pc;function Qa(){}function ei(){}ei.resetWarningCache=Qa;var Nc=function(){function t(r,o,s,i,a,l){if(l!==Ac){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:ei,resetWarningCache:Qa};return n.PropTypes=n,n};Xa.exports=Nc();var Fc=Xa.exports;const Mt=Fa(Fc);function Rc(t){const e=t.ownerDocument.defaultView||window,{overflow:n,overflowX:r,overflowY:o}=e.getComputedStyle(t);return/auto|scroll|overlay|hidden/.test(n+o+r)}function Tc(t){return t.localName==="html"?t:t.assignedSlot||t.parentElement||t.ownerDocument.documentElement}function ti(t){return["html","body","#document"].includes(t.localName)?t.ownerDocument.body:Ml(t)&&Rc(t)?t:ti(Tc(t))}var Mc=Jl?P.useLayoutEffect:P.useEffect;function Do(t,e=[]){const n=P.useRef(t);return Mc(()=>{n.current=t}),P.useCallback((...r)=>{var o;return(o=n.current)==null?void 0:o.call(n,...r)},e)}function Bc(t){const{ref:e,handler:n,enabled:r=!0}=t,o=Do(n),i=P.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;P.useEffect(()=>{if(!r)return;const a=d=>{co(d,e)&&(i.isPointerDown=!0)},l=d=>{if(i.ignoreEmulatedMouseEvents){i.ignoreEmulatedMouseEvents=!1;return}i.isPointerDown&&n&&co(d,e)&&(i.isPointerDown=!1,o(d))},c=d=>{i.ignoreEmulatedMouseEvents=!0,n&&i.isPointerDown&&co(d,e)&&(i.isPointerDown=!1,o(d))},u=Wa(e.current);return u.addEventListener("mousedown",a,!0),u.addEventListener("mouseup",l,!0),u.addEventListener("touchstart",a,!0),u.addEventListener("touchend",c,!0),()=>{u.removeEventListener("mousedown",a,!0),u.removeEventListener("mouseup",l,!0),u.removeEventListener("touchstart",a,!0),u.removeEventListener("touchend",c,!0)}},[n,e,o,i,r])}function co(t,e){var n;const r=t.target;return r&&!Wa(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function zc(t,e){const n=P.useId();return P.useMemo(()=>t||[e,n].filter(Boolean).join("-"),[t,e,n])}function Lc(t,e){const n=t!==void 0;return[n,n&&typeof t<"u"?t:e]}function Wc(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=Do(n),i=Do(e),[a,l]=P.useState(t.defaultIsOpen||!1),[c,u]=Lc(r,a),d=zc(o,"disclosure"),p=P.useCallback(()=>{c||l(!1),i==null||i()},[c,i]),h=P.useCallback(()=>{c||l(!0),s==null||s()},[c,s]),v=P.useCallback(()=>{(u?p:h)()},[u,h,p]);return{isOpen:!!u,onOpen:h,onClose:p,onToggle:v,isControlled:c,getButtonProps:(f={})=>({...f,"aria-expanded":u,"aria-controls":d,onClick:Bl(f.onClick,v)}),getDisclosureProps:(f={})=>({...f,hidden:!u,id:d})}}var gn=fe(function(e,n){const{htmlSize:r,...o}=e,s=Rt("Input",o),i=Ye(o),a=_c(i),l=_e("chakra-input",e.className);return k.jsx(de.input,{size:r,...a,__css:s.field,ref:n,className:l})});gn.displayName="Input";gn.id="Input";function Uc(t,e){return Array.isArray(t)?t.map(n=>n===null?null:e(n)):zl(t)?Object.keys(t).reduce((n,r)=>(n[r]=e(t[r]),n),{}):t!=null?e(t):null}var wt=fe(function(e,n){const r=Hn("Text",e),{className:o,align:s,decoration:i,casing:a,...l}=Ye(e),c=Yl({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return k.jsx(de.p,{ref:n,className:_e("chakra-text",e.className),...c,...l,__css:r})});wt.displayName="Text";var jo=t=>k.jsx(de.div,{className:"chakra-stack__divider",...t,__css:{...t.__css,borderWidth:0,alignSelf:"stretch",borderColor:"inherit",width:"auto",height:"auto"}});jo.displayName="StackDivider";var ni=t=>k.jsx(de.div,{className:"chakra-stack__item",...t,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...t.__css}});ni.displayName="StackItem";function Kc(t){const{spacing:e,direction:n}=t,r={column:{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":Uc(n,o=>r[o])}}var Ke=fe((t,e)=>{const{isInline:n,direction:r,align:o,justify:s,spacing:i="0.5rem",wrap:a,children:l,divider:c,className:u,shouldWrapChildren:d,...p}=t,h=n?"row":r??"column",v=P.useMemo(()=>Kc({spacing:i,direction:h}),[i,h]),f=!!c,m=!d&&!f,y=P.useMemo(()=>{const _=ks(l);return m?_:_.map((x,C)=>{const D=typeof x.key<"u"?x.key:C,E=C+1===_.length,I=d?k.jsx(ni,{children:x},D):x;if(!f)return I;const R=P.cloneElement(c,{__css:v}),K=E?null:R;return k.jsxs(P.Fragment,{children:[I,K]},D)})},[c,v,f,m,d,l]),g=_e("chakra-stack",u);return k.jsx(de.div,{ref:e,display:"flex",alignItems:o,justifyContent:s,flexDirection:h,flexWrap:a,gap:f?void 0:i,className:g,...p,children:y})});Ke.displayName="Stack";var ot=fe((t,e)=>k.jsx(Ke,{align:"center",...t,direction:"row",ref:e}));ot.displayName="HStack";var sn=fe(function(e,n){const r=Hn("Heading",e),{className:o,...s}=Ye(e);return k.jsx(de.h2,{ref:n,className:_e("chakra-heading",e.className),...s,__css:r})});sn.displayName="Heading";var jt=de("div");jt.displayName="Box";var ri=fe(function(e,n){const{size:r,centerContent:o=!0,...s}=e,i=o?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return k.jsx(jt,{ref:n,boxSize:r,__css:{...i,flexShrink:0,flexGrow:0},...s})});ri.displayName="Square";var $c=fe(function(e,n){const{size:r,...o}=e;return k.jsx(ri,{size:r,ref:n,borderRadius:"9999px",...o})});$c.displayName="Circle";var oi=fe(function(e,n){const r=Hn("Badge",e),{className:o,...s}=Ye(e);return k.jsx(de.span,{ref:n,className:_e("chakra-badge",e.className),...s,__css:{display:"inline-block",whiteSpace:"nowrap",verticalAlign:"middle",...r}})});oi.displayName="Badge";var Wt=fe(function(e,n){const{direction:r,align:o,justify:s,wrap:i,basis:a,grow:l,shrink:c,...u}=e,d={display:"flex",flexDirection:r,alignItems:o,justifyContent:s,flexWrap:i,flexBasis:a,flexGrow:l,flexShrink:c};return k.jsx(de.div,{ref:n,__css:d,...u})});Wt.displayName="Flex";function Vc(t){const{key:e}=t;return e.length===1||e.length>1&&/[^a-zA-Z0-9]/.test(e)}function Hc(t={}){const{timeout:e=300,preventDefault:n=()=>!0}=t,[r,o]=P.useState([]),s=P.useRef(),i=()=>{s.current&&(clearTimeout(s.current),s.current=null)},a=()=>{i(),s.current=setTimeout(()=>{o([]),s.current=null},e)};P.useEffect(()=>i,[]);function l(c){return u=>{if(u.key==="Backspace"){const d=[...r];d.pop(),o(d);return}if(Vc(u)){const d=r.concat(u.key);n(u)&&(u.preventDefault(),u.stopPropagation()),o(d),c(d.join("")),a()}}}return l}function qc(t,e,n,r){if(e==null)return r;if(!r)return t.find(i=>n(i).toLowerCase().startsWith(e.toLowerCase()));const o=t.filter(s=>n(s).toLowerCase().startsWith(e.toLowerCase()));if(o.length>0){let s;return o.includes(r)?(s=o.indexOf(r)+1,s===o.length&&(s=0),o[s]):(s=t.indexOf(o[0]),t[s])}return r}function Gc(){const t=P.useRef(new Map),e=t.current,n=P.useCallback((o,s,i,a)=>{t.current.set(i,{type:s,el:o,options:a}),o.addEventListener(s,i,a)},[]),r=P.useCallback((o,s,i,a)=>{o.removeEventListener(s,i,a),t.current.delete(i)},[]);return P.useEffect(()=>()=>{e.forEach((o,s)=>{r(o.el,o.type,s,o.options)})},[r,e]),{add:n,remove:r}}function uo(t){const e=t.target,{tagName:n,isContentEditable:r}=e;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function si(t={}){const{ref:e,isDisabled:n,isFocusable:r,clickOnEnter:o=!0,clickOnSpace:s=!0,onMouseDown:i,onMouseUp:a,onClick:l,onKeyDown:c,onKeyUp:u,tabIndex:d,onMouseOver:p,onMouseLeave:h,...v}=t,[f,m]=P.useState(!0),[y,g]=P.useState(!1),_=Gc(),x=A=>{A&&A.tagName!=="BUTTON"&&m(!1)},C=f?d:d||0,D=n&&!r,E=P.useCallback(A=>{if(n){A.stopPropagation(),A.preventDefault();return}A.currentTarget.focus(),l==null||l(A)},[n,l]),F=P.useCallback(A=>{y&&uo(A)&&(A.preventDefault(),A.stopPropagation(),g(!1),_.remove(document,"keyup",F,!1))},[y,_]),I=P.useCallback(A=>{if(c==null||c(A),n||A.defaultPrevented||A.metaKey||!uo(A.nativeEvent)||f)return;const X=o&&A.key==="Enter";s&&A.key===" "&&(A.preventDefault(),g(!0)),X&&(A.preventDefault(),A.currentTarget.click()),_.add(document,"keyup",F,!1)},[n,f,c,o,s,_,F]),R=P.useCallback(A=>{if(u==null||u(A),n||A.defaultPrevented||A.metaKey||!uo(A.nativeEvent)||f)return;s&&A.key===" "&&(A.preventDefault(),g(!1),A.currentTarget.click())},[s,f,n,u]),K=P.useCallback(A=>{A.button===0&&(g(!1),_.remove(document,"mouseup",K,!1))},[_]),j=P.useCallback(A=>{if(A.button!==0)return;if(n){A.stopPropagation(),A.preventDefault();return}f||g(!0),A.currentTarget.focus({preventScroll:!0}),_.add(document,"mouseup",K,!1),i==null||i(A)},[n,f,i,_,K]),M=P.useCallback(A=>{A.button===0&&(f||g(!1),a==null||a(A))},[a,f]),b=P.useCallback(A=>{if(n){A.preventDefault();return}p==null||p(A)},[n,p]),N=P.useCallback(A=>{y&&(A.preventDefault(),g(!1)),h==null||h(A)},[y,h]),H=Me(e,x);return f?{...v,ref:H,type:"button","aria-disabled":D?void 0:n,disabled:D,onClick:E,onMouseDown:i,onMouseUp:a,onKeyUp:u,onKeyDown:c,onMouseOver:p,onMouseLeave:h}:{...v,ref:H,role:"button","data-active":it(y),"aria-disabled":n?"true":void 0,tabIndex:D?void 0:C,onClick:E,onMouseDown:j,onMouseUp:M,onKeyUp:R,onKeyDown:I,onMouseOver:b,onMouseLeave:N}}function Zc(t){const e=t.current;if(!e)return!1;const n=Wl(e);return!n||e.contains(n)?!1:!!Ul(n)}function ai(t,e){const{shouldFocus:n,visible:r,focusRef:o}=e,s=n&&!r;qr(()=>{if(!s||Zc(t))return;const i=(o==null?void 0:o.current)||t.current;let a;if(i)return a=requestAnimationFrame(()=>{i.focus({preventScroll:!0})}),()=>{cancelAnimationFrame(a)}},[s,t,o])}var Jc={preventScroll:!0,shouldFocus:!1};function Yc(t,e=Jc){const{focusRef:n,preventScroll:r,shouldFocus:o,visible:s}=e,i=Xc(t)?t.current:t,a=o&&s,l=P.useRef(a),c=P.useRef(s);Na(()=>{!c.current&&s&&(l.current=a),c.current=s},[s,a]);const u=P.useCallback(()=>{if(!(!s||!i||!l.current)&&(l.current=!1,!i.contains(document.activeElement)))if(n!=null&&n.current)requestAnimationFrame(()=>{var d;(d=n.current)==null||d.focus({preventScroll:r})});else{const d=Ll(i);d.length>0&&requestAnimationFrame(()=>{d[0].focus({preventScroll:r})})}},[s,r,i,n]);qr(()=>{u()},[u]),on(i,"transitionend",u)}function Xc(t){return"current"in t}var Qt=(t,e)=>({var:t,varRef:e?`var(${t}, ${e})`:`var(${t})`}),Ae={arrowShadowColor:Qt("--popper-arrow-shadow-color"),arrowSize:Qt("--popper-arrow-size","8px"),arrowSizeHalf:Qt("--popper-arrow-size-half"),arrowBg:Qt("--popper-arrow-bg"),transformOrigin:Qt("--popper-transform-origin"),arrowOffset:Qt("--popper-arrow-offset")};function Qc(t){if(t.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}var eu={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},tu=t=>eu[t],na={scroll:!0,resize:!0};function nu(t){let e;return typeof t=="object"?e={enabled:!0,options:{...na,...t}}:e={enabled:t,options:na},e}var ru={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`},effect:({state:t})=>()=>{const e=t.elements.reference;t.elements.popper.style.width=`${e.offsetWidth}px`}},ou={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:t})=>{ra(t)},effect:({state:t})=>()=>{ra(t)}},ra=t=>{t.elements.popper.style.setProperty(Ae.transformOrigin.var,tu(t.placement))},su={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:t})=>{au(t)}},au=t=>{var e;if(!t.placement)return;const n=iu(t.placement);if((e=t.elements)!=null&&e.arrow&&n){Object.assign(t.elements.arrow.style,{[n.property]:n.value,width:Ae.arrowSize.varRef,height:Ae.arrowSize.varRef,zIndex:-1});const r={[Ae.arrowSizeHalf.var]:`calc(${Ae.arrowSize.varRef} / 2 - 1px)`,[Ae.arrowOffset.var]:`calc(${Ae.arrowSizeHalf.varRef} * -1)`};for(const o in r)t.elements.arrow.style.setProperty(o,r[o])}},iu=t=>{if(t.startsWith("top"))return{property:"bottom",value:Ae.arrowOffset.varRef};if(t.startsWith("bottom"))return{property:"top",value:Ae.arrowOffset.varRef};if(t.startsWith("left"))return{property:"right",value:Ae.arrowOffset.varRef};if(t.startsWith("right"))return{property:"left",value:Ae.arrowOffset.varRef}},lu={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:t})=>{oa(t)},effect:({state:t})=>()=>{oa(t)}},oa=t=>{if(!t.elements.arrow)return;const e=t.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!e)return;const n=Qc(t.placement);n&&e.style.setProperty("--popper-arrow-default-shadow",n),Object.assign(e.style,{transform:"rotate(45deg)",background:Ae.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},cu={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},uu={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function du(t,e="ltr"){var n,r;const o=((n=cu[t])==null?void 0:n[e])||t;return e==="ltr"?o:(r=uu[t])!=null?r:o}var $e="top",tt="bottom",nt="right",Ve="left",Es="auto",qn=[$e,tt,nt,Ve],dn="start",Mn="end",fu="clippingParents",ii="viewport",Cn="popper",hu="reference",sa=qn.reduce(function(t,e){return t.concat([e+"-"+dn,e+"-"+Mn])},[]),li=[].concat(qn,[Es]).reduce(function(t,e){return t.concat([e,e+"-"+dn,e+"-"+Mn])},[]),pu="beforeRead",mu="read",yu="afterRead",vu="beforeMain",gu="main",wu="afterMain",bu="beforeWrite",_u="write",xu="afterWrite",ku=[pu,mu,yu,vu,gu,wu,bu,_u,xu];function dt(t){return t?(t.nodeName||"").toLowerCase():null}function Ze(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function qt(t){var e=Ze(t).Element;return t instanceof e||t instanceof Element}function et(t){var e=Ze(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Cs(t){if(typeof ShadowRoot>"u")return!1;var e=Ze(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Eu(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},o=e.attributes[n]||{},s=e.elements[n];!et(s)||!dt(s)||(Object.assign(s.style,r),Object.keys(o).forEach(function(i){var a=o[i];a===!1?s.removeAttribute(i):s.setAttribute(i,a===!0?"":a)}))})}function Cu(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var o=e.elements[r],s=e.attributes[r]||{},i=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),a=i.reduce(function(l,c){return l[c]="",l},{});!et(o)||!dt(o)||(Object.assign(o.style,a),Object.keys(s).forEach(function(l){o.removeAttribute(l)}))})}}const Su={name:"applyStyles",enabled:!0,phase:"write",fn:Eu,effect:Cu,requires:["computeStyles"]};function ut(t){return t.split("-")[0]}var Ut=Math.max,Or=Math.min,fn=Math.round;function Po(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function ci(){return!/^((?!chrome|android).)*safari/i.test(Po())}function hn(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),o=1,s=1;e&&et(t)&&(o=t.offsetWidth>0&&fn(r.width)/t.offsetWidth||1,s=t.offsetHeight>0&&fn(r.height)/t.offsetHeight||1);var i=qt(t)?Ze(t):window,a=i.visualViewport,l=!ci()&&n,c=(r.left+(l&&a?a.offsetLeft:0))/o,u=(r.top+(l&&a?a.offsetTop:0))/s,d=r.width/o,p=r.height/s;return{width:d,height:p,top:u,right:c+d,bottom:u+p,left:c,x:c,y:u}}function Ss(t){var e=hn(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function ui(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Cs(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function kt(t){return Ze(t).getComputedStyle(t)}function Iu(t){return["table","td","th"].indexOf(dt(t))>=0}function Tt(t){return((qt(t)?t.ownerDocument:t.document)||window.document).documentElement}function eo(t){return dt(t)==="html"?t:t.assignedSlot||t.parentNode||(Cs(t)?t.host:null)||Tt(t)}function aa(t){return!et(t)||kt(t).position==="fixed"?null:t.offsetParent}function Ou(t){var e=/firefox/i.test(Po()),n=/Trident/i.test(Po());if(n&&et(t)){var r=kt(t);if(r.position==="fixed")return null}var o=eo(t);for(Cs(o)&&(o=o.host);et(o)&&["html","body"].indexOf(dt(o))<0;){var s=kt(o);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return o;o=o.parentNode}return null}function Gn(t){for(var e=Ze(t),n=aa(t);n&&Iu(n)&&kt(n).position==="static";)n=aa(n);return n&&(dt(n)==="html"||dt(n)==="body"&&kt(n).position==="static")?e:n||Ou(t)||e}function Is(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function jn(t,e,n){return Ut(t,Or(e,n))}function Du(t,e,n){var r=jn(t,e,n);return r>n?n:r}function di(){return{top:0,right:0,bottom:0,left:0}}function fi(t){return Object.assign({},di(),t)}function hi(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var ju=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,fi(typeof e!="number"?e:hi(e,qn))};function Pu(t){var e,n=t.state,r=t.name,o=t.options,s=n.elements.arrow,i=n.modifiersData.popperOffsets,a=ut(n.placement),l=Is(a),c=[Ve,nt].indexOf(a)>=0,u=c?"height":"width";if(!(!s||!i)){var d=ju(o.padding,n),p=Ss(s),h=l==="y"?$e:Ve,v=l==="y"?tt:nt,f=n.rects.reference[u]+n.rects.reference[l]-i[l]-n.rects.popper[u],m=i[l]-n.rects.reference[l],y=Gn(s),g=y?l==="y"?y.clientHeight||0:y.clientWidth||0:0,_=f/2-m/2,x=d[h],C=g-p[u]-d[v],D=g/2-p[u]/2+_,E=jn(x,D,C),F=l;n.modifiersData[r]=(e={},e[F]=E,e.centerOffset=E-D,e)}}function Au(t){var e=t.state,n=t.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||ui(e.elements.popper,o)&&(e.elements.arrow=o))}const Nu={name:"arrow",enabled:!0,phase:"main",fn:Pu,effect:Au,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function pn(t){return t.split("-")[1]}var Fu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ru(t,e){var n=t.x,r=t.y,o=e.devicePixelRatio||1;return{x:fn(n*o)/o||0,y:fn(r*o)/o||0}}function ia(t){var e,n=t.popper,r=t.popperRect,o=t.placement,s=t.variation,i=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,p=i.x,h=p===void 0?0:p,v=i.y,f=v===void 0?0:v,m=typeof u=="function"?u({x:h,y:f}):{x:h,y:f};h=m.x,f=m.y;var y=i.hasOwnProperty("x"),g=i.hasOwnProperty("y"),_=Ve,x=$e,C=window;if(c){var D=Gn(n),E="clientHeight",F="clientWidth";if(D===Ze(n)&&(D=Tt(n),kt(D).position!=="static"&&a==="absolute"&&(E="scrollHeight",F="scrollWidth")),D=D,o===$e||(o===Ve||o===nt)&&s===Mn){x=tt;var I=d&&D===C&&C.visualViewport?C.visualViewport.height:D[E];f-=I-r.height,f*=l?1:-1}if(o===Ve||(o===$e||o===tt)&&s===Mn){_=nt;var R=d&&D===C&&C.visualViewport?C.visualViewport.width:D[F];h-=R-r.width,h*=l?1:-1}}var K=Object.assign({position:a},c&&Fu),j=u===!0?Ru({x:h,y:f},Ze(n)):{x:h,y:f};if(h=j.x,f=j.y,l){var M;return Object.assign({},K,(M={},M[x]=g?"0":"",M[_]=y?"0":"",M.transform=(C.devicePixelRatio||1)<=1?"translate("+h+"px, "+f+"px)":"translate3d("+h+"px, "+f+"px, 0)",M))}return Object.assign({},K,(e={},e[x]=g?f+"px":"",e[_]=y?h+"px":"",e.transform="",e))}function Tu(t){var e=t.state,n=t.options,r=n.gpuAcceleration,o=r===void 0?!0:r,s=n.adaptive,i=s===void 0?!0:s,a=n.roundOffsets,l=a===void 0?!0:a,c={placement:ut(e.placement),variation:pn(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,ia(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:i,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,ia(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Mu={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Tu,data:{}};var nr={passive:!0};function Bu(t){var e=t.state,n=t.instance,r=t.options,o=r.scroll,s=o===void 0?!0:o,i=r.resize,a=i===void 0?!0:i,l=Ze(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",n.update,nr)}),a&&l.addEventListener("resize",n.update,nr),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",n.update,nr)}),a&&l.removeEventListener("resize",n.update,nr)}}const zu={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Bu,data:{}};var Lu={left:"right",right:"left",bottom:"top",top:"bottom"};function hr(t){return t.replace(/left|right|bottom|top/g,function(e){return Lu[e]})}var Wu={start:"end",end:"start"};function la(t){return t.replace(/start|end/g,function(e){return Wu[e]})}function Os(t){var e=Ze(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Ds(t){return hn(Tt(t)).left+Os(t).scrollLeft}function Uu(t,e){var n=Ze(t),r=Tt(t),o=n.visualViewport,s=r.clientWidth,i=r.clientHeight,a=0,l=0;if(o){s=o.width,i=o.height;var c=ci();(c||!c&&e==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}return{width:s,height:i,x:a+Ds(t),y:l}}function Ku(t){var e,n=Tt(t),r=Os(t),o=(e=t.ownerDocument)==null?void 0:e.body,s=Ut(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),i=Ut(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),a=-r.scrollLeft+Ds(t),l=-r.scrollTop;return kt(o||n).direction==="rtl"&&(a+=Ut(n.clientWidth,o?o.clientWidth:0)-s),{width:s,height:i,x:a,y:l}}function js(t){var e=kt(t),n=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function pi(t){return["html","body","#document"].indexOf(dt(t))>=0?t.ownerDocument.body:et(t)&&js(t)?t:pi(eo(t))}function Pn(t,e){var n;e===void 0&&(e=[]);var r=pi(t),o=r===((n=t.ownerDocument)==null?void 0:n.body),s=Ze(r),i=o?[s].concat(s.visualViewport||[],js(r)?r:[]):r,a=e.concat(i);return o?a:a.concat(Pn(eo(i)))}function Ao(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function $u(t,e){var n=hn(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function ca(t,e,n){return e===ii?Ao(Uu(t,n)):qt(e)?$u(e,n):Ao(Ku(Tt(t)))}function Vu(t){var e=Pn(eo(t)),n=["absolute","fixed"].indexOf(kt(t).position)>=0,r=n&&et(t)?Gn(t):t;return qt(r)?e.filter(function(o){return qt(o)&&ui(o,r)&&dt(o)!=="body"}):[]}function Hu(t,e,n,r){var o=e==="clippingParents"?Vu(t):[].concat(e),s=[].concat(o,[n]),i=s[0],a=s.reduce(function(l,c){var u=ca(t,c,r);return l.top=Ut(u.top,l.top),l.right=Or(u.right,l.right),l.bottom=Or(u.bottom,l.bottom),l.left=Ut(u.left,l.left),l},ca(t,i,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function mi(t){var e=t.reference,n=t.element,r=t.placement,o=r?ut(r):null,s=r?pn(r):null,i=e.x+e.width/2-n.width/2,a=e.y+e.height/2-n.height/2,l;switch(o){case $e:l={x:i,y:e.y-n.height};break;case tt:l={x:i,y:e.y+e.height};break;case nt:l={x:e.x+e.width,y:a};break;case Ve:l={x:e.x-n.width,y:a};break;default:l={x:e.x,y:e.y}}var c=o?Is(o):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case dn:l[c]=l[c]-(e[u]/2-n[u]/2);break;case Mn:l[c]=l[c]+(e[u]/2-n[u]/2);break}}return l}function Bn(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=r===void 0?t.placement:r,s=n.strategy,i=s===void 0?t.strategy:s,a=n.boundary,l=a===void 0?fu:a,c=n.rootBoundary,u=c===void 0?ii:c,d=n.elementContext,p=d===void 0?Cn:d,h=n.altBoundary,v=h===void 0?!1:h,f=n.padding,m=f===void 0?0:f,y=fi(typeof m!="number"?m:hi(m,qn)),g=p===Cn?hu:Cn,_=t.rects.popper,x=t.elements[v?g:p],C=Hu(qt(x)?x:x.contextElement||Tt(t.elements.popper),l,u,i),D=hn(t.elements.reference),E=mi({reference:D,element:_,strategy:"absolute",placement:o}),F=Ao(Object.assign({},_,E)),I=p===Cn?F:D,R={top:C.top-I.top+y.top,bottom:I.bottom-C.bottom+y.bottom,left:C.left-I.left+y.left,right:I.right-C.right+y.right},K=t.modifiersData.offset;if(p===Cn&&K){var j=K[o];Object.keys(R).forEach(function(M){var b=[nt,tt].indexOf(M)>=0?1:-1,N=[$e,tt].indexOf(M)>=0?"y":"x";R[M]+=j[N]*b})}return R}function qu(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=n.boundary,s=n.rootBoundary,i=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?li:l,u=pn(r),d=u?a?sa:sa.filter(function(v){return pn(v)===u}):qn,p=d.filter(function(v){return c.indexOf(v)>=0});p.length===0&&(p=d);var h=p.reduce(function(v,f){return v[f]=Bn(t,{placement:f,boundary:o,rootBoundary:s,padding:i})[ut(f)],v},{});return Object.keys(h).sort(function(v,f){return h[v]-h[f]})}function Gu(t){if(ut(t)===Es)return[];var e=hr(t);return[la(t),e,la(e)]}function Zu(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var o=n.mainAxis,s=o===void 0?!0:o,i=n.altAxis,a=i===void 0?!0:i,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,v=h===void 0?!0:h,f=n.allowedAutoPlacements,m=e.options.placement,y=ut(m),g=y===m,_=l||(g||!v?[hr(m)]:Gu(m)),x=[m].concat(_).reduce(function(Y,Z){return Y.concat(ut(Z)===Es?qu(e,{placement:Z,boundary:u,rootBoundary:d,padding:c,flipVariations:v,allowedAutoPlacements:f}):Z)},[]),C=e.rects.reference,D=e.rects.popper,E=new Map,F=!0,I=x[0],R=0;R<x.length;R++){var K=x[R],j=ut(K),M=pn(K)===dn,b=[$e,tt].indexOf(j)>=0,N=b?"width":"height",H=Bn(e,{placement:K,boundary:u,rootBoundary:d,altBoundary:p,padding:c}),A=b?M?nt:Ve:M?tt:$e;C[N]>D[N]&&(A=hr(A));var X=hr(A),V=[];if(s&&V.push(H[j]<=0),a&&V.push(H[A]<=0,H[X]<=0),V.every(function(Y){return Y})){I=K,F=!1;break}E.set(K,V)}if(F)for(var te=v?3:1,z=function(Z){var he=x.find(function(ye){var le=E.get(ye);if(le)return le.slice(0,Z).every(function(ue){return ue})});if(he)return I=he,"break"},B=te;B>0;B--){var ne=z(B);if(ne==="break")break}e.placement!==I&&(e.modifiersData[r]._skip=!0,e.placement=I,e.reset=!0)}}const Ju={name:"flip",enabled:!0,phase:"main",fn:Zu,requiresIfExists:["offset"],data:{_skip:!1}};function ua(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function da(t){return[$e,nt,tt,Ve].some(function(e){return t[e]>=0})}function Yu(t){var e=t.state,n=t.name,r=e.rects.reference,o=e.rects.popper,s=e.modifiersData.preventOverflow,i=Bn(e,{elementContext:"reference"}),a=Bn(e,{altBoundary:!0}),l=ua(i,r),c=ua(a,o,s),u=da(l),d=da(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const Xu={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Yu};function Qu(t,e,n){var r=ut(t),o=[Ve,$e].indexOf(r)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,i=s[0],a=s[1];return i=i||0,a=(a||0)*o,[Ve,nt].indexOf(r)>=0?{x:a,y:i}:{x:i,y:a}}function ed(t){var e=t.state,n=t.options,r=t.name,o=n.offset,s=o===void 0?[0,0]:o,i=li.reduce(function(u,d){return u[d]=Qu(d,e.rects,s),u},{}),a=i[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=i}const td={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ed};function nd(t){var e=t.state,n=t.name;e.modifiersData[n]=mi({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const rd={name:"popperOffsets",enabled:!0,phase:"read",fn:nd,data:{}};function od(t){return t==="x"?"y":"x"}function sd(t){var e=t.state,n=t.options,r=t.name,o=n.mainAxis,s=o===void 0?!0:o,i=n.altAxis,a=i===void 0?!1:i,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,p=n.tether,h=p===void 0?!0:p,v=n.tetherOffset,f=v===void 0?0:v,m=Bn(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),y=ut(e.placement),g=pn(e.placement),_=!g,x=Is(y),C=od(x),D=e.modifiersData.popperOffsets,E=e.rects.reference,F=e.rects.popper,I=typeof f=="function"?f(Object.assign({},e.rects,{placement:e.placement})):f,R=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),K=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,j={x:0,y:0};if(D){if(s){var M,b=x==="y"?$e:Ve,N=x==="y"?tt:nt,H=x==="y"?"height":"width",A=D[x],X=A+m[b],V=A-m[N],te=h?-F[H]/2:0,z=g===dn?E[H]:F[H],B=g===dn?-F[H]:-E[H],ne=e.elements.arrow,Y=h&&ne?Ss(ne):{width:0,height:0},Z=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:di(),he=Z[b],ye=Z[N],le=jn(0,E[H],Y[H]),ue=_?E[H]/2-te-le-he-R.mainAxis:z-le-he-R.mainAxis,ke=_?-E[H]/2+te+le+ye+R.mainAxis:B+le+ye+R.mainAxis,ve=e.elements.arrow&&Gn(e.elements.arrow),me=ve?x==="y"?ve.clientTop||0:ve.clientLeft||0:0,Ee=(M=K==null?void 0:K[x])!=null?M:0,w=A+ue-Ee-me,U=A+ke-Ee,W=jn(h?Or(X,w):X,A,h?Ut(V,U):V);D[x]=W,j[x]=W-A}if(a){var O,S=x==="x"?$e:Ve,T=x==="x"?tt:nt,q=D[C],J=C==="y"?"height":"width",L=q+m[S],Q=q-m[T],re=[$e,Ve].indexOf(y)!==-1,ee=(O=K==null?void 0:K[C])!=null?O:0,se=re?L:q-E[J]-F[J]-ee+R.altAxis,ge=re?q+E[J]+F[J]-ee-R.altAxis:Q,pe=h&&re?Du(se,q,ge):jn(h?se:L,q,h?ge:Q);D[C]=pe,j[C]=pe-q}e.modifiersData[r]=j}}const ad={name:"preventOverflow",enabled:!0,phase:"main",fn:sd,requiresIfExists:["offset"]};function id(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function ld(t){return t===Ze(t)||!et(t)?Os(t):id(t)}function cd(t){var e=t.getBoundingClientRect(),n=fn(e.width)/t.offsetWidth||1,r=fn(e.height)/t.offsetHeight||1;return n!==1||r!==1}function ud(t,e,n){n===void 0&&(n=!1);var r=et(e),o=et(e)&&cd(e),s=Tt(e),i=hn(t,o,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((dt(e)!=="body"||js(s))&&(a=ld(e)),et(e)?(l=hn(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Ds(s))),{x:i.left+a.scrollLeft-l.x,y:i.top+a.scrollTop-l.y,width:i.width,height:i.height}}function dd(t){var e=new Map,n=new Set,r=[];t.forEach(function(s){e.set(s.name,s)});function o(s){n.add(s.name);var i=[].concat(s.requires||[],s.requiresIfExists||[]);i.forEach(function(a){if(!n.has(a)){var l=e.get(a);l&&o(l)}}),r.push(s)}return t.forEach(function(s){n.has(s.name)||o(s)}),r}function fd(t){var e=dd(t);return ku.reduce(function(n,r){return n.concat(e.filter(function(o){return o.phase===r}))},[])}function hd(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function pd(t){var e=t.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var fa={placement:"bottom",modifiers:[],strategy:"absolute"};function ha(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function md(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,o=e.defaultOptions,s=o===void 0?fa:o;return function(a,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},fa,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],p=!1,h={state:u,setOptions:function(y){var g=typeof y=="function"?y(u.options):y;f(),u.options=Object.assign({},s,u.options,g),u.scrollParents={reference:qt(a)?Pn(a):a.contextElement?Pn(a.contextElement):[],popper:Pn(l)};var _=fd(pd([].concat(r,u.options.modifiers)));return u.orderedModifiers=_.filter(function(x){return x.enabled}),v(),h.update()},forceUpdate:function(){if(!p){var y=u.elements,g=y.reference,_=y.popper;if(ha(g,_)){u.rects={reference:ud(g,Gn(_),u.options.strategy==="fixed"),popper:Ss(_)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(R){return u.modifiersData[R.name]=Object.assign({},R.data)});for(var x=0;x<u.orderedModifiers.length;x++){if(u.reset===!0){u.reset=!1,x=-1;continue}var C=u.orderedModifiers[x],D=C.fn,E=C.options,F=E===void 0?{}:E,I=C.name;typeof D=="function"&&(u=D({state:u,options:F,name:I,instance:h})||u)}}}},update:hd(function(){return new Promise(function(m){h.forceUpdate(),m(u)})}),destroy:function(){f(),p=!0}};if(!ha(a,l))return h;h.setOptions(c).then(function(m){!p&&c.onFirstUpdate&&c.onFirstUpdate(m)});function v(){u.orderedModifiers.forEach(function(m){var y=m.name,g=m.options,_=g===void 0?{}:g,x=m.effect;if(typeof x=="function"){var C=x({state:u,name:y,instance:h,options:_}),D=function(){};d.push(C||D)}})}function f(){d.forEach(function(m){return m()}),d=[]}return h}}var yd=[zu,rd,Mu,Su,td,Ju,ad,Nu,Xu],vd=md({defaultModifiers:yd});function Ps(t={}){const{enabled:e=!0,modifiers:n,placement:r="bottom",strategy:o="absolute",arrowPadding:s=8,eventListeners:i=!0,offset:a,gutter:l=8,flip:c=!0,boundary:u="clippingParents",preventOverflow:d=!0,matchWidth:p,direction:h="ltr"}=t,v=P.useRef(null),f=P.useRef(null),m=P.useRef(null),y=du(r,h),g=P.useRef(()=>{}),_=P.useCallback(()=>{var R;!e||!v.current||!f.current||((R=g.current)==null||R.call(g),m.current=vd(v.current,f.current,{placement:y,modifiers:[lu,su,ou,{...ru,enabled:!!p},{name:"eventListeners",...nu(i)},{name:"arrow",options:{padding:s}},{name:"offset",options:{offset:a??[0,l]}},{name:"flip",enabled:!!c,options:{padding:8}},{name:"preventOverflow",enabled:!!d,options:{boundary:u}},...n??[]],strategy:o}),m.current.forceUpdate(),g.current=m.current.destroy)},[y,e,n,p,i,s,a,l,c,d,u,o]);P.useEffect(()=>()=>{var R;!v.current&&!f.current&&((R=m.current)==null||R.destroy(),m.current=null)},[]);const x=P.useCallback(R=>{v.current=R,_()},[_]),C=P.useCallback((R={},K=null)=>({...R,ref:Me(x,K)}),[x]),D=P.useCallback(R=>{f.current=R,_()},[_]),E=P.useCallback((R={},K=null)=>({...R,ref:Me(D,K),style:{...R.style,position:o,minWidth:p?void 0:"max-content",inset:"0 auto auto 0"}}),[o,D,p]),F=P.useCallback((R={},K=null)=>{const{size:j,shadowColor:M,bg:b,style:N,...H}=R;return{...H,ref:K,"data-popper-arrow":"",style:gd(R)}},[]),I=P.useCallback((R={},K=null)=>({...R,ref:K,"data-popper-arrow-inner":""}),[]);return{update(){var R;(R=m.current)==null||R.update()},forceUpdate(){var R;(R=m.current)==null||R.forceUpdate()},transformOrigin:Ae.transformOrigin.varRef,referenceRef:x,popperRef:D,getPopperProps:E,getArrowProps:F,getArrowInnerProps:I,getReferenceProps:C}}function gd(t){const{size:e,shadowColor:n,bg:r,style:o}=t,s={...o,position:"absolute"};return e&&(s["--popper-arrow-size"]=e),n&&(s["--popper-arrow-shadow-color"]=n),r&&(s["--popper-arrow-bg"]=r),s}function As(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=Lt(n),i=Lt(e),[a,l]=P.useState(t.defaultIsOpen||!1),c=r!==void 0?r:a,u=r!==void 0,d=P.useId(),p=o??`disclosure-${d}`,h=P.useCallback(()=>{u||l(!1),i==null||i()},[u,i]),v=P.useCallback(()=>{u||l(!0),s==null||s()},[u,s]),f=P.useCallback(()=>{c?h():v()},[c,v,h]);function m(g={}){return{...g,"aria-expanded":c,"aria-controls":p,onClick(_){var x;(x=g.onClick)==null||x.call(g,_),f()}}}function y(g={}){return{...g,hidden:!c,id:p}}return{isOpen:c,onOpen:v,onClose:h,onToggle:f,isControlled:u,getButtonProps:m,getDisclosureProps:y}}function wd(t){const{ref:e,handler:n,enabled:r=!0}=t,o=Lt(n),i=P.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;P.useEffect(()=>{if(!r)return;const a=d=>{fo(d,e)&&(i.isPointerDown=!0)},l=d=>{if(i.ignoreEmulatedMouseEvents){i.ignoreEmulatedMouseEvents=!1;return}i.isPointerDown&&n&&fo(d,e)&&(i.isPointerDown=!1,o(d))},c=d=>{i.ignoreEmulatedMouseEvents=!0,n&&i.isPointerDown&&fo(d,e)&&(i.isPointerDown=!1,o(d))},u=yi(e.current);return u.addEventListener("mousedown",a,!0),u.addEventListener("mouseup",l,!0),u.addEventListener("touchstart",a,!0),u.addEventListener("touchend",c,!0),()=>{u.removeEventListener("mousedown",a,!0),u.removeEventListener("mouseup",l,!0),u.removeEventListener("touchstart",a,!0),u.removeEventListener("touchend",c,!0)}},[n,e,o,i,r])}function fo(t,e){var n;const r=t.target;return r&&!yi(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function yi(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function vi(t){const{isOpen:e,ref:n}=t,[r,o]=P.useState(e),[s,i]=P.useState(!1);return P.useEffect(()=>{s||(o(e),i(!0))},[e,s,r]),on(()=>n.current,"animationend",()=>{o(e)}),{present:!(e?!1:!r),onComplete(){var l;const c=Kl(n.current),u=new c.CustomEvent("animationend",{bubbles:!0});(l=n.current)==null||l.dispatchEvent(u)}}}function Ns(t){const{wasSelected:e,enabled:n,isSelected:r,mode:o="unmount"}=t;return!!(!n||r||o==="keepMounted"&&e)}var[bd,_d,xd,kd]=$a(),[Ed,Zn]=rt({strict:!1,name:"MenuContext"});function Cd(t,...e){const n=P.useId(),r=t||n;return P.useMemo(()=>e.map(o=>`${o}-${r}`),[r,e])}function gi(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function pa(t){return gi(t).activeElement===t}function Sd(t={}){const{id:e,closeOnSelect:n=!0,closeOnBlur:r=!0,initialFocusRef:o,autoSelect:s=!0,isLazy:i,isOpen:a,defaultIsOpen:l,onClose:c,onOpen:u,placement:d="bottom-start",lazyBehavior:p="unmount",direction:h,computePositionOnMount:v=!1,...f}=t,m=P.useRef(null),y=P.useRef(null),g=xd(),_=P.useCallback(()=>{requestAnimationFrame(()=>{var ne;(ne=m.current)==null||ne.focus({preventScroll:!1})})},[]),x=P.useCallback(()=>{const ne=setTimeout(()=>{var Y;if(o)(Y=o.current)==null||Y.focus();else{const Z=g.firstEnabled();Z&&M(Z.index)}});X.current.add(ne)},[g,o]),C=P.useCallback(()=>{const ne=setTimeout(()=>{const Y=g.lastEnabled();Y&&M(Y.index)});X.current.add(ne)},[g]),D=P.useCallback(()=>{u==null||u(),s?x():_()},[s,x,_,u]),{isOpen:E,onOpen:F,onClose:I,onToggle:R}=As({isOpen:a,defaultIsOpen:l,onClose:c,onOpen:D});wd({enabled:E&&r,ref:m,handler:ne=>{var Y;(Y=y.current)!=null&&Y.contains(ne.target)||I()}});const K=Ps({...f,enabled:E||v,placement:d,direction:h}),[j,M]=P.useState(-1);qr(()=>{E||M(-1)},[E]),ai(m,{focusRef:y,visible:E,shouldFocus:!0});const b=vi({isOpen:E,ref:m}),[N,H]=Cd(e,"menu-button","menu-list"),A=P.useCallback(()=>{F(),_()},[F,_]),X=P.useRef(new Set([]));P.useEffect(()=>{const ne=X.current;return()=>{ne.forEach(Y=>clearTimeout(Y)),ne.clear()}},[]);const V=P.useCallback(()=>{F(),x()},[x,F]),te=P.useCallback(()=>{F(),C()},[F,C]),z=P.useCallback(()=>{var ne,Y;const Z=gi(m.current),he=(ne=m.current)==null?void 0:ne.contains(Z.activeElement);if(!(E&&!he))return;const le=(Y=g.item(j))==null?void 0:Y.node;le==null||le.focus({preventScroll:!0})},[E,j,g]),B=P.useRef(null);return{openAndFocusMenu:A,openAndFocusFirstItem:V,openAndFocusLastItem:te,onTransitionEnd:z,unstable__animationState:b,descendants:g,popper:K,buttonId:N,menuId:H,forceUpdate:K.forceUpdate,orientation:"vertical",isOpen:E,onToggle:R,onOpen:F,onClose:I,menuRef:m,buttonRef:y,focusedIndex:j,closeOnSelect:n,closeOnBlur:r,autoSelect:s,setFocusedIndex:M,isLazy:i,lazyBehavior:p,initialFocusRef:o,rafId:B}}function Zp(t={},e=null){const n=Zn(),{onToggle:r,popper:o,openAndFocusFirstItem:s,openAndFocusLastItem:i}=n,a=P.useCallback(l=>{const c=l.key,d={Enter:s,ArrowDown:s,ArrowUp:i}[c];d&&(l.preventDefault(),l.stopPropagation(),d(l))},[s,i]);return{...t,ref:Me(n.buttonRef,e,o.referenceRef),id:n.buttonId,"data-active":it(n.isOpen),"aria-expanded":n.isOpen,"aria-haspopup":"menu","aria-controls":n.menuId,onClick:Oe(t.onClick,r),onKeyDown:Oe(t.onKeyDown,a)}}function No(t){var e;return Dd(t)&&!!((e=t==null?void 0:t.getAttribute("role"))!=null&&e.startsWith("menuitem"))}function Id(t={},e=null){const n=Zn();if(!n)throw new Error("useMenuContext: context is undefined. Seems you forgot to wrap component within <Menu>");const{focusedIndex:r,setFocusedIndex:o,menuRef:s,isOpen:i,onClose:a,menuId:l,isLazy:c,lazyBehavior:u,unstable__animationState:d}=n,p=_d(),h=Hc({preventDefault:y=>y.key!==" "&&No(y.target)}),v=P.useCallback(y=>{if(!y.currentTarget.contains(y.target))return;const g=y.key,x={Tab:D=>D.preventDefault(),Escape:a,ArrowDown:()=>{const D=p.nextEnabled(r);D&&o(D.index)},ArrowUp:()=>{const D=p.prevEnabled(r);D&&o(D.index)}}[g];if(x){y.preventDefault(),x(y);return}const C=h(D=>{const E=qc(p.values(),D,F=>{var I,R;return(R=(I=F==null?void 0:F.node)==null?void 0:I.textContent)!=null?R:""},p.item(r));if(E){const F=p.indexOf(E.node);o(F)}});No(y.target)&&C(y)},[p,r,h,a,o]),f=P.useRef(!1);i&&(f.current=!0);const m=Ns({wasSelected:f.current,enabled:c,mode:u,isSelected:d.present});return{...t,ref:Me(s,e),children:m?t.children:null,tabIndex:-1,role:"menu",id:l,style:{...t.style,transformOrigin:"var(--popper-transform-origin)"},"aria-orientation":"vertical",onKeyDown:Oe(t.onKeyDown,v)}}function Od(t={}){const{popper:e,isOpen:n}=Zn();return e.getPopperProps({...t,style:{visibility:n?"visible":"hidden",...t.style}})}function wi(t={},e=null){const{onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onClick:s,onFocus:i,isDisabled:a,isFocusable:l,closeOnSelect:c,type:u,...d}=t,p=Zn(),{setFocusedIndex:h,focusedIndex:v,closeOnSelect:f,onClose:m,menuRef:y,isOpen:g,menuId:_,rafId:x}=p,C=P.useRef(null),D=`${_}-menuitem-${P.useId()}`,{index:E,register:F}=kd({disabled:a&&!l}),I=P.useCallback(A=>{n==null||n(A),!a&&h(E)},[h,E,a,n]),R=P.useCallback(A=>{r==null||r(A),C.current&&!pa(C.current)&&I(A)},[I,r]),K=P.useCallback(A=>{o==null||o(A),!a&&h(-1)},[h,a,o]),j=P.useCallback(A=>{s==null||s(A),No(A.currentTarget)&&(c??f)&&m()},[m,s,f,c]),M=P.useCallback(A=>{i==null||i(A),h(E)},[h,i,E]),b=E===v,N=a&&!l;qr(()=>{if(g)return b&&!N&&C.current?(x.current&&cancelAnimationFrame(x.current),x.current=requestAnimationFrame(()=>{var A;(A=C.current)==null||A.focus({preventScroll:!0}),x.current=null})):y.current&&!pa(y.current)&&y.current.focus({preventScroll:!0}),()=>{x.current&&cancelAnimationFrame(x.current)}},[b,N,y,g]);const H=si({onClick:j,onFocus:M,onMouseEnter:I,onMouseMove:R,onMouseLeave:K,ref:Me(F,C,e),isDisabled:a,isFocusable:l});return{...d,...H,type:u??H.type,id:D,role:"menuitem",tabIndex:b?0:-1}}function Jp(t={},e=null){const{type:n="radio",isChecked:r,...o}=t;return{...wi(o,e),role:`menuitem${n}`,"aria-checked":r}}function Yp(t={}){const{children:e,type:n="radio",value:r,defaultValue:o,onChange:s,...i}=t,l=n==="radio"?"":[],[c,u]=Va({defaultValue:o??l,value:r,onChange:s}),d=P.useCallback(v=>{if(n==="radio"&&typeof c=="string"&&u(v),n==="checkbox"&&Array.isArray(c)){const f=c.includes(v)?c.filter(m=>m!==v):c.concat(v);u(f)}},[c,u,n]),h=ks(e).map(v=>{if(v.type.id!=="MenuItemOption")return v;const f=y=>{var g,_;d(v.props.value),(_=(g=v.props).onClick)==null||_.call(g,y)},m=n==="radio"?v.props.value===c:c.includes(v.props.value);return P.cloneElement(v,{type:n,onClick:f,isChecked:m})});return{...i,children:h}}function Dd(t){var e;if(!jd(t))return!1;const n=(e=t.ownerDocument.defaultView)!=null?e:window;return t instanceof n.HTMLElement}function jd(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}var[Pd,to]=rt({name:"MenuStylesContext",errorMessage:`useMenuStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Menu />" `}),Fs=t=>{const{children:e}=t,n=Rt("Menu",t),r=Ye(t),{direction:o}=vs(),{descendants:s,...i}=Sd({...r,direction:o}),a=P.useMemo(()=>i,[i]),{isOpen:l,onClose:c,forceUpdate:u}=a;return k.jsx(bd,{value:s,children:k.jsx(Ed,{value:a,children:k.jsx(Pd,{value:n,children:Ra(e,{isOpen:l,onClose:c,forceUpdate:u})})})})};Fs.displayName="Menu";var bi=fe((t,e)=>{const n=to();return k.jsx(de.span,{ref:e,...t,__css:n.command,className:"chakra-menu__command"})});bi.displayName="MenuCommand";var Ad=fe((t,e)=>{const{type:n,...r}=t,o=to(),s=r.as||n?n??void 0:"button",i=P.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...o.item}),[o.item]);return k.jsx(de.button,{ref:e,type:s,...r,__css:i})}),_i=t=>{const{className:e,children:n,...r}=t,o=to(),s=P.Children.only(n),i=P.isValidElement(s)?P.cloneElement(s,{focusable:"false","aria-hidden":!0,className:_e("chakra-menu__icon",s.props.className)}):null,a=_e("chakra-menu__icon-wrapper",e);return k.jsx(de.span,{className:a,...r,__css:o.icon,children:i})};_i.displayName="MenuIcon";var mt=fe((t,e)=>{const{icon:n,iconSpacing:r="0.75rem",command:o,commandSpacing:s="0.75rem",children:i,...a}=t,l=wi(a,e),u=n||o?k.jsx("span",{style:{pointerEvents:"none",flex:1},children:i}):i;return k.jsxs(Ad,{...l,className:_e("chakra-menu__menuitem",l.className),children:[n&&k.jsx(_i,{fontSize:"0.8em",marginEnd:r,children:n}),u,o&&k.jsx(bi,{marginStart:s,children:o})]})});mt.displayName="MenuItem";var Nd={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},Fd=de(gs.div),Rs=fe(function(e,n){var r,o;const{rootProps:s,motionProps:i,...a}=e,{isOpen:l,onTransitionEnd:c,unstable__animationState:u}=Zn(),d=Id(a,n),p=Od(s),h=to();return k.jsx(de.div,{...p,__css:{zIndex:(o=e.zIndex)!=null?o:(r=h.list)==null?void 0:r.zIndex},children:k.jsx(Fd,{variants:Nd,initial:!1,animate:l?"enter":"exit",__css:{outline:0,...h.list},...i,className:_e("chakra-menu__menu-list",d.className),...d,onUpdate:c,onAnimationComplete:Ta(u.onComplete,d.onAnimationComplete)})})});Rs.displayName="MenuList";var[Rd,wn]=rt({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[Td,no]=rt({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `});function xi(t){const e=P.Children.only(t.children),{getTriggerProps:n}=wn();return P.cloneElement(e,n(e.props,e.ref))}xi.displayName="PopoverTrigger";var en={click:"click",hover:"hover"};function Md(t={}){const{closeOnBlur:e=!0,closeOnEsc:n=!0,initialFocusRef:r,id:o,returnFocusOnClose:s=!0,autoFocus:i=!0,arrowSize:a,arrowShadowColor:l,trigger:c=en.click,openDelay:u=200,closeDelay:d=200,isLazy:p,lazyBehavior:h="unmount",computePositionOnMount:v,...f}=t,{isOpen:m,onClose:y,onOpen:g,onToggle:_}=As(t),x=P.useRef(null),C=P.useRef(null),D=P.useRef(null),E=P.useRef(!1),F=P.useRef(!1);m&&(F.current=!0);const[I,R]=P.useState(!1),[K,j]=P.useState(!1),M=P.useId(),b=o??M,[N,H,A,X]=["popover-trigger","popover-content","popover-header","popover-body"].map(U=>`${U}-${b}`),{referenceRef:V,getArrowProps:te,getPopperProps:z,getArrowInnerProps:B,forceUpdate:ne}=Ps({...f,enabled:m||!!v}),Y=vi({isOpen:m,ref:D});Dc({enabled:m,ref:C}),ai(D,{focusRef:C,visible:m,shouldFocus:s&&c===en.click}),Yc(D,{focusRef:r,visible:m,shouldFocus:i&&c===en.click});const Z=Ns({wasSelected:F.current,enabled:p,mode:h,isSelected:Y.present}),he=P.useCallback((U={},W=null)=>{const O={...U,style:{...U.style,transformOrigin:Ae.transformOrigin.varRef,[Ae.arrowSize.var]:a?`${a}px`:void 0,[Ae.arrowShadowColor.var]:l},ref:Me(D,W),children:Z?U.children:null,id:H,tabIndex:-1,role:"dialog",onKeyDown:Oe(U.onKeyDown,S=>{n&&S.key==="Escape"&&y()}),onBlur:Oe(U.onBlur,S=>{const T=ma(S),q=ho(D.current,T),J=ho(C.current,T);m&&e&&(!q&&!J)&&y()}),"aria-labelledby":I?A:void 0,"aria-describedby":K?X:void 0};return c===en.hover&&(O.role="tooltip",O.onMouseEnter=Oe(U.onMouseEnter,()=>{E.current=!0}),O.onMouseLeave=Oe(U.onMouseLeave,S=>{S.nativeEvent.relatedTarget!==null&&(E.current=!1,setTimeout(()=>y(),d))})),O},[Z,H,I,A,K,X,c,n,y,m,e,d,l,a]),ye=P.useCallback((U={},W=null)=>z({...U,style:{visibility:m?"visible":"hidden",...U.style}},W),[m,z]),le=P.useCallback((U,W=null)=>({...U,ref:Me(W,x,V)}),[x,V]),ue=P.useRef(),ke=P.useRef(),ve=P.useCallback(U=>{x.current==null&&V(U)},[V]),me=P.useCallback((U={},W=null)=>{const O={...U,ref:Me(C,W,ve),id:N,"aria-haspopup":"dialog","aria-expanded":m,"aria-controls":H};return c===en.click&&(O.onClick=Oe(U.onClick,_)),c===en.hover&&(O.onFocus=Oe(U.onFocus,()=>{ue.current===void 0&&g()}),O.onBlur=Oe(U.onBlur,S=>{const T=ma(S),q=!ho(D.current,T);m&&e&&q&&y()}),O.onKeyDown=Oe(U.onKeyDown,S=>{S.key==="Escape"&&y()}),O.onMouseEnter=Oe(U.onMouseEnter,()=>{E.current=!0,ue.current=window.setTimeout(()=>g(),u)}),O.onMouseLeave=Oe(U.onMouseLeave,()=>{E.current=!1,ue.current&&(clearTimeout(ue.current),ue.current=void 0),ke.current=window.setTimeout(()=>{E.current===!1&&y()},d)})),O},[N,m,H,c,ve,_,g,e,y,u,d]);P.useEffect(()=>()=>{ue.current&&clearTimeout(ue.current),ke.current&&clearTimeout(ke.current)},[]);const Ee=P.useCallback((U={},W=null)=>({...U,id:A,ref:Me(W,O=>{R(!!O)})}),[A]),w=P.useCallback((U={},W=null)=>({...U,id:X,ref:Me(W,O=>{j(!!O)})}),[X]);return{forceUpdate:ne,isOpen:m,onAnimationComplete:Y.onComplete,onClose:y,getAnchorProps:le,getArrowProps:te,getArrowInnerProps:B,getPopoverPositionerProps:ye,getPopoverProps:he,getTriggerProps:me,getHeaderProps:Ee,getBodyProps:w}}function ho(t,e){return t===e||(t==null?void 0:t.contains(e))}function ma(t){var e;const n=t.currentTarget.ownerDocument.activeElement;return(e=t.relatedTarget)!=null?e:n}function ki(t){const e=Rt("Popover",t),{children:n,...r}=Ye(t),o=vs(),s=Md({...r,direction:o.direction});return k.jsx(Rd,{value:s,children:k.jsx(Td,{value:e,children:Ra(n,{isOpen:s.isOpen,onClose:s.onClose,forceUpdate:s.forceUpdate})})})}ki.displayName="Popover";var po=(t,e)=>e?`${t}.${e}, ${e}`:void 0;function Ei(t){var e;const{bg:n,bgColor:r,backgroundColor:o,shadow:s,boxShadow:i,shadowColor:a}=t,{getArrowProps:l,getArrowInnerProps:c}=wn(),u=no(),d=(e=n??r)!=null?e:o,p=s??i;return k.jsx(de.div,{...l(),className:"chakra-popover__arrow-positioner",children:k.jsx(de.div,{className:_e("chakra-popover__arrow",t.className),...c(t),__css:{"--popper-arrow-shadow-color":po("colors",a),"--popper-arrow-bg":po("colors",d),"--popper-arrow-shadow":po("shadows",p),...u.arrow}})})}Ei.displayName="PopoverArrow";var Ci=fe(function(e,n){const{getBodyProps:r}=wn(),o=no();return k.jsx(de.div,{...r(e,n),className:_e("chakra-popover__body",e.className),__css:o.body})});Ci.displayName="PopoverBody";var Si=fe(function(e,n){const{onClose:r}=wn(),o=no();return k.jsx($l,{size:"sm",onClick:r,className:_e("chakra-popover__close-btn",e.className),__css:o.closeButton,ref:n,...e})});Si.displayName="PopoverCloseButton";function Bd(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}var zd={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},Ld=de(gs.section),Ii=fe(function(e,n){const{variants:r=zd,...o}=e,{isOpen:s}=wn();return k.jsx(Ld,{ref:n,variants:Bd(r),initial:!1,animate:s?"enter":"exit",...o})});Ii.displayName="PopoverTransition";var Oi=fe(function(e,n){const{rootProps:r,motionProps:o,...s}=e,{getPopoverProps:i,getPopoverPositionerProps:a,onAnimationComplete:l}=wn(),c=no(),u={position:"relative",display:"flex",flexDirection:"column",...c.content};return k.jsx(de.div,{...a(r),__css:c.popper,className:"chakra-popover__popper",children:k.jsx(Ii,{...o,...i(s,n),onAnimationComplete:Ta(l,s.onAnimationComplete),className:_e("chakra-popover__content",e.className),__css:u})})});Oi.displayName="PopoverContent";var[Wd,Ud,Kd,$d]=$a();function Vd(t){var e;const{defaultIndex:n,onChange:r,index:o,isManual:s,isLazy:i,lazyBehavior:a="unmount",orientation:l="horizontal",direction:c="ltr",...u}=t,[d,p]=P.useState(n??0),[h,v]=Va({defaultValue:n??0,value:o,onChange:r});P.useEffect(()=>{o!=null&&p(o)},[o]);const f=Kd(),m=P.useId();return{id:`tabs-${(e=t.id)!=null?e:m}`,selectedIndex:h,focusedIndex:d,setSelectedIndex:v,setFocusedIndex:p,isManual:s,isLazy:i,lazyBehavior:a,orientation:l,descendants:f,direction:c,htmlProps:u}}var[Hd,ro]=rt({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function qd(t){const{focusedIndex:e,orientation:n,direction:r}=ro(),o=Ud(),s=P.useCallback(i=>{const a=()=>{var g;const _=o.nextEnabled(e);_&&((g=_.node)==null||g.focus())},l=()=>{var g;const _=o.prevEnabled(e);_&&((g=_.node)==null||g.focus())},c=()=>{var g;const _=o.firstEnabled();_&&((g=_.node)==null||g.focus())},u=()=>{var g;const _=o.lastEnabled();_&&((g=_.node)==null||g.focus())},d=n==="horizontal",p=n==="vertical",h=i.key,v=r==="ltr"?"ArrowLeft":"ArrowRight",f=r==="ltr"?"ArrowRight":"ArrowLeft",y={[v]:()=>d&&l(),[f]:()=>d&&a(),ArrowDown:()=>p&&a(),ArrowUp:()=>p&&l(),Home:c,End:u}[h];y&&(i.preventDefault(),y(i))},[o,e,n,r]);return{...t,role:"tablist","aria-orientation":n,onKeyDown:Oe(t.onKeyDown,s)}}function Gd(t){const{isDisabled:e=!1,isFocusable:n=!1,...r}=t,{setSelectedIndex:o,isManual:s,id:i,setFocusedIndex:a,selectedIndex:l}=ro(),{index:c,register:u}=$d({disabled:e&&!n}),d=c===l,p=()=>{o(c)},h=()=>{a(c),!s&&!(e&&n)&&o(c)},v=si({...r,ref:Me(u,t.ref),isDisabled:e,isFocusable:n,onClick:Oe(t.onClick,p)}),f="button";return{...v,id:Di(i,c),role:"tab",tabIndex:d?0:-1,type:f,"aria-selected":d,"aria-controls":ji(i,c),onFocus:e?void 0:Oe(t.onFocus,h)}}var[Zd,Jd]=rt({});function Yd(t){const e=ro(),{id:n,selectedIndex:r}=e,s=ks(t.children).map((i,a)=>P.createElement(Zd,{key:a,value:{isSelected:a===r,id:ji(n,a),tabId:Di(n,a),selectedIndex:r}},i));return{...t,children:s}}function Xd(t){const{children:e,...n}=t,{isLazy:r,lazyBehavior:o}=ro(),{isSelected:s,id:i,tabId:a}=Jd(),l=P.useRef(!1);s&&(l.current=!0);const c=Ns({wasSelected:l.current,isSelected:s,enabled:r,mode:o});return{tabIndex:0,...n,children:c?e:null,role:"tabpanel","aria-labelledby":a,hidden:!s,id:i}}function Di(t,e){return`${t}--tab-${e}`}function ji(t,e){return`${t}--tabpanel-${e}`}var[Qd,oo]=rt({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),Pi=fe(function(e,n){const r=Rt("Tabs",e),{children:o,className:s,...i}=Ye(e),{htmlProps:a,descendants:l,...c}=Vd(i),u=P.useMemo(()=>c,[c]),{isFitted:d,...p}=a,h={position:"relative",...r.root};return k.jsx(Wd,{value:l,children:k.jsx(Hd,{value:u,children:k.jsx(Qd,{value:r,children:k.jsx(de.div,{className:_e("chakra-tabs",s),ref:n,...p,__css:h,children:o})})})})});Pi.displayName="Tabs";var Ai=fe(function(e,n){const r=qd({...e,ref:n}),s={display:"flex",...oo().tablist};return k.jsx(de.div,{...r,className:_e("chakra-tabs__tablist",e.className),__css:s})});Ai.displayName="TabList";var Fo=fe(function(e,n){const r=Xd({...e,ref:n}),o=oo();return k.jsx(de.div,{outline:"0",...r,className:_e("chakra-tabs__tab-panel",e.className),__css:o.tabpanel})});Fo.displayName="TabPanel";var Ni=fe(function(e,n){const r=Yd(e),o=oo();return k.jsx(de.div,{...r,width:"100%",ref:n,className:_e("chakra-tabs__tab-panels",e.className),__css:o.tabpanels})});Ni.displayName="TabPanels";var Ro=fe(function(e,n){const r=oo(),o=Gd({...e,ref:n}),s={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...r.tab};return k.jsx(de.button,{...o,className:_e("chakra-tabs__tab",e.className),__css:s})});Ro.displayName="Tab";var[ef,Fi]=rt({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),Gt=fe((t,e)=>{const n=Rt("Tag",t),r=Ye(t),o={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...n.container};return k.jsx(ef,{value:n,children:k.jsx(de.span,{ref:e,...r,__css:o})})});Gt.displayName="Tag";var tf=fe((t,e)=>{const n=Fi();return k.jsx(de.span,{ref:e,noOfLines:1,...t,__css:n.label})});tf.displayName="TagLabel";var nf=fe((t,e)=>k.jsx(Hr,{ref:e,verticalAlign:"top",marginEnd:"0.5rem",...t}));nf.displayName="TagLeftIcon";var rf=fe((t,e)=>k.jsx(Hr,{ref:e,verticalAlign:"top",marginStart:"0.5rem",...t}));rf.displayName="TagRightIcon";var Ri=t=>k.jsx(Hr,{verticalAlign:"inherit",viewBox:"0 0 512 512",...t,children:k.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});Ri.displayName="TagCloseIcon";var of=fe((t,e)=>{const{isDisabled:n,children:r,...o}=t,i={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...Fi().closeButton};return k.jsx(de.button,{ref:e,"aria-label":"close",...o,type:"button",disabled:n,__css:i,children:r||k.jsx(Ri,{})})});of.displayName="TagCloseButton";var sf={exit:{scale:.85,opacity:0,transition:{opacity:{duration:.15,easings:"easeInOut"},scale:{duration:.2,easings:"easeInOut"}}},enter:{scale:1,opacity:1,transition:{opacity:{easings:"easeOut",duration:.2},scale:{duration:.2,ease:[.175,.885,.4,1.1]}}}},To=t=>{var e;return((e=t.current)==null?void 0:e.ownerDocument)||document},pr=t=>{var e,n;return((n=(e=t.current)==null?void 0:e.ownerDocument)==null?void 0:n.defaultView)||window};function af(t={}){const{openDelay:e=0,closeDelay:n=0,closeOnClick:r=!0,closeOnMouseDown:o,closeOnScroll:s,closeOnPointerDown:i=o,closeOnEsc:a=!0,onOpen:l,onClose:c,placement:u,id:d,isOpen:p,defaultIsOpen:h,arrowSize:v=10,arrowShadowColor:f,arrowPadding:m,modifiers:y,isDisabled:g,gutter:_,offset:x,direction:C,...D}=t,{isOpen:E,onOpen:F,onClose:I}=As({isOpen:p,defaultIsOpen:h,onOpen:l,onClose:c}),{referenceRef:R,getPopperProps:K,getArrowInnerProps:j,getArrowProps:M}=Ps({enabled:E,placement:u,arrowPadding:m,modifiers:y,gutter:_,offset:x,direction:C}),b=P.useId(),H=`tooltip-${d??b}`,A=P.useRef(null),X=P.useRef(),V=P.useCallback(()=>{X.current&&(clearTimeout(X.current),X.current=void 0)},[]),te=P.useRef(),z=P.useCallback(()=>{te.current&&(clearTimeout(te.current),te.current=void 0)},[]),B=P.useCallback(()=>{z(),I()},[I,z]),ne=lf(A,B),Y=P.useCallback(()=>{if(!g&&!X.current){E&&ne();const me=pr(A);X.current=me.setTimeout(F,e)}},[ne,g,E,F,e]),Z=P.useCallback(()=>{V();const me=pr(A);te.current=me.setTimeout(B,n)},[n,B,V]),he=P.useCallback(()=>{E&&r&&Z()},[r,Z,E]),ye=P.useCallback(()=>{E&&i&&Z()},[i,Z,E]),le=P.useCallback(me=>{E&&me.key==="Escape"&&Z()},[E,Z]);on(()=>To(A),"keydown",a?le:void 0),on(()=>{if(!s)return null;const me=A.current;if(!me)return null;const Ee=ti(me);return Ee.localName==="body"?pr(A):Ee},"scroll",()=>{E&&s&&B()},{passive:!0,capture:!0}),P.useEffect(()=>{g&&(V(),E&&I())},[g,E,I,V]),P.useEffect(()=>()=>{V(),z()},[V,z]),on(()=>A.current,"pointerleave",Z);const ue=P.useCallback((me={},Ee=null)=>({...me,ref:Me(A,Ee,R),onPointerEnter:Oe(me.onPointerEnter,U=>{U.pointerType!=="touch"&&Y()}),onClick:Oe(me.onClick,he),onPointerDown:Oe(me.onPointerDown,ye),onFocus:Oe(me.onFocus,Y),onBlur:Oe(me.onBlur,Z),"aria-describedby":E?H:void 0}),[Y,Z,ye,E,H,he,R]),ke=P.useCallback((me={},Ee=null)=>K({...me,style:{...me.style,[Ae.arrowSize.var]:v?`${v}px`:void 0,[Ae.arrowShadowColor.var]:f}},Ee),[K,v,f]),ve=P.useCallback((me={},Ee=null)=>{const w={...me.style,position:"relative",transformOrigin:Ae.transformOrigin.varRef};return{ref:Ee,...D,...me,id:H,role:"tooltip",style:w}},[D,H]);return{isOpen:E,show:Y,hide:Z,getTriggerProps:ue,getTooltipProps:ve,getTooltipPositionerProps:ke,getArrowProps:M,getArrowInnerProps:j}}var mo="chakra-ui:close-tooltip";function lf(t,e){return P.useEffect(()=>{const n=To(t);return n.addEventListener(mo,e),()=>n.removeEventListener(mo,e)},[e,t]),()=>{const n=To(t),r=pr(t);n.dispatchEvent(new r.CustomEvent(mo))}}function cf(t,e=[]){const n=Object.assign({},t);for(const r of e)r in n&&delete n[r];return n}function uf(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}var df=de(gs.div),bt=fe((t,e)=>{var n,r;const o=Hn("Tooltip",t),s=Ye(t),i=vs(),{children:a,label:l,shouldWrapChildren:c,"aria-label":u,hasArrow:d,bg:p,portalProps:h,background:v,backgroundColor:f,bgColor:m,motionProps:y,...g}=s,_=(r=(n=v??f)!=null?n:p)!=null?r:m;if(_){o.bg=_;const K=Vl(i,"colors",_);o[Ae.arrowBg.var]=K}const x=af({...g,direction:i.direction}),C=typeof a=="string"||c;let D;if(C)D=k.jsx(de.span,{display:"inline-block",tabIndex:0,...x.getTriggerProps(),children:a});else{const K=P.Children.only(a);D=P.cloneElement(K,x.getTriggerProps(K.props,K.ref))}const E=!!u,F=x.getTooltipProps({},e),I=E?cf(F,["role","id"]):F,R=uf(F,["role","id"]);return l?k.jsxs(k.Fragment,{children:[D,k.jsx(Hl,{children:x.isOpen&&k.jsx(Ma,{...h,children:k.jsx(de.div,{...x.getTooltipPositionerProps(),__css:{zIndex:o.zIndex,pointerEvents:"none"},children:k.jsxs(df,{variants:sf,initial:"exit",animate:"enter",exit:"exit",...y,...I,__css:o,children:[l,E&&k.jsx(de.span,{srOnly:!0,...R,children:u}),d&&k.jsx(de.div,{"data-popper-arrow":!0,className:"chakra-tooltip__arrow-wrapper",children:k.jsx(de.div,{"data-popper-arrow-inner":!0,className:"chakra-tooltip__arrow",__css:{bg:o.bg}})})]})})})})]}):k.jsx(k.Fragment,{children:a})});bt.displayName="Tooltip";let rr;const ff=new Uint8Array(16);function hf(){if(!rr&&(rr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!rr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return rr(ff)}const Re=[];for(let t=0;t<256;++t)Re.push((t+256).toString(16).slice(1));function pf(t,e=0){return Re[t[e+0]]+Re[t[e+1]]+Re[t[e+2]]+Re[t[e+3]]+"-"+Re[t[e+4]]+Re[t[e+5]]+"-"+Re[t[e+6]]+Re[t[e+7]]+"-"+Re[t[e+8]]+Re[t[e+9]]+"-"+Re[t[e+10]]+Re[t[e+11]]+Re[t[e+12]]+Re[t[e+13]]+Re[t[e+14]]+Re[t[e+15]]}const mf=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ya={randomUUID:mf};function Dr(t,e,n){if(ya.randomUUID&&!e&&!t)return ya.randomUUID();t=t||{};const r=t.random||(t.rng||hf)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let o=0;o<16;++o)e[n+o]=r[o];return e}return pf(r)}async function yf(t){console.warn("[workspace deprecated] getDB is deprecated",t);try{const e=await fetch(`/workspace/get_db?table=${t}`);return e.ok?await e.json():void 0}catch(e){console.error("Error fetching workspace:",e);return}}async function vf(t,e){try{return await(await fetch("/workspace/save_db",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table:t,json:e})})).text()}catch(n){console.error("Error saving workspace:",n)}}async function gf(t,e){try{return await(await fetch("/workspace/update_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,json_str:e})})).text()}catch(n){alert("Error saving workflow .json file: "+n),console.error("Error saving workspace:",n)}}async function Ti(t,e=!1){try{return await(await fetch("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,deleteEmptyFolder:e})})).text()}catch(n){console.error("Error deleting file:",n)}}async function Xp(t){try{return await(await fetch("/workspace/get_system_dir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absolute_dir:t??""})})).json()}catch(e){console.error("Error getting workflows dir:",e)}}async function Qp(){try{return await(await fetch("/workspace/open_workflow_file_browser",{method:"POST",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error open workflows folder:",t)}}async function wf(){const e=await(await fetch("/workspace/get_my_workflows_dir")).json();return e.error&&alert(`Failed to fetch my workflows path: ${e.error}`),e}async function bf(){try{return await(await fetch("/model_manager/get_model_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function em(){try{return await(await fetch("/model_manager/get_folder_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function tm(t){try{return await(await fetch("/model_manager/cancel_installation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({save_path:t})})).text()}catch(e){console.error("Error move file:",e)}}async function nm(t,e){try{return await(await fetch("/workspace/copy_json_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({src:t,dst:e})})).json()}catch(n){console.error("Error copy flows to new directory:",n)}}const _f="backup",jr="workspace";let or=null;function xf(){return new Promise((t,e)=>{const n=indexedDB.open("WorkspaceDB",3);n.onupgradeneeded=r=>{const o=r.target.result;o.objectStoreNames.contains(jr)||o.createObjectStore(jr,{keyPath:"id"})},n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{e(r.target.error)}})}async function kf(){try{return or==null&&(or=await xf()),new Promise((t,e)=>{if(or==null)return e("indexDB is null");const o=or.transaction([jr],"readonly").objectStore(jr).get(_f);o.onsuccess=()=>{o.result?t(o.result.value):t(void 0)},o.onerror=()=>e(o.error)})}catch(t){console.error("Error while reading from database:",t)}}async function Ef(){try{return await kf()}catch(t){console.error("Error retrieving data from IndexedDB:",t)}}const Ce=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ne=Object.keys,ze=Array.isArray;function Ue(t,e){return typeof e!="object"||Ne(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||Ce.Promise||(Ce.Promise=Promise);const zn=Object.getPrototypeOf,Cf={}.hasOwnProperty;function Je(t,e){return Cf.call(t,e)}function mn(t,e){typeof e=="function"&&(e=e(zn(t))),(typeof Reflect>"u"?Ne:Reflect.ownKeys)(e).forEach(n=>{_t(t,n,e[n])})}const Mi=Object.defineProperty;function _t(t,e,n,r){Mi(t,e,Ue(n&&Je(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function an(t){return{from:function(e){return t.prototype=Object.create(e.prototype),_t(t.prototype,"constructor",t),{extend:mn.bind(null,t.prototype)}}}}const Sf=Object.getOwnPropertyDescriptor;function Ts(t,e){let n;return Sf(t,e)||(n=zn(t))&&Ts(n,e)}const If=[].slice;function Pr(t,e,n){return If.call(t,e,n)}function Bi(t,e){return e(t)}function In(t){if(!t)throw new Error("Assertion Failed")}function zi(t){Ce.setImmediate?setImmediate(t):setTimeout(t,0)}function Li(t,e){return t.reduce((n,r,o)=>{var s=e(r,o);return s&&(n[s[0]]=s[1]),n},{})}function xt(t,e){if(Je(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,o=e.length;r<o;++r){var s=xt(t,e[r]);n.push(s)}return n}var i=e.indexOf(".");if(i!==-1){var a=t[e.substr(0,i)];return a===void 0?void 0:xt(a,e.substr(i+1))}}function st(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){In(typeof n!="string"&&"length"in n);for(var r=0,o=e.length;r<o;++r)st(t,e[r],n[r])}else{var s=e.indexOf(".");if(s!==-1){var i=e.substr(0,s),a=e.substr(s+1);if(a==="")n===void 0?ze(t)&&!isNaN(parseInt(i))?t.splice(i,1):delete t[i]:t[i]=n;else{var l=t[i];l&&Je(t,i)||(l=t[i]={}),st(l,a,n)}}else n===void 0?ze(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Wi(t){var e={};for(var n in t)Je(t,n)&&(e[n]=t[n]);return e}const Of=[].concat;function Ui(t){return Of.apply([],t)}const Ki="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ui([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>Ce[t]),Df=Ki.map(t=>Ce[t]);Li(Ki,t=>[t,!0]);let It=null;function Jn(t){It=typeof WeakMap<"u"&&new WeakMap;const e=Mo(t);return It=null,e}function Mo(t){if(!t||typeof t!="object")return t;let e=It&&It.get(t);if(e)return e;if(ze(t)){e=[],It&&It.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Mo(t[n]))}else if(Df.indexOf(t.constructor)>=0)e=t;else{const s=zn(t);for(var o in e=s===Object.prototype?{}:Object.create(s),It&&It.set(t,e),t)Je(t,o)&&(e[o]=Mo(t[o]))}return e}const{toString:jf}={};function Bo(t){return jf.call(t).slice(8,-1)}const zo=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Pf=typeof zo=="symbol"?function(t){var e;return t!=null&&(e=t[zo])&&e.apply(t)}:function(){return null},rn={};function vt(t){var e,n,r,o;if(arguments.length===1){if(ze(t))return t.slice();if(this===rn&&typeof t=="string")return[t];if(o=Pf(t)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const Ms=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var ft=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function $i(t,e){ft=t,Vi=e}var Vi=()=>!0;const Af=!new Error("").stack;function Yt(){if(Af)try{throw Yt.arguments,new Error}catch(t){return t}return new Error}function Lo(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(Vi).map(r=>`
`+r).join("")):""}var Hi=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Bs=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Hi),Nf={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ln(t,e){this._e=Yt(),this.name=t,this.message=e}function qi(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,o)=>o.indexOf(n)===r).join(`
`)}function Ar(t,e,n,r){this._e=Yt(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=qi(t,e)}function An(t,e){this._e=Yt(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=qi(t,e)}an(ln).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Lo(this._e,2))}},toString:function(){return this.name+": "+this.message}}),an(Ar).from(ln),an(An).from(ln);var zs=Bs.reduce((t,e)=>(t[e]=e+"Error",t),{});const Ff=ln;var ce=Bs.reduce((t,e)=>{var n=e+"Error";function r(o,s){this._e=Yt(),this.name=n,o?typeof o=="string"?(this.message=`${o}${s?`
 `+s:""}`,this.inner=s||null):typeof o=="object"&&(this.message=`${o.name} ${o.message}`,this.inner=o):(this.message=Nf[e]||n,this.inner=null)}return an(r).from(Ff),t[e]=r,t},{});ce.Syntax=SyntaxError,ce.Type=TypeError,ce.Range=RangeError;var va=Hi.reduce((t,e)=>(t[e+"Error"]=ce[e],t),{}),mr=Bs.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=ce[e]),t),{});function xe(){}function Ln(t){return t}function Rf(t,e){return t==null||t===Ln?e:function(n){return e(t(n))}}function Zt(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Tf(t,e){return t===xe?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Zt(r,this.onsuccess):r),o&&(this.onerror=this.onerror?Zt(o,this.onerror):o),s!==void 0?s:n}}function Mf(t,e){return t===xe?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Zt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Zt(r,this.onerror):r)}}function Bf(t,e){return t===xe?e:function(n){var r=t.apply(this,arguments);Ue(n,r);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?Zt(o,this.onsuccess):o),s&&(this.onerror=this.onerror?Zt(s,this.onerror):s),r===void 0?i===void 0?void 0:i:Ue(r,i)}}function zf(t,e){return t===xe?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function Ls(t,e){return t===xe?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return n.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}mr.ModifyError=Ar,mr.DexieError=ln,mr.BulkError=An;var Wn={};const Gi=100,[Wo,Nr,Uo]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,zn(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,zn(e),t]})(),Zi=Nr&&Nr.then,yr=Wo&&Wo.constructor,Ws=!!Uo;var Ko=!1,Lf=Uo?()=>{Uo.then(sr)}:Ce.setImmediate?setImmediate.bind(null,sr):Ce.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{sr(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(sr,0)},Nn=function(t,e){On.push([t,e]),Fr&&(Lf(),Fr=!1)},$o=!0,Fr=!0,Kt=[],vr=[],Vo=null,Ho=Ln,cn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ba,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{ba(t[0],t[1])}catch{}})}},ae=cn,On=[],$t=0,gr=[];function oe(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=xe,this._lib=!1;var e=this._PSD=ae;if(ft&&(this._stackHolder=Yt(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Wn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Go(this,this._value))}this._state=null,this._value=null,++e.ref,Yi(this,t)}const qo={get:function(){var t=ae,e=Rr;function n(r,o){var s=!t.global&&(t!==ae||e!==Rr);const i=s&&!Et();var a=new oe((l,c)=>{Us(this,new Ji(Tr(r,t,s,i),Tr(o,t,s,i),l,c,t))});return ft&&el(a,this),a}return n.prototype=Wn,n},set:function(t){_t(this,"then",t&&t.prototype===Wn?qo:{get:function(){return t},set:qo.set})}};function Ji(t,e,n,r,o){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=o}function Yi(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Yn();n&&typeof n.then=="function"?Yi(t,(o,s)=>{n instanceof oe?n._then(o,s):n.then(o,s)}):(t._state=!0,t._value=n,Xi(t)),r&&Xn()}},Go.bind(null,t))}catch(n){Go(t,n)}}function Go(t,e){if(vr.push(e),t._state===null){var n=t._lib&&Yn();e=Ho(e),t._state=!1,t._value=e,ft&&e!==null&&typeof e=="object"&&!e._promise&&function(r,o,s){try{r.apply(null,s)}catch(i){o&&o(i)}}(()=>{var r=Ts(e,"stack");e._promise=t,_t(e,"stack",{get:()=>Ko?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){Kt.some(o=>o._value===r._value)||Kt.push(r)}(t),Xi(t),n&&Xn()}}function Xi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Us(t,e[n]);var o=t._PSD;--o.ref||o.finalize(),$t===0&&(++$t,Nn(()=>{--$t==0&&Ks()},[]))}function Us(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++$t,Nn(Wf,[n,t,e])}else t._listeners.push(e)}function Wf(t,e,n){try{Vo=e;var r,o=e._value;e._state?r=t(o):(vr.length&&(vr=[]),r=t(o),vr.indexOf(o)===-1&&function(s){for(var i=Kt.length;i;)if(Kt[--i]._value===s._value)return void Kt.splice(i,1)}(e)),n.resolve(r)}catch(s){n.reject(s)}finally{Vo=null,--$t==0&&Ks(),--n.psd.ref||n.psd.finalize()}}function Qi(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var o,s,i=t._value;i!=null?(o=i.name||"Error",s=i.message||i,r=Lo(i,0)):(o=i,s=""),e.push(o+(s?": "+s:"")+r)}return ft&&((r=Lo(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&Qi(t._prev,e,n)),e}function el(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function sr(){Yn()&&Xn()}function Yn(){var t=$o;return $o=!1,Fr=!1,t}function Xn(){var t,e,n;do for(;On.length>0;)for(t=On,On=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(On.length>0);$o=!0,Fr=!0}function Ks(){var t=Kt;Kt=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=gr.slice(0),n=e.length;n;)e[--n]()}function ar(t){return new oe(Wn,!1,t)}function Se(t,e){var n=ae;return function(){var r=Yn(),o=ae;try{return At(n,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{At(o,!1),r&&Xn()}}}mn(oe.prototype,{then:qo,_then:function(t,e){Us(this,new Ji(null,null,t,e,ae))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):ar(r)):this.then(null,r=>r&&r.name===e?n(r):ar(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),ar(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Ko=!0;var t=Qi(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Ko=!1}}},timeout:function(t,e){return t<1/0?new oe((n,r)=>{var o=setTimeout(()=>r(new ce.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&_t(oe.prototype,Symbol.toStringTag,"Dexie.Promise"),cn.env=tl(),mn(oe,{all:function(){var t=vt.apply(null,arguments).map(ir);return new oe(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((o,s)=>oe.resolve(o).then(i=>{t[s]=i,--r||e(t)},n))})},resolve:t=>{if(t instanceof oe)return t;if(t&&typeof t.then=="function")return new oe((n,r)=>{t.then(n,r)});var e=new oe(Wn,!0,t);return el(e,Vo),e},reject:ar,race:function(){var t=vt.apply(null,arguments).map(ir);return new oe((e,n)=>{t.map(r=>oe.resolve(r).then(e,n))})},PSD:{get:()=>ae,set:t=>ae=t},totalEchoes:{get:()=>Rr},newPSD:Pt,usePSD:_n,scheduler:{get:()=>Nn,set:t=>{Nn=t}},rejectionMapper:{get:()=>Ho,set:t=>{Ho=t}},follow:(t,e)=>new oe((n,r)=>Pt((o,s)=>{var i=ae;i.unhandleds=[],i.onunhandled=s,i.finalize=Zt(function(){(function(a){function l(){a(),gr.splice(gr.indexOf(l),1)}gr.push(l),++$t,Nn(()=>{--$t==0&&Ks()},[])})(()=>{this.unhandleds.length===0?o():s(this.unhandleds[0])})},i.finalize),t()},e,n,r))}),yr&&(yr.allSettled&&_t(oe,"allSettled",function(){const t=vt.apply(null,arguments).map(ir);return new oe(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((o,s)=>oe.resolve(o).then(i=>r[s]={status:"fulfilled",value:i},i=>r[s]={status:"rejected",reason:i}).then(()=>--n||e(r)))})}),yr.any&&typeof AggregateError<"u"&&_t(oe,"any",function(){const t=vt.apply(null,arguments).map(ir);return new oe((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const o=new Array(r);t.forEach((s,i)=>oe.resolve(s).then(a=>e(a),a=>{o[i]=a,--r||n(new AggregateError(o))}))})}));const Be={awaits:0,echoes:0,id:0};var Uf=0,wr=[],yo=0,Rr=0,Kf=0;function Pt(t,e,n,r){var o=ae,s=Object.create(o);s.parent=o,s.ref=0,s.global=!1,s.id=++Kf;var i=cn.env;s.env=Ws?{Promise:oe,PromiseProp:{value:oe,configurable:!0,writable:!0},all:oe.all,race:oe.race,allSettled:oe.allSettled,any:oe.any,resolve:oe.resolve,reject:oe.reject,nthen:ga(i.nthen,s),gthen:ga(i.gthen,s)}:{},e&&Ue(s,e),++o.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=_n(s,t,n,r);return s.ref===0&&s.finalize(),a}function bn(){return Be.id||(Be.id=++Uf),++Be.awaits,Be.echoes+=Gi,Be.id}function Et(){return!!Be.awaits&&(--Be.awaits==0&&(Be.id=0),Be.echoes=Be.awaits*Gi,!0)}function ir(t){return Be.echoes&&t&&t.constructor===yr?(bn(),t.then(e=>(Et(),e),e=>(Et(),Fe(e)))):t}function $f(t){++Rr,Be.echoes&&--Be.echoes!=0||(Be.echoes=Be.id=0),wr.push(ae),At(t,!0)}function Vf(){var t=wr[wr.length-1];wr.pop(),At(t,!1)}function At(t,e){var n=ae;if((e?!Be.echoes||yo++&&t===ae:!yo||--yo&&t===ae)||nl(e?$f.bind(null,t):Vf),t!==ae&&(ae=t,n===cn&&(cn.env=tl()),Ws)){var r=cn.env.Promise,o=t.env;Nr.then=o.nthen,r.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(Ce,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function tl(){var t=Ce.Promise;return Ws?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(Ce,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Nr.then,gthen:t.prototype.then}:{}}function _n(t,e,n,r,o){var s=ae;try{return At(t,!0),e(n,r,o)}finally{At(s,!1)}}function nl(t){Zi.call(Wo,t)}function Tr(t,e,n,r){return typeof t!="function"?t:function(){var o=ae;n&&bn(),At(e,!0);try{return t.apply(this,arguments)}finally{At(o,!1),r&&nl(Et)}}}function ga(t,e){return function(n,r){return t.call(this,Tr(n,e),Tr(r,e))}}(""+Zi).indexOf("[native code]")===-1&&(bn=Et=xe);const wa="unhandledrejection";function ba(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,o={promise:e,reason:t};if(Ce.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(wa,!0,!0),Ue(r,o)):Ce.CustomEvent&&Ue(r=new CustomEvent(wa,{detail:o}),o),r&&Ce.dispatchEvent&&(dispatchEvent(r),!Ce.PromiseRejectionEvent&&Ce.onunhandledrejection))try{Ce.onunhandledrejection(r)}catch{}ft&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var Fe=oe.reject;function Zo(t,e,n,r){if(t.idbdb&&(t._state.openComplete||ae.letThrough||t._vip)){var o=t._createTransaction(e,n,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===zs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Zo(t,e,n,r))):Fe(s)}return o._promise(e,(s,i)=>Pt(()=>(ae.trans=o,r(s,i,o)))).then(s=>o._completion.then(()=>s))}if(t._state.openComplete)return Fe(new ce.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Fe(new ce.DatabaseClosed);t.open().catch(xe)}return t._state.dbReadyPromise.then(()=>Zo(t,e,n,r))}const _a="3.2.4",zt="￿",Jo=-1/0,pt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",rl="String expected.",Fn=[],so=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Hf=so,qf=so,ol=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),ao="__dbnames",vo="readonly",go="readwrite";function Jt(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const sl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function lr(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=Jn(e))[t],e)}class Gf{_trans(e,n,r){const o=this._tx||ae.trans,s=this.name;function i(l,c,u){if(!u.schema[s])throw new ce.NotFound("Table "+s+" not part of transaction");return n(u.idbtrans,u)}const a=Yn();try{return o&&o.db===this.db?o===ae.trans?o._promise(e,i,r):Pt(()=>o._promise(e,i,r),{trans:o,transless:ae.transless||ae}):Zo(this.db,e,[this.name],i)}finally{a&&Xn()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(o=>this.hook.reading.fire(o))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(ze(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=Ne(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(c=>c.compound&&n.every(u=>c.keyPath.indexOf(u)>=0)&&c.keyPath.every(u=>n.indexOf(u)>=0))[0];if(r&&this.db._maxKey!==zt)return this.where(r.name).equals(r.keyPath.map(c=>e[c]));!r&&ft&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:o}=this.schema,s=this.db._deps.indexedDB;function i(c,u){try{return s.cmp(c,u)===0}catch{return!1}}const[a,l]=n.reduce(([c,u],d)=>{const p=o[d],h=e[d];return[c||p,c||!p?Jt(u,p&&p.multi?v=>{const f=xt(v,d);return ze(f)&&f.some(m=>i(h,m))}:v=>i(h,xt(v,d))):u]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,ze(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=r=>{if(!r)return r;const o=Object.create(e.prototype);for(var s in r)if(Je(r,s))try{o[s]=r[s]}catch{}return o};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){Ue(this,e)})}add(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=lr(o)(e)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"add",keys:n!=null?[n]:null,values:[s]})).then(i=>i.numFailures?oe.reject(i.failures[0]):i.lastResult).then(i=>{if(o)try{st(e,o,i)}catch{}return i})}update(e,n){if(typeof e!="object"||ze(e))return this.where(":id").equals(e).modify(n);{const r=xt(e,this.schema.primKey.keyPath);if(r===void 0)return Fe(new ce.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?Ne(n).forEach(o=>{st(e,o,n[o])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=lr(o)(e)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"put",values:[s],keys:n!=null?[n]:null})).then(i=>i.numFailures?oe.reject(i.failures[0]):i.lastResult).then(i=>{if(o)try{st(e,o,i)}catch{}return i})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?oe.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:sl})).then(e=>e.numFailures?oe.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(o=>this.hook.reading.fire(o))))}bulkAdd(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&o)throw new ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=l&&a?e.map(lr(l)):e;return this.core.mutate({trans:i,type:"add",keys:o,values:u,wantResults:s}).then(({numFailures:d,results:p,lastResult:h,failures:v})=>{if(d===0)return s?p:h;throw new An(`${this.name}.bulkAdd(): ${d} of ${c} operations failed`,v)})})}bulkPut(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&o)throw new ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=l&&a?e.map(lr(l)):e;return this.core.mutate({trans:i,type:"put",keys:o,values:u,wantResults:s}).then(({numFailures:d,results:p,lastResult:h,failures:v})=>{if(d===0)return s?p:h;throw new An(`${this.name}.bulkPut(): ${d} of ${c} operations failed`,v)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:o,failures:s})=>{if(r===0)return o;throw new An(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,s)})}}function Rn(t){var e={},n=function(i,a){if(a){for(var l=arguments.length,c=new Array(l-1);--l;)c[l-1]=arguments[l];return e[i].subscribe.apply(null,c),t}if(typeof i=="string")return e[i]};n.addEventType=s;for(var r=1,o=arguments.length;r<o;++r)s(arguments[r]);return n;function s(i,a,l){if(typeof i!="object"){var c;a||(a=zf),l||(l=xe);var u={subscribers:[],fire:l,subscribe:function(d){u.subscribers.indexOf(d)===-1&&(u.subscribers.push(d),u.fire=a(u.fire,d))},unsubscribe:function(d){u.subscribers=u.subscribers.filter(function(p){return p!==d}),u.fire=u.subscribers.reduce(a,l)}};return e[i]=n[i]=u,u}Ne(c=i).forEach(function(d){var p=c[d];if(ze(p))s(d,c[d][0],c[d][1]);else{if(p!=="asap")throw new ce.InvalidArgument("Invalid event config");var h=s(d,Ln,function(){for(var v=arguments.length,f=new Array(v);v--;)f[v]=arguments[v];h.subscribers.forEach(function(m){zi(function(){m.apply(null,f)})})})}})}}function Sn(t,e){return an(e).from({prototype:t}),e}function tn(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function wo(t,e){t.filter=Jt(t.filter,e)}function bo(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>Jt(r(),e()):e,t.justLimit=n&&!r}function br(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new ce.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function xa(t,e,n){const r=br(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function cr(t,e,n,r){const o=t.replayFilter?Jt(t.filter,t.replayFilter()):t.filter;if(t.or){const s={},i=(a,l,c)=>{if(!o||o(l,c,p=>l.stop(p),p=>l.fail(p))){var u=l.primaryKey,d=""+u;d==="[object ArrayBuffer]"&&(d=""+new Uint8Array(u)),Je(s,d)||(s[d]=!0,e(a,l,c))}};return Promise.all([t.or._iterate(i,n),ka(xa(t,r,n),t.algorithm,i,!t.keysOnly&&t.valueMapper)])}return ka(xa(t,r,n),Jt(t.algorithm,o),e,!t.keysOnly&&t.valueMapper)}function ka(t,e,n,r){var o=Se(r?(s,i,a)=>n(r(s),i,a):n);return t.then(s=>{if(s)return s.start(()=>{var i=()=>s.continue();e&&!e(s,a=>i=a,a=>{s.stop(a),i=xe},a=>{s.fail(a),i=xe})||o(s.value,s,a=>i=a),i()})})}function We(t,e){try{const n=Ea(t),r=Ea(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(o,s){const i=o.length,a=s.length,l=i<a?i:a;for(let c=0;c<l;++c)if(o[c]!==s[c])return o[c]<s[c]?-1:1;return i===a?0:i<a?-1:1}(Ca(t),Ca(e));case"Array":return function(o,s){const i=o.length,a=s.length,l=i<a?i:a;for(let c=0;c<l;++c){const u=We(o[c],s[c]);if(u!==0)return u}return i===a?0:i<a?-1:1}(t,e)}}catch{}return NaN}function Ea(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=Bo(t);return n==="ArrayBuffer"?"binary":n}function Ca(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class Zf{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,Fe.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,Fe.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=Jt(n.algorithm,e)}_iterate(e,n){return cr(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Ue(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>cr(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,o=r.table.core;if(tn(r,!0))return o.count({trans:n,query:{index:br(r,o.schema),range:r.range}}).then(i=>Math.min(i,r.limit));var s=0;return cr(r,()=>(++s,!1),n,o).then(()=>s)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),o=r[0],s=r.length-1;function i(c,u){return u?i(c[r[u]],u-1):c[o]}var a=this._ctx.dir==="next"?1:-1;function l(c,u){var d=i(c,s),p=i(u,s);return d<p?-a:d>p?a:0}return this.toArray(function(c){return c.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&tn(r,!0)&&r.limit>0){const{valueMapper:o}=r,s=br(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:s,range:r.range}}).then(({result:i})=>o?i.map(o):i)}{const o=[];return cr(r,s=>o.push(s),n,r.table.core).then(()=>o)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,tn(n)?bo(n,()=>{var r=e;return(o,s)=>r===0||(r===1?(--r,!1):(s(()=>{o.advance(r),r=0}),!1))}):bo(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),bo(this._ctx,()=>{var n=e;return function(r,o,s){return--n<=0&&o(s),n>=0}},!0),this}until(e,n){return wo(this._ctx,function(r,o,s){return!e(r.value)||(o(s),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return wo(this._ctx,function(o){return e(o.value)}),n=this._ctx,r=e,n.isMatch=Jt(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.key,o)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.primaryKey,o)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&tn(n,!0)&&n.limit>0)return this._read(o=>{var s=br(n,n.table.core.schema);return n.table.core.query({trans:o,values:!1,limit:n.limit,query:{index:s,range:n.range}})}).then(({result:o})=>o).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return wo(this._ctx,function(o){var s=o.primaryKey.toString(),i=Je(r,s);return r[s]=!0,!i}),this}modify(e){var n=this._ctx;return this._write(r=>{var o;if(typeof e=="function")o=e;else{var s=Ne(e),i=s.length;o=function(f){for(var m=!1,y=0;y<i;++y){var g=s[y],_=e[g];xt(f,g)!==_&&(st(f,g,_),m=!0)}return m}}const a=n.table.core,{outbound:l,extractKey:c}=a.schema.primaryKey,u=this.db._options.modifyChunkSize||200,d=[];let p=0;const h=[],v=(f,m)=>{const{failures:y,numFailures:g}=m;p+=f-g;for(let _ of Ne(y))d.push(y[_])};return this.clone().primaryKeys().then(f=>{const m=y=>{const g=Math.min(u,f.length-y);return a.getMany({trans:r,keys:f.slice(y,y+g),cache:"immutable"}).then(_=>{const x=[],C=[],D=l?[]:null,E=[];for(let I=0;I<g;++I){const R=_[I],K={value:Jn(R),primKey:f[y+I]};o.call(K,K.value,K)!==!1&&(K.value==null?E.push(f[y+I]):l||We(c(R),c(K.value))===0?(C.push(K.value),l&&D.push(f[y+I])):(E.push(f[y+I]),x.push(K.value)))}const F=tn(n)&&n.limit===1/0&&(typeof e!="function"||e===_o)&&{index:n.index,range:n.range};return Promise.resolve(x.length>0&&a.mutate({trans:r,type:"add",values:x}).then(I=>{for(let R in I.failures)E.splice(parseInt(R),1);v(x.length,I)})).then(()=>(C.length>0||F&&typeof e=="object")&&a.mutate({trans:r,type:"put",keys:D,values:C,criteria:F,changeSpec:typeof e!="function"&&e}).then(I=>v(C.length,I))).then(()=>(E.length>0||F&&e===_o)&&a.mutate({trans:r,type:"delete",keys:E,criteria:F}).then(I=>v(E.length,I))).then(()=>f.length>y+g&&m(y+u))})};return m(0).then(()=>{if(d.length>0)throw new Ar("Error modifying one or more objects",d,p,h);return f.length})})})}delete(){var e=this._ctx,n=e.range;return tn(e)&&(e.isPrimKey&&!qf||n.type===3)?this._write(r=>{const{primaryKey:o}=e.table.core.schema,s=n;return e.table.core.count({trans:r,query:{index:o,range:s}}).then(i=>e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(({failures:a,lastResult:l,results:c,numFailures:u})=>{if(u)throw new Ar("Could not delete some values",Object.keys(a).map(d=>a[d]),i-u);return i-u}))}):this.modify(_o)}}const _o=(t,e)=>e.value=null;function Jf(t,e){return t<e?-1:t===e?0:1}function Yf(t,e){return t>e?-1:t===e?0:1}function He(t,e,n){var r=t instanceof il?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function nn(t){return new t.Collection(t,()=>al("")).limit(0)}function Xf(t,e,n,r,o,s){for(var i=Math.min(t.length,r.length),a=-1,l=0;l<i;++l){var c=e[l];if(c!==r[l])return o(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):o(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;o(t[l],c)<0&&(a=l)}return i<r.length&&s==="next"?t+n.substr(t.length):i<t.length&&s==="prev"?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function ur(t,e,n,r){var o,s,i,a,l,c,u,d=n.length;if(!n.every(f=>typeof f=="string"))return He(t,rl);function p(f){o=function(y){return y==="next"?g=>g.toUpperCase():g=>g.toLowerCase()}(f),s=function(y){return y==="next"?g=>g.toLowerCase():g=>g.toUpperCase()}(f),i=f==="next"?Jf:Yf;var m=n.map(function(y){return{lower:s(y),upper:o(y)}}).sort(function(y,g){return i(y.lower,g.lower)});a=m.map(function(y){return y.upper}),l=m.map(function(y){return y.lower}),c=f,u=f==="next"?"":r}p("next");var h=new t.Collection(t,()=>St(a[0],l[d-1]+r));h._ondirectionchange=function(f){p(f)};var v=0;return h._addAlgorithm(function(f,m,y){var g=f.key;if(typeof g!="string")return!1;var _=s(g);if(e(_,l,v))return!0;for(var x=null,C=v;C<d;++C){var D=Xf(g,_,a[C],l[C],i,c);D===null&&x===null?v=C+1:(x===null||i(x,D)>0)&&(x=D)}return m(x!==null?function(){f.continue(x+u)}:y),!1}),h}function St(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function al(t){return{type:1,lower:t,upper:t}}class il{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,o){r=r!==!1,o=o===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||o)&&(!r||!o)?nn(this):new this.Collection(this,()=>St(e,n,!r,!o))}catch{return He(this,pt)}}equals(e){return e==null?He(this,pt):new this.Collection(this,()=>al(e))}above(e){return e==null?He(this,pt):new this.Collection(this,()=>St(e,void 0,!0))}aboveOrEqual(e){return e==null?He(this,pt):new this.Collection(this,()=>St(e,void 0,!1))}below(e){return e==null?He(this,pt):new this.Collection(this,()=>St(void 0,e,!1,!0))}belowOrEqual(e){return e==null?He(this,pt):new this.Collection(this,()=>St(void 0,e))}startsWith(e){return typeof e!="string"?He(this,rl):this.between(e,e+zt,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):ur(this,(n,r)=>n.indexOf(r[0])===0,[e],zt)}equalsIgnoreCase(e){return ur(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=vt.apply(rn,arguments);return e.length===0?nn(this):ur(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=vt.apply(rn,arguments);return e.length===0?nn(this):ur(this,(n,r)=>r.some(o=>n.indexOf(o)===0),e,zt)}anyOf(){const e=vt.apply(rn,arguments);let n=this._cmp;try{e.sort(n)}catch{return He(this,pt)}if(e.length===0)return nn(this);const r=new this.Collection(this,()=>St(e[0],e[e.length-1]));r._ondirectionchange=s=>{n=s==="next"?this._ascending:this._descending,e.sort(n)};let o=0;return r._addAlgorithm((s,i,a)=>{const l=s.key;for(;n(l,e[o])>0;)if(++o,o===e.length)return i(a),!1;return n(l,e[o])===0||(i(()=>{s.continue(e[o])}),!1)}),r}notEqual(e){return this.inAnyRange([[Jo,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=vt.apply(rn,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return He(this,pt)}const n=e.reduce((r,o)=>r?r.concat([[r[r.length-1][1],o]]):[[Jo,o]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,o=this._ascending,s=this._descending,i=this._min,a=this._max;if(e.length===0)return nn(this);if(!e.every(g=>g[0]!==void 0&&g[1]!==void 0&&o(g[0],g[1])<=0))return He(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ce.InvalidArgument);const l=!n||n.includeLowers!==!1,c=n&&n.includeUppers===!0;let u,d=o;function p(g,_){return d(g[0],_[0])}try{u=e.reduce(function(g,_){let x=0,C=g.length;for(;x<C;++x){const D=g[x];if(r(_[0],D[1])<0&&r(_[1],D[0])>0){D[0]=i(D[0],_[0]),D[1]=a(D[1],_[1]);break}}return x===C&&g.push(_),g},[]),u.sort(p)}catch{return He(this,pt)}let h=0;const v=c?g=>o(g,u[h][1])>0:g=>o(g,u[h][1])>=0,f=l?g=>s(g,u[h][0])>0:g=>s(g,u[h][0])>=0;let m=v;const y=new this.Collection(this,()=>St(u[0][0],u[u.length-1][1],!l,!c));return y._ondirectionchange=g=>{g==="next"?(m=v,d=o):(m=f,d=s),u.sort(p)},y._addAlgorithm((g,_,x)=>{for(var C=g.key;m(C);)if(++h,h===u.length)return _(x),!1;return!!function(D){return!v(D)&&!f(D)}(C)||(this._cmp(C,u[h][1])===0||this._cmp(C,u[h][0])===0||_(()=>{d===o?g.continue(u[h][0]):g.continue(u[h][1])}),!1)}),y}startsWithAnyOf(){const e=vt.apply(rn,arguments);return e.every(n=>typeof n=="string")?e.length===0?nn(this):this.inAnyRange(e.map(n=>[n,n+zt])):He(this,"startsWithAnyOf() only works with strings")}}function lt(t){return Se(function(e){return Un(e),t(e.target.error),!1})}function Un(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const Kn="storagemutated",Ot="x-storagemutated-1",Nt=Rn(null,Kn);class Qf{_lock(){return In(!ae.global),++this._reculock,this._reculock!==1||ae.global||(ae.lockOwnerFor=this),this}_unlock(){if(In(!ae.global),--this._reculock==0)for(ae.global||(ae.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{_n(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&ae.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(In(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new ce.DatabaseClosed(r);case"MissingAPIError":throw new ce.MissingAPI(r.message,r);default:throw new ce.OpenFailed(r)}if(!this.active)throw new ce.TransactionInactive;return In(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Se(o=>{Un(o),this._reject(e.error)}),e.onabort=Se(o=>{Un(o),this.active&&this._reject(new ce.Abort(e.error)),this.active=!1,this.on("abort").fire(o)}),e.oncomplete=Se(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Nt.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return Fe(new ce.ReadOnly("Transaction is readonly"));if(!this.active)return Fe(new ce.TransactionInactive);if(this._locked())return new oe((s,i)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(s,i)},ae])});if(r)return Pt(()=>{var s=new oe((i,a)=>{this._lock();const l=n(i,a,this);l&&l.then&&l.then(i,a)});return s.finally(()=>this._unlock()),s._lib=!0,s});var o=new oe((s,i)=>{var a=n(s,i,this);a&&a.then&&a.then(s,i)});return o._lib=!0,o}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=oe.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var o=n.idbtrans.objectStore(n.storeNames[0]);(function i(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(o.get(-1/0).onsuccess=i)})()}var s=n._waitingFor;return new oe((i,a)=>{r.then(l=>n._waitingQueue.push(Se(i.bind(null,l))),l=>n._waitingQueue.push(Se(a.bind(null,l)))).finally(()=>{n._waitingFor===s&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ce.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(Je(n,e))return n[e];const r=this.schema[e];if(!r)throw new ce.NotFound("Table "+e+" not part of transaction");const o=new this.db.Table(e,r,this);return o.core=this.db.core.table(e),n[e]=o,o}}function Yo(t,e,n,r,o,s,i){return{name:t,keyPath:e,unique:n,multi:r,auto:o,compound:s,src:(n&&!i?"&":"")+(r?"*":"")+(o?"++":"")+ll(e)}}function ll(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function cl(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Li(n,r=>[r.name,r])}}let $n=t=>{try{return t.only([[]]),$n=()=>[[]],[[]]}catch{return $n=()=>zt,zt}};function Xo(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?r=>r[e]:r=>xt(r,e)}(t):e=>xt(e,t)}function Sa(t){return[].slice.call(t)}let eh=0;function Tn(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function th(t,e,n){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:c,upper:u,lowerOpen:d,upperOpen:p}=l;return c===void 0?u===void 0?null:e.upperBound(u,!!p):u===void 0?e.lowerBound(c,!!d):e.bound(c,u,!!d,!!p)}const{schema:o,hasGetAll:s}=function(l,c){const u=Sa(l.objectStoreNames);return{schema:{name:l.name,tables:u.map(d=>c.objectStore(d)).map(d=>{const{keyPath:p,autoIncrement:h}=d,v=ze(p),f=p==null,m={},y={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:f,compound:v,keyPath:p,autoIncrement:h,unique:!0,extractKey:Xo(p)},indexes:Sa(d.indexNames).map(g=>d.index(g)).map(g=>{const{name:_,unique:x,multiEntry:C,keyPath:D}=g,E={name:_,compound:ze(D),keyPath:D,unique:x,multiEntry:C,extractKey:Xo(D)};return m[Tn(D)]=E,E}),getIndexByKeyPath:g=>m[Tn(g)]};return m[":id"]=y.primaryKey,p!=null&&(m[Tn(p)]=y.primaryKey),y})},hasGetAll:u.length>0&&"getAll"in c.objectStore(u[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),i=o.tables.map(l=>function(c){const u=c.name;return{name:u,schema:c,mutate:function({trans:d,type:p,keys:h,values:v,range:f}){return new Promise((m,y)=>{m=Se(m);const g=d.objectStore(u),_=g.keyPath==null,x=p==="put"||p==="add";if(!x&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:C}=h||v||{length:1};if(h&&v&&h.length!==v.length)throw new Error("Given keys array must have same length as given values array.");if(C===0)return m({numFailures:0,failures:{},results:[],lastResult:void 0});let D;const E=[],F=[];let I=0;const R=j=>{++I,Un(j)};if(p==="deleteRange"){if(f.type===4)return m({numFailures:I,failures:F,results:[],lastResult:void 0});f.type===3?E.push(D=g.clear()):E.push(D=g.delete(r(f)))}else{const[j,M]=x?_?[v,h]:[v,null]:[h,null];if(x)for(let b=0;b<C;++b)E.push(D=M&&M[b]!==void 0?g[p](j[b],M[b]):g[p](j[b])),D.onerror=R;else for(let b=0;b<C;++b)E.push(D=g[p](j[b])),D.onerror=R}const K=j=>{const M=j.target.result;E.forEach((b,N)=>b.error!=null&&(F[N]=b.error)),m({numFailures:I,failures:F,results:p==="delete"?h:E.map(b=>b.result),lastResult:M})};D.onerror=j=>{R(j),K(j)},D.onsuccess=K})},getMany:({trans:d,keys:p})=>new Promise((h,v)=>{h=Se(h);const f=d.objectStore(u),m=p.length,y=new Array(m);let g,_=0,x=0;const C=E=>{const F=E.target;y[F._pos]=F.result,++x===_&&h(y)},D=lt(v);for(let E=0;E<m;++E)p[E]!=null&&(g=f.get(p[E]),g._pos=E,g.onsuccess=C,g.onerror=D,++_);_===0&&h(y)}),get:({trans:d,key:p})=>new Promise((h,v)=>{h=Se(h);const f=d.objectStore(u).get(p);f.onsuccess=m=>h(m.target.result),f.onerror=lt(v)}),query:function(d){return p=>new Promise((h,v)=>{h=Se(h);const{trans:f,values:m,limit:y,query:g}=p,_=y===1/0?void 0:y,{index:x,range:C}=g,D=f.objectStore(u),E=x.isPrimaryKey?D:D.index(x.name),F=r(C);if(y===0)return h({result:[]});if(d){const I=m?E.getAll(F,_):E.getAllKeys(F,_);I.onsuccess=R=>h({result:R.target.result}),I.onerror=lt(v)}else{let I=0;const R=m||!("openKeyCursor"in E)?E.openCursor(F):E.openKeyCursor(F),K=[];R.onsuccess=j=>{const M=R.result;return M?(K.push(m?M.value:M.primaryKey),++I===y?h({result:K}):void M.continue()):h({result:K})},R.onerror=lt(v)}})}(s),openCursor:function({trans:d,values:p,query:h,reverse:v,unique:f}){return new Promise((m,y)=>{m=Se(m);const{index:g,range:_}=h,x=d.objectStore(u),C=g.isPrimaryKey?x:x.index(g.name),D=v?f?"prevunique":"prev":f?"nextunique":"next",E=p||!("openKeyCursor"in C)?C.openCursor(r(_),D):C.openKeyCursor(r(_),D);E.onerror=lt(y),E.onsuccess=Se(F=>{const I=E.result;if(!I)return void m(null);I.___id=++eh,I.done=!1;const R=I.continue.bind(I);let K=I.continuePrimaryKey;K&&(K=K.bind(I));const j=I.advance.bind(I),M=()=>{throw new Error("Cursor not stopped")};I.trans=d,I.stop=I.continue=I.continuePrimaryKey=I.advance=()=>{throw new Error("Cursor not started")},I.fail=Se(y),I.next=function(){let b=1;return this.start(()=>b--?this.continue():this.stop()).then(()=>this)},I.start=b=>{const N=new Promise((A,X)=>{A=Se(A),E.onerror=lt(X),I.fail=X,I.stop=V=>{I.stop=I.continue=I.continuePrimaryKey=I.advance=M,A(V)}}),H=()=>{if(E.result)try{b()}catch(A){I.fail(A)}else I.done=!0,I.start=()=>{throw new Error("Cursor behind last entry")},I.stop()};return E.onsuccess=Se(A=>{E.onsuccess=H,H()}),I.continue=R,I.continuePrimaryKey=K,I.advance=j,H(),N},m(I)},y)})},count({query:d,trans:p}){const{index:h,range:v}=d;return new Promise((f,m)=>{const y=p.objectStore(u),g=h.isPrimaryKey?y:y.index(h.name),_=r(v),x=_?g.count(_):g.count();x.onsuccess=Se(C=>f(C.target.result)),x.onerror=lt(m)})}}}(l)),a={};return i.forEach(l=>a[l.name]=l),{stack:"dbcore",transaction:t.transaction.bind(t),table(l){if(!a[l])throw new Error(`Table '${l}' not found`);return a[l]},MIN_KEY:-1/0,MAX_KEY:$n(e),schema:o}}function Qo({_novip:t},e){const n=e.db,r=function(o,s,{IDBKeyRange:i,indexedDB:a},l){return{dbcore:function(u,d){return d.reduce((p,{create:h})=>({...p,...h(p)}),u)}(th(s,i,l),o.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(o=>{const s=o.name;t.core.schema.tables.some(i=>i.name===s)&&(o.core=t.core.table(s),t[s]instanceof t.Table&&(t[s].core=o.core))})}function Mr({_novip:t},e,n,r){n.forEach(o=>{const s=r[o];e.forEach(i=>{const a=Ts(i,o);(!a||"value"in a&&a.value===void 0)&&(i===t.Transaction.prototype||i instanceof t.Transaction?_t(i,o,{get(){return this.table(o)},set(l){Mi(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):i[o]=new t.Table(o,s))})})}function es({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function nh(t,e){return t._cfg.version-e._cfg.version}function rh(t,e,n,r){const o=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,o);s.create(n),s._completion.catch(r);const i=s._reject.bind(s),a=ae.transless||ae;Pt(()=>{ae.trans=s,ae.transless=a,e===0?(Ne(o).forEach(l=>{xo(n,l,o[l].primKey,o[l].indexes)}),Qo(t,n),oe.follow(()=>t.on.populate.fire(s)).catch(i)):function({_novip:l},c,u,d){const p=[],h=l._versions;let v=l._dbSchema=ns(l,l.idbdb,d),f=!1;const m=h.filter(g=>g._cfg.version>=c);function y(){return p.length?oe.resolve(p.shift()(u.idbtrans)).then(y):oe.resolve()}return m.forEach(g=>{p.push(()=>{const _=v,x=g._cfg.dbschema;rs(l,_,d),rs(l,x,d),v=l._dbSchema=x;const C=ul(_,x);C.add.forEach(E=>{xo(d,E[0],E[1].primKey,E[1].indexes)}),C.change.forEach(E=>{if(E.recreate)throw new ce.Upgrade("Not yet support for changing primary key");{const F=d.objectStore(E.name);E.add.forEach(I=>ts(F,I)),E.change.forEach(I=>{F.deleteIndex(I.name),ts(F,I)}),E.del.forEach(I=>F.deleteIndex(I))}});const D=g._cfg.contentUpgrade;if(D&&g._cfg.version>c){Qo(l,d),u._memoizedTables={},f=!0;let E=Wi(x);C.del.forEach(K=>{E[K]=_[K]}),es(l,[l.Transaction.prototype]),Mr(l,[l.Transaction.prototype],Ne(E),E),u.schema=E;const F=Ms(D);let I;F&&bn();const R=oe.follow(()=>{if(I=D(u),I&&F){var K=Et.bind(null,null);I.then(K,K)}});return I&&typeof I.then=="function"?oe.resolve(I):R.then(()=>I)}}),p.push(_=>{(!f||!Hf)&&function(x,C){[].slice.call(C.db.objectStoreNames).forEach(D=>x[D]==null&&C.db.deleteObjectStore(D))}(g._cfg.dbschema,_),es(l,[l.Transaction.prototype]),Mr(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),u.schema=l._dbSchema})}),y().then(()=>{var g,_;_=d,Ne(g=v).forEach(x=>{_.db.objectStoreNames.contains(x)||xo(_,x,g[x].primKey,g[x].indexes)})})}(t,e,s,n).catch(i)})}function ul(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const o=t[r],s=e[r];if(o){const i={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||o.primKey.auto!==s.primKey.auto&&!so)i.recreate=!0,n.change.push(i);else{const a=o.idxByName,l=s.idxByName;let c;for(c in a)l[c]||i.del.push(c);for(c in l){const u=a[c],d=l[c];u?u.src!==d.src&&i.change.push(d):i.add.push(d)}(i.del.length>0||i.add.length>0||i.change.length>0)&&n.change.push(i)}}else n.add.push([r,s])}return n}function xo(t,e,n,r){const o=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(s=>ts(o,s)),o}function ts(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function ns(t,e,n){const r={};return Pr(e.objectStoreNames,0).forEach(o=>{const s=n.objectStore(o);let i=s.keyPath;const a=Yo(ll(i),i||"",!1,!1,!!s.autoIncrement,i&&typeof i!="string",!0),l=[];for(let u=0;u<s.indexNames.length;++u){const d=s.index(s.indexNames[u]);i=d.keyPath;var c=Yo(d.name,i,!!d.unique,!!d.multiEntry,!1,i&&typeof i!="string",!1);l.push(c)}r[o]=cl(o,a,l)}),r}function rs({_novip:t},e,n){const r=n.db.objectStoreNames;for(let o=0;o<r.length;++o){const s=r[o],i=n.objectStore(s);t._hasGetAll="getAll"in i;for(let a=0;a<i.indexNames.length;++a){const l=i.indexNames[a],c=i.index(l).keyPath,u=typeof c=="string"?c:"["+Pr(c).join("+")+"]";if(e[s]){const d=e[s].idxByName[u];d&&(d.name=l,delete e[s].idxByName[u],e[s].idxByName[l]=d)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Ce.WorkerGlobalScope&&Ce instanceof Ce.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class oh{_parseStoresSpec(e,n){Ne(e).forEach(r=>{if(e[r]!==null){var o=e[r].split(",").map((i,a)=>{const l=(i=i.trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Yo(l,c||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),ze(c),a===0)}),s=o.shift();if(s.multi)throw new ce.Schema("Primary key cannot be multi-valued");o.forEach(i=>{if(i.auto)throw new ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!i.keyPath)throw new ce.Schema("Index must have a name and cannot be an empty string")}),n[r]=cl(r,s,o)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?Ue(this._cfg.storesSource,e):e;const r=n._versions,o={};let s={};return r.forEach(i=>{Ue(o,i._cfg.storesSource),s=i._cfg.dbschema={},i._parseStoresSpec(o,s)}),n._dbSchema=s,es(n,[n._allTables,n,n.Transaction.prototype]),Mr(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],Ne(s),s),n._storeNames=Ne(s),this}upgrade(e){return this._cfg.contentUpgrade=Ls(this._cfg.contentUpgrade||xe,e),this}}function $s(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Vt(ao,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Vs(t){return t&&typeof t.databases=="function"}function os(t){return Pt(function(){return ae.letThrough=!0,t()})}function sh(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function ah(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?Fe(e.dbOpenError):t);ft&&(e.openCanceller._stackHolder=Yt()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function o(){if(e.openCanceller!==r)throw new ce.DatabaseClosed("db.open() was cancelled")}let s=e.dbReadyResolve,i=null,a=!1;return oe.race([r,(typeof navigator>"u"?oe.resolve():sh()).then(()=>new oe((l,c)=>{if(o(),!n)throw new ce.MissingAPI;const u=t.name,d=e.autoSchema?n.open(u):n.open(u,Math.round(10*t.verno));if(!d)throw new ce.MissingAPI;d.onerror=lt(c),d.onblocked=Se(t._fireOnBlocked),d.onupgradeneeded=Se(p=>{if(i=d.transaction,e.autoSchema&&!t._options.allowEmptyDB){d.onerror=Un,i.abort(),d.result.close();const v=n.deleteDatabase(u);v.onsuccess=v.onerror=Se(()=>{c(new ce.NoSuchDatabase(`Database ${u} doesnt exist`))})}else{i.onerror=lt(c);var h=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;a=h<1,t._novip.idbdb=d.result,rh(t,h/10,i,c)}},c),d.onsuccess=Se(()=>{i=null;const p=t._novip.idbdb=d.result,h=Pr(p.objectStoreNames);if(h.length>0)try{const f=p.transaction((v=h).length===1?v[0]:v,"readonly");e.autoSchema?function({_novip:m},y,g){m.verno=y.version/10;const _=m._dbSchema=ns(0,y,g);m._storeNames=Pr(y.objectStoreNames,0),Mr(m,[m._allTables],Ne(_),_)}(t,p,f):(rs(t,t._dbSchema,f),function(m,y){const g=ul(ns(0,m.idbdb,y),m._dbSchema);return!(g.add.length||g.change.some(_=>_.add.length||_.change.length))}(t,f)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Qo(t,f)}catch{}var v;Fn.push(t),p.onversionchange=Se(f=>{e.vcFired=!0,t.on("versionchange").fire(f)}),p.onclose=Se(f=>{t.on("close").fire(f)}),a&&function({indexedDB:f,IDBKeyRange:m},y){!Vs(f)&&y!==ao&&$s(f,m).put({name:y}).catch(xe)}(t._deps,u),l()},c)}))]).then(()=>(o(),e.onReadyBeingFired=[],oe.resolve(os(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let c=e.onReadyBeingFired.reduce(Ls,xe);return e.onReadyBeingFired=[],oe.resolve(os(()=>c(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{i&&i.abort()}catch{}return r===e.openCanceller&&t._close(),Fe(l)}).finally(()=>{e.openComplete=!0,s()})}function ss(t){var e=s=>t.next(s),n=o(e),r=o(s=>t.throw(s));function o(s){return i=>{var a=s(i),l=a.value;return a.done?l:l&&typeof l.then=="function"?l.then(n,r):ze(l)?Promise.all(l).then(n,r):n(l)}}return o(e)()}function ih(t,e,n){var r=arguments.length;if(r<2)throw new ce.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return n=o.pop(),[t,Ui(o),n]}function dl(t,e,n,r,o){return oe.resolve().then(()=>{const s=ae.transless||ae,i=t._createTransaction(e,n,t._dbSchema,r),a={trans:i,transless:s};if(r)i.idbtrans=r.idbtrans;else try{i.create(),t._state.PR1398_maxLoop=3}catch(d){return d.name===zs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>dl(t,e,n,null,o))):Fe(d)}const l=Ms(o);let c;l&&bn();const u=oe.follow(()=>{if(c=o.call(i,i),c)if(l){var d=Et.bind(null,null);c.then(d,d)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=ss(c))},a);return(c&&typeof c.then=="function"?oe.resolve(c).then(d=>i.active?d:Fe(new ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):u.then(()=>c)).then(d=>(r&&i._resolve(),i._completion.then(()=>d))).catch(d=>(i._reject(d),Fe(d)))})}function dr(t,e,n){const r=ze(t)?t.slice():[t];for(let o=0;o<n;++o)r.push(e);return r}const lh={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,o={},s=[];function i(u,d,p){const h=Tn(u),v=o[h]=o[h]||[],f=u==null?0:typeof u=="string"?1:u.length,m=d>0,y={...p,isVirtual:m,keyTail:d,keyLength:f,extractKey:Xo(u),unique:!m&&p.unique};return v.push(y),y.isPrimaryKey||s.push(y),f>1&&i(f===2?u[0]:u.slice(0,f-1),d+1,p),v.sort((g,_)=>g.keyTail-_.keyTail),y}const a=i(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[a];for(const u of r.indexes)i(u.keyPath,0,u);function l(u){const d=u.query.index;return d.isVirtual?{...u,query:{index:d,range:(p=u.query.range,h=d.keyTail,{type:p.type===1?2:p.type,lower:dr(p.lower,p.lowerOpen?t.MAX_KEY:t.MIN_KEY,h),lowerOpen:!0,upper:dr(p.upper,p.upperOpen?t.MIN_KEY:t.MAX_KEY,h),upperOpen:!0})}}:u;var p,h}return{...n,schema:{...r,primaryKey:a,indexes:s,getIndexByKeyPath:function(u){const d=o[Tn(u)];return d&&d[0]}},count:u=>n.count(l(u)),query:u=>n.query(l(u)),openCursor(u){const{keyTail:d,isVirtual:p,keyLength:h}=u.query.index;return p?n.openCursor(l(u)).then(v=>v&&function(f){return Object.create(f,{continue:{value:function(y){y!=null?f.continue(dr(y,u.reverse?t.MAX_KEY:t.MIN_KEY,d)):u.unique?f.continue(f.key.slice(0,h).concat(u.reverse?t.MIN_KEY:t.MAX_KEY,d)):f.continue()}},continuePrimaryKey:{value(y,g){f.continuePrimaryKey(dr(y,t.MAX_KEY,d),g)}},primaryKey:{get:()=>f.primaryKey},key:{get(){const y=f.key;return h===1?y[0]:y.slice(0,h)}},value:{get:()=>f.value}})}(v)):n.openCursor(u)}}}}}};function Hs(t,e,n,r){return n=n||{},r=r||"",Ne(t).forEach(o=>{if(Je(e,o)){var s=t[o],i=e[o];if(typeof s=="object"&&typeof i=="object"&&s&&i){const a=Bo(s);a!==Bo(i)?n[r+o]=e[o]:a==="Object"?Hs(s,i,n,r+o+"."):s!==i&&(n[r+o]=e[o])}else s!==i&&(n[r+o]=e[o])}else n[r+o]=void 0}),Ne(e).forEach(o=>{Je(t,o)||(n[r+o]=e[o])}),n}const ch={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(s){const i=ae.trans,{deleting:a,creating:l,updating:c}=i.table(e).hook;switch(s.type){case"add":if(l.fire===xe)break;return i._promise("readwrite",()=>u(s),!0);case"put":if(l.fire===xe&&c.fire===xe)break;return i._promise("readwrite",()=>u(s),!0);case"delete":if(a.fire===xe)break;return i._promise("readwrite",()=>u(s),!0);case"deleteRange":if(a.fire===xe)break;return i._promise("readwrite",()=>function(p){return d(p.trans,p.range,1e4)}(s),!0)}return n.mutate(s);function u(p){const h=ae.trans,v=p.keys||function(f,m){return m.type==="delete"?m.keys:m.keys||m.values.map(f.extractKey)}(r,p);if(!v)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:v}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(f,m,y){return m.type==="add"?Promise.resolve([]):f.getMany({trans:m.trans,keys:y,cache:"immutable"})}(n,p,v).then(f=>{const m=v.map((y,g)=>{const _=f[g],x={onerror:null,onsuccess:null};if(p.type==="delete")a.fire.call(x,y,_,h);else if(p.type==="add"||_===void 0){const C=l.fire.call(x,y,p.values[g],h);y==null&&C!=null&&(y=C,p.keys[g]=y,r.outbound||st(p.values[g],r.keyPath,y))}else{const C=Hs(_,p.values[g]),D=c.fire.call(x,C,y,_,h);if(D){const E=p.values[g];Object.keys(D).forEach(F=>{Je(E,F)?E[F]=D[F]:st(E,F,D[F])})}}return x});return n.mutate(p).then(({failures:y,results:g,numFailures:_,lastResult:x})=>{for(let C=0;C<v.length;++C){const D=g?g[C]:v[C],E=m[C];D==null?E.onerror&&E.onerror(y[C]):E.onsuccess&&E.onsuccess(p.type==="put"&&f[C]?p.values[C]:D)}return{failures:y,results:g,numFailures:_,lastResult:x}}).catch(y=>(m.forEach(g=>g.onerror&&g.onerror(y)),Promise.reject(y)))})}function d(p,h,v){return n.query({trans:p,values:!1,query:{index:r,range:h},limit:v}).then(({result:f})=>u({type:"delete",keys:f,trans:p}).then(m=>m.numFailures>0?Promise.reject(m.failures[0]):f.length<v?{failures:[],numFailures:0,lastResult:void 0}:d(p,{...h,lower:f[f.length-1],lowerOpen:!0},v)))}}}}})};function fl(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let o=0,s=0;o<e.keys.length&&s<t.length;++o)We(e.keys[o],t[s])===0&&(r.push(n?Jn(e.values[o]):e.values[o]),++s);return r.length===t.length?r:null}catch{return null}}const uh={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const o=fl(r.keys,r.trans._cache,r.cache==="clone");return o?oe.resolve(o):n.getMany(r).then(s=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?Jn(s):s},s))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function qs(t){return!("from"in t)}const yt=function(t,e){if(!this){const n=new yt;return t&&"d"in t&&Ue(n,t),n}Ue(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function Vn(t,e,n){const r=We(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(qs(t))return Ue(t,{from:e,to:n,d:1});const o=t.l,s=t.r;if(We(n,t.from)<0)return o?Vn(o,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Ia(t);if(We(e,t.to)>0)return s?Vn(s,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Ia(t);We(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),We(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const i=!t.r;o&&!t.l&&Br(t,o),s&&i&&Br(t,s)}function Br(t,e){qs(e)||function n(r,{from:o,to:s,l:i,r:a}){Vn(r,o,s),i&&n(r,i),a&&n(r,a)}(t,e)}function dh(t,e){const n=as(e);let r=n.next();if(r.done)return!1;let o=r.value;const s=as(t);let i=s.next(o.from),a=i.value;for(;!r.done&&!i.done;){if(We(a.from,o.to)<=0&&We(a.to,o.from)>=0)return!0;We(o.from,a.from)<0?o=(r=n.next(a.from)).value:a=(i=s.next(o.from)).value}return!1}function as(t){let e=qs(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&We(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||We(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Ia(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){const s=o==="r"?"l":"r",i={...t},a=t[o];t.from=a.from,t.to=a.to,t[o]=a[o],i[o]=a[s],t[s]=i,i.d=Oa(i)}t.d=Oa(t)}function Oa({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}mn(yt.prototype,{add(t){return Br(this,t),this},addKey(t){return Vn(this,t,t),this},addKeys(t){return t.forEach(e=>Vn(this,e,e)),this},[zo](){return as(this)}});const fh={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new yt(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const o=t.table(r),{schema:s}=o,{primaryKey:i}=s,{extractKey:a,outbound:l}=i,c={...o,mutate:p=>{const h=p.trans,v=h.mutatedParts||(h.mutatedParts={}),f=D=>{const E=`idb://${e}/${r}/${D}`;return v[E]||(v[E]=new yt)},m=f(""),y=f(":dels"),{type:g}=p;let[_,x]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const C=p.trans._cache;return o.mutate(p).then(D=>{if(ze(_)){g!=="delete"&&(_=D.results),m.addKeys(_);const E=fl(_,C);E||g==="add"||y.addKeys(_),(E||x)&&function(F,I,R,K){function j(M){const b=F(M.name||"");function N(A){return A!=null?M.extractKey(A):null}const H=A=>M.multiEntry&&ze(A)?A.forEach(X=>b.addKey(X)):b.addKey(A);(R||K).forEach((A,X)=>{const V=R&&N(R[X]),te=K&&N(K[X]);We(V,te)!==0&&(V!=null&&H(V),te!=null&&H(te))})}I.indexes.forEach(j)}(f,s,E,x)}else if(_){const E={from:_.lower,to:_.upper};y.add(E),m.add(E)}else m.add(n),y.add(n),s.indexes.forEach(E=>f(E.name).add(n));return D})}},u=({query:{index:p,range:h}})=>{var v,f;return[p,new yt((v=h.lower)!==null&&v!==void 0?v:t.MIN_KEY,(f=h.upper)!==null&&f!==void 0?f:t.MAX_KEY)]},d={get:p=>[i,new yt(p.key)],getMany:p=>[i,new yt().addKeys(p.keys)],count:u,query:u,openCursor:u};return Ne(d).forEach(p=>{c[p]=function(h){const{subscr:v}=ae;if(v){const f=x=>{const C=`idb://${e}/${r}/${x}`;return v[C]||(v[C]=new yt)},m=f(""),y=f(":dels"),[g,_]=d[p](h);if(f(g.name||"").add(_),!g.isPrimaryKey){if(p!=="count"){const x=p==="query"&&l&&h.values&&o.query({...h,values:!1});return o[p].apply(this,arguments).then(C=>{if(p==="query"){if(l&&h.values)return x.then(({result:E})=>(m.addKeys(E),C));const D=h.values?C.result.map(a):C.result;h.values?m.addKeys(D):y.addKeys(D)}else if(p==="openCursor"){const D=C,E=h.values;return D&&Object.create(D,{key:{get:()=>(y.addKey(D.primaryKey),D.key)},primaryKey:{get(){const F=D.primaryKey;return y.addKey(F),F}},value:{get:()=>(E&&m.addKey(D.primaryKey),D.value)}})}return C})}y.add(n)}}return o[p].apply(this,arguments)}}),c}}}};class Vt{constructor(e,n){this._middlewares={},this.verno=0;const r=Vt.dependencies;this._options=n={addons:Vt.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:o}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:xe,dbReadyPromise:null,cancelOpen:xe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var i;s.dbReadyPromise=new oe(a=>{s.dbReadyResolve=a}),s.openCanceller=new oe((a,l)=>{s.cancelOpen=l}),this._state=s,this.name=e,this.on=Rn(this,"populate","blocked","versionchange","close",{ready:[Ls,xe]}),this.on.ready.subscribe=Bi(this.on.ready.subscribe,a=>(l,c)=>{Vt.vip(()=>{const u=this._state;if(u.openComplete)u.dbOpenError||oe.resolve().then(l),c&&a(l);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(l),c&&a(l);else{a(l);const d=this;c||a(function p(){d.on.ready.unsubscribe(l),d.on.ready.unsubscribe(p)})}})}),this.Collection=(i=this,Sn(Zf.prototype,function(a,l){this.db=i;let c=sl,u=null;if(l)try{c=l()}catch(v){u=v}const d=a._ctx,p=d.table,h=p.hook.reading.fire;this._ctx={table:p,index:d.index,isPrimKey:!d.index||p.schema.primKey.keyPath&&d.index===p.schema.primKey.name,range:c,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:u,or:d.or,valueMapper:h!==Ln?h:null}})),this.Table=function(a){return Sn(Gf.prototype,function(l,c,u){this.db=a,this._tx=u,this.name=l,this.schema=c,this.hook=a._allTables[l]?a._allTables[l].hook:Rn(null,{creating:[Tf,xe],reading:[Rf,Ln],updating:[Bf,xe],deleting:[Mf,xe]})})}(this),this.Transaction=function(a){return Sn(Qf.prototype,function(l,c,u,d,p){this.db=a,this.mode=l,this.storeNames=c,this.schema=u,this.chromeTransactionDurability=d,this.idbtrans=null,this.on=Rn(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new oe((h,v)=>{this._resolve=h,this._reject=v}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},h=>{var v=this.active;return this.active=!1,this.on.error.fire(h),this.parent?this.parent._reject(h):v&&this.idbtrans&&this.idbtrans.abort(),Fe(h)})})}(this),this.Version=function(a){return Sn(oh.prototype,function(l){this.db=a,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(a){return Sn(il.prototype,function(l,c,u){this.db=a,this._ctx={table:l,index:c===":id"?null:c,or:u};const d=a._deps.indexedDB;if(!d)throw new ce.MissingAPI;this._cmp=this._ascending=d.cmp.bind(d),this._descending=(p,h)=>d.cmp(h,p),this._max=(p,h)=>d.cmp(p,h)>0?p:h,this._min=(p,h)=>d.cmp(p,h)<0?p:h,this._IDBKeyRange=a._deps.IDBKeyRange})}(this),this.on("versionchange",a=>{a.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",a=>{!a.newVersion||a.newVersion<a.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${a.oldVersion/10}`)}),this._maxKey=$n(n.IDBKeyRange),this._createTransaction=(a,l,c,u)=>new this.Transaction(a,l,c,this._options.chromeTransactionDurability,u),this._fireOnBlocked=a=>{this.on("blocked").fire(a),Fn.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(a))},this.use(lh),this.use(ch),this.use(fh),this.use(uh),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(a=>a(this))}version(e){if(isNaN(e)||e<.1)throw new ce.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(o=>o._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(nh),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||ae.letThrough||this._vip)?e():new oe((n,r)=>{if(this._state.openComplete)return r(new ce.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new ce.DatabaseClosed);this.open().catch(xe)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:o}){o&&this.unuse({stack:e,name:o});const s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:n,level:r??10,name:o}),s.sort((i,a)=>i.level-a.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(o=>r?o.create!==r:!!n&&o.name!==n)),this}open(){return ah(this)}_close(){const e=this._state,n=Fn.indexOf(this);if(n>=0&&Fn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new oe(r=>{e.dbReadyResolve=r}),e.openCanceller=new oe((r,o)=>{e.cancelOpen=o})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new ce.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new oe((r,o)=>{const s=()=>{this.close();var i=this._deps.indexedDB.deleteDatabase(this.name);i.onsuccess=Se(()=>{(function({indexedDB:a,IDBKeyRange:l},c){!Vs(a)&&c!==ao&&$s(a,l).delete(c).catch(xe)})(this._deps,this.name),r()}),i.onerror=lt(o),i.onblocked=this._fireOnBlocked};if(e)throw new ce.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Ne(this._allTables).map(e=>this._allTables[e])}transaction(){const e=ih.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let o=ae.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);const s=e.indexOf("?")!==-1;let i,a;e=e.replace("!","").replace("?","");try{if(a=n.map(c=>{var u=c instanceof this.Table?c.name:c;if(typeof u!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return u}),e=="r"||e===vo)i=vo;else{if(e!="rw"&&e!=go)throw new ce.InvalidArgument("Invalid transaction mode: "+e);i=go}if(o){if(o.mode===vo&&i===go){if(!s)throw new ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&a.forEach(c=>{if(o&&o.storeNames.indexOf(c)===-1){if(!s)throw new ce.SubTransaction("Table "+c+" not included in parent transaction.");o=null}}),s&&o&&!o.active&&(o=null)}}catch(c){return o?o._promise(null,(u,d)=>{d(c)}):Fe(c)}const l=dl.bind(null,this,i,a,o,r);return o?o._promise(i,l,"lock"):ae.trans?_n(ae.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!Je(this._allTables,e))throw new ce.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const hh=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class ph{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[hh](){return this}}function hl(t,e){return Ne(e).forEach(n=>{Br(t[n]||(t[n]=new yt),e[n])}),t}function mh(t){let e,n=!1;const r=new ph(o=>{const s=Ms(t);let i=!1,a={},l={};const c={get closed(){return i},unsubscribe:()=>{i=!0,Nt.storagemutated.unsubscribe(h)}};o.start&&o.start(c);let u=!1,d=!1;function p(){return Ne(l).some(f=>a[f]&&dh(a[f],l[f]))}const h=f=>{hl(a,f),p()&&v()},v=()=>{if(u||i)return;a={};const f={},m=function(y){s&&bn();const g=()=>Pt(t,{subscr:y,trans:null}),_=ae.trans?_n(ae.transless,g):g();return s&&_.then(Et,Et),_}(f);d||(Nt(Kn,h),d=!0),u=!0,Promise.resolve(m).then(y=>{n=!0,e=y,u=!1,i||(p()?v():(a={},l=f,o.next&&o.next(y)))},y=>{u=!1,n=!1,o.error&&o.error(y),c.unsubscribe()})};return v(),c});return r.hasValue=()=>n,r.getValue=()=>e,r}let is;try{is={indexedDB:Ce.indexedDB||Ce.mozIndexedDB||Ce.webkitIndexedDB||Ce.msIndexedDB,IDBKeyRange:Ce.IDBKeyRange||Ce.webkitIDBKeyRange}}catch{is={indexedDB:null,IDBKeyRange:null}}const Bt=Vt;function _r(t){let e=gt;try{gt=!0,Nt.storagemutated.fire(t)}finally{gt=e}}mn(Bt,{...mr,delete:t=>new Bt(t,{addons:[]}).delete(),exists:t=>new Bt(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return Vs(e)?Promise.resolve(e.databases()).then(r=>r.map(o=>o.name).filter(o=>o!==ao)):$s(e,n).toCollection().primaryKeys()}(Bt.dependencies).then(t)}catch{return Fe(new ce.MissingAPI)}},defineClass:()=>function(t){Ue(this,t)},ignoreTransaction:t=>ae.trans?_n(ae.transless,t):t(),vip:os,async:function(t){return function(){try{var e=ss(t.apply(this,arguments));return e&&typeof e.then=="function"?e:oe.resolve(e)}catch(n){return Fe(n)}}},spawn:function(t,e,n){try{var r=ss(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:oe.resolve(r)}catch(o){return Fe(o)}},currentTransaction:{get:()=>ae.trans||null},waitFor:function(t,e){const n=oe.resolve(typeof t=="function"?Bt.ignoreTransaction(t):t).timeout(e||6e4);return ae.trans?ae.trans.waitFor(n):n},Promise:oe,debug:{get:()=>ft,set:t=>{$i(t,t==="dexie"?()=>!0:ol)}},derive:an,extend:Ue,props:mn,override:Bi,Events:Rn,on:Nt,liveQuery:mh,extendObservabilitySet:hl,getByKeyPath:xt,setByKeyPath:st,delByKeyPath:function(t,e){typeof e=="string"?st(t,e,void 0):"length"in e&&[].map.call(e,function(n){st(t,n,void 0)})},shallowClone:Wi,deepClone:Jn,getObjectDiff:Hs,cmp:We,asap:zi,minKey:Jo,addons:[],connections:Fn,errnames:zs,dependencies:is,semVer:_a,version:_a.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),Bt.maxKey=$n(Bt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Nt(Kn,t=>{if(!gt){let e;so?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Ot,!0,!0,t)):e=new CustomEvent(Ot,{detail:t}),gt=!0,dispatchEvent(e),gt=!1}}),addEventListener(Ot,({detail:t})=>{gt||_r(t)}));let gt=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(Ot);typeof t.unref=="function"&&t.unref(),Nt(Kn,e=>{gt||t.postMessage(e)}),t.onmessage=e=>{e.data&&_r(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Nt(Kn,e=>{try{gt||(typeof localStorage<"u"&&localStorage.setItem(Ot,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:Ot,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===Ot){const n=JSON.parse(e.newValue);n&&_r(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===Ot&&_r(e.changedParts)})}oe.rejectionMapper=function(t,e){if(!t||t instanceof ln||t instanceof TypeError||t instanceof SyntaxError||!t.name||!va[t.name])return t;var n=new va[t.name](e||t.message,t);return"stack"in t&&_t(n,"stack",{get:function(){return this.inner.stack}}),n},$i(ft,ol);var yh=(t=>(t.SAVE="save",t.SAVE_AS="saveAs",t.openSpotlightSearch="openSpotlightSearch",t))(yh||{}),xr=(t=>(t.MOVE_TO_ROOT_FOLDER="moveToRootFolder",t.DELETE="delete",t))(xr||{});const vh="comfyui_workspace_db";class gh extends Vt{constructor(){super(vh);Ie(this,"workflows");Ie(this,"changelogs");Ie(this,"media");Ie(this,"folders");Ie(this,"tags");Ie(this,"userSettings");Ie(this,"models");Ie(this,"cache");Ie(this,"workflowVersions");this.version(1).stores({workflows:"&id, name, parentFolderID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id"}).upgrade(n=>{}),this.version(2).stores({workflows:"&id, name, parentFolderID,cloudID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id",workflowVersions:"&id, name, workflowID,cloudID"}).upgrade(n=>{})}}const ie=new gh,wh="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let ls=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=wh[n[t]&63];return e};class Xt{constructor(e){Ie(this,"tableName");this.tableName=e}async saveDiskDB(){const e=await ie[this.tableName].toArray(),n={};e.forEach(r=>{r.id?n[r.id]=r:r.name?n[r.name]=r:console.error("TableBaseModel should have id or name")});try{vf(this.tableName,JSON.stringify(n))}catch(r){console.error("error saving disk db",r)}}async add(e){return e.id||(e.id=ls()),e.createTime||(e.createTime=Date.now()),await ie[this.tableName].add(e),await this.saveDiskDB(),e}async put(e){return await ie[this.tableName].put(e),await this.saveDiskDB(),e}async bulkPut(e){await ie[this.tableName].bulkPut(e),this.saveDiskDB()}async update(e,n){return await ie[this.tableName].update(e,n),this.saveDiskDB(),await this.get(e)??null}async listAll(){return await ie[this.tableName].toArray()}async filter(e){return await ie[this.tableName].filter(e).toArray()}async batchQuery(e){return await ie[this.tableName].bulkGet(e)}async getRecords(){console.warn("[DEPRECATED] getRecords() call, should only be used for one-time backfill for indexdb",this.tableName);const e=await yf(this.tableName);let n;try{n=e!=null?JSON.parse(e):null}catch{}if(n==null){const r=await Ef()??"{}";n=JSON.parse(r)[this.tableName]}return n??{}}async get(e){return await ie[this.tableName].get(e)}async delete(e){await ie[this.tableName].delete(e),this.saveDiskDB()}async listByIndex(e,n){return await ie[this.tableName].where(e).equals(n).toArray()}}const bh=80,Lr=class Lr extends Xt{constructor(){super("changelogs")}static async load(){return new Lr}async listByWorkflowID(e){return await ie.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime")}async getLastestByWorkflowID(e){return(await this.listByWorkflowID(e))[0]}async create(e){const n=await this.getLastestByWorkflowID(e.workflowID);if(n!=null&&n.json===e.json)return null;const r={id:Dr(),json:e.json,workflowID:e.workflowID,createTime:Date.now(),isAutoSave:e.isAutoSave};return await this.deleteLogsExceedLimit(e.workflowID),await ie.changelogs.add(r),r}async deleteLogsExceedLimit(e){var o;const n=await ie.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime"),r=((o=G==null?void 0:G.settings)==null?void 0:o.maximumChangelogNumber)??bh;if(n.length>r){const s=n.slice(r);await ie.changelogs.bulkDelete(s.map(i=>i.id))}}};Ie(Lr,"TABLE_NAME","changelogs");let cs=Lr;const rm="CWM_WORKFLOWS_SORT_TYPE";var ct=(t=>(t.RECENTLY_OPENED="recentlyOpened",t.RECENTLY_MODIFIED="newest",t.OLDEST_MODIFIED="oldest",t.AZ="name A-Z",t.ZA="name Z-A",t))(ct||{});const om=[{title:"Import Workflows",type:"file"},{title:"Import Folder",type:"folder"}],_h="comfyspace_tracking",qe="workspace_info",xh=9999999,ko="upgrade_to_2way_sync",us=28,sm="SHORTCUT_TRIGGER_EVENT";function kr(...t){const e=t.filter(n=>n!=="").join("/");return Ft(e)}function Ft(t){let n=t.split("/").filter(r=>r!=="").join("/").replace(/\\/g,"/");return n=n.replace(/^\/+/,""),n}function Eo(t){return kr(t.parentFolderID??"",t.name+".json")}var Dt;(t=>{async function e({parentFolderID:a,name:l}){return Ft(`${a??""}/${l}`)}t.genFolderRelPath=e;async function n(a){await fetch("/workspace/folder/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Ft(a.id)})})}t.createFolder=n;async function r(a,l){const u=await(await fetch("/workspace/folder/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folder:a,newParentPath:l})})).json();u.error&&alert("Failed to move folder: "+u.error)}t.moveFolder=r;async function o(a){try{return await(await fetch("/workspace/folder/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a})})).text()}catch(l){console.error("Error deleting file:",l)}}t.deleteFolder=o;async function s(a){try{const c=await(await fetch("/workspace/file/count_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a})})).json();return c.error&&console.error("Error counting files:",c.error),c.count}catch(l){console.error("Error renaming file:",l)}return null}t.genFilesCountInFolder=s;async function i(a,l){try{const u=await(await fetch("/workspace/folder/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absPath:a,newName:l})})).json();u.error&&alert("Failed to rename folder: "+u.error)}catch(c){console.error("Error renaming file:",c)}}t.renameFolder=i})(Dt||(Dt={}));async function Dn(t){const e=await Gs(t);if(e==null)return;const n=await pl(t);await($==null?void 0:$.updateMetaInfo(t.id,{filePath:n??void 0}));const r=t.json,o=JSON.parse(r);o.extra[qe]={id:t.id,name:t.name},delete o.extra[_h],await gf(e,JSON.stringify(o))}async function Co(t){if(t.name==null)return;const e=await Gs(t);e!=null&&Ti(e)}async function Gs(t){let e=Eh(t.name)+".json",n=t.parentFolderID;for(;n!=null;){const r=await(Le==null?void 0:Le.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??void 0}return e??null}async function kh(t){let e="",n=t;for(;n!=null;){const r=await(Le==null?void 0:Le.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??null}return e}async function pl(t){const e=await Gs(t);let n=await(G==null?void 0:G.getSetting("myWorkflowsDir"));return n?(n.endsWith("/")||(n=n+"/"),n+e):(console.error("myWorkflowsDir is not set"),null)}async function am(t){if(await(G==null?void 0:G.getSetting("twoWaySync")))return await Dt.genFilesCountInFolder(t)??0;const n=await($==null?void 0:$.listAll())??[],r=await(Le==null?void 0:Le.listAll())??[],o=[t];let s=0;for(;o.length>0;){const i=o.shift();if(i){for(const l of n)l.parentFolderID===i&&s++;const a=r.filter(l=>l.parentFolderID===i).map(l=>l.id);a.length&&o.push(...a)}}return s}function Eh(t){return t=t.replace(/[\\/:*?"<>|]/g,"_"),t.trim()}function ml(t,e=!0,n=!1,r="-"){const o=new Date(t),s=String(o.getDate()).padStart(2,"0"),i=String(o.getMonth()+1).padStart(2,"0"),a=o.getFullYear(),l=String(o.getHours()).padStart(2,"0"),c=String(o.getMinutes()).padStart(2,"0"),u=String(o.getSeconds()).padStart(2,"0"),d=`${i}${r}${s}${r}${a}`;return e?d+` ${l}:${c}`:n?d+`:${u}`:d}async function Ch(t=!1){if(await(G==null?void 0:G.getSetting("twoWaySync")))return;const n=await($==null?void 0:$.listAll())??[];for(const r of n){const o=await pl(r);r.filePath!=o&&(r.filePath!=null&&await Ti(r.filePath,t),await Dn(r))}}const Er=(t,e=ct.RECENTLY_MODIFIED)=>{const n=[...t];switch(e){case ct.AZ:n.sort((r,o)=>r.name.localeCompare(o.name));break;case ct.ZA:n.sort((r,o)=>o.name.localeCompare(r.name));break;case ct.RECENTLY_MODIFIED:n.sort((r,o)=>o.updateTime-r.updateTime);break;case ct.OLDEST_MODIFIED:n.sort((r,o)=>r.updateTime-o.updateTime);break;case ct.RECENTLY_OPENED:n.sort((r,o)=>(o.lastOpenedTime??0)-(r.lastOpenedTime??0));break}return n};function Sh(t){const e=t.nodes,n=new Array,r=new Map,o=new Array;for(let s=0;s<t.nodes.length;++s){const i=t.nodes[s];if(i.inputs)for(const a of i.inputs)a.link&&(o.push(a.link),a.link=null);if(i.outputs)for(const a of i.outputs)a.links&&(o.concat(a.links),a.links=[]);r.set(i.id,s)}for(const s of t.links)o.includes(s[0])&&n.push([r.get(s[1]),s[2],r.get(s[3]),s[4],s[1]]);return JSON.stringify({nodes:e,links:n})}function im(t,e){let n=JSON.parse(t);if(!n||!n.nodes||n.nodes.length==0)return;const r=localStorage.getItem("litegrapheditor_clipboard");localStorage.setItem("litegrapheditor_clipboard",Sh(n));const o=we.canvas.graph_mouse;e&&(e[0]-=15,e[1]-=15,we.canvas.graph_mouse=e),we.canvas.pasteFromClipboard(),we.canvas.graph_mouse=o,r&&localStorage.setItem("litegrapheditor_clipboard",r)}const lm=t=>{var n;const e=(n=G==null?void 0:G.settings)==null?void 0:n.shortcuts;if(!e)return!1;for(const r in e){const s=e[r].split("+"),i={Control:t.ctrlKey,Shift:t.shiftKey,Alt:t.altKey,Command:t.metaKey,[t.key.toUpperCase()]:!0};for(const a in i)i[a]||delete i[a];if(s.length===Object.keys(i).length&&s.every(a=>i[a]))return r}};function cm(t){const e=["png","jpg","jpeg","gif","bmp","webp"],n=t.split(".").pop();return n!=null&&e.includes(n)}function Ih(t){return`/workspace/view_media?filename=${t}`}function Da(){const e=window.location.hash.slice(1).split("/").find(n=>n.includes("workspaceId@"));return e?e.split("@")[1]:null}function yl(t){const e=window.location.hash.slice(1).split("/"),n=e.findIndex(o=>o.includes("workspaceId@")),r=`workspaceId@${t}`;return n>=0?e[n]=r:e.push(r),`${e.join("/")}`}const Oh=t=>{const e=yl(t);window.open(`${window.location.origin}/#${e}`)},Cr={last_node_id:9,last_link_id:9,nodes:[{id:7,type:"CLIPTextEncode",pos:[413,389],size:{0:425.27801513671875,1:180.6060791015625},flags:{},order:3,mode:0,inputs:[{name:"clip",type:"CLIP",link:5}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[6],slot_index:0}],properties:{},widgets_values:["text, watermark"]},{id:6,type:"CLIPTextEncode",pos:[415,186],size:{0:422.84503173828125,1:164.31304931640625},flags:{},order:2,mode:0,inputs:[{name:"clip",type:"CLIP",link:3}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[4],slot_index:0}],properties:{},widgets_values:["beautiful scenery nature glass bottle landscape, , purple galaxy bottle,"]},{id:5,type:"EmptyLatentImage",pos:[473,609],size:{0:315,1:106},flags:{},order:1,mode:0,outputs:[{name:"LATENT",type:"LATENT",links:[2],slot_index:0}],properties:{},widgets_values:[512,512,1]},{id:3,type:"KSampler",pos:[863,186],size:{0:315,1:262},flags:{},order:4,mode:0,inputs:[{name:"model",type:"MODEL",link:1},{name:"positive",type:"CONDITIONING",link:4},{name:"negative",type:"CONDITIONING",link:6},{name:"latent_image",type:"LATENT",link:2}],outputs:[{name:"LATENT",type:"LATENT",links:[7],slot_index:0}],properties:{},widgets_values:[0x8e7ff42ed37e,!0,20,8,"euler","normal",1]},{id:8,type:"VAEDecode",pos:[1209,188],size:{0:210,1:46},flags:{},order:5,mode:0,inputs:[{name:"samples",type:"LATENT",link:7},{name:"vae",type:"VAE",link:8}],outputs:[{name:"IMAGE",type:"IMAGE",links:[9],slot_index:0}],properties:{}},{id:9,type:"SaveImage",pos:[1451,189],size:{0:210,1:26},flags:{},order:6,mode:0,inputs:[{name:"images",type:"IMAGE",link:9}],properties:{}},{id:4,type:"CheckpointLoaderSimple",pos:[26,474],size:{0:315,1:98},flags:{},order:0,mode:0,outputs:[{name:"MODEL",type:"MODEL",links:[1],slot_index:0},{name:"CLIP",type:"CLIP",links:[3,5],slot_index:1},{name:"VAE",type:"VAE",links:[8],slot_index:2}],properties:{},widgets_values:["v1-5-pruned-emaonly.ckpt"]}],links:[[1,4,0,3,0,"MODEL"],[2,5,0,3,3,"LATENT"],[3,4,1,6,0,"CLIP"],[4,6,0,3,1,"CONDITIONING"],[5,4,1,7,0,"CLIP"],[6,7,0,3,2,"CONDITIONING"],[7,3,0,8,0,"LATENT"],[8,4,2,8,1,"VAE"],[9,8,0,9,0,"IMAGE"]],groups:[],config:{},extra:{},version:.4};var Qe;(t=>{async function e(l,c){try{const d=await(await fetch("/workspace/file/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Eo(l),newParentPath:c})})).json();return d.error?(alert("Error moving file: "+d.error),!1):!0}catch(u){console.error("Error deleting file:",u)}}t.moveWorkflow=e;async function n(l,c){try{const d=await(await fetch("/workspace/file/gen_unique_name",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:kr(c??"",l)})})).json();return d.error?(console.error("Error getting unique name:",d.error),null):d.uniqueName}catch(u){console.error("Error deleting file:",u)}return null}t.genFileUniqueName=n;async function r({parentFolderID:l,name:c},u){try{const p=await(await fetch("/workspace/file/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:kr(l??"",c+".json"),newName:u})})).json();return p.error?(alert("Error rename file: "+p.error),!1):!0}catch(d){console.error("Error deleting file:",d)}}t.renameWorkflow=r;async function o(l){const c=l.json,u=JSON.parse(c);u.extra[qe]==null&&(u.extra[qe]={}),u.extra[qe].id=l.id;const p=await(await fetch("/workspace/file/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Eo(l),json:JSON.stringify(u)})})).json();if(p.error)throw console.error("Error saving file:",p.error),alert(`"Error saving file: ${p.error}
      
      👉Please try "Save as" from "Files" dropdown menu
      `),new Error(p.error);return p}t.saveWorkflow=o;async function s(l){try{return await(await fetch("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:Eo(l),deleteEmptyFolder:!1})})).text()}catch(c){alert("Error deleting workflow .json file: "+c),console.error("Error deleting file:",c)}}t.deleteWorkflow=s;async function i({parentFolderID:l,name:c,json:u,id:d}){var v;let p=JSON.parse(u);p.extra==null&&(p.extra={}),p.extra[qe]==null&&(p.extra[qe]={}),p.extra[qe].id=d;const h={parentFolderPath:Ft(l??""),name:c,json:JSON.stringify(p)};try{const m=await(await fetch("/workspace/create_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).json();return m.name&&await((v=ie.workflows)==null?void 0:v.update(d,{name:m.name})),m}catch(f){return console.error(`Error creating file <${d}> at "${l}"`,f),alert(`Error creating file <${d}> at "${l}"`),{}}}t.createWorkflow=i;async function a({parentFolderID:l,name:c,id:u}){const d=kr(l??"",c+".json");try{const h=await(await fetch("/workspace/get_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:d,id:u})})).json();return h.error&&(console.error(`Error getting file <${u}> at "${d}"`,h.error),alert({message:`Error getting file <${u}> at "${d}"`,level:"error"})),h}catch(p){return console.error(`Erro finding file <${u}> at "${d}"`,p),{}}}t.getFile=a})(Qe||(Qe={}));async function Zs(t,e=!1,n=!1){try{return await(await fetch("/workspace/file/scan_my_workflows_folder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Ft(t),recursive:e,metaInfoOnly:n})})).json()}catch(r){return console.error("Error scan local new files:",r),[]}}async function Dh(t,e){const n=Ft(t??""),o=(await Zs(n)).map(async a=>{var u;const l=a.name,c=[n,l].join("/");return jh(a)?{id:Ft(c),name:a.name,parentFolderID:n,type:"folder",createTime:Date.now(),updateTime:Date.now()}:{...await((u=ie.workflows)==null?void 0:u.get(a.id))??{createTime:Date.now(),updateTime:Date.now()},id:a.id,json:a.json??"{}",name:l.replace(/\.json$/,""),parentFolderID:n,createTime:a.createTime}}),s=await Promise.all(o);ie.workflows.bulkPut(s.filter(a=>!zh(a)));const i=s.filter(a=>a!=null);return Er(i,e??ct.RECENTLY_MODIFIED)}function jh(t){return"type"in t&&t.type==="folder"}const Wr=class Wr extends Xt{constructor(){super("workflows");Ie(this,"_curWorkflow",null)}get curWorkflow(){return this._curWorkflow}static async load(){return new Wr}updateCurWorkflowID(n){if(n==null){this._curWorkflow=null;return}this.get(n).then(r=>{this._curWorkflow=r??null})}updateCurWorkflow(n){this._curWorkflow=n}async latestVersionCheck(){if(this._curWorkflow){const n=await ie.workflows.get(this._curWorkflow.id);return n?(n==null?void 0:n.updateTime)===this._curWorkflow.updateTime:!0}return!0}async listByIndex(n,r){const o=await super.listByIndex(n,r);return await(G==null?void 0:G.getSetting("twoWaySync"))?(await Promise.all(o.map(async a=>await this.get(a.id)))).filter(a=>a!=null):o}async generateUniqueName(n,r){if(await(G==null?void 0:G.getSetting("twoWaySync"))){const l=await Qe.genFileUniqueName((n??"Untitled Flow")+".json",r??"");return(l==null?void 0:l.replace(/\.json$/,""))??"Untitled Flow"}let s=n??"Untitled Flow";const a=(await this.listAll()??[]).filter(l=>l.parentFolderID==r).map(l=>l.name);if(a.includes(s)){let l=2,c=!0;for(;c;)a.includes(`${s} ${l}`)?l++:(s=`${s} ${l}`,c=!1)}return s}async createFlow(n){const{name:r}=n,o=await this.generateUniqueName(r,n.parentFolderID??void 0),s=Date.now(),i={...n,id:n.id??ls(),json:n.json??JSON.stringify(Cr),name:o,updateTime:n.updateTime??s,createTime:n.createTime??s};return await ie.workflows.add(i),this.saveDiskDB(),await(G==null?void 0:G.getSetting("twoWaySync"))?(await Qe.createWorkflow(i),await this.get(i.id)):(Dn(i),i)}async update(n,r){throw new Error("Method not allowed.")}async updateTopFields(n,r){return this._update(n,r)}async updateMetaInfo(n,r){return this._update(n,r)}async _update(n,r){await ie.workflows.update(n,r);const o=await ie.workflows.get(n)??null;return this._curWorkflow&&this._curWorkflow.id===n&&(this._curWorkflow=o),this.saveDiskDB(),o}async updateFolder(n,r){var a;const o=await(G==null?void 0:G.getSetting("twoWaySync")),s=await this.get(n),i=await this.updateMetaInfo(n,r);!i||!s||(o?await Qe.moveWorkflow(s,r.parentFolderID):(await Dn(i),await Co(s),(i==null?void 0:i.parentFolderID)!=null&&await((a=ie.folders)==null?void 0:a.update(i.parentFolderID,{updateTime:Date.now()}))))}async genLastManualSavedJson(n){const r=await(Ge==null?void 0:Ge.getLastestByWorkflowID(n));return r==null?void 0:r.json}async updateName(n,r){const o=await this.get(n);return await(G==null?void 0:G.getSetting("twoWaySync"))&&o&&await Qe.renameWorkflow(o,r.name+".json"),await this.updateMetaInfo(n,r)}async updateFlow(n,r){const o=await this.get(n,!1);if(o==null)return;const s=JSON.stringify(o.json),i=JSON.stringify(r.json);if(s===i)return;const a=await this._update(n,{updateTime:Date.now(),json:r.json});await(G==null?void 0:G.getSetting("twoWaySync"))?a&&await Qe.saveWorkflow(a):a&&await Dn(a)}async batchCreateFlows(n=[],r=!1,o){var i,a;const s=[];for(const l of n){const c=l.name&&r?l.name:await this.generateUniqueName(l.name,o),u=ls(),d=Date.now(),p={id:u,name:c,json:l.json,parentFolderID:o,updateTime:d,createTime:d,tags:[]};if(s.push(p),await(G==null?void 0:G.getSetting("twoWaySync")))try{const v=JSON.parse(l.json),f=(a=(i=v==null?void 0:v.extra)==null?void 0:i[qe])==null?void 0:a.id;f&&(await this.get(f)||(p.id=f)),Qe.createWorkflow(p)}catch(v){console.error("batchCreateFlows error",v)}else await Dn(p)}try{await ie.workflows.bulkAdd(s),this.saveDiskDB()}catch(l){console.error("batchCreateFlows error",l)}}async deleteFlow(n){const r=await this.get(n);r&&(await(G==null?void 0:G.getSetting("twoWaySync"))?await Qe.deleteWorkflow(r):Co({...r})),await ie.workflows.delete(n),this.saveDiskDB()}async batchDeleteFlow(n){const r=await ie.workflows.bulkGet(n);for(const o of r){if(!o)return;await(G==null?void 0:G.getSetting("twoWaySync"))?await Qe.deleteWorkflow(o):Co({...o})}await ie.workflows.bulkDelete(n),this.saveDiskDB()}async listFolderContent(n,r){if(await(G==null?void 0:G.getSetting("twoWaySync"))){const l=await Dh(n??null);return Er(l,r??ct.RECENTLY_MODIFIED)}const s=await this.listAll().then(l=>l.filter(c=>c.parentFolderID==n))??[],i=await(Le==null?void 0:Le.listAll().then(l=>l.filter(c=>c.parentFolderID==n)))??[],a=[...s,...i];return Er(a,r??ct.RECENTLY_MODIFIED)}async get(n,r=!0){const o=await(G==null?void 0:G.getSetting("twoWaySync")),s=await ie.workflows.get(n);if(!o||!r)return s;if(s==null)return;const i=await Qe.getFile({parentFolderID:s.parentFolderID??null,name:s.name,id:s.id});if(i.json)return{...s,json:JSON.stringify(i.json)}}async listAll(n){const r=await(G==null?void 0:G.getSetting("twoWaySync"));let o;if(r){const i=(await Zs("",!0)).filter(a=>(a==null?void 0:a.type)==="workflow").map(async a=>{const l=await ie.workflows.get(a.id);return a.updateTime=(l==null?void 0:l.updateTime)??Date.now(),l!=null&&l.lastOpenedTime&&(a.lastOpenedTime=l==null?void 0:l.lastOpenedTime),a});o=await Promise.all(i)}else o=await ie.workflows.toArray();return n?Er(o,n):o}async updateLastOpenedTime(n){await ie.workflows.update(n,{lastOpenedTime:Date.now()})}};Ie(Wr,"TABLE_NAME","workflows");let ds=Wr;const Ur=class Ur extends Xt{constructor(){super("folders")}static async load(){return new Ur}async create(e){const n=await this.generateUniqueName(e.name,e.parentFolderID),r=await(G==null?void 0:G.getSetting("twoWaySync")),o=await Dt.genFolderRelPath({name:n,parentFolderID:e.parentFolderID??""}),s={id:r?o:Dr(),name:n,parentFolderID:e.parentFolderID??null,updateTime:Date.now(),createTime:Date.now(),type:"folder"};return r?await Dt.createFolder(s):(await ie.folders.add(s),this.saveDiskDB()),s}async update(e,n){if(await(G==null?void 0:G.getSetting("twoWaySync")))return"parentFolderID"in n&&await Dt.moveFolder(e,n.parentFolderID??""),"name"in n&&await Dt.renameFolder(e,n.name??""),null;const o=await this.get(e);if(o==null)return null;const s="name"in n&&n.name!=o.name,i="parentFolderID"in n&&n.parentFolderID!=o.parentFolderID,a={...o,...n};return n.name!=null&&(a.updateTime=Date.now()),i&&(n.name=await this.generateUniqueName(a.name,a.parentFolderID??void 0)),await ie.folders.update(e,n),this.saveDiskDB(),(s||i)&&Ch(!0),a}async deleteFolder(e,n=xr.DELETE){if(await(G==null?void 0:G.getSetting("twoWaySync"))){await Zs(e,!0,!0).then(a=>{a.forEach(l=>{l.type==="workflow"&&($==null||$.deleteFlow(l.id))})}),await Dt.deleteFolder(e);return}const o=await($==null?void 0:$.listAll())??[],s=await this.listAll(),i=[e];for(;i.length>0;){const a=i.shift();if(a){for(const c of o)if(c.parentFolderID===a)switch(n){case xr.DELETE:await($==null?void 0:$.deleteFlow(c.id));break;case xr.MOVE_TO_ROOT_FOLDER:await($==null?void 0:$.updateFolder(c.id,{parentFolderID:void 0}));break}await ie.folders.delete(a);const l=s.filter(c=>c.parentFolderID===a).map(c=>c.id);l.length&&i.push(...l)}}this.saveDiskDB()}async generateUniqueName(e,n){if(await(G==null?void 0:G.getSetting("twoWaySync")))return await Qe.genFileUniqueName(e??"New folder",n??"")??"New folder";let o=e??"New folder";const s=await this.listAll().then(i=>i.filter(a=>a.parentFolderID==n).map(a=>a.name));if(s.includes(o)){let i=2,a=!0;for(;a;)s.includes(`${o} ${i}`)?i++:(o=`${o} ${i}`,a=!1)}return o}};Ie(Ur,"TABLE_NAME","folders");let fs=Ur;function Ph(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=o=>{const s=new Uint8Array(o.target.result),i=new DataView(s.buffer);i.getUint32(0)!==2303741511&&(console.error("Not a valid PNG file"),n());let a=8;const l={};for(;a<s.length;){const c=i.getUint32(a),u=String.fromCharCode(...s.slice(a+4,a+8));if(u==="tEXt"||u=="comf"){let d=a+8;for(;s[d]!==0;)d++;const p=String.fromCharCode(...s.slice(a+8,d)),h=s.slice(d+1,a+8+c),v=Array.from(h).map(f=>String.fromCharCode(f)).join("");l[p]=v}a+=12+c}e(l)},r.readAsArrayBuffer(t)})}function Ah(t){const e=new Uint16Array(t.slice(0,2))[0]===18761;function n(i,a,l){const c=t.slice(i,i+l);if(l===2)return new DataView(c.buffer,c.byteOffset,c.byteLength).getUint16(0,a);if(l===4)return new DataView(c.buffer,c.byteOffset,c.byteLength).getUint32(0,a)}const r=n(4,e,4);function o(i){const a=n(i,e,2),l={};for(let c=0;c<a;c++){const u=i+2+c*12,d=n(u,e,2),p=n(u+2,e,2),h=n(u+4,e,4),v=n(u+8,e,4);let f;p===2&&(f=String.fromCharCode(...t.slice(v,v+h-1))),l[d]=f}return l}return o(r)}function Nh(t){return new Promise(e=>{const n=new FileReader;n.onload=r=>{var l;const o=new Uint8Array((l=r==null?void 0:r.target)==null?void 0:l.result),s=new DataView(o.buffer);if(s.getUint32(0)!==1380533830||s.getUint32(8)!==1464156752){console.error("Not a valid WEBP file"),e();return}let i=12;const a={};for(;i<o.length;){const c=s.getUint32(i+4,!0);if(String.fromCharCode(...o.slice(i,i+4))==="EXIF"){String.fromCharCode(...o.slice(i+8,i+8+6))=="Exif\0\0"&&(i+=6);const d=Ah(o.slice(i+8,i+8+c));for(const p in d){const h=d[p],v=h.indexOf(":");a[h.slice(0,v)]=h.slice(v+1)}}i+=8+c}e(a)},n.readAsArrayBuffer(t)})}function Fh(t){return!!(t!=null&&t.endsWith(".webm")||t!=null&&t.endsWith(".mp4"))}function Rh(t){return new Promise(e=>{const n=new FileReader;n.onload=r=>{const o=new Uint8Array(r.target.result),s=new DataView(o.buffer),i=new TextDecoder;if(s.getUint32(0)==440786851){let a=12;for(;a<o.length-16;){if(s.getUint16(a)==17543&&String.fromCharCode(...o.slice(a-7,a))==="COMMENT"){const c=s.getUint32(a+2),u=Math.clz32(c)+1;if(u<4){const d=c>>8*(4-u)&~(1<<7*u),p=i.decode(o.slice(a+2+u,a+2+u+d)),h=JSON.parse(p);e(h);return}}a+=1}}else if(s.getUint32(4)==1718909296&&s.getUint32(8)==1769172845){let a=o.length-4;for(;a>16;){if(s.getUint32(a)==1684108385&&s.getUint32(a-8)==2841865588){s.getUint32(a+4),s.getUint32(a+8);const l=s.getUint32(a-4)-4*4,c=i.decode(o.slice(a+12,a+12+l)),u=JSON.parse(c);e(u);return}a-=1}}else{console.error("Unknown magic: "+s.getUint32(0)),e();return}},n.readAsArrayBuffer(t)})}function Th(t){const e=t.split(".").pop();return fetch(t).then(n=>{if(!n.ok)throw new Error("Network response was not ok");return n.blob()}).then(async n=>{const r=t.split("/").pop()??"",o=new File([n],r);if(Fh(t))return Rh(o);if(e==="webp")return Nh(o);const s=await Ph(o),i=JSON.parse(s==null?void 0:s.prompt),a=JSON.parse(s==null?void 0:s.workflow);return{prompt:i,workflow:a}})}class vl extends Xt{constructor(){super("media")}async listByWorkflowID(e){return await ie.media.where("workflowID").equals(e).reverse().sortBy("createTime")}async create(e){const n=e.localPath.split(".").pop();if(n==null)return null;const r=await Th(`/workspace/view_media?filename=${e.localPath}`).catch(s=>(console.error("get meta error:",s),{prompt:""})),o={id:e.localPath,localPath:e.localPath,workflowID:e.workflowID,createTime:Date.now(),workflowJSON:JSON.stringify(r==null?void 0:r.prompt),format:n};return await($==null?void 0:$.updateMetaInfo(e.workflowID,{latestImage:o.localPath})),ie.media.put(o),this.saveDiskDB(),o}async delete(e){var n,r;super.delete(e),((n=$==null?void 0:$.curWorkflow)==null?void 0:n.coverMediaPath)===e&&($==null||$.updateMetaInfo($.curWorkflow.id,{coverMediaPath:void 0})),((r=$==null?void 0:$.curWorkflow)==null?void 0:r.latestImage)===e&&($==null||$.updateMetaInfo($.curWorkflow.id,{latestImage:void 0}))}}Ie(vl,"TABLE_NAME","media");const um=["Checkpoint","TextualInversion","Hypernetwork","LORA","Controlnet","Upscaler","VAE"],Mh={Checkpoint:"checkpoints",TextualInversion:"embeddings",Hypernetwork:"hypernetworks",LORA:"loras",Controlnet:"controlnet",Upscaler:"upscale_models",VAE:"vae"};function dm(t){return t.modelVersions!==void 0}function Bh(t){var e;return((e=t.files)==null?void 0:e[0])!==void 0}function fm(t,e){var r,o,s,i,a,l;if(!t)return;let n;return Bh(t)?n={id:t.id,SHA256:(o=(r=t.files)==null?void 0:r[0].hashes)==null?void 0:o.SHA256,name:(s=t.files)==null?void 0:s[0].name,sizeKB:(a=(i=t.files)==null?void 0:i[0])==null?void 0:a.sizeKB}:n={id:t.id,SHA256:(l=t.hashes)==null?void 0:l[2],name:`${e} ${t.name}`},n}const Kr=class Kr extends Xt{constructor(){super("userSettings");Ie(this,"defaultSettings");Ie(this,"DEFAULT_USER","guest");Ie(this,"_autoSave",!1);Ie(this,"_settings");this.defaultSettings={id:this.DEFAULT_USER,topBarStyle:{top:0,left:0},myWorkflowsDir:"",shortcuts:{save:"Shift+S",saveAs:"Control+Alt+S",openSpotlightSearch:"Control+P"},defaultFolders:Mh,autoSave:!1,autoSaveDuration:3,twoWaySync:!1,foldersOnTop:!1,cloudHost:"https://www.nodecafe.org",overwriteCurWorkflowWhenDroppingFileToCanvas:!1,maximumChangelogNumber:80,hideCoverImage:!1,disableUnsavedWarning:!1}}get settings(){return this._settings}get autoSave(){return this._autoSave}async getSetting(n){const r=await this.get(this.DEFAULT_USER);return n==="shortcuts"&&(r!=null&&r.shortcuts)?{...this.defaultSettings.shortcuts,...r.shortcuts}:(r==null?void 0:r[n])??this.defaultSettings[n]}async upsert(n){const o={...await this.get(this.DEFAULT_USER)??this.defaultSettings,...n};await this.put(o),this._settings={...this.defaultSettings,...o}}static async load(){const n=new Kr,r=await wf();return n.defaultSettings.myWorkflowsDir=r.path,await n.get(n.DEFAULT_USER).then(o=>{n._autoSave=(o==null?void 0:o.autoSave)??!1,n._settings={...n.defaultSettings,...o}}),await n.upsert({cloudHost:n.defaultSettings.cloudHost}),n}};Ie(Kr,"TABLE_NAME","userSettings");let hs=Kr;const $r=class $r extends Xt{constructor(){super("tags")}static async load(){return new $r}};Ie($r,"TABLE_NAME","tags");let ps=$r;const Vr=class Vr extends Xt{constructor(){super("workflowVersions")}static async load(){return new Vr}async listByWorkflowID(e){return await ie[this.tableName].where("workflowID").equals(e).reverse().sortBy("createTime")??[]}async getLatestByWorkflowID(e){const n=await this.listByWorkflowID(e);return n!=null&&n.length?n[0]:null}};Ie(Vr,"TABLE_NAME","workflowVersions");let ms=Vr;function zh(t){return"type"in t&&t.type==="folder"}let $=null,Sr=null,G=null,Le=null,Ge=null,Ht=null,be=null;async function Lh(){const t=async()=>{$=await ds.load()},e=async()=>{Sr=await ps.load()},n=async()=>{G=await hs.load()},r=async()=>{Le=await fs.load()},o=async()=>{Ge=await cs.load()},s=async()=>{Ht=new vl},i=async()=>{be=await ms.load()};await Promise.all([t(),e(),n(),r(),o(),s(),i()]),localStorage.getItem("WORKSPACE_INDEXDB_BACKFILL")!=="true"&&(await Wh(),localStorage.setItem("WORKSPACE_INDEXDB_BACKFILL","true"))}async function Wh(){const t=async()=>{try{const a=await($==null?void 0:$.getRecords());a&&await ie.workflows.bulkPut(Object.values(a))}catch(a){console.error(a)}},e=async()=>{try{const a=await(Le==null?void 0:Le.getRecords());a&&await ie.folders.bulkPut(Object.values(a))}catch(a){console.error(a)}},n=async()=>{try{const a=await(Ht==null?void 0:Ht.getRecords());a&&await ie.media.bulkPut(Object.values(a))}catch(a){console.error(a)}},r=async()=>{try{const a=await(Ge==null?void 0:Ge.getRecords());a&&await ie.changelogs.bulkPut(Object.values(a))}catch(a){console.error(a)}},o=async()=>{try{const a=await(Sr==null?void 0:Sr.getRecords());a&&await ie.tags.bulkPut(Object.values(a))}catch(a){console.error(a)}},s=async()=>{try{const a=G,l=await a.getRecords().then(c=>c[a.DEFAULT_USER]?c[a.DEFAULT_USER]:c);await ie.userSettings.put({...a.defaultSettings,...l})}catch(a){console.error(a)}},i=async()=>{try{const a=await(be==null?void 0:be.getRecords());a&&await ie.workflowVersions.bulkPut(Object.values(a))}catch(a){console.error(a)}};await Promise.all([t(),e(),n(),r(),o(),s(),i()])}const Ct=P.createContext({curFlowID:null,loadWorkflowID:()=>{},saveCurWorkflow:()=>{},discardUnsavedChanges:async()=>{},isDirty:!1,loadNewWorkflow:()=>{},loadFilePath:()=>{},setRoute:()=>{},route:"root",curVersion:null,setIsDirty:()=>{},setCurVersion:()=>{}}),hm=P.createContext({refreshFolderStamp:0,setRefreshFolderStamp:()=>{}}),So={x:0,y:0};function Uh({children:t,onDragEnd:e,dragIconId:n}){const r=P.useRef(So),o=P.useRef(!1),[s,i]=P.useState(So),a=d=>{var p,h,v;if(!(!(d.target instanceof Element)||!(d.target.parentNode instanceof Element))&&[(p=d.target)==null?void 0:p.id,(v=(h=d.target)==null?void 0:h.parentNode)==null?void 0:v.id].includes(n)){r.current={x:d.clientX,y:d.clientY},o.current=!0,window.addEventListener("mousemove",l),window.addEventListener("mouseup",c);const f=document.getElementsByTagName("body")[0];f.style.userSelect="none"}},l=P.useCallback(d=>{const p={x:d.clientX-r.current.x,y:d.clientY-r.current.y};i(p)},[]),c=P.useCallback(()=>{i(p=>(setTimeout(()=>{e(p)},0),So)),o.current=!1;const d=document.getElementsByTagName("body")[0];d.style.userSelect="auto",window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",c)},[e,l]),u={transform:`translate(${s.x}px, ${s.y}px)`,zIndex:o.current?1e3:1};return k.jsx("div",{style:u,onMouseDown:a,children:t})}var Kh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},$h=Object.defineProperty,Vh=Object.defineProperties,Hh=Object.getOwnPropertyDescriptors,zr=Object.getOwnPropertySymbols,gl=Object.prototype.hasOwnProperty,wl=Object.prototype.propertyIsEnumerable,ja=(t,e,n)=>e in t?$h(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pa=(t,e)=>{for(var n in e||(e={}))gl.call(e,n)&&ja(t,n,e[n]);if(zr)for(var n of zr(e))wl.call(e,n)&&ja(t,n,e[n]);return t},qh=(t,e)=>Vh(t,Hh(e)),Gh=(t,e)=>{var n={};for(var r in t)gl.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&zr)for(var r of zr(t))e.indexOf(r)<0&&wl.call(t,r)&&(n[r]=t[r]);return n},Pe=(t,e,n)=>{const r=P.forwardRef((o,s)=>{var i=o,{color:a="currentColor",size:l=24,stroke:c=2,children:u}=i,d=Gh(i,["color","size","stroke","children"]);return P.createElement("svg",Pa(qh(Pa({ref:s},Kh),{width:l,height:l,stroke:a,strokeWidth:c,className:`tabler-icon tabler-icon-${t}`}),d),[...n.map(([p,h])=>P.createElement(p,h)),...u||[]])});return r.propTypes={color:Mt.string,size:Mt.oneOfType([Mt.string,Mt.number]),stroke:Mt.oneOfType([Mt.string,Mt.number])},r.displayName=`${e}`,r},Zh=Pe("arrow-back-up-double","IconArrowBackUpDouble",[["path",{d:"M13 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M8 14l-4 -4l4 -4",key:"svg-1"}],["path",{d:"M9 10h7a4 4 0 1 1 0 8h-1",key:"svg-2"}]]),Jh=Pe("chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),ys=Pe("device-floppy","IconDeviceFloppy",[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]]),Aa=Pe("download","IconDownload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 11l5 5l5 -5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]),bl=Pe("external-link","IconExternalLink",[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]]),Yh=Pe("folder","IconFolder",[["path",{d:"M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2",key:"svg-0"}]]),Xh=Pe("grip-vertical","IconGripVertical",[["path",{d:"M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}],["path",{d:"M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-4"}],["path",{d:"M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-5"}]]),Qh=Pe("history","IconHistory",[["path",{d:"M12 8l0 4l2 2",key:"svg-0"}],["path",{d:"M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5",key:"svg-1"}]]),ep=Pe("info-circle","IconInfoCircle",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 9h.01",key:"svg-1"}],["path",{d:"M11 12h1v4h1",key:"svg-2"}]]),tp=Pe("link","IconLink",[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]]),_l=Pe("lock","IconLock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]),np=Pe("pencil","IconPencil",[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}]]),rp=Pe("photo","IconPhoto",[["path",{d:"M15 8h.01",key:"svg-0"}],["path",{d:"M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z",key:"svg-1"}],["path",{d:"M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5",key:"svg-2"}],["path",{d:"M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3",key:"svg-3"}]]),op=Pe("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),sp=Pe("refresh","IconRefresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]),ap=Pe("share-2","IconShare2",[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]]),ip=Pe("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]),xl=Pe("triangle-inverted-filled","IconTriangleInvertedFilled",[["path",{d:"M20.118 3h-16.225a2.914 2.914 0 0 0 -2.503 4.371l8.116 13.549a2.917 2.917 0 0 0 4.987 .005l8.11 -13.539a2.914 2.914 0 0 0 -2.486 -4.386z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}]]),lp=Pe("versions","IconVersions",[["path",{d:"M10 5m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 7l0 10",key:"svg-1"}],["path",{d:"M4 8l0 8",key:"svg-2"}]]),cp=Pe("world","IconWorld",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]]),up=Pe("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);function dp(t){const{promptMessage:e="Are you sure you want to delete this?",variant:n="ghost",onDelete:r,isDisabled:o=!1,tooltipText:s}=t;return k.jsx(ki,{isLazy:!0,placement:"auto",children:({onClose:i})=>k.jsxs(k.Fragment,{children:[k.jsx(xi,{children:k.jsx(jt,{children:k.jsx(bt,{hasArrow:!0,label:s,placement:"bottom",children:k.jsx(un,{"aria-label":"Delete confirm",size:"sm",icon:k.jsx(ip,{color:"#F56565",size:"20px"}),isDisabled:o,variant:n})})})}),k.jsxs(Oi,{children:[k.jsx(Ei,{}),k.jsx(Si,{onClick:i}),k.jsxs(Ci,{children:[k.jsx(wt,{mb:4,pr:4,fontWeight:600,children:e}),k.jsx(Te,{colorScheme:"red",size:"sm",onClick:()=>{r(),i()},children:"Yes, delete"})]})]})]})})}function fp({onClose:t}){Ua();const{curFlowID:e,isDirty:n,loadWorkflowID:r,curVersion:o}=P.useContext(Ct),[s,i]=P.useState(0),[a,l]=P.useState(null),[c,u]=P.useState([]),[d,p]=P.useState([]),h=async m=>{var C;const y=await($==null?void 0:$.get(m)),g=await(Ge==null?void 0:Ge.listByWorkflowID(m));u(g??[]);const _=g==null?void 0:g.filter(D=>D.json===(y==null?void 0:y.json)),x=(C=_==null?void 0:_[0])==null?void 0:C.id;x&&l(x)},v=async()=>{const m=await(be==null?void 0:be.listByWorkflowID(e))??[];p(m)},f=m=>{be==null||be.delete(m).then(()=>{v()})};return P.useEffect(()=>{switch(s){case 0:v();break;case 1:h(e);break}},[s]),P.useEffect(()=>(we.canvasEl.addEventListener("click",t),()=>{we.canvasEl.removeEventListener("click",t)}),[s]),k.jsxs(hc,{width:430,height:"100vh",gap:0,position:"fixed",top:0,left:0,zIndex:1e3,children:[k.jsx(fc,{pb:1,mb:0,children:k.jsxs(Wt,{justifyContent:"space-between",alignItems:"center",children:[k.jsx(sn,{size:"md",children:"Version History"}),k.jsx(un,{size:"sm",icon:k.jsx(up,{}),onClick:t,variant:"ghost","aria-label":"close version history"})]})}),k.jsx(dc,{overflowY:"auto",gap:0,children:k.jsxs(Pi,{isFitted:!0,variant:"enclosed",onChange:i,colorScheme:"teal",children:[k.jsxs(Ai,{mb:"1em",children:[k.jsx(Ro,{children:"Versions"}),k.jsx(Ro,{children:"Change History"})]}),k.jsxs(Ni,{children:[k.jsx(Fo,{children:k.jsx(Ke,{divider:k.jsx(jo,{}),spacing:2,children:d==null?void 0:d.map(m=>k.jsxs(Wt,{w:"100%",mb:1,justify:"space-between",backgroundColor:m.id===(o==null?void 0:o.id)?"teal.300":void 0,borderRadius:4,children:[k.jsxs(Ke,{textAlign:"left",gap:0,children:[k.jsx(wt,{fontWeight:"500",children:m.name??"untitled"}),k.jsxs(wt,{color:"GrayText",fontSize:"sm",children:["Created: ",ml(m.createTime)]})]}),k.jsxs(Wt,{alignItems:"center",gap:2,children:[k.jsx(Te,{size:"sm",onClick:()=>{if(n){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}we.loadGraphData(JSON.parse(m.json)),r(e,m.id),t()},children:"Load"}),k.jsx(dp,{promptMessage:"Are you sure you want to delete this version?",onDelete:()=>{f(m.id)}})]})]},m.id))})}),k.jsxs(Fo,{children:[k.jsx(wt,{mb:4,children:"All the saved changes of this workflow"}),k.jsx(Ke,{divider:k.jsx(jo,{}),spacing:2,children:c==null?void 0:c.map(m=>k.jsxs(ot,{justifyContent:"space-between",children:[k.jsxs(Te,{size:"sm",variant:"ghost",onClick:()=>{if(n){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}we.loadGraphData(JSON.parse(m.json)),$==null||$.updateFlow(e,{json:m.json}),t()},isActive:m.id===a,children:["Saved at ",new Date(m.createTime).toLocaleString()]},m.id),m.isAutoSave?k.jsx(Gt,{colorScheme:"teal",size:"sm",children:"Auto save"}):null]},m.id))})]})]})]})})]})}function hp({workflowId:t,onClose:e}){const[n,r]=P.useState(""),[o,s]=P.useState(""),i=l=>{r(l.target.value),o&&s("")},a=async()=>{const l=n.trim();if(r(l),(await(be==null?void 0:be.listByWorkflowID(t))??[]).some(u=>u.name===l))s("The name is duplicated, please modify it and submit again.");else{const u=JSON.stringify(we.graph.serialize());await(be==null?void 0:be.add({name:n,workflowID:t,createTime:Date.now(),json:u})),e()}};return k.jsxs(Gr,{isOpen:!0,onClose:e,children:[k.jsx(ws,{}),k.jsxs(Zr,{children:[k.jsx(bs,{children:"Create Version"}),k.jsx(_s,{}),k.jsx(Jr,{children:k.jsxs(Yr,{isInvalid:!!o,children:[k.jsx(Qr,{children:"Name"}),k.jsx(gn,{value:n,onChange:i,autoFocus:!0,onKeyUp:l=>{l.code==="Enter"&&!o&&n&&a()}}),o&&k.jsx(Xr,{children:o})]})}),k.jsxs(xs,{children:[k.jsx(Te,{colorScheme:"teal",mr:3,onClick:a,isDisabled:!n||!!o,children:"Create"}),k.jsx(Te,{onClick:e,children:"Cancel"})]})]})]})}function pp({options:t,menuButton:e,isOpen:n,onClose:r}){const o=P.useRef(null);return Bc({ref:o,handler:()=>r()}),k.jsxs(jt,{position:"relative",children:[k.jsx(jt,{children:e}),n&&k.jsx(jt,{ref:o,mt:"8px",shadow:"md",p:"2",position:"absolute",zIndex:"dropdown",children:t})]})}function mp({menuButton:t,menuContent:e,onClose:n}){const r=P.useRef(),[o,s]=P.useState(!1),i=()=>{r.current=setTimeout(()=>s(!1),400)},a=()=>{s(!0),clearTimeout(r.current),r.current=void 0};return k.jsx(pp,{isOpen:o,onClose:i,menuButton:k.jsx(jt,{"aria-label":"menu",onClick:a,onMouseEnter:a,onMouseLeave:i,children:t}),options:k.jsx(Fs,{isOpen:!0,children:k.jsx(Rs,{minWidth:150,zIndex:1e3,onMouseEnter:a,onMouseLeave:i,children:e})})})}const kl="WORKSPACE_CIVIT_API_KEY_STORAGE_KEY";function pm(){return localStorage.getItem(kl)}function mm(t){localStorage.setItem(kl,t)}function yp(t){return`https://civitai.com/api/download/models/${t}`}function vp(t,e){return e?`https://civitai.com/models/${t}?modelVersionId=${e}`:`https://civitai.com/models/${t}`}function El(t){return t.includes("huggingface")?t.replace("/resolve/","/blob/"):void 0}async function ym(t){var e,n;try{const r=`https://civitai.com/api/v1/model-versions/by-hash/${t}`,s=await(await fetch(r)).json();let i;if(await(G==null?void 0:G.getSetting("showNsfwModelThumbnail"))===!0)i=(n=(e=s==null?void 0:s.images)==null?void 0:e[0])==null?void 0:n.url;else if(!s.model.nsfw){const l=s.images.find(c=>c.nsfwLevel==1);i=l==null?void 0:l.url}return{modelName:s.model.name,civitModelID:String(s.modelId),civitModelVersionID:String(s.id),imageUrl:i??void 0}}catch{return{}}}async function gp(t,e,n){const r=await ie.models.where("fileName").equals(t).toArray()??[],o=r.at(0);return{filename:t,nodeType:e,fileHash:(o==null?void 0:o.fileHash)??null,fileFolder:(o==null?void 0:o.fileFolder)??null,downloadUrl:o!=null&&o.civitModelVersionID?yp(o.civitModelVersionID):(o==null?void 0:o.downloadUrl)??null,inputName:n,length:r.length,infoUrl:o!=null&&o.civitModelID?vp(o.civitModelID,o.civitModelVersionID):El((o==null?void 0:o.downloadUrl)??"")??null}}async function wp(t){var p,h;let e=[],n={};const r=[".ckpt",".pt",".bin",".pth",".safetensors"],o=[".jpeg",".jpg",".png",".gif",".webp"],s=(h=(p=we.graph.extra)==null?void 0:p[qe])==null?void 0:h.deps,i=await we.graphToPrompt();Object.values(i.output).forEach(v=>{v.inputs&&Object.keys(v.inputs).forEach(f=>{var y,g;const m=(y=v.inputs)==null?void 0:y[f];typeof m=="string"&&(r.some(_=>m.endsWith(_))&&e.push(gp(m,v.class_type,f)),o.some(_=>m.endsWith(_))&&(n[m]=((g=s==null?void 0:s.images)==null?void 0:g[m])??{filename:m,nodeType:v.class_type}))})});const l=await fetch("workspace/fetch_node_repos",{method:"POST",body:JSON.stringify({nodes:t.map(v=>v.type)})}).then(v=>v.ok?v.json():[]).catch(v=>(console.error("Error fetching node repos",v),[])),c=await Promise.all(e),u={};c.forEach(v=>{u[v.filename]=v});const d={};return Object.values(l).forEach(v=>{d[v.gitRepo]=v}),{models:u,images:n,nodeRepos:Object.values(d)}}function Cl(t,e){const n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=`${e}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}function bp(){const{setRoute:t,saveCurWorkflow:e}=P.useContext(Ct),[n,r]=P.useState(),[o,s]=P.useState({}),[i,a]=P.useState(!1),l=P.useCallback(async()=>{const f=we.graph.serialize();wp(f.nodes??[]).then(m=>{r(m)})},[]),c=P.useCallback(async()=>{r(void 0),await bf(),window.addEventListener("model_list_updated",()=>{l(),window.removeEventListener("model_list_updated",()=>{})})},[]);P.useEffect(()=>{l()},[]);const u=f=>!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(f),d=P.useCallback(f=>{let m=!0;return f.forEach(y=>{const g=y.filename;if(!y.downloadUrl){s(_=>({..._,[g]:"Invalid URL"})),m=!1;return}if(!u(y.downloadUrl)){s(_=>({..._,[g]:"Invalid URL"})),m=!1;return}if(!y.fileFolder){s(_=>({..._,[g]:"Model file not found, please re-scan models folder"})),m=!1;return}}),m},[]),p=async f=>{var E,F;f.preventDefault();const m=new FormData(f.target),y=Object.values((n==null?void 0:n.models)??{}).map(async I=>{var j,M;const R=(j=m.get(I.filename))==null?void 0:j.toString();if(R!=null&&R.length){const b=_p(I.filename);await ie.models.update(b+"@"+I.fileFolder,{downloadUrl:R})}const K=(M=I.infoUrl)!=null&&M.length?I.infoUrl:R?El(R):null;return{filename:I.filename,nodeType:I.nodeType,fileHash:I.fileHash,fileFolder:I.fileFolder,downloadUrl:R??I.downloadUrl??null,infoUrl:K??null,inputName:I.inputName}})??[],g=await Promise.all(y);if(!d(g))return;s({}),a(!0);const _=Object.values((n==null?void 0:n.images)??{}).filter(I=>!I.url).map(I=>I.filename),x=(n==null?void 0:n.images)??{};if(_.length){const R=await(await fetch("/workspace/upload_image",{method:"POST",body:JSON.stringify({images:_})})).json();Object.keys(R).forEach(K=>{x!=null&&x[K]&&(x[K].url=R[K])})}a(!1);const C={};g.forEach(I=>{C[I.filename]=I});const D=we.graph.serialize();(E=D.extra||(D.extra={}))[qe]||(E[qe]={}),D.extra[qe].deps={models:C,images:x??{},nodeRepos:(n==null?void 0:n.nodeRepos)??[]},e(),console.log("json",D),Cl(JSON.stringify(D,null,2),(((F=$==null?void 0:$.curWorkflow)==null?void 0:F.name)??"unknown")+".runner")},h=Object.values((n==null?void 0:n.images)??{}),v=Object.values((n==null?void 0:n.models)??[]);return k.jsx(Gr,{isOpen:!0,onClose:()=>t("root"),size:"xl",children:k.jsx(Zr,{children:k.jsxs(Jr,{p:5,gap:5,children:[k.jsxs(ot,{children:[k.jsx(sn,{size:"md",children:"Workflow Resouce Dependencies"}),k.jsx(bt,{label:`.runner.json workflows include all resource dependecy download urls
              (models, cursom nodes, input images) and can be one-click
              installed and run in any ComfyUI with workpace-manager installed.`,children:k.jsx(oi,{borderRadius:10,children:k.jsx(ep,{size:20})})})]}),k.jsx(wt,{color:"GrayText",children:"Export one-click installable workflow"}),n==null&&k.jsx(Xs,{size:"md",color:"teal.400"}),n&&k.jsx("form",{onSubmit:p,children:k.jsxs(Ke,{gap:5,mt:5,children:[k.jsxs(Ke,{children:[k.jsxs(sn,{size:"sm",children:["Models (",v.length,")"]}),v.map((f,m)=>k.jsx(xp,{modelFile:f,errors:o,onClickRefetchModelList:c},m))]}),h.length>0&&k.jsxs(Ke,{children:[k.jsxs(ot,{children:[k.jsxs(sn,{size:"sm",children:["Images (",h.length,")"]}),k.jsx("p",{style:{color:"GrayText"},children:"Will be uploaded as url"})]}),i&&k.jsxs("span",{children:[k.jsx(Xs,{size:"md",color:"teal.400"})," Uploading"]}),h.map(f=>k.jsxs(Ke,{children:[k.jsx("p",{children:f.filename}),k.jsx(Ha,{width:250,src:`/workspace/view_media?filename=${f.filename}&isPreview=true&isInput=true`})]},f.filename))]}),k.jsx(Te,{width:"fit-content",colorScheme:"teal",type:"submit",mt:4,children:"Download .runner.json"})]})})]})})})}function _p(t){const e=t.split(".");return e.length>1?(e.pop(),e.join(".")):t}function xp({modelFile:t,errors:e,onClickRefetchModelList:n}){const r=t.filename,[o,s]=P.useState(!t.downloadUrl);return t.fileFolder?k.jsxs(Ke,{ml:2,children:[k.jsxs(Wt,{gap:2,children:[k.jsx(Gt,{height:"fit-content",colorScheme:"teal",children:t.fileFolder}),t.downloadUrl?k.jsxs(ot,{children:[k.jsx("a",{href:t.infoUrl??t.downloadUrl,target:"_blank",children:t.filename}),k.jsx(bl,{size:18}),k.jsx(un,{ml:3,"aria-label":"edit",icon:k.jsx(np,{size:18}),size:"xs",onClick:()=>s(!o)})]}):k.jsx(Ke,{children:k.jsxs("span",{children:[t.filename," ",k.jsx("span",{children:"❓"})]})})]},t.filename+t.nodeType),k.jsx(Ke,{style:{display:o?"block":"none"},children:k.jsx(bt,{label:"Model download link, supports Huggingface and Civitai",children:k.jsx(gn,{name:r,defaultValue:t.downloadUrl??"",size:"sm",isInvalid:e[r]!=null,placeholder:"https://civitai.com/api/download/models/324524"})})}),k.jsx(wt,{color:"red.400",children:e[r]})]}):k.jsxs(Ke,{children:[k.jsxs(Wt,{gap:2,children:[k.jsx("p",{children:t.filename}),k.jsx(Gt,{size:"sm",colorScheme:"red",children:"Model file not found"})]}),k.jsx(Te,{size:"sm",leftIcon:k.jsx(sp,{}),width:"fit-content",borderColor:"red",borderWidth:e[r]!=null?2:0,onClick:n,children:"Fetch model file"})]})}const kp=P.lazy(()=>yn(()=>import("./ShareDialog-v08oH_7Y.js"),__vite__mapDeps([0,1,2,3,4])));function Ep(){var D;const{curFlowID:t,loadWorkflowID:e,discardUnsavedChanges:n,saveCurWorkflow:r,setRoute:o,route:s}=P.useContext(Ct),[i,a]=P.useState(!1),[l,c]=P.useState(""),[u,d]=P.useState(""),[p,h]=P.useState(),[v,f]=P.useState({save:"",saveAs:""}),[m,y]=P.useState(!1);P.useEffect(()=>{t&&($==null||$.get(t).then(E=>{c((E==null?void 0:E.name)??""),h(E)})),G==null||G.getSetting("shortcuts").then(E=>{f(E)})},[t]);const g=E=>{c(E.target.value),u&&d("")},_=async()=>{if(!t){alert("Flow ID is required");return}const E=JSON.stringify(we.graph.serialize()),F=await($==null?void 0:$.createFlow({json:E,name:l,parentFolderID:p==null?void 0:p.parentFolderID}));F&&await e(F.id,null,!0),x()},x=()=>{o("root")},C=P.useCallback(async()=>{const E=$==null?void 0:$.curWorkflow;if(!E){alert("No current workflow!");return}const F=we.graph.serialize(),I=JSON.stringify(F,null,2);Cl(I,E.name)},[t]);return k.jsxs(k.Fragment,{children:[k.jsx(mp,{menuButton:k.jsx(Ba,{children:k.jsxs(Te,{px:1,height:us+"px","aria-label":"menu",size:"sm",backgroundColor:"#434554",children:["File",k.jsx(Jh,{size:20})]})}),menuContent:k.jsx(Fs,{isOpen:!0,children:k.jsxs(Rs,{minWidth:150,zIndex:1e3,children:[k.jsx(mt,{onClick:r,icon:k.jsx(ys,{size:20}),iconSpacing:1,command:v.save,children:"Save"}),!((D=G==null?void 0:G.settings)!=null&&D.autoSave)&&k.jsx(bt,{label:"Revert workflow to your last saved version. You will lose all changes made since your last save.",children:k.jsx(mt,{onClick:n,icon:k.jsx(Zh,{size:20}),iconSpacing:1,children:"Discard unsaved changes"})}),k.jsx(mt,{onClick:C,icon:k.jsx(Aa,{size:20}),iconSpacing:1,children:"Download"}),k.jsxs(mt,{onClick:()=>o("downloadSpaceJson"),icon:k.jsx(Aa,{size:20}),iconSpacing:1,children:["Download .runner.json ",k.jsx(Gt,{size:"sm",children:"🧪beta"})]}),k.jsx(mt,{onClick:()=>o("saveAsModal"),icon:k.jsx(ys,{size:20}),iconSpacing:1,command:v.saveAs,children:"Save As"}),k.jsx(mt,{onClick:()=>a(!0),icon:k.jsx(lp,{size:20}),iconSpacing:1,children:"Create Version"}),k.jsx(mt,{onClick:()=>o("versionHistory"),icon:k.jsx(Qh,{size:20}),iconSpacing:1,children:"Versions History"}),k.jsx(mt,{onClick:()=>y(!0),icon:k.jsx(ap,{size:20}),iconSpacing:1,alignItems:"center",children:k.jsxs(ot,{children:[k.jsx("p",{children:"Share"})," ",k.jsx(Gt,{size:"sm",children:"🧪beta"})]})})]})})}),m&&k.jsx(kp,{onClose:()=>y(!1)}),s=="versionHistory"&&k.jsx(fp,{onClose:()=>o("root")}),s=="downloadSpaceJson"&&k.jsx(bp,{}),s==="saveAsModal"&&k.jsxs(Gr,{isOpen:!0,onClose:x,children:[k.jsx(ws,{}),k.jsxs(Zr,{children:[k.jsx(bs,{children:"Save As"}),k.jsx(_s,{}),k.jsx(Jr,{children:k.jsxs(Yr,{isInvalid:!!u,children:[k.jsx(Qr,{children:"Workflow name"}),k.jsx(gn,{value:l,onChange:g,autoFocus:!0,onKeyUp:E=>{E.code==="Enter"&&!u&&l&&_()}}),u&&k.jsx(Xr,{children:u})]})}),k.jsxs(xs,{children:[k.jsx(Te,{colorScheme:"teal",mr:3,onClick:_,isDisabled:!l||!!u,children:"Save"}),k.jsx(Te,{onClick:x,children:"Cancel"})]})]})]}),i&&k.jsx(hp,{workflowId:t,onClose:()=>a(!1)})]})}function Cp({displayName:t,updateFlowName:e,isDirty:n}){const{isOpen:r,onOpen:o,onClose:s}=Wc(),{curFlowID:i}=P.useContext(Ct),[a,l]=P.useState(t),[c,u]=P.useState(""),d=()=>{l(t),o()},p=f=>{l(f.target.value),c&&u("")},h=async()=>{var f;if(i){const m=a.trim();if(l(m),t===m)return v();await($==null?void 0:$.generateUniqueName(m,((f=$.curWorkflow)==null?void 0:f.parentFolderID)??""))!==m?u("The name is duplicated, please modify it and submit again."):(await($==null?void 0:$.updateName(i,{name:m})),e(m),v())}},v=()=>{u(""),s()};return i==null?null:k.jsxs(ot,{children:[k.jsx(bt,{label:t,placement:"bottom",children:k.jsxs(wt,{as:"div",color:"white",onClick:d,maxW:200,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:[k.jsx("div",{style:{width:8,display:"inline-block"},children:k.jsx(wt,{as:"span",children:n&&"* "})}),t]})}),k.jsxs(Gr,{isOpen:r,onClose:v,children:[k.jsx(ws,{}),k.jsxs(Zr,{children:[k.jsx(bs,{children:"Edit workflow name"}),k.jsx(_s,{}),k.jsx(Jr,{children:k.jsxs(Yr,{isInvalid:!!c,children:[k.jsx(Qr,{children:"Workflow name"}),k.jsx(gn,{value:a,onChange:p,autoFocus:!0,onKeyUp:f=>{f.code==="Enter"&&!c&&a&&h()}}),c&&k.jsx(Xr,{children:c})]})}),k.jsxs(xs,{children:[k.jsx(Te,{colorScheme:"teal",mr:3,onClick:h,isDisabled:!a||!!c,children:"Save"}),k.jsx(Te,{onClick:v,children:"Cancel"})]})]})]})]})}function vm(t){const e=new Uint8Array(t);return window.crypto.getRandomValues(e),Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}const gm=[{label:"Private",value:"PRIVATE",icon:k.jsx(_l,{})},{label:"Unlisted, anyone with the link can view",value:"UNLISTED",icon:k.jsx(tp,{})},{label:"Public",value:"PUBLIC",icon:k.jsx(cp,{})}],wm=()=>{const t=we.graph._nodes,e={};for(let n of t)if(n.type in LiteGraph.registered_node_types){const r=structuredClone(LiteGraph.registered_node_types[n.type].nodeData);if(r==null)continue;for(let o in r.input){const s=r.input[o];for(let i in s){const a=s[i];Array.isArray(a[0])&&(a[0]=["value_1","value_2"])}}e[n.type]=r}return e};async function Sp(t){const e=t.cloudOrigin;if(!e)throw Error("cloudURL is required");return fetch(e+`/api/getWorkflow?id=${t.cloudID}`).then(n=>n.json()).then(n=>{var o;return((o=n.data)==null?void 0:o.privacy)??"PRIVATE"})}function bm({privacy:t,showEmoji:e=!1}){let n;return t==="PRIVATE"?(n="Private",e&&(n="🔒 Private")):t==="UNLISTED"?(n="Unlisted",e&&(n="🔗 Unlisted")):t==="PUBLIC"&&(n="Public",e&&(n="🌐 Public")),k.jsx("span",{children:n})}function Ip({}){const[t,e]=P.useState(),[n,r]=P.useState(),{curFlowID:o}=P.useContext(Ct);return P.useEffect(()=>{o&&($==null||$.get(o).then(s=>{s!=null&&s.cloudID?(e(s.cloudOrigin+"/workflow/"+s.cloudID),Sp(s).then(i=>{r(i)})):e(void 0)}))},[o]),t?k.jsx("a",{href:t,style:{textDecoration:"none"},target:"_blank",children:k.jsx(Ba,{children:k.jsx(Gt,{children:n==="PUBLIC"?"🌐":n==="UNLISTED"?"🔗":"🔒"})})}):null}function Op({}){const{setRoute:t,curVersion:e,isDirty:n,setCurVersion:r}=P.useContext(Ct);return P.useEffect(()=>{n&&e&&(e==null?void 0:e.name.endsWith("*"))===!1&&(r==null||r({...e,name:e.name+"*"}))},[n]),e?k.jsx(Wt,{alignItems:"center",children:k.jsx(qa,{size:"sm",isAttached:!0,variant:"outline",children:k.jsx(Te,{rightIcon:k.jsx(xl,{size:10}),onClick:()=>t("versionHistory"),children:e.name})})}):null}const Dp=P.lazy(()=>yn(()=>import("./AppIsDirtyEventListener-h-RjyOhv.js"),__vite__mapDeps([5,1,6]))),jp=P.lazy(()=>yn(()=>import("./ModelManagerTopbar-9vTfJIQ5.js").then(t=>t.M),__vite__mapDeps([7,1,8,2,9,10]))),Pp=P.lazy(()=>yn(()=>import("./SpotlightSearch-xR_1HCZI.js"),__vite__mapDeps([11,1,6,12,13])));function Ap({curFlowName:t,setCurFlowName:e}){var d;const{isDirty:n,loadNewWorkflow:r,saveCurWorkflow:o,setRoute:s,curFlowID:i,route:a}=P.useContext(Ct),[l,c]=P.useState(),u=P.useCallback((p,h=!1)=>{const{top:v=0,left:f=0}=l||{};let{top:m=0,left:y=0}=p??{};m+=v,y+=f;const g=document.documentElement.clientWidth,_=document.documentElement.clientHeight,x=document.getElementById("workspaceManagerPanel"),C=(x==null?void 0:x.offsetWidth)||392;m+36>_&&(m=_-36),y+C>=g&&(y=g-C),c({top:Math.max(0,m),left:Math.max(0,y)}),h&&(G==null||G.upsert({topBarStyle:{top:m,left:y}}))},[l]);return P.useEffect(()=>{G==null||G.getSetting("topBarStyle").then(p=>{u(p,!1)})},[]),l?k.jsx(Uh,{onDragEnd:p=>{u({top:p.y,left:p.x},!0)},dragIconId:"dragPanelIcon",children:k.jsxs(ot,{style:{padding:2,position:"fixed",...l},justifyContent:"space-between",alignItems:"center",gap:2,draggable:!1,id:"workspaceManagerPanel",className:"workspaceManagerPanel",children:[k.jsx(Te,{size:"sm","aria-label":"workspace folder",height:us+"px",onClick:()=>s("recentFlows"),px:2,children:k.jsxs(ot,{gap:1,children:[k.jsx(Yh,{size:21}),k.jsx(xl,{size:8})]})}),k.jsx(P.Suspense,{fallback:k.jsx("div",{style:{width:"60px"}}),children:k.jsx(jp,{})}),k.jsx(bt,{label:"New workflow",children:k.jsx(Te,{size:"sm",variant:"outline",colorScheme:"teal","aria-label":"new workflow",height:us+"px",onClick:()=>r(),px:1,children:k.jsx(ot,{gap:0,children:k.jsx(op,{size:16,color:"white"})})})}),k.jsx(Cp,{isDirty:n,displayName:t??"",updateFlowName:p=>{e(p),requestAnimationFrame(()=>{u()})}}),((d=$==null?void 0:$.curWorkflow)==null?void 0:d.saveLock)&&k.jsx(_l,{color:"#FFF",size:20}),i&&k.jsxs(ot,{gap:"4px",children:[k.jsx(bt,{label:"Open gallery",children:k.jsx(un,{onClick:()=>s("gallery"),icon:k.jsx(rp,{size:22,color:"white"}),size:"sm","aria-label":"open gallery",variant:"ghost"})}),k.jsx(Ep,{})]}),i&&n?k.jsx(bt,{label:"Save workflow",children:k.jsx(un,{onClick:o,icon:k.jsx(ys,{size:23,color:"white"}),size:"xs",paddingY:4,"aria-label":"save workspace",variant:"ghost"})}):k.jsx("div",{style:{width:1}}),k.jsx(Ip,{}),k.jsx(Op,{}),k.jsx(Dp,{}),k.jsx(Xh,{id:"dragPanelIcon",className:"dragPanelIcon",cursor:"move",size:15,color:"#FFF"}),a==="spotlightSearch"&&k.jsx(Pp,{})]})}):null}function Np(){const{showDialog:t}=za(),{loadWorkflowID:e}=P.useContext(Ct),n=async(o,s)=>{var c,u;const{workflow:i,version:a}=o.detail;if(!i.id||!a.id)return;const l=(c=await($==null?void 0:$.listByIndex("cloudID",i.id)))==null?void 0:c.at(0);if(l){const d=(u=await(be==null?void 0:be.listByIndex("cloudID",a.id)))==null?void 0:u.at(0);if(d)await e(l.id,d.id);else{const p=await(be==null?void 0:be.add({id:a.id,cloudID:a.id,workflowID:l.id,cloudOrigin:s,name:a.name,authorID:a.authorID,json:a.json}));p&&e(l.id,p.id)}}else{const d=await($==null?void 0:$.createFlow({cloudID:i.id,cloudOrigin:s,name:i.name,json:a.json,updateTime:Date.now()}));if(!d){alert("Failed to add workflow to local db");return}const p=await(be==null?void 0:be.put({id:a.id,cloudID:a.id,workflowID:d.id,cloudOrigin:s,name:a.name,json:a.json,authorID:a.authorID,createTime:Date.now()}));await e(d.id,p==null?void 0:p.id)}},r=async o=>{const s=o.data;if(Fp(s)){const i=o.origin;t(`Open workflow "${s.detail.workflow.name}", version "${s.detail.version.name}" from ${i}`,[{label:"Open",colorScheme:"teal",onClick:()=>{n(s,i)}}])}};return P.useEffect(()=>{window.opener&&window.opener.postMessage("comfyui_workspace_manager_connected","*"),window.addEventListener("message",r)},[]),null}function Fp(t){return t.type==="workspace_open_workflow"}const Rp=t=>typeof t=="function",Tp=t=>{const[e,n]=P.useState(t),r=P.useRef(e),o=P.useCallback(s=>{r.current=Rp(s)?s(r.current):s,n(r.current)},[]);return[e,o,r]};function fr(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Sl={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,o,s){function i(c,u){if(!o[c]){if(!r[c]){var d=typeof fr=="function"&&fr;if(!u&&d)return d(c,!0);if(a)return a(c,!0);var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}var h=o[c]={exports:{}};r[c][0].call(h.exports,function(v){var f=r[c][1][v];return i(f||v)},h,h.exports,n,r,o,s)}return o[c].exports}for(var a=typeof fr=="function"&&fr,l=0;l<s.length;l++)i(s[l]);return i}({1:[function(n,r,o){var s=n("./utils"),i=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var c,u,d,p,h,v,f,m=[],y=0,g=l.length,_=g,x=s.getTypeOf(l)!=="string";y<l.length;)_=g-y,d=x?(c=l[y++],u=y<g?l[y++]:0,y<g?l[y++]:0):(c=l.charCodeAt(y++),u=y<g?l.charCodeAt(y++):0,y<g?l.charCodeAt(y++):0),p=c>>2,h=(3&c)<<4|u>>4,v=1<_?(15&u)<<2|d>>6:64,f=2<_?63&d:64,m.push(a.charAt(p)+a.charAt(h)+a.charAt(v)+a.charAt(f));return m.join("")},o.decode=function(l){var c,u,d,p,h,v,f=0,m=0,y="data:";if(l.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var g,_=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&_--,l.charAt(l.length-2)===a.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=i.uint8array?new Uint8Array(0|_):new Array(0|_);f<l.length;)c=a.indexOf(l.charAt(f++))<<2|(p=a.indexOf(l.charAt(f++)))>>4,u=(15&p)<<4|(h=a.indexOf(l.charAt(f++)))>>2,d=(3&h)<<6|(v=a.indexOf(l.charAt(f++))),g[m++]=c,h!==64&&(g[m++]=u),v!==64&&(g[m++]=d);return g}},{"./support":30,"./utils":32}],2:[function(n,r,o){var s=n("./external"),i=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,p,h,v){this.compressedSize=u,this.uncompressedSize=d,this.crc32=p,this.compression=h,this.compressedContent=v}c.prototype={getContentWorker:function(){var u=new i(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new i(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,p){return u.pipe(new a).pipe(new l("uncompressedSize")).pipe(d.compressWorker(p)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,o){var s=n("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},o.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,o){var s=n("./utils"),i=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();r.exports=function(a,l){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?function(c,u,d,p){var h=i,v=p+d;c^=-1;for(var f=p;f<v;f++)c=c>>>8^h[255&(c^u[f])];return-1^c}(0|l,a,a.length,0):function(c,u,d,p){var h=i,v=p+d;c^=-1;for(var f=p;f<v;f++)c=c>>>8^h[255&(c^u.charCodeAt(f))];return-1^c}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(n,r,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(n,r,o){var s=null;s=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:s}},{lie:37}],7:[function(n,r,o){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=n("pako"),a=n("./utils"),l=n("./stream/GenericWorker"),c=s?"uint8array":"array";function u(d,p){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=p,this.meta={}}o.magic="\b\0",a.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(p){d.push({data:p,meta:d.meta})}},o.compressWorker=function(d){return new u("Deflate",d)},o.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,o){function s(h,v){var f,m="";for(f=0;f<v;f++)m+=String.fromCharCode(255&h),h>>>=8;return m}function i(h,v,f,m,y,g){var _,x,C=h.file,D=h.compression,E=g!==c.utf8encode,F=a.transformTo("string",g(C.name)),I=a.transformTo("string",c.utf8encode(C.name)),R=C.comment,K=a.transformTo("string",g(R)),j=a.transformTo("string",c.utf8encode(R)),M=I.length!==C.name.length,b=j.length!==R.length,N="",H="",A="",X=C.dir,V=C.date,te={crc32:0,compressedSize:0,uncompressedSize:0};v&&!f||(te.crc32=h.crc32,te.compressedSize=h.compressedSize,te.uncompressedSize=h.uncompressedSize);var z=0;v&&(z|=8),E||!M&&!b||(z|=2048);var B=0,ne=0;X&&(B|=16),y==="UNIX"?(ne=798,B|=function(Z,he){var ye=Z;return Z||(ye=he?16893:33204),(65535&ye)<<16}(C.unixPermissions,X)):(ne=20,B|=function(Z){return 63&(Z||0)}(C.dosPermissions)),_=V.getUTCHours(),_<<=6,_|=V.getUTCMinutes(),_<<=5,_|=V.getUTCSeconds()/2,x=V.getUTCFullYear()-1980,x<<=4,x|=V.getUTCMonth()+1,x<<=5,x|=V.getUTCDate(),M&&(H=s(1,1)+s(u(F),4)+I,N+="up"+s(H.length,2)+H),b&&(A=s(1,1)+s(u(K),4)+j,N+="uc"+s(A.length,2)+A);var Y="";return Y+=`
\0`,Y+=s(z,2),Y+=D.magic,Y+=s(_,2),Y+=s(x,2),Y+=s(te.crc32,4),Y+=s(te.compressedSize,4),Y+=s(te.uncompressedSize,4),Y+=s(F.length,2),Y+=s(N.length,2),{fileRecord:d.LOCAL_FILE_HEADER+Y+F+N,dirRecord:d.CENTRAL_FILE_HEADER+s(ne,2)+Y+s(K.length,2)+"\0\0\0\0"+s(B,4)+s(m,4)+F+N+K}}var a=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function p(h,v,f,m){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=f,this.encodeFileName=m,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(p,l),p.prototype.push=function(h){var v=h.meta.percent||0,f=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,l.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:f?(v+100*(f-m-1))/f:100}}))},p.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var v=this.streamFiles&&!h.file.dir;if(v){var f=i(h,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(h){this.accumulate=!1;var v=this.streamFiles&&!h.file.dir,f=i(h,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),v)this.push({data:function(m){return d.DATA_DESCRIPTOR+s(m.crc32,4)+s(m.compressedSize,4)+s(m.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var h=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var f=this.bytesWritten-h,m=function(y,g,_,x,C){var D=a.transformTo("string",C(x));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(y,2)+s(y,2)+s(g,4)+s(_,4)+s(D.length,2)+D}(this.dirRecords.length,f,h,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(h){this._sources.push(h);var v=this;return h.on("data",function(f){v.processChunk(f)}),h.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),h.on("error",function(f){v.error(f)}),this},p.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(h){var v=this._sources;if(!l.prototype.error.call(this,h))return!1;for(var f=0;f<v.length;f++)try{v[f].error(h)}catch{}return!0},p.prototype.lock=function(){l.prototype.lock.call(this);for(var h=this._sources,v=0;v<h.length;v++)h[v].lock()},r.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,o){var s=n("../compressions"),i=n("./ZipFileWorker");o.generateWorker=function(a,l,c){var u=new i(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{a.forEach(function(p,h){d++;var v=function(g,_){var x=g||_,C=s[x];if(!C)throw new Error(x+" is not a valid compression method !");return C}(h.options.compression,l.compression),f=h.options.compressionOptions||l.compressionOptions||{},m=h.dir,y=h.date;h._compressWorker(v,f).withStreamInfo("file",{name:p,dir:m,date:y,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(p){u.error(p)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,o){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new s;for(var a in this)typeof this[a]!="function"&&(i[a]=this[a]);return i}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(i,a){return new s().loadAsync(i,a)},s.external=n("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,o){var s=n("./utils"),i=n("./external"),a=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(p){return new i.Promise(function(h,v){var f=p.decompressed.getContentWorker().pipe(new c);f.on("error",function(m){v(m)}).on("end",function(){f.streamInfo.crc32!==p.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}r.exports=function(p,h){var v=this;return h=s.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(p)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",p,!0,h.optimizedBinaryString,h.base64).then(function(f){var m=new l(h);return m.load(f),m}).then(function(f){var m=[i.Promise.resolve(f)],y=f.files;if(h.checkCRC32)for(var g=0;g<y.length;g++)m.push(d(y[g]));return i.Promise.all(m)}).then(function(f){for(var m=f.shift(),y=m.files,g=0;g<y.length;g++){var _=y[g],x=_.fileNameStr,C=s.resolve(_.fileNameStr);v.file(C,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:h.createFolders}),_.dir||(v.file(C).unsafeOriginalName=x)}return m.zipComment.length&&(v.comment=m.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,o){var s=n("../utils"),i=n("../stream/GenericWorker");function a(l,c){i.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(a,i),a.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,o){var s=n("readable-stream").Readable;function i(a,l,c){s.call(this,l),this._helper=a;var u=this;a.on("data",function(d,p){u.push(d)||u._helper.pause(),c&&c(p)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(i,s),i.prototype._read=function(){this._helper.resume()},r.exports=i},{"../utils":32,"readable-stream":16}],14:[function(n,r,o){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,i);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,i)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var i=new Buffer(s);return i.fill(0),i},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,r,o){function s(C,D,E){var F,I=a.getTypeOf(D),R=a.extend(E||{},u);R.date=R.date||new Date,R.compression!==null&&(R.compression=R.compression.toUpperCase()),typeof R.unixPermissions=="string"&&(R.unixPermissions=parseInt(R.unixPermissions,8)),R.unixPermissions&&16384&R.unixPermissions&&(R.dir=!0),R.dosPermissions&&16&R.dosPermissions&&(R.dir=!0),R.dir&&(C=y(C)),R.createFolders&&(F=m(C))&&g.call(this,F,!0);var K=I==="string"&&R.binary===!1&&R.base64===!1;E&&E.binary!==void 0||(R.binary=!K),(D instanceof d&&D.uncompressedSize===0||R.dir||!D||D.length===0)&&(R.base64=!1,R.binary=!0,D="",R.compression="STORE",I="string");var j=null;j=D instanceof d||D instanceof l?D:v.isNode&&v.isStream(D)?new f(C,D):a.prepareContent(C,D,R.binary,R.optimizedBinaryString,R.base64);var M=new p(C,j,R);this.files[C]=M}var i=n("./utf8"),a=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),p=n("./zipObject"),h=n("./generate"),v=n("./nodejsUtils"),f=n("./nodejs/NodejsStreamInputAdapter"),m=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var D=C.lastIndexOf("/");return 0<D?C.substring(0,D):""},y=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},g=function(C,D){return D=D!==void 0?D:u.createFolders,C=y(C),this.files[C]||s.call(this,C,null,{dir:!0,createFolders:D}),this.files[C]};function _(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var D,E,F;for(D in this.files)F=this.files[D],(E=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&C(E,F)},filter:function(C){var D=[];return this.forEach(function(E,F){C(E,F)&&D.push(F)}),D},file:function(C,D,E){if(arguments.length!==1)return C=this.root+C,s.call(this,C,D,E),this;if(_(C)){var F=C;return this.filter(function(R,K){return!K.dir&&F.test(R)})}var I=this.files[this.root+C];return I&&!I.dir?I:null},folder:function(C){if(!C)return this;if(_(C))return this.filter(function(I,R){return R.dir&&C.test(I)});var D=this.root+C,E=g.call(this,D),F=this.clone();return F.root=E.name,F},remove:function(C){C=this.root+C;var D=this.files[C];if(D||(C.slice(-1)!=="/"&&(C+="/"),D=this.files[C]),D&&!D.dir)delete this.files[C];else for(var E=this.filter(function(I,R){return R.name.slice(0,C.length)===C}),F=0;F<E.length;F++)delete this.files[E[F].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var D,E={};try{if((E=a.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=E.type.toLowerCase(),E.compression=E.compression.toUpperCase(),E.type==="binarystring"&&(E.type="string"),!E.type)throw new Error("No output type specified.");a.checkSupport(E.type),E.platform!=="darwin"&&E.platform!=="freebsd"&&E.platform!=="linux"&&E.platform!=="sunos"||(E.platform="UNIX"),E.platform==="win32"&&(E.platform="DOS");var F=E.comment||this.comment||"";D=h.generateWorker(this,E,F)}catch(I){(D=new l("error")).error(I)}return new c(D,E.type||"string",E.mimeType)},generateAsync:function(C,D){return this.generateInternalStream(C).accumulate(D)},generateNodeStream:function(C,D){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(D)}};r.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,o){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,o){var s=n("./DataReader");function i(a){s.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}n("../utils").inherits(i,s),i.prototype.byteAt=function(a){return this.data[this.zero+a]},i.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===l&&this.data[p+1]===c&&this.data[p+2]===u&&this.data[p+3]===d)return p-this.zero;return-1},i.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),p=this.readData(4);return l===p[0]&&c===p[1]&&u===p[2]&&d===p[3]},i.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=i},{"../utils":32,"./DataReader":18}],18:[function(n,r,o){var s=n("../utils");function i(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,c=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=a,c},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},r.exports=i},{"../utils":32}],19:[function(n,r,o){var s=n("./Uint8ArrayReader");function i(a){s.call(this,a)}n("../utils").inherits(i,s),i.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,o){var s=n("./DataReader");function i(a){s.call(this,a)}n("../utils").inherits(i,s),i.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},i.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},i.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},i.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=i},{"../utils":32,"./DataReader":18}],21:[function(n,r,o){var s=n("./ArrayReader");function i(a){s.call(this,a)}n("../utils").inherits(i,s),i.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,o){var s=n("../utils"),i=n("../support"),a=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var p=s.getTypeOf(d);return s.checkSupport(p),p!=="string"||i.uint8array?p==="nodebuffer"?new c(d):i.uint8array?new u(s.transformTo("uint8array",d)):new a(s.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,o){var s=n("./GenericWorker"),i=n("../utils");function a(l){s.call(this,"ConvertWorker to "+l),this.destType=l}i.inherits(a,s),a.prototype.processChunk=function(l){this.push({data:i.transformTo(this.destType,l.data),meta:l.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,o){var s=n("./GenericWorker"),i=n("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(a,s),a.prototype.processChunk=function(l){this.streamInfo.crc32=i(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,o){var s=n("../utils"),i=n("./GenericWorker");function a(l){i.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(a,i),a.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}i.prototype.processChunk.call(this,l)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,o){var s=n("../utils"),i=n("./GenericWorker");function a(l){i.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=s.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}s.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,o){function s(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,a){return this._listeners[i].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,a){if(this._listeners[i])for(var l=0;l<this._listeners[i].length;l++)this._listeners[i][l].call(this,a)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var a=this;return i.on("data",function(l){a.processChunk(l)}),i.on("end",function(){a.end()}),i.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,a){return this.extraStreamInfo[i]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},r.exports=s},{}],29:[function(n,r,o){var s=n("../utils"),i=n("./ConvertWorker"),a=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(v,f){return new u.Promise(function(m,y){var g=[],_=v._internalType,x=v._outputType,C=v._mimeType;v.on("data",function(D,E){g.push(D),f&&f(E)}).on("error",function(D){g=[],y(D)}).on("end",function(){try{var D=function(E,F,I){switch(E){case"blob":return s.newBlob(s.transformTo("arraybuffer",F),I);case"base64":return l.encode(F);default:return s.transformTo(E,F)}}(x,function(E,F){var I,R=0,K=null,j=0;for(I=0;I<F.length;I++)j+=F[I].length;switch(E){case"string":return F.join("");case"array":return Array.prototype.concat.apply([],F);case"uint8array":for(K=new Uint8Array(j),I=0;I<F.length;I++)K.set(F[I],R),R+=F[I].length;return K;case"nodebuffer":return Buffer.concat(F);default:throw new Error("concat : unsupported type '"+E+"'")}}(_,g),C);m(D)}catch(E){y(E)}g=[]}).resume()})}function h(v,f,m){var y=f;switch(f){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=f,this._mimeType=m,s.checkSupport(y),this._worker=v.pipe(new i(y)),v.lock()}catch(g){this._worker=new a("error"),this._worker.error(g)}}h.prototype={accumulate:function(v){return p(this,v)},on:function(v,f){var m=this;return v==="data"?this._worker.on(v,function(y){f.call(m,y.data,y.meta)}):this._worker.on(v,function(){s.delay(f,arguments,m)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},v)}},r.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var s=new ArrayBuffer(0);try{o.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(s),o.blob=i.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!n("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,o){for(var s=n("./utils"),i=n("./support"),a=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function p(){l.call(this,"utf-8 encode")}o.utf8encode=function(h){return i.nodebuffer?a.newBufferFrom(h,"utf-8"):function(v){var f,m,y,g,_,x=v.length,C=0;for(g=0;g<x;g++)(64512&(m=v.charCodeAt(g)))==55296&&g+1<x&&(64512&(y=v.charCodeAt(g+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),g++),C+=m<128?1:m<2048?2:m<65536?3:4;for(f=i.uint8array?new Uint8Array(C):new Array(C),g=_=0;_<C;g++)(64512&(m=v.charCodeAt(g)))==55296&&g+1<x&&(64512&(y=v.charCodeAt(g+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),g++),m<128?f[_++]=m:(m<2048?f[_++]=192|m>>>6:(m<65536?f[_++]=224|m>>>12:(f[_++]=240|m>>>18,f[_++]=128|m>>>12&63),f[_++]=128|m>>>6&63),f[_++]=128|63&m);return f}(h)},o.utf8decode=function(h){return i.nodebuffer?s.transformTo("nodebuffer",h).toString("utf-8"):function(v){var f,m,y,g,_=v.length,x=new Array(2*_);for(f=m=0;f<_;)if((y=v[f++])<128)x[m++]=y;else if(4<(g=c[y]))x[m++]=65533,f+=g-1;else{for(y&=g===2?31:g===3?15:7;1<g&&f<_;)y=y<<6|63&v[f++],g--;1<g?x[m++]=65533:y<65536?x[m++]=y:(y-=65536,x[m++]=55296|y>>10&1023,x[m++]=56320|1023&y)}return x.length!==m&&(x.subarray?x=x.subarray(0,m):x.length=m),s.applyFromCharCode(x)}(h=s.transformTo(i.uint8array?"uint8array":"array",h))},s.inherits(d,l),d.prototype.processChunk=function(h){var v=s.transformTo(i.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var f=v;(v=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),v.set(f,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var m=function(g,_){var x;for((_=_||g.length)>g.length&&(_=g.length),x=_-1;0<=x&&(192&g[x])==128;)x--;return x<0||x===0?_:x+c[g[x]]>_?x:_}(v),y=v;m!==v.length&&(i.uint8array?(y=v.subarray(0,m),this.leftOver=v.subarray(m,v.length)):(y=v.slice(0,m),this.leftOver=v.slice(m,v.length))),this.push({data:o.utf8decode(y),meta:h.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=d,s.inherits(p,l),p.prototype.processChunk=function(h){this.push({data:o.utf8encode(h.data),meta:h.meta})},o.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,o){var s=n("./support"),i=n("./base64"),a=n("./nodejsUtils"),l=n("./external");function c(f){return f}function u(f,m){for(var y=0;y<f.length;++y)m[y]=255&f.charCodeAt(y);return m}n("setimmediate"),o.newBlob=function(f,m){o.checkSupport("blob");try{return new Blob([f],{type:m})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(f),y.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(f,m,y){var g=[],_=0,x=f.length;if(x<=y)return String.fromCharCode.apply(null,f);for(;_<x;)m==="array"||m==="nodebuffer"?g.push(String.fromCharCode.apply(null,f.slice(_,Math.min(_+y,x)))):g.push(String.fromCharCode.apply(null,f.subarray(_,Math.min(_+y,x)))),_+=y;return g.join("")},stringifyByChar:function(f){for(var m="",y=0;y<f.length;y++)m+=String.fromCharCode(f[y]);return m},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function p(f){var m=65536,y=o.getTypeOf(f),g=!0;if(y==="uint8array"?g=d.applyCanBeUsed.uint8array:y==="nodebuffer"&&(g=d.applyCanBeUsed.nodebuffer),g)for(;1<m;)try{return d.stringifyByChunk(f,y,m)}catch{m=Math.floor(m/2)}return d.stringifyByChar(f)}function h(f,m){for(var y=0;y<f.length;y++)m[y]=f[y];return m}o.applyFromCharCode=p;var v={};v.string={string:c,array:function(f){return u(f,new Array(f.length))},arraybuffer:function(f){return v.string.uint8array(f).buffer},uint8array:function(f){return u(f,new Uint8Array(f.length))},nodebuffer:function(f){return u(f,a.allocBuffer(f.length))}},v.array={string:p,array:c,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return a.newBufferFrom(f)}},v.arraybuffer={string:function(f){return p(new Uint8Array(f))},array:function(f){return h(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:c,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return a.newBufferFrom(new Uint8Array(f))}},v.uint8array={string:p,array:function(f){return h(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:c,nodebuffer:function(f){return a.newBufferFrom(f)}},v.nodebuffer={string:p,array:function(f){return h(f,new Array(f.length))},arraybuffer:function(f){return v.nodebuffer.uint8array(f).buffer},uint8array:function(f){return h(f,new Uint8Array(f.length))},nodebuffer:c},o.transformTo=function(f,m){if(m=m||"",!f)return m;o.checkSupport(f);var y=o.getTypeOf(m);return v[y][f](m)},o.resolve=function(f){for(var m=f.split("/"),y=[],g=0;g<m.length;g++){var _=m[g];_==="."||_===""&&g!==0&&g!==m.length-1||(_===".."?y.pop():y.push(_))}return y.join("/")},o.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(f)?"nodebuffer":s.uint8array&&f instanceof Uint8Array?"uint8array":s.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(f){if(!s[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(f){var m,y,g="";for(y=0;y<(f||"").length;y++)g+="\\x"+((m=f.charCodeAt(y))<16?"0":"")+m.toString(16).toUpperCase();return g},o.delay=function(f,m,y){setImmediate(function(){f.apply(y||null,m||[])})},o.inherits=function(f,m){function y(){}y.prototype=m.prototype,f.prototype=new y},o.extend=function(){var f,m,y={};for(f=0;f<arguments.length;f++)for(m in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],m)&&y[m]===void 0&&(y[m]=arguments[f][m]);return y},o.prepareContent=function(f,m,y,g,_){return l.Promise.resolve(m).then(function(x){return s.blob&&(x instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,D){var E=new FileReader;E.onload=function(F){C(F.target.result)},E.onerror=function(F){D(F.target.error)},E.readAsArrayBuffer(x)}):x}).then(function(x){var C=o.getTypeOf(x);return C?(C==="arraybuffer"?x=o.transformTo("uint8array",x):C==="string"&&(_?x=i.decode(x):y&&g!==!0&&(x=function(D){return u(D,s.uint8array?new Uint8Array(D.length):new Array(D.length))}(x))),x):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,o){var s=n("./reader/readerFor"),i=n("./utils"),a=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(p)+", expected "+i.pretty(d)+")")}},isSignature:function(d,p){var h=this.reader.index;this.reader.setIndex(d);var v=this.reader.readString(4)===p;return this.reader.setIndex(h),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),p=c.uint8array?"uint8array":"array",h=i.transformTo(p,d);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,p,h,v=this.zip64EndOfCentralSize-44;0<v;)d=this.reader.readInt(2),p=this.reader.readInt(4),h=this.reader.readData(p),this.zip64ExtensibleData[d]={id:d,length:p,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,p;for(d=0;d<this.files.length;d++)p=this.files[d],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var p=d;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var v=p-h;if(0<v)this.isSignature(p,a.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(d){this.reader=s(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,o){var s=n("./reader/readerFor"),i=n("./utils"),a=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function p(h,v){this.options=h,this.loadOptions=v}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var v,f;if(h.skip(22),this.fileNameLength=h.readInt(2),f=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(m){for(var y in u)if(Object.prototype.hasOwnProperty.call(u,y)&&u[y].magic===m)return u[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,v,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var v=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(v),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=s(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var v,f,m,y=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<y;)v=h.readInt(2),f=h.readInt(2),m=h.readData(f),this.extraFields[v]={id:v,length:f,value:m};h.setIndex(y)},handleUTF8:function(){var h=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var f=i.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var y=i.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var v=s(h.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:c.utf8decode(v.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var v=s(h.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:c.utf8decode(v.readData(h.length-5))}return null}},r.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,o){function s(v,f,m){this.name=v,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=f,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var i=n("./stream/StreamHelper"),a=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");s.prototype={internalStream:function(v){var f=null,m="string";try{if(!v)throw new Error("No output type specified.");var y=(m=v.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),f=this._decompressWorker();var g=!this._dataBinary;g&&!y&&(f=f.pipe(new l.Utf8EncodeWorker)),!g&&y&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(_){(f=new u("error")).error(_)}return new i(f,m,"")},async:function(v,f){return this.internalStream(v).accumulate(f)},nodeStream:function(v,f){return this.internalStream(v||"nodebuffer").toNodejsStream(f)},_compressWorker:function(v,f){if(this._data instanceof c&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(m,v,f)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<d.length;h++)s.prototype[d[h]]=p;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,o){(function(s){var i,a,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,u=new l(v),d=s.document.createTextNode("");u.observe(d,{characterData:!0}),i=function(){d.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)i="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var f=s.document.createElement("script");f.onreadystatechange=function(){v(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},s.document.documentElement.appendChild(f)}:function(){setTimeout(v,0)};else{var p=new s.MessageChannel;p.port1.onmessage=v,i=function(){p.port2.postMessage(0)}}var h=[];function v(){var f,m;a=!0;for(var y=h.length;y;){for(m=h,h=[],f=-1;++f<y;)m[f]();y=h.length}a=!1}r.exports=function(f){h.push(f)!==1||a||i()}}).call(this,typeof tr<"u"?tr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,o){var s=n("immediate");function i(){}var a={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,y!==i&&f(this,y)}function p(y,g,_){this.promise=y,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function h(y,g,_){s(function(){var x;try{x=g(_)}catch(C){return a.reject(y,C)}x===y?a.reject(y,new TypeError("Cannot resolve promise with itself")):a.resolve(y,x)})}function v(y){var g=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof g=="function")return function(){g.apply(y,arguments)}}function f(y,g){var _=!1;function x(E){_||(_=!0,a.reject(y,E))}function C(E){_||(_=!0,a.resolve(y,E))}var D=m(function(){g(C,x)});D.status==="error"&&x(D.value)}function m(y,g){var _={};try{_.value=y(g),_.status="success"}catch(x){_.status="error",_.value=x}return _}(r.exports=d).prototype.finally=function(y){if(typeof y!="function")return this;var g=this.constructor;return this.then(function(_){return g.resolve(y()).then(function(){return _})},function(_){return g.resolve(y()).then(function(){throw _})})},d.prototype.catch=function(y){return this.then(null,y)},d.prototype.then=function(y,g){if(typeof y!="function"&&this.state===c||typeof g!="function"&&this.state===l)return this;var _=new this.constructor(i);return this.state!==u?h(_,this.state===c?y:g,this.outcome):this.queue.push(new p(_,y,g)),_},p.prototype.callFulfilled=function(y){a.resolve(this.promise,y)},p.prototype.otherCallFulfilled=function(y){h(this.promise,this.onFulfilled,y)},p.prototype.callRejected=function(y){a.reject(this.promise,y)},p.prototype.otherCallRejected=function(y){h(this.promise,this.onRejected,y)},a.resolve=function(y,g){var _=m(v,g);if(_.status==="error")return a.reject(y,_.value);var x=_.value;if(x)f(y,x);else{y.state=c,y.outcome=g;for(var C=-1,D=y.queue.length;++C<D;)y.queue[C].callFulfilled(g)}return y},a.reject=function(y,g){y.state=l,y.outcome=g;for(var _=-1,x=y.queue.length;++_<x;)y.queue[_].callRejected(g);return y},d.resolve=function(y){return y instanceof this?y:a.resolve(new this(i),y)},d.reject=function(y){var g=new this(i);return a.reject(g,y)},d.all=function(y){var g=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,x=!1;if(!_)return this.resolve([]);for(var C=new Array(_),D=0,E=-1,F=new this(i);++E<_;)I(y[E],E);return F;function I(R,K){g.resolve(R).then(function(j){C[K]=j,++D!==_||x||(x=!0,a.resolve(F,C))},function(j){x||(x=!0,a.reject(F,j))})}},d.race=function(y){var g=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,x=!1;if(!_)return this.resolve([]);for(var C=-1,D=new this(i);++C<_;)E=y[C],g.resolve(E).then(function(F){x||(x=!0,a.resolve(D,F))},function(F){x||(x=!0,a.reject(D,F))});var E;return D}},{immediate:36}],38:[function(n,r,o){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,o){var s=n("./zlib/deflate"),i=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,p=-1,h=0,v=8;function f(y){if(!(this instanceof f))return new f(y);this.options=i.assign({level:p,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},y||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var _=s.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(_!==d)throw new Error(l[_]);if(g.header&&s.deflateSetHeader(this.strm,g.header),g.dictionary){var x;if(x=typeof g.dictionary=="string"?a.string2buf(g.dictionary):u.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(_=s.deflateSetDictionary(this.strm,x))!==d)throw new Error(l[_]);this._dict_set=!0}}function m(y,g){var _=new f(g);if(_.push(y,!0),_.err)throw _.msg||l[_.err];return _.result}f.prototype.push=function(y,g){var _,x,C=this.strm,D=this.options.chunkSize;if(this.ended)return!1;x=g===~~g?g:g===!0?4:0,typeof y=="string"?C.input=a.string2buf(y):u.call(y)==="[object ArrayBuffer]"?C.input=new Uint8Array(y):C.input=y,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new i.Buf8(D),C.next_out=0,C.avail_out=D),(_=s.deflate(C,x))!==1&&_!==d)return this.onEnd(_),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||x!==4&&x!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(i.shrinkBuf(C.output,C.next_out))):this.onData(i.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&_!==1);return x===4?(_=s.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===d):x!==2||(this.onEnd(d),!(C.avail_out=0))},f.prototype.onData=function(y){this.chunks.push(y)},f.prototype.onEnd=function(y){y===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},o.Deflate=f,o.deflate=m,o.deflateRaw=function(y,g){return(g=g||{}).raw=!0,m(y,g)},o.gzip=function(y,g){return(g=g||{}).gzip=!0,m(y,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,o){var s=n("./zlib/inflate"),i=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),p=Object.prototype.toString;function h(f){if(!(this instanceof h))return new h(f);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},f||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||f&&f.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&!(15&m.windowBits)&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var y=s.inflateInit2(this.strm,m.windowBits);if(y!==l.Z_OK)throw new Error(c[y]);this.header=new d,s.inflateGetHeader(this.strm,this.header)}function v(f,m){var y=new h(m);if(y.push(f,!0),y.err)throw y.msg||c[y.err];return y.result}h.prototype.push=function(f,m){var y,g,_,x,C,D,E=this.strm,F=this.options.chunkSize,I=this.options.dictionary,R=!1;if(this.ended)return!1;g=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?E.input=a.binstring2buf(f):p.call(f)==="[object ArrayBuffer]"?E.input=new Uint8Array(f):E.input=f,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new i.Buf8(F),E.next_out=0,E.avail_out=F),(y=s.inflate(E,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(D=typeof I=="string"?a.string2buf(I):p.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,y=s.inflateSetDictionary(this.strm,D)),y===l.Z_BUF_ERROR&&R===!0&&(y=l.Z_OK,R=!1),y!==l.Z_STREAM_END&&y!==l.Z_OK)return this.onEnd(y),!(this.ended=!0);E.next_out&&(E.avail_out!==0&&y!==l.Z_STREAM_END&&(E.avail_in!==0||g!==l.Z_FINISH&&g!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=a.utf8border(E.output,E.next_out),x=E.next_out-_,C=a.buf2string(E.output,_),E.next_out=x,E.avail_out=F-x,x&&i.arraySet(E.output,E.output,_,x,0),this.onData(C)):this.onData(i.shrinkBuf(E.output,E.next_out)))),E.avail_in===0&&E.avail_out===0&&(R=!0)}while((0<E.avail_in||E.avail_out===0)&&y!==l.Z_STREAM_END);return y===l.Z_STREAM_END&&(g=l.Z_FINISH),g===l.Z_FINISH?(y=s.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===l.Z_OK):g!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(E.avail_out=0))},h.prototype.onData=function(f){this.chunks.push(f)},h.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},o.Inflate=h,o.inflate=v,o.inflateRaw=function(f,m){return(m=m||{}).raw=!0,v(f,m)},o.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,o){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},o.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var i={arraySet:function(l,c,u,d,p){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),p);else for(var h=0;h<d;h++)l[p+h]=c[u+h]},flattenChunks:function(l){var c,u,d,p,h,v;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(v=new Uint8Array(d),c=p=0,u=l.length;c<u;c++)h=l[c],v.set(h,p),p+=h.length;return v}},a={arraySet:function(l,c,u,d,p){for(var h=0;h<d;h++)l[p+h]=c[u+h]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,i)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,a))},o.setTyped(s)},{}],42:[function(n,r,o){var s=n("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,p){if(p<65537&&(d.subarray&&a||!d.subarray&&i))return String.fromCharCode.apply(null,s.shrinkBuf(d,p));for(var h="",v=0;v<p;v++)h+=String.fromCharCode(d[v]);return h}l[254]=l[254]=1,o.string2buf=function(d){var p,h,v,f,m,y=d.length,g=0;for(f=0;f<y;f++)(64512&(h=d.charCodeAt(f)))==55296&&f+1<y&&(64512&(v=d.charCodeAt(f+1)))==56320&&(h=65536+(h-55296<<10)+(v-56320),f++),g+=h<128?1:h<2048?2:h<65536?3:4;for(p=new s.Buf8(g),f=m=0;m<g;f++)(64512&(h=d.charCodeAt(f)))==55296&&f+1<y&&(64512&(v=d.charCodeAt(f+1)))==56320&&(h=65536+(h-55296<<10)+(v-56320),f++),h<128?p[m++]=h:(h<2048?p[m++]=192|h>>>6:(h<65536?p[m++]=224|h>>>12:(p[m++]=240|h>>>18,p[m++]=128|h>>>12&63),p[m++]=128|h>>>6&63),p[m++]=128|63&h);return p},o.buf2binstring=function(d){return u(d,d.length)},o.binstring2buf=function(d){for(var p=new s.Buf8(d.length),h=0,v=p.length;h<v;h++)p[h]=d.charCodeAt(h);return p},o.buf2string=function(d,p){var h,v,f,m,y=p||d.length,g=new Array(2*y);for(h=v=0;h<y;)if((f=d[h++])<128)g[v++]=f;else if(4<(m=l[f]))g[v++]=65533,h+=m-1;else{for(f&=m===2?31:m===3?15:7;1<m&&h<y;)f=f<<6|63&d[h++],m--;1<m?g[v++]=65533:f<65536?g[v++]=f:(f-=65536,g[v++]=55296|f>>10&1023,g[v++]=56320|1023&f)}return u(g,v)},o.utf8border=function(d,p){var h;for((p=p||d.length)>d.length&&(p=d.length),h=p-1;0<=h&&(192&d[h])==128;)h--;return h<0||h===0?p:h+l[d[h]]>p?h:p}},{"./common":41}],43:[function(n,r,o){r.exports=function(s,i,a,l){for(var c=65535&s|0,u=s>>>16&65535|0,d=0;a!==0;){for(a-=d=2e3<a?2e3:a;u=u+(c=c+i[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,o){var s=function(){for(var i,a=[],l=0;l<256;l++){i=l;for(var c=0;c<8;c++)i=1&i?3988292384^i>>>1:i>>>1;a[l]=i}return a}();r.exports=function(i,a,l,c){var u=s,d=c+l;i^=-1;for(var p=c;p<d;p++)i=i>>>8^u[255&(i^a[p])];return-1^i}},{}],46:[function(n,r,o){var s,i=n("../utils/common"),a=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,p=4,h=0,v=-2,f=-1,m=4,y=2,g=8,_=9,x=286,C=30,D=19,E=2*x+1,F=15,I=3,R=258,K=R+I+1,j=42,M=113,b=1,N=2,H=3,A=4;function X(w,U){return w.msg=u[U],U}function V(w){return(w<<1)-(4<w?9:0)}function te(w){for(var U=w.length;0<=--U;)w[U]=0}function z(w){var U=w.state,W=U.pending;W>w.avail_out&&(W=w.avail_out),W!==0&&(i.arraySet(w.output,U.pending_buf,U.pending_out,W,w.next_out),w.next_out+=W,U.pending_out+=W,w.total_out+=W,w.avail_out-=W,U.pending-=W,U.pending===0&&(U.pending_out=0))}function B(w,U){a._tr_flush_block(w,0<=w.block_start?w.block_start:-1,w.strstart-w.block_start,U),w.block_start=w.strstart,z(w.strm)}function ne(w,U){w.pending_buf[w.pending++]=U}function Y(w,U){w.pending_buf[w.pending++]=U>>>8&255,w.pending_buf[w.pending++]=255&U}function Z(w,U){var W,O,S=w.max_chain_length,T=w.strstart,q=w.prev_length,J=w.nice_match,L=w.strstart>w.w_size-K?w.strstart-(w.w_size-K):0,Q=w.window,re=w.w_mask,ee=w.prev,se=w.strstart+R,ge=Q[T+q-1],pe=Q[T+q];w.prev_length>=w.good_match&&(S>>=2),J>w.lookahead&&(J=w.lookahead);do if(Q[(W=U)+q]===pe&&Q[W+q-1]===ge&&Q[W]===Q[T]&&Q[++W]===Q[T+1]){T+=2,W++;do;while(Q[++T]===Q[++W]&&Q[++T]===Q[++W]&&Q[++T]===Q[++W]&&Q[++T]===Q[++W]&&Q[++T]===Q[++W]&&Q[++T]===Q[++W]&&Q[++T]===Q[++W]&&Q[++T]===Q[++W]&&T<se);if(O=R-(se-T),T=se-R,q<O){if(w.match_start=U,J<=(q=O))break;ge=Q[T+q-1],pe=Q[T+q]}}while((U=ee[U&re])>L&&--S!=0);return q<=w.lookahead?q:w.lookahead}function he(w){var U,W,O,S,T,q,J,L,Q,re,ee=w.w_size;do{if(S=w.window_size-w.lookahead-w.strstart,w.strstart>=ee+(ee-K)){for(i.arraySet(w.window,w.window,ee,ee,0),w.match_start-=ee,w.strstart-=ee,w.block_start-=ee,U=W=w.hash_size;O=w.head[--U],w.head[U]=ee<=O?O-ee:0,--W;);for(U=W=ee;O=w.prev[--U],w.prev[U]=ee<=O?O-ee:0,--W;);S+=ee}if(w.strm.avail_in===0)break;if(q=w.strm,J=w.window,L=w.strstart+w.lookahead,Q=S,re=void 0,re=q.avail_in,Q<re&&(re=Q),W=re===0?0:(q.avail_in-=re,i.arraySet(J,q.input,q.next_in,re,L),q.state.wrap===1?q.adler=l(q.adler,J,re,L):q.state.wrap===2&&(q.adler=c(q.adler,J,re,L)),q.next_in+=re,q.total_in+=re,re),w.lookahead+=W,w.lookahead+w.insert>=I)for(T=w.strstart-w.insert,w.ins_h=w.window[T],w.ins_h=(w.ins_h<<w.hash_shift^w.window[T+1])&w.hash_mask;w.insert&&(w.ins_h=(w.ins_h<<w.hash_shift^w.window[T+I-1])&w.hash_mask,w.prev[T&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=T,T++,w.insert--,!(w.lookahead+w.insert<I)););}while(w.lookahead<K&&w.strm.avail_in!==0)}function ye(w,U){for(var W,O;;){if(w.lookahead<K){if(he(w),w.lookahead<K&&U===d)return b;if(w.lookahead===0)break}if(W=0,w.lookahead>=I&&(w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+I-1])&w.hash_mask,W=w.prev[w.strstart&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=w.strstart),W!==0&&w.strstart-W<=w.w_size-K&&(w.match_length=Z(w,W)),w.match_length>=I)if(O=a._tr_tally(w,w.strstart-w.match_start,w.match_length-I),w.lookahead-=w.match_length,w.match_length<=w.max_lazy_match&&w.lookahead>=I){for(w.match_length--;w.strstart++,w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+I-1])&w.hash_mask,W=w.prev[w.strstart&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=w.strstart,--w.match_length!=0;);w.strstart++}else w.strstart+=w.match_length,w.match_length=0,w.ins_h=w.window[w.strstart],w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+1])&w.hash_mask;else O=a._tr_tally(w,0,w.window[w.strstart]),w.lookahead--,w.strstart++;if(O&&(B(w,!1),w.strm.avail_out===0))return b}return w.insert=w.strstart<I-1?w.strstart:I-1,U===p?(B(w,!0),w.strm.avail_out===0?H:A):w.last_lit&&(B(w,!1),w.strm.avail_out===0)?b:N}function le(w,U){for(var W,O,S;;){if(w.lookahead<K){if(he(w),w.lookahead<K&&U===d)return b;if(w.lookahead===0)break}if(W=0,w.lookahead>=I&&(w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+I-1])&w.hash_mask,W=w.prev[w.strstart&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=w.strstart),w.prev_length=w.match_length,w.prev_match=w.match_start,w.match_length=I-1,W!==0&&w.prev_length<w.max_lazy_match&&w.strstart-W<=w.w_size-K&&(w.match_length=Z(w,W),w.match_length<=5&&(w.strategy===1||w.match_length===I&&4096<w.strstart-w.match_start)&&(w.match_length=I-1)),w.prev_length>=I&&w.match_length<=w.prev_length){for(S=w.strstart+w.lookahead-I,O=a._tr_tally(w,w.strstart-1-w.prev_match,w.prev_length-I),w.lookahead-=w.prev_length-1,w.prev_length-=2;++w.strstart<=S&&(w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+I-1])&w.hash_mask,W=w.prev[w.strstart&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=w.strstart),--w.prev_length!=0;);if(w.match_available=0,w.match_length=I-1,w.strstart++,O&&(B(w,!1),w.strm.avail_out===0))return b}else if(w.match_available){if((O=a._tr_tally(w,0,w.window[w.strstart-1]))&&B(w,!1),w.strstart++,w.lookahead--,w.strm.avail_out===0)return b}else w.match_available=1,w.strstart++,w.lookahead--}return w.match_available&&(O=a._tr_tally(w,0,w.window[w.strstart-1]),w.match_available=0),w.insert=w.strstart<I-1?w.strstart:I-1,U===p?(B(w,!0),w.strm.avail_out===0?H:A):w.last_lit&&(B(w,!1),w.strm.avail_out===0)?b:N}function ue(w,U,W,O,S){this.good_length=w,this.max_lazy=U,this.nice_length=W,this.max_chain=O,this.func=S}function ke(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*E),this.dyn_dtree=new i.Buf16(2*(2*C+1)),this.bl_tree=new i.Buf16(2*(2*D+1)),te(this.dyn_ltree),te(this.dyn_dtree),te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(F+1),this.heap=new i.Buf16(2*x+1),te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*x+1),te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ve(w){var U;return w&&w.state?(w.total_in=w.total_out=0,w.data_type=y,(U=w.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?j:M,w.adler=U.wrap===2?0:1,U.last_flush=d,a._tr_init(U),h):X(w,v)}function me(w){var U=ve(w);return U===h&&function(W){W.window_size=2*W.w_size,te(W.head),W.max_lazy_match=s[W.level].max_lazy,W.good_match=s[W.level].good_length,W.nice_match=s[W.level].nice_length,W.max_chain_length=s[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=I-1,W.match_available=0,W.ins_h=0}(w.state),U}function Ee(w,U,W,O,S,T){if(!w)return v;var q=1;if(U===f&&(U=6),O<0?(q=0,O=-O):15<O&&(q=2,O-=16),S<1||_<S||W!==g||O<8||15<O||U<0||9<U||T<0||m<T)return X(w,v);O===8&&(O=9);var J=new ke;return(w.state=J).strm=w,J.wrap=q,J.gzhead=null,J.w_bits=O,J.w_size=1<<J.w_bits,J.w_mask=J.w_size-1,J.hash_bits=S+7,J.hash_size=1<<J.hash_bits,J.hash_mask=J.hash_size-1,J.hash_shift=~~((J.hash_bits+I-1)/I),J.window=new i.Buf8(2*J.w_size),J.head=new i.Buf16(J.hash_size),J.prev=new i.Buf16(J.w_size),J.lit_bufsize=1<<S+6,J.pending_buf_size=4*J.lit_bufsize,J.pending_buf=new i.Buf8(J.pending_buf_size),J.d_buf=1*J.lit_bufsize,J.l_buf=3*J.lit_bufsize,J.level=U,J.strategy=T,J.method=W,me(w)}s=[new ue(0,0,0,0,function(w,U){var W=65535;for(W>w.pending_buf_size-5&&(W=w.pending_buf_size-5);;){if(w.lookahead<=1){if(he(w),w.lookahead===0&&U===d)return b;if(w.lookahead===0)break}w.strstart+=w.lookahead,w.lookahead=0;var O=w.block_start+W;if((w.strstart===0||w.strstart>=O)&&(w.lookahead=w.strstart-O,w.strstart=O,B(w,!1),w.strm.avail_out===0)||w.strstart-w.block_start>=w.w_size-K&&(B(w,!1),w.strm.avail_out===0))return b}return w.insert=0,U===p?(B(w,!0),w.strm.avail_out===0?H:A):(w.strstart>w.block_start&&(B(w,!1),w.strm.avail_out),b)}),new ue(4,4,8,4,ye),new ue(4,5,16,8,ye),new ue(4,6,32,32,ye),new ue(4,4,16,16,le),new ue(8,16,32,32,le),new ue(8,16,128,128,le),new ue(8,32,128,256,le),new ue(32,128,258,1024,le),new ue(32,258,258,4096,le)],o.deflateInit=function(w,U){return Ee(w,U,g,15,8,0)},o.deflateInit2=Ee,o.deflateReset=me,o.deflateResetKeep=ve,o.deflateSetHeader=function(w,U){return w&&w.state?w.state.wrap!==2?v:(w.state.gzhead=U,h):v},o.deflate=function(w,U){var W,O,S,T;if(!w||!w.state||5<U||U<0)return w?X(w,v):v;if(O=w.state,!w.output||!w.input&&w.avail_in!==0||O.status===666&&U!==p)return X(w,w.avail_out===0?-5:v);if(O.strm=w,W=O.last_flush,O.last_flush=U,O.status===j)if(O.wrap===2)w.adler=0,ne(O,31),ne(O,139),ne(O,8),O.gzhead?(ne(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),ne(O,255&O.gzhead.time),ne(O,O.gzhead.time>>8&255),ne(O,O.gzhead.time>>16&255),ne(O,O.gzhead.time>>24&255),ne(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),ne(O,255&O.gzhead.os),O.gzhead.extra&&O.gzhead.extra.length&&(ne(O,255&O.gzhead.extra.length),ne(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(w.adler=c(w.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=69):(ne(O,0),ne(O,0),ne(O,0),ne(O,0),ne(O,0),ne(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),ne(O,3),O.status=M);else{var q=g+(O.w_bits-8<<4)<<8;q|=(2<=O.strategy||O.level<2?0:O.level<6?1:O.level===6?2:3)<<6,O.strstart!==0&&(q|=32),q+=31-q%31,O.status=M,Y(O,q),O.strstart!==0&&(Y(O,w.adler>>>16),Y(O,65535&w.adler)),w.adler=1}if(O.status===69)if(O.gzhead.extra){for(S=O.pending;O.gzindex<(65535&O.gzhead.extra.length)&&(O.pending!==O.pending_buf_size||(O.gzhead.hcrc&&O.pending>S&&(w.adler=c(w.adler,O.pending_buf,O.pending-S,S)),z(w),S=O.pending,O.pending!==O.pending_buf_size));)ne(O,255&O.gzhead.extra[O.gzindex]),O.gzindex++;O.gzhead.hcrc&&O.pending>S&&(w.adler=c(w.adler,O.pending_buf,O.pending-S,S)),O.gzindex===O.gzhead.extra.length&&(O.gzindex=0,O.status=73)}else O.status=73;if(O.status===73)if(O.gzhead.name){S=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>S&&(w.adler=c(w.adler,O.pending_buf,O.pending-S,S)),z(w),S=O.pending,O.pending===O.pending_buf_size)){T=1;break}T=O.gzindex<O.gzhead.name.length?255&O.gzhead.name.charCodeAt(O.gzindex++):0,ne(O,T)}while(T!==0);O.gzhead.hcrc&&O.pending>S&&(w.adler=c(w.adler,O.pending_buf,O.pending-S,S)),T===0&&(O.gzindex=0,O.status=91)}else O.status=91;if(O.status===91)if(O.gzhead.comment){S=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>S&&(w.adler=c(w.adler,O.pending_buf,O.pending-S,S)),z(w),S=O.pending,O.pending===O.pending_buf_size)){T=1;break}T=O.gzindex<O.gzhead.comment.length?255&O.gzhead.comment.charCodeAt(O.gzindex++):0,ne(O,T)}while(T!==0);O.gzhead.hcrc&&O.pending>S&&(w.adler=c(w.adler,O.pending_buf,O.pending-S,S)),T===0&&(O.status=103)}else O.status=103;if(O.status===103&&(O.gzhead.hcrc?(O.pending+2>O.pending_buf_size&&z(w),O.pending+2<=O.pending_buf_size&&(ne(O,255&w.adler),ne(O,w.adler>>8&255),w.adler=0,O.status=M)):O.status=M),O.pending!==0){if(z(w),w.avail_out===0)return O.last_flush=-1,h}else if(w.avail_in===0&&V(U)<=V(W)&&U!==p)return X(w,-5);if(O.status===666&&w.avail_in!==0)return X(w,-5);if(w.avail_in!==0||O.lookahead!==0||U!==d&&O.status!==666){var J=O.strategy===2?function(L,Q){for(var re;;){if(L.lookahead===0&&(he(L),L.lookahead===0)){if(Q===d)return b;break}if(L.match_length=0,re=a._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,re&&(B(L,!1),L.strm.avail_out===0))return b}return L.insert=0,Q===p?(B(L,!0),L.strm.avail_out===0?H:A):L.last_lit&&(B(L,!1),L.strm.avail_out===0)?b:N}(O,U):O.strategy===3?function(L,Q){for(var re,ee,se,ge,pe=L.window;;){if(L.lookahead<=R){if(he(L),L.lookahead<=R&&Q===d)return b;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=I&&0<L.strstart&&(ee=pe[se=L.strstart-1])===pe[++se]&&ee===pe[++se]&&ee===pe[++se]){ge=L.strstart+R;do;while(ee===pe[++se]&&ee===pe[++se]&&ee===pe[++se]&&ee===pe[++se]&&ee===pe[++se]&&ee===pe[++se]&&ee===pe[++se]&&ee===pe[++se]&&se<ge);L.match_length=R-(ge-se),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=I?(re=a._tr_tally(L,1,L.match_length-I),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(re=a._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),re&&(B(L,!1),L.strm.avail_out===0))return b}return L.insert=0,Q===p?(B(L,!0),L.strm.avail_out===0?H:A):L.last_lit&&(B(L,!1),L.strm.avail_out===0)?b:N}(O,U):s[O.level].func(O,U);if(J!==H&&J!==A||(O.status=666),J===b||J===H)return w.avail_out===0&&(O.last_flush=-1),h;if(J===N&&(U===1?a._tr_align(O):U!==5&&(a._tr_stored_block(O,0,0,!1),U===3&&(te(O.head),O.lookahead===0&&(O.strstart=0,O.block_start=0,O.insert=0))),z(w),w.avail_out===0))return O.last_flush=-1,h}return U!==p?h:O.wrap<=0?1:(O.wrap===2?(ne(O,255&w.adler),ne(O,w.adler>>8&255),ne(O,w.adler>>16&255),ne(O,w.adler>>24&255),ne(O,255&w.total_in),ne(O,w.total_in>>8&255),ne(O,w.total_in>>16&255),ne(O,w.total_in>>24&255)):(Y(O,w.adler>>>16),Y(O,65535&w.adler)),z(w),0<O.wrap&&(O.wrap=-O.wrap),O.pending!==0?h:1)},o.deflateEnd=function(w){var U;return w&&w.state?(U=w.state.status)!==j&&U!==69&&U!==73&&U!==91&&U!==103&&U!==M&&U!==666?X(w,v):(w.state=null,U===M?X(w,-3):h):v},o.deflateSetDictionary=function(w,U){var W,O,S,T,q,J,L,Q,re=U.length;if(!w||!w.state||(T=(W=w.state).wrap)===2||T===1&&W.status!==j||W.lookahead)return v;for(T===1&&(w.adler=l(w.adler,U,re,0)),W.wrap=0,re>=W.w_size&&(T===0&&(te(W.head),W.strstart=0,W.block_start=0,W.insert=0),Q=new i.Buf8(W.w_size),i.arraySet(Q,U,re-W.w_size,W.w_size,0),U=Q,re=W.w_size),q=w.avail_in,J=w.next_in,L=w.input,w.avail_in=re,w.next_in=0,w.input=U,he(W);W.lookahead>=I;){for(O=W.strstart,S=W.lookahead-(I-1);W.ins_h=(W.ins_h<<W.hash_shift^W.window[O+I-1])&W.hash_mask,W.prev[O&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=O,O++,--S;);W.strstart=O,W.lookahead=I-1,he(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=I-1,W.match_available=0,w.next_in=J,w.input=L,w.avail_in=q,W.wrap=T,h},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,o){r.exports=function(s,i){var a,l,c,u,d,p,h,v,f,m,y,g,_,x,C,D,E,F,I,R,K,j,M,b,N;a=s.state,l=s.next_in,b=s.input,c=l+(s.avail_in-5),u=s.next_out,N=s.output,d=u-(i-s.avail_out),p=u+(s.avail_out-257),h=a.dmax,v=a.wsize,f=a.whave,m=a.wnext,y=a.window,g=a.hold,_=a.bits,x=a.lencode,C=a.distcode,D=(1<<a.lenbits)-1,E=(1<<a.distbits)-1;e:do{_<15&&(g+=b[l++]<<_,_+=8,g+=b[l++]<<_,_+=8),F=x[g&D];t:for(;;){if(g>>>=I=F>>>24,_-=I,(I=F>>>16&255)===0)N[u++]=65535&F;else{if(!(16&I)){if(!(64&I)){F=x[(65535&F)+(g&(1<<I)-1)];continue t}if(32&I){a.mode=12;break e}s.msg="invalid literal/length code",a.mode=30;break e}R=65535&F,(I&=15)&&(_<I&&(g+=b[l++]<<_,_+=8),R+=g&(1<<I)-1,g>>>=I,_-=I),_<15&&(g+=b[l++]<<_,_+=8,g+=b[l++]<<_,_+=8),F=C[g&E];n:for(;;){if(g>>>=I=F>>>24,_-=I,!(16&(I=F>>>16&255))){if(!(64&I)){F=C[(65535&F)+(g&(1<<I)-1)];continue n}s.msg="invalid distance code",a.mode=30;break e}if(K=65535&F,_<(I&=15)&&(g+=b[l++]<<_,(_+=8)<I&&(g+=b[l++]<<_,_+=8)),h<(K+=g&(1<<I)-1)){s.msg="invalid distance too far back",a.mode=30;break e}if(g>>>=I,_-=I,(I=u-d)<K){if(f<(I=K-I)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break e}if(M=y,(j=0)===m){if(j+=v-I,I<R){for(R-=I;N[u++]=y[j++],--I;);j=u-K,M=N}}else if(m<I){if(j+=v+m-I,(I-=m)<R){for(R-=I;N[u++]=y[j++],--I;);if(j=0,m<R){for(R-=I=m;N[u++]=y[j++],--I;);j=u-K,M=N}}}else if(j+=m-I,I<R){for(R-=I;N[u++]=y[j++],--I;);j=u-K,M=N}for(;2<R;)N[u++]=M[j++],N[u++]=M[j++],N[u++]=M[j++],R-=3;R&&(N[u++]=M[j++],1<R&&(N[u++]=M[j++]))}else{for(j=u-K;N[u++]=N[j++],N[u++]=N[j++],N[u++]=N[j++],2<(R-=3););R&&(N[u++]=N[j++],1<R&&(N[u++]=N[j++]))}break}}break}}while(l<c&&u<p);l-=R=_>>3,g&=(1<<(_-=R<<3))-1,s.next_in=l,s.next_out=u,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=u<p?p-u+257:257-(u-p),a.hold=g,a.bits=_}},{}],49:[function(n,r,o){var s=n("../utils/common"),i=n("./adler32"),a=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,p=0,h=-2,v=1,f=852,m=592;function y(j){return(j>>>24&255)+(j>>>8&65280)+((65280&j)<<8)+((255&j)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(j){var M;return j&&j.state?(M=j.state,j.total_in=j.total_out=M.total=0,j.msg="",M.wrap&&(j.adler=1&M.wrap),M.mode=v,M.last=0,M.havedict=0,M.dmax=32768,M.head=null,M.hold=0,M.bits=0,M.lencode=M.lendyn=new s.Buf32(f),M.distcode=M.distdyn=new s.Buf32(m),M.sane=1,M.back=-1,p):h}function x(j){var M;return j&&j.state?((M=j.state).wsize=0,M.whave=0,M.wnext=0,_(j)):h}function C(j,M){var b,N;return j&&j.state?(N=j.state,M<0?(b=0,M=-M):(b=1+(M>>4),M<48&&(M&=15)),M&&(M<8||15<M)?h:(N.window!==null&&N.wbits!==M&&(N.window=null),N.wrap=b,N.wbits=M,x(j))):h}function D(j,M){var b,N;return j?(N=new g,(j.state=N).window=null,(b=C(j,M))!==p&&(j.state=null),b):h}var E,F,I=!0;function R(j){if(I){var M;for(E=new s.Buf32(512),F=new s.Buf32(32),M=0;M<144;)j.lens[M++]=8;for(;M<256;)j.lens[M++]=9;for(;M<280;)j.lens[M++]=7;for(;M<288;)j.lens[M++]=8;for(c(u,j.lens,0,288,E,0,j.work,{bits:9}),M=0;M<32;)j.lens[M++]=5;c(d,j.lens,0,32,F,0,j.work,{bits:5}),I=!1}j.lencode=E,j.lenbits=9,j.distcode=F,j.distbits=5}function K(j,M,b,N){var H,A=j.state;return A.window===null&&(A.wsize=1<<A.wbits,A.wnext=0,A.whave=0,A.window=new s.Buf8(A.wsize)),N>=A.wsize?(s.arraySet(A.window,M,b-A.wsize,A.wsize,0),A.wnext=0,A.whave=A.wsize):(N<(H=A.wsize-A.wnext)&&(H=N),s.arraySet(A.window,M,b-N,H,A.wnext),(N-=H)?(s.arraySet(A.window,M,b-N,N,0),A.wnext=N,A.whave=A.wsize):(A.wnext+=H,A.wnext===A.wsize&&(A.wnext=0),A.whave<A.wsize&&(A.whave+=H))),0}o.inflateReset=x,o.inflateReset2=C,o.inflateResetKeep=_,o.inflateInit=function(j){return D(j,15)},o.inflateInit2=D,o.inflate=function(j,M){var b,N,H,A,X,V,te,z,B,ne,Y,Z,he,ye,le,ue,ke,ve,me,Ee,w,U,W,O,S=0,T=new s.Buf8(4),q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return h;(b=j.state).mode===12&&(b.mode=13),X=j.next_out,H=j.output,te=j.avail_out,A=j.next_in,N=j.input,V=j.avail_in,z=b.hold,B=b.bits,ne=V,Y=te,U=p;e:for(;;)switch(b.mode){case v:if(b.wrap===0){b.mode=13;break}for(;B<16;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if(2&b.wrap&&z===35615){T[b.check=0]=255&z,T[1]=z>>>8&255,b.check=a(b.check,T,2,0),B=z=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&z)<<8)+(z>>8))%31){j.msg="incorrect header check",b.mode=30;break}if((15&z)!=8){j.msg="unknown compression method",b.mode=30;break}if(B-=4,w=8+(15&(z>>>=4)),b.wbits===0)b.wbits=w;else if(w>b.wbits){j.msg="invalid window size",b.mode=30;break}b.dmax=1<<w,j.adler=b.check=1,b.mode=512&z?10:12,B=z=0;break;case 2:for(;B<16;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if(b.flags=z,(255&b.flags)!=8){j.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){j.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=z>>8&1),512&b.flags&&(T[0]=255&z,T[1]=z>>>8&255,b.check=a(b.check,T,2,0)),B=z=0,b.mode=3;case 3:for(;B<32;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}b.head&&(b.head.time=z),512&b.flags&&(T[0]=255&z,T[1]=z>>>8&255,T[2]=z>>>16&255,T[3]=z>>>24&255,b.check=a(b.check,T,4,0)),B=z=0,b.mode=4;case 4:for(;B<16;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}b.head&&(b.head.xflags=255&z,b.head.os=z>>8),512&b.flags&&(T[0]=255&z,T[1]=z>>>8&255,b.check=a(b.check,T,2,0)),B=z=0,b.mode=5;case 5:if(1024&b.flags){for(;B<16;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}b.length=z,b.head&&(b.head.extra_len=z),512&b.flags&&(T[0]=255&z,T[1]=z>>>8&255,b.check=a(b.check,T,2,0)),B=z=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(V<(Z=b.length)&&(Z=V),Z&&(b.head&&(w=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),s.arraySet(b.head.extra,N,A,Z,w)),512&b.flags&&(b.check=a(b.check,N,Z,A)),V-=Z,A+=Z,b.length-=Z),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(V===0)break e;for(Z=0;w=N[A+Z++],b.head&&w&&b.length<65536&&(b.head.name+=String.fromCharCode(w)),w&&Z<V;);if(512&b.flags&&(b.check=a(b.check,N,Z,A)),V-=Z,A+=Z,w)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(V===0)break e;for(Z=0;w=N[A+Z++],b.head&&w&&b.length<65536&&(b.head.comment+=String.fromCharCode(w)),w&&Z<V;);if(512&b.flags&&(b.check=a(b.check,N,Z,A)),V-=Z,A+=Z,w)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;B<16;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if(z!==(65535&b.check)){j.msg="header crc mismatch",b.mode=30;break}B=z=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),j.adler=b.check=0,b.mode=12;break;case 10:for(;B<32;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}j.adler=b.check=y(z),B=z=0,b.mode=11;case 11:if(b.havedict===0)return j.next_out=X,j.avail_out=te,j.next_in=A,j.avail_in=V,b.hold=z,b.bits=B,2;j.adler=b.check=1,b.mode=12;case 12:if(M===5||M===6)break e;case 13:if(b.last){z>>>=7&B,B-=7&B,b.mode=27;break}for(;B<3;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}switch(b.last=1&z,B-=1,3&(z>>>=1)){case 0:b.mode=14;break;case 1:if(R(b),b.mode=20,M!==6)break;z>>>=2,B-=2;break e;case 2:b.mode=17;break;case 3:j.msg="invalid block type",b.mode=30}z>>>=2,B-=2;break;case 14:for(z>>>=7&B,B-=7&B;B<32;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if((65535&z)!=(z>>>16^65535)){j.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&z,B=z=0,b.mode=15,M===6)break e;case 15:b.mode=16;case 16:if(Z=b.length){if(V<Z&&(Z=V),te<Z&&(Z=te),Z===0)break e;s.arraySet(H,N,A,Z,X),V-=Z,A+=Z,te-=Z,X+=Z,b.length-=Z;break}b.mode=12;break;case 17:for(;B<14;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if(b.nlen=257+(31&z),z>>>=5,B-=5,b.ndist=1+(31&z),z>>>=5,B-=5,b.ncode=4+(15&z),z>>>=4,B-=4,286<b.nlen||30<b.ndist){j.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;B<3;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}b.lens[q[b.have++]]=7&z,z>>>=3,B-=3}for(;b.have<19;)b.lens[q[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,W={bits:b.lenbits},U=c(0,b.lens,0,19,b.lencode,0,b.work,W),b.lenbits=W.bits,U){j.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;ue=(S=b.lencode[z&(1<<b.lenbits)-1])>>>16&255,ke=65535&S,!((le=S>>>24)<=B);){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if(ke<16)z>>>=le,B-=le,b.lens[b.have++]=ke;else{if(ke===16){for(O=le+2;B<O;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if(z>>>=le,B-=le,b.have===0){j.msg="invalid bit length repeat",b.mode=30;break}w=b.lens[b.have-1],Z=3+(3&z),z>>>=2,B-=2}else if(ke===17){for(O=le+3;B<O;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}B-=le,w=0,Z=3+(7&(z>>>=le)),z>>>=3,B-=3}else{for(O=le+7;B<O;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}B-=le,w=0,Z=11+(127&(z>>>=le)),z>>>=7,B-=7}if(b.have+Z>b.nlen+b.ndist){j.msg="invalid bit length repeat",b.mode=30;break}for(;Z--;)b.lens[b.have++]=w}}if(b.mode===30)break;if(b.lens[256]===0){j.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,W={bits:b.lenbits},U=c(u,b.lens,0,b.nlen,b.lencode,0,b.work,W),b.lenbits=W.bits,U){j.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,W={bits:b.distbits},U=c(d,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,W),b.distbits=W.bits,U){j.msg="invalid distances set",b.mode=30;break}if(b.mode=20,M===6)break e;case 20:b.mode=21;case 21:if(6<=V&&258<=te){j.next_out=X,j.avail_out=te,j.next_in=A,j.avail_in=V,b.hold=z,b.bits=B,l(j,Y),X=j.next_out,H=j.output,te=j.avail_out,A=j.next_in,N=j.input,V=j.avail_in,z=b.hold,B=b.bits,b.mode===12&&(b.back=-1);break}for(b.back=0;ue=(S=b.lencode[z&(1<<b.lenbits)-1])>>>16&255,ke=65535&S,!((le=S>>>24)<=B);){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if(ue&&!(240&ue)){for(ve=le,me=ue,Ee=ke;ue=(S=b.lencode[Ee+((z&(1<<ve+me)-1)>>ve)])>>>16&255,ke=65535&S,!(ve+(le=S>>>24)<=B);){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}z>>>=ve,B-=ve,b.back+=ve}if(z>>>=le,B-=le,b.back+=le,b.length=ke,ue===0){b.mode=26;break}if(32&ue){b.back=-1,b.mode=12;break}if(64&ue){j.msg="invalid literal/length code",b.mode=30;break}b.extra=15&ue,b.mode=22;case 22:if(b.extra){for(O=b.extra;B<O;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}b.length+=z&(1<<b.extra)-1,z>>>=b.extra,B-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;ue=(S=b.distcode[z&(1<<b.distbits)-1])>>>16&255,ke=65535&S,!((le=S>>>24)<=B);){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if(!(240&ue)){for(ve=le,me=ue,Ee=ke;ue=(S=b.distcode[Ee+((z&(1<<ve+me)-1)>>ve)])>>>16&255,ke=65535&S,!(ve+(le=S>>>24)<=B);){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}z>>>=ve,B-=ve,b.back+=ve}if(z>>>=le,B-=le,b.back+=le,64&ue){j.msg="invalid distance code",b.mode=30;break}b.offset=ke,b.extra=15&ue,b.mode=24;case 24:if(b.extra){for(O=b.extra;B<O;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}b.offset+=z&(1<<b.extra)-1,z>>>=b.extra,B-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){j.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(te===0)break e;if(Z=Y-te,b.offset>Z){if((Z=b.offset-Z)>b.whave&&b.sane){j.msg="invalid distance too far back",b.mode=30;break}he=Z>b.wnext?(Z-=b.wnext,b.wsize-Z):b.wnext-Z,Z>b.length&&(Z=b.length),ye=b.window}else ye=H,he=X-b.offset,Z=b.length;for(te<Z&&(Z=te),te-=Z,b.length-=Z;H[X++]=ye[he++],--Z;);b.length===0&&(b.mode=21);break;case 26:if(te===0)break e;H[X++]=b.length,te--,b.mode=21;break;case 27:if(b.wrap){for(;B<32;){if(V===0)break e;V--,z|=N[A++]<<B,B+=8}if(Y-=te,j.total_out+=Y,b.total+=Y,Y&&(j.adler=b.check=b.flags?a(b.check,H,Y,X-Y):i(b.check,H,Y,X-Y)),Y=te,(b.flags?z:y(z))!==b.check){j.msg="incorrect data check",b.mode=30;break}B=z=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;B<32;){if(V===0)break e;V--,z+=N[A++]<<B,B+=8}if(z!==(4294967295&b.total)){j.msg="incorrect length check",b.mode=30;break}B=z=0}b.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return h}return j.next_out=X,j.avail_out=te,j.next_in=A,j.avail_in=V,b.hold=z,b.bits=B,(b.wsize||Y!==j.avail_out&&b.mode<30&&(b.mode<27||M!==4))&&K(j,j.output,j.next_out,Y-j.avail_out)?(b.mode=31,-4):(ne-=j.avail_in,Y-=j.avail_out,j.total_in+=ne,j.total_out+=Y,b.total+=Y,b.wrap&&Y&&(j.adler=b.check=b.flags?a(b.check,H,Y,j.next_out-Y):i(b.check,H,Y,j.next_out-Y)),j.data_type=b.bits+(b.last?64:0)+(b.mode===12?128:0)+(b.mode===20||b.mode===15?256:0),(ne==0&&Y===0||M===4)&&U===p&&(U=-5),U)},o.inflateEnd=function(j){if(!j||!j.state)return h;var M=j.state;return M.window&&(M.window=null),j.state=null,p},o.inflateGetHeader=function(j,M){var b;return j&&j.state&&2&(b=j.state).wrap?((b.head=M).done=!1,p):h},o.inflateSetDictionary=function(j,M){var b,N=M.length;return j&&j.state?(b=j.state).wrap!==0&&b.mode!==11?h:b.mode===11&&i(1,M,N,0)!==b.check?-3:K(j,M,N,N)?(b.mode=31,-4):(b.havedict=1,p):h},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,o){var s=n("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,p,h,v,f,m,y){var g,_,x,C,D,E,F,I,R,K=y.bits,j=0,M=0,b=0,N=0,H=0,A=0,X=0,V=0,te=0,z=0,B=null,ne=0,Y=new s.Buf16(16),Z=new s.Buf16(16),he=null,ye=0;for(j=0;j<=15;j++)Y[j]=0;for(M=0;M<h;M++)Y[d[p+M]]++;for(H=K,N=15;1<=N&&Y[N]===0;N--);if(N<H&&(H=N),N===0)return v[f++]=20971520,v[f++]=20971520,y.bits=1,0;for(b=1;b<N&&Y[b]===0;b++);for(H<b&&(H=b),j=V=1;j<=15;j++)if(V<<=1,(V-=Y[j])<0)return-1;if(0<V&&(u===0||N!==1))return-1;for(Z[1]=0,j=1;j<15;j++)Z[j+1]=Z[j]+Y[j];for(M=0;M<h;M++)d[p+M]!==0&&(m[Z[d[p+M]]++]=M);if(E=u===0?(B=he=m,19):u===1?(B=i,ne-=257,he=a,ye-=257,256):(B=l,he=c,-1),j=b,D=f,X=M=z=0,x=-1,C=(te=1<<(A=H))-1,u===1&&852<te||u===2&&592<te)return 1;for(;;){for(F=j-X,R=m[M]<E?(I=0,m[M]):m[M]>E?(I=he[ye+m[M]],B[ne+m[M]]):(I=96,0),g=1<<j-X,b=_=1<<A;v[D+(z>>X)+(_-=g)]=F<<24|I<<16|R|0,_!==0;);for(g=1<<j-1;z&g;)g>>=1;if(g!==0?(z&=g-1,z+=g):z=0,M++,--Y[j]==0){if(j===N)break;j=d[p+m[M]]}if(H<j&&(z&C)!==x){for(X===0&&(X=H),D+=b,V=1<<(A=j-X);A+X<N&&!((V-=Y[A+X])<=0);)A++,V<<=1;if(te+=1<<A,u===1&&852<te||u===2&&592<te)return 1;v[x=z&C]=H<<24|A<<16|D-f|0}}return z!==0&&(v[D+z]=j-X<<24|64<<16|0),y.bits=H,0}},{"../utils/common":41}],51:[function(n,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,o){var s=n("../utils/common"),i=0,a=1;function l(S){for(var T=S.length;0<=--T;)S[T]=0}var c=0,u=29,d=256,p=d+1+u,h=30,v=19,f=2*p+1,m=15,y=16,g=7,_=256,x=16,C=17,D=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(2*(p+2));l(K);var j=new Array(2*h);l(j);var M=new Array(512);l(M);var b=new Array(256);l(b);var N=new Array(u);l(N);var H,A,X,V=new Array(h);function te(S,T,q,J,L){this.static_tree=S,this.extra_bits=T,this.extra_base=q,this.elems=J,this.max_length=L,this.has_stree=S&&S.length}function z(S,T){this.dyn_tree=S,this.max_code=0,this.stat_desc=T}function B(S){return S<256?M[S]:M[256+(S>>>7)]}function ne(S,T){S.pending_buf[S.pending++]=255&T,S.pending_buf[S.pending++]=T>>>8&255}function Y(S,T,q){S.bi_valid>y-q?(S.bi_buf|=T<<S.bi_valid&65535,ne(S,S.bi_buf),S.bi_buf=T>>y-S.bi_valid,S.bi_valid+=q-y):(S.bi_buf|=T<<S.bi_valid&65535,S.bi_valid+=q)}function Z(S,T,q){Y(S,q[2*T],q[2*T+1])}function he(S,T){for(var q=0;q|=1&S,S>>>=1,q<<=1,0<--T;);return q>>>1}function ye(S,T,q){var J,L,Q=new Array(m+1),re=0;for(J=1;J<=m;J++)Q[J]=re=re+q[J-1]<<1;for(L=0;L<=T;L++){var ee=S[2*L+1];ee!==0&&(S[2*L]=he(Q[ee]++,ee))}}function le(S){var T;for(T=0;T<p;T++)S.dyn_ltree[2*T]=0;for(T=0;T<h;T++)S.dyn_dtree[2*T]=0;for(T=0;T<v;T++)S.bl_tree[2*T]=0;S.dyn_ltree[2*_]=1,S.opt_len=S.static_len=0,S.last_lit=S.matches=0}function ue(S){8<S.bi_valid?ne(S,S.bi_buf):0<S.bi_valid&&(S.pending_buf[S.pending++]=S.bi_buf),S.bi_buf=0,S.bi_valid=0}function ke(S,T,q,J){var L=2*T,Q=2*q;return S[L]<S[Q]||S[L]===S[Q]&&J[T]<=J[q]}function ve(S,T,q){for(var J=S.heap[q],L=q<<1;L<=S.heap_len&&(L<S.heap_len&&ke(T,S.heap[L+1],S.heap[L],S.depth)&&L++,!ke(T,J,S.heap[L],S.depth));)S.heap[q]=S.heap[L],q=L,L<<=1;S.heap[q]=J}function me(S,T,q){var J,L,Q,re,ee=0;if(S.last_lit!==0)for(;J=S.pending_buf[S.d_buf+2*ee]<<8|S.pending_buf[S.d_buf+2*ee+1],L=S.pending_buf[S.l_buf+ee],ee++,J===0?Z(S,L,T):(Z(S,(Q=b[L])+d+1,T),(re=E[Q])!==0&&Y(S,L-=N[Q],re),Z(S,Q=B(--J),q),(re=F[Q])!==0&&Y(S,J-=V[Q],re)),ee<S.last_lit;);Z(S,_,T)}function Ee(S,T){var q,J,L,Q=T.dyn_tree,re=T.stat_desc.static_tree,ee=T.stat_desc.has_stree,se=T.stat_desc.elems,ge=-1;for(S.heap_len=0,S.heap_max=f,q=0;q<se;q++)Q[2*q]!==0?(S.heap[++S.heap_len]=ge=q,S.depth[q]=0):Q[2*q+1]=0;for(;S.heap_len<2;)Q[2*(L=S.heap[++S.heap_len]=ge<2?++ge:0)]=1,S.depth[L]=0,S.opt_len--,ee&&(S.static_len-=re[2*L+1]);for(T.max_code=ge,q=S.heap_len>>1;1<=q;q--)ve(S,Q,q);for(L=se;q=S.heap[1],S.heap[1]=S.heap[S.heap_len--],ve(S,Q,1),J=S.heap[1],S.heap[--S.heap_max]=q,S.heap[--S.heap_max]=J,Q[2*L]=Q[2*q]+Q[2*J],S.depth[L]=(S.depth[q]>=S.depth[J]?S.depth[q]:S.depth[J])+1,Q[2*q+1]=Q[2*J+1]=L,S.heap[1]=L++,ve(S,Q,1),2<=S.heap_len;);S.heap[--S.heap_max]=S.heap[1],function(pe,Xe){var xn,at,kn,je,Qn,io,ht=Xe.dyn_tree,Js=Xe.max_code,Il=Xe.stat_desc.static_tree,Ol=Xe.stat_desc.has_stree,Dl=Xe.stat_desc.extra_bits,Ys=Xe.stat_desc.extra_base,En=Xe.stat_desc.max_length,er=0;for(je=0;je<=m;je++)pe.bl_count[je]=0;for(ht[2*pe.heap[pe.heap_max]+1]=0,xn=pe.heap_max+1;xn<f;xn++)En<(je=ht[2*ht[2*(at=pe.heap[xn])+1]+1]+1)&&(je=En,er++),ht[2*at+1]=je,Js<at||(pe.bl_count[je]++,Qn=0,Ys<=at&&(Qn=Dl[at-Ys]),io=ht[2*at],pe.opt_len+=io*(je+Qn),Ol&&(pe.static_len+=io*(Il[2*at+1]+Qn)));if(er!==0){do{for(je=En-1;pe.bl_count[je]===0;)je--;pe.bl_count[je]--,pe.bl_count[je+1]+=2,pe.bl_count[En]--,er-=2}while(0<er);for(je=En;je!==0;je--)for(at=pe.bl_count[je];at!==0;)Js<(kn=pe.heap[--xn])||(ht[2*kn+1]!==je&&(pe.opt_len+=(je-ht[2*kn+1])*ht[2*kn],ht[2*kn+1]=je),at--)}}(S,T),ye(Q,ge,S.bl_count)}function w(S,T,q){var J,L,Q=-1,re=T[1],ee=0,se=7,ge=4;for(re===0&&(se=138,ge=3),T[2*(q+1)+1]=65535,J=0;J<=q;J++)L=re,re=T[2*(J+1)+1],++ee<se&&L===re||(ee<ge?S.bl_tree[2*L]+=ee:L!==0?(L!==Q&&S.bl_tree[2*L]++,S.bl_tree[2*x]++):ee<=10?S.bl_tree[2*C]++:S.bl_tree[2*D]++,Q=L,ge=(ee=0)===re?(se=138,3):L===re?(se=6,3):(se=7,4))}function U(S,T,q){var J,L,Q=-1,re=T[1],ee=0,se=7,ge=4;for(re===0&&(se=138,ge=3),J=0;J<=q;J++)if(L=re,re=T[2*(J+1)+1],!(++ee<se&&L===re)){if(ee<ge)for(;Z(S,L,S.bl_tree),--ee!=0;);else L!==0?(L!==Q&&(Z(S,L,S.bl_tree),ee--),Z(S,x,S.bl_tree),Y(S,ee-3,2)):ee<=10?(Z(S,C,S.bl_tree),Y(S,ee-3,3)):(Z(S,D,S.bl_tree),Y(S,ee-11,7));Q=L,ge=(ee=0)===re?(se=138,3):L===re?(se=6,3):(se=7,4)}}l(V);var W=!1;function O(S,T,q,J){Y(S,(c<<1)+(J?1:0),3),function(L,Q,re,ee){ue(L),ee&&(ne(L,re),ne(L,~re)),s.arraySet(L.pending_buf,L.window,Q,re,L.pending),L.pending+=re}(S,T,q,!0)}o._tr_init=function(S){W||(function(){var T,q,J,L,Q,re=new Array(m+1);for(L=J=0;L<u-1;L++)for(N[L]=J,T=0;T<1<<E[L];T++)b[J++]=L;for(b[J-1]=L,L=Q=0;L<16;L++)for(V[L]=Q,T=0;T<1<<F[L];T++)M[Q++]=L;for(Q>>=7;L<h;L++)for(V[L]=Q<<7,T=0;T<1<<F[L]-7;T++)M[256+Q++]=L;for(q=0;q<=m;q++)re[q]=0;for(T=0;T<=143;)K[2*T+1]=8,T++,re[8]++;for(;T<=255;)K[2*T+1]=9,T++,re[9]++;for(;T<=279;)K[2*T+1]=7,T++,re[7]++;for(;T<=287;)K[2*T+1]=8,T++,re[8]++;for(ye(K,p+1,re),T=0;T<h;T++)j[2*T+1]=5,j[2*T]=he(T,5);H=new te(K,E,d+1,p,m),A=new te(j,F,0,h,m),X=new te(new Array(0),I,0,v,g)}(),W=!0),S.l_desc=new z(S.dyn_ltree,H),S.d_desc=new z(S.dyn_dtree,A),S.bl_desc=new z(S.bl_tree,X),S.bi_buf=0,S.bi_valid=0,le(S)},o._tr_stored_block=O,o._tr_flush_block=function(S,T,q,J){var L,Q,re=0;0<S.level?(S.strm.data_type===2&&(S.strm.data_type=function(ee){var se,ge=4093624447;for(se=0;se<=31;se++,ge>>>=1)if(1&ge&&ee.dyn_ltree[2*se]!==0)return i;if(ee.dyn_ltree[18]!==0||ee.dyn_ltree[20]!==0||ee.dyn_ltree[26]!==0)return a;for(se=32;se<d;se++)if(ee.dyn_ltree[2*se]!==0)return a;return i}(S)),Ee(S,S.l_desc),Ee(S,S.d_desc),re=function(ee){var se;for(w(ee,ee.dyn_ltree,ee.l_desc.max_code),w(ee,ee.dyn_dtree,ee.d_desc.max_code),Ee(ee,ee.bl_desc),se=v-1;3<=se&&ee.bl_tree[2*R[se]+1]===0;se--);return ee.opt_len+=3*(se+1)+5+5+4,se}(S),L=S.opt_len+3+7>>>3,(Q=S.static_len+3+7>>>3)<=L&&(L=Q)):L=Q=q+5,q+4<=L&&T!==-1?O(S,T,q,J):S.strategy===4||Q===L?(Y(S,2+(J?1:0),3),me(S,K,j)):(Y(S,4+(J?1:0),3),function(ee,se,ge,pe){var Xe;for(Y(ee,se-257,5),Y(ee,ge-1,5),Y(ee,pe-4,4),Xe=0;Xe<pe;Xe++)Y(ee,ee.bl_tree[2*R[Xe]+1],3);U(ee,ee.dyn_ltree,se-1),U(ee,ee.dyn_dtree,ge-1)}(S,S.l_desc.max_code+1,S.d_desc.max_code+1,re+1),me(S,S.dyn_ltree,S.dyn_dtree)),le(S),J&&ue(S)},o._tr_tally=function(S,T,q){return S.pending_buf[S.d_buf+2*S.last_lit]=T>>>8&255,S.pending_buf[S.d_buf+2*S.last_lit+1]=255&T,S.pending_buf[S.l_buf+S.last_lit]=255&q,S.last_lit++,T===0?S.dyn_ltree[2*q]++:(S.matches++,T--,S.dyn_ltree[2*(b[q]+d+1)]++,S.dyn_dtree[2*B(T)]++),S.last_lit===S.lit_bufsize-1},o._tr_align=function(S){Y(S,2,3),Z(S,_,K),function(T){T.bi_valid===16?(ne(T,T.bi_buf),T.bi_buf=0,T.bi_valid=0):8<=T.bi_valid&&(T.pending_buf[T.pending++]=255&T.bi_buf,T.bi_buf>>=8,T.bi_valid-=8)}(S)}},{"../utils/common":41}],53:[function(n,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,o){(function(s){(function(i,a){if(!i.setImmediate){var l,c,u,d,p=1,h={},v=!1,f=i.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(i);m=m&&m.setTimeout?m:i,l={}.toString.call(i.process)==="[object process]"?function(x){process.nextTick(function(){g(x)})}:function(){if(i.postMessage&&!i.importScripts){var x=!0,C=i.onmessage;return i.onmessage=function(){x=!1},i.postMessage("","*"),i.onmessage=C,x}}()?(d="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",_,!1):i.attachEvent("onmessage",_),function(x){i.postMessage(d+x,"*")}):i.MessageChannel?((u=new MessageChannel).port1.onmessage=function(x){g(x.data)},function(x){u.port2.postMessage(x)}):f&&"onreadystatechange"in f.createElement("script")?(c=f.documentElement,function(x){var C=f.createElement("script");C.onreadystatechange=function(){g(x),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(x){setTimeout(g,0,x)},m.setImmediate=function(x){typeof x!="function"&&(x=new Function(""+x));for(var C=new Array(arguments.length-1),D=0;D<C.length;D++)C[D]=arguments[D+1];var E={callback:x,args:C};return h[p]=E,l(p),p++},m.clearImmediate=y}function y(x){delete h[x]}function g(x){if(v)setTimeout(g,0,x);else{var C=h[x];if(C){v=!0;try{(function(D){var E=D.callback,F=D.args;switch(F.length){case 0:E();break;case 1:E(F[0]);break;case 2:E(F[0],F[1]);break;case 3:E(F[0],F[1],F[2]);break;default:E.apply(a,F)}})(C)}finally{y(x),v=!1}}}}function _(x){x.source===i&&typeof x.data=="string"&&x.data.indexOf(d)===0&&g(+x.data.slice(d.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof tr<"u"?tr:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Sl);var Mp=Sl.exports;const Bp=Fa(Mp),zp=async t=>{const e=`ComfyUI workspace workflows ${ml(Date.now())}`,n=new Bp,r=await(G==null?void 0:G.getSetting("twoWaySync"));for(const o of t){let s;r?s=o.parentFolderID??"":s=await kh(o.parentFolderID??null).then(async a=>Ft(a??""));const i=n.folder(s);i==null||i.file(`${o.name}.json`,o.json)}n.generateAsync({type:"blob"}).then(function(o){const s=document.createElement("a");s.href=window.URL.createObjectURL(o),s.download=`${e}.zip`,document.body.appendChild(s),s.click(),document.body.removeChild(s)})};function Lp({myWorkflowsDir:t}){return k.jsxs(Ke,{gap:3,children:[k.jsx(sn,{size:"md",children:"🦄 Upgrade to 2.0 - enable two way sync!"}),k.jsx("p",{children:"Your workflows will be synced to and from path:"}),k.jsx("p",{children:k.jsx("b",{children:t})}),k.jsxs("p",{children:["You can manually put workflow files into this folder using File Explorer to sync them with your workspace. You can change this path anytime in Settings ",">"," Workspace Save Directory"]}),k.jsxs("p",{children:[k.jsx("b",{children:"Please download all your workflows before enabling two way sync as a backup!"})," ","So you can manually import some workflows into your workspace in case something unexpected happens."]}),k.jsx(Te,{colorScheme:"teal",variant:"outline",width:"fit-content",onClick:async()=>{const e=await($==null?void 0:$.listAll());zp(e??[])},children:"👉 Download All My Workflows"})]})}const Wp=(t,e)=>{const n=t.nodes==null?[]:t.nodes,r=e.nodes==null?[]:e.nodes;t.nodes=[],e.nodes=[];let o=JSON.stringify(t)===JSON.stringify(e);if(o){const s=(a,l)=>{const c=l.order,u=l.pos;return delete l.order,delete l.pos,a.set(l.id,JSON.stringify(l)),a.set(l.id+"_pos",u),l.order=c,l.pos=u,a},i=(a,l,c)=>Math.abs(a-l)>c;if(n.length==r.length){const a=n.reduce(s,new Map),l=r.reduce(s,new Map);for(let[c,u]of a){if(!l.has(c)){o=!1;break}if(typeof c=="string"&&c.includes("_pos")){const d=l.get(c);if(d==null||u==null||i(d[0],u[0],5)||i(d[1],u[1],5)){o=!1;break}}else if(l.get(c)!==u){o=!1;break}}}}return t.nodes=n,e.nodes=r,o},Up=La.lazy(()=>yn(()=>import("./RecentFilesDrawer-wX0u4Vce.js"),__vite__mapDeps([14,1,8,2,13,15,12,4]))),Kp=La.lazy(()=>yn(()=>import("./GalleryModal-tg9F_Ckt.js"),__vite__mapDeps([16,1,15,12,9,8,2,3])));function $p(){const[t,e]=P.useState(null),[n,r]=P.useState("root"),[o,s]=P.useState(!0),[i,a]=P.useState(null),l=P.useRef(null),[c,u]=P.useState(!1),d=P.useRef(null),{showDialog:p}=za(),[h,v]=P.useState(!1);P.useRef(!1);const f=Ua(),[m,y]=Tp(null),g=P.useCallback(async()=>{var N,H;if(l.current){if((N=$==null?void 0:$.curWorkflow)!=null&&N.saveLock){f({title:"The workflow is locked and cannot be saved",status:"warning",duration:3e3});return}const A=JSON.stringify(we.graph.serialize());await Promise.all([$==null?void 0:$.updateFlow(l.current,{json:A}),Ge==null?void 0:Ge.create({workflowID:l.current,json:A,isAutoSave:!1})]),(H=G==null?void 0:G.settings)!=null&&H.autoSave&&f({title:"Saved",status:"success",duration:1e3,isClosable:!0}),u(!1)}},[]),_=async()=>{var H,A,X;if((H=G==null?void 0:G.settings)!=null&&H.autoSave){alert("You cannot discard unsaved changes when auto save is enabled");return}if(confirm("Are you sure you want to discard unsaved changes? This will revert current workflow to your last saved version. You will lose all changes made since your last save.")){const V=(A=$==null?void 0:$.curWorkflow)==null?void 0:A.id;if(V==null)return;const te=(X=await($==null?void 0:$.get(V)))==null?void 0:X.json;te?($==null||$.updateCurWorkflow({...$.curWorkflow,json:te}),await we.loadGraphData(JSON.parse(te)),u(!1)):alert("Error: No last saved version found")}},x=N=>{const H=(N==null?void 0:N.id)??null;if($==null||$.updateCurWorkflow(N),l.current=H,a(H),e((N==null?void 0:N.name)??""),H==null){document.title="ComfyUI",window.location.hash="",localStorage.removeItem("curFlowID");return}if(Da()){const A=yl(H);window.location.hash=A,document.title=N.name+" - ComfyUI"}else localStorage.setItem("curFlowID",H),document.title="ComfyUI - "+N.name;N&&($==null||$.updateLastOpenedTime(N.id))},C=async()=>{localStorage.removeItem("workspace"),localStorage.removeItem("comfyspace");try{await Lh()}catch(A){console.error("error loading db",A)}s(!1);let N=null;N=Da(),N==null&&(N=localStorage.getItem("curFlowID")),N&&E(N),fetch("/workspace/deduplicate_workflow_ids"),!await(G==null?void 0:G.getSetting("twoWaySync"))&&ie.cache.get(ko).then(async A=>{if((A==null?void 0:A.value)!=="true"){if(await ie.workflows.count()==0){await(G==null?void 0:G.upsert({twoWaySync:!0})),await ie.cache.put({id:ko,value:"true"});return}const V=await(G==null?void 0:G.getSetting("myWorkflowsDir"));p(k.jsx(Lp,{myWorkflowsDir:V??"undefined"}),[{label:"I have downloaded all my workflows and ready to enable",onClick:async()=>{await(G==null?void 0:G.upsert({twoWaySync:!0})),await(G==null?void 0:G.getSetting("twoWaySync"))&&(ie.cache.put({id:ko,value:"true"}),location.reload())},colorScheme:"red"}],{closeOnOverlayClick:!1})}})},D=()=>{if(l.current==null)return!1;const N=$==null?void 0:$.curWorkflow;if(N==null)return!1;if(N.json==null)return!0;const H=we.graph.serialize()??{};let A={};try{A=N!=null&&N.json?JSON.parse(N==null?void 0:N.json):{}}catch(V){console.error("error parsing json",V)}return!Wp(H,A)},E=async(N,H)=>{if(we.graph==null)return;const A=await($==null?void 0:$.get(N));if(A==null){alert("Error: Workflow not found! id: "+N),x(null);return}const X=H?await(be==null?void 0:be.get(H)):null;we.ui.dialog.close(),X?(y(X),x({...A,json:X.json}),we.loadGraphData(JSON.parse(X.json))):(x(A),y(null),we.loadGraphData(JSON.parse(A.json))),r("root"),c&&u(!1)},F=async(N,H,A=!1)=>{var X;if(N===null){x(null),we.graph.clear();return}if(!c||A||(X=G==null?void 0:G.settings)!=null&&X.autoSave||($==null?void 0:$.curWorkflow)==null){E(N,H);return}I(N)},I=async N=>{var A;const H=[N?{label:"Open in new tab",icon:k.jsx(bl,{}),onClick:()=>{Oh(N)}}:null,{label:"Save",colorScheme:"teal",onClick:async()=>{await g(),N&&E(N)}}];H.push({label:"Discard",colorScheme:"red",onClick:async()=>{N&&E(N)}}),p(`Please save or discard your changes to "${(A=$==null?void 0:$.curWorkflow)==null?void 0:A.name}" before leaving, or your changes will be lost.`,H)},R=async N=>{const H=(N==null?void 0:N.json)??JSON.stringify(Cr),A=await($==null?void 0:$.createFlow({json:H,name:N==null?void 0:N.name}));A&&await F(A.id),r("root")},K=async(N,H=!1)=>{const A=N.split("/").pop()??N;H?g():R({name:A});const X=await fetch(Ih(N)),V=await X.blob(),te=new File([V],A,{type:X.headers.get("Content-Type")||""});await we.handleFile(te),r("root")},j=async(N,H)=>{const A=await($==null?void 0:$.get(N));if(A==null)return;const X=await($==null?void 0:$.createFlow({json:A.json,name:H||A.name,parentFolderID:A.parentFolderID,tags:A.tags}));X&&await F(X.id)},M=P.useCallback(N=>{if(l.current==null)return;let H=N.filename;N.subfolder!=null&&N.subfolder!==""&&(H=N.subfolder+"/"+H),Ht==null||Ht.create({workflowID:l.current,localPath:H})},[]),b=P.useCallback(()=>{r("root")},[]);return P.useEffect(()=>{C(),v(!0);const N=document.getElementById("comfy-file-input"),H=async()=>{if(N&&N.files&&N.files.length>0){const te={id:Dr(),name:N.files[0].name,json:JSON.stringify(Cr),updateTime:Date.now(),createTime:Date.now()};x(te),await($==null?void 0:$.createFlow(te))}};N==null||N.addEventListener("change",H);const A=te=>{var ne,Y;const z=((ne=G==null?void 0:G.settings)==null?void 0:ne.autoSave)??!0;if((Y=$==null?void 0:$.curWorkflow)!=null&&Y.saveLock)return;const B=D();!z&&B&&(te.preventDefault(),te.returnValue="You have unsaved changes!",I())};window.addEventListener("beforeunload",A);const X=te=>{var z,B,ne,Y,Z,he;(ne=(B=(z=te.detail)==null?void 0:z.output)==null?void 0:B.images)==null||ne.forEach(ye=>{ye.type==="output"&&M(ye)}),(he=(Z=(Y=te.detail)==null?void 0:Y.output)==null?void 0:Z.gifs)==null||he.forEach(ye=>{ye.type==="output"&&M(ye)})};ql.addEventListener("executed",X);const V=async te=>{var Y,Z;const z=(Z=(Y=te.dataTransfer)==null?void 0:Y.files[0])==null?void 0:Z.name,B=we.dragOverNode;if(B&&B.onDragDrop)return;if(!(await(G==null?void 0:G.getSetting("overwriteCurWorkflowWhenDroppingFileToCanvas"))??!1)&&z){const he={id:Dr(),name:z,json:JSON.stringify(Cr),updateTime:Date.now(),createTime:Date.now()};x(he),await($==null?void 0:$.createFlow(he))}};return we.canvasEl.addEventListener("drop",V),()=>{window.removeEventListener("change",H),window.removeEventListener("beforeunload",A),window.removeEventListener("executed",X),we.canvasEl.removeEventListener("drop",V)}},[]),o?null:k.jsx(Ct.Provider,{value:{curFlowID:i,onDuplicateWorkflow:j,loadWorkflowID:F,discardUnsavedChanges:_,saveCurWorkflow:g,isDirty:c,setIsDirty:u,loadNewWorkflow:R,loadFilePath:K,setRoute:r,route:n,curVersion:m,setCurVersion:y},children:k.jsx("div",{ref:d,className:"workspace_manager",children:k.jsxs(Ma,{containerRef:d,children:[k.jsxs(jt,{style:{position:"absolute",top:0,right:0,left:0},zIndex:xh,draggable:!1,children:[k.jsx(Ap,{curFlowName:t,setCurFlowName:e}),h&&n==="recentFlows"&&k.jsx(P.Suspense,{children:k.jsx(Up,{onClose:b,onClickNewFlow:()=>{R(),r("root")}})}),n==="gallery"&&k.jsx(P.Suspense,{children:k.jsx(Kp,{onclose:()=>r("root")})})]}),k.jsx(Np,{})]})})})}const _m=Object.freeze(Object.defineProperty({__proto__:null,default:$p},Symbol.toStringTag,{value:"Module"}));export{Oh as $,Jh as A,jt as B,om as C,dp as D,yh as E,Wt as F,Yh as G,ot as H,un as I,Ph as J,Le as K,Yr as L,_i as M,Qr as N,Xr as O,np as P,op as Q,hm as R,Ad as S,Gt as T,Cr as U,am as V,xr as W,zh as X,rm as Y,Ct as Z,bl as _,Yp as a,_l as a0,Ht as a1,ml as a2,ct as a3,hc as a4,xh as a5,Qp as a6,Er as a7,im as a8,Va as a9,Tp as aA,Mh as aB,um as aC,pm as aD,us as aE,ks as aF,vn as aG,gm as aH,oi as aI,be as aJ,vm as aK,wm as aL,Sp as aM,bm as aN,qe as aO,fc as aP,_m as aQ,_c as aa,cm as ab,Ha as ac,Th as ad,sn as ae,on as af,xc as ag,Wp as ah,sm as ai,lm as aj,Ge as ak,Yl as al,ie as am,ym as an,bf as ao,dm as ap,fm as aq,em as ar,tm as as,Wc as at,ki as au,xi as av,Oi as aw,Ei as ax,Si as ay,mm as az,Zp as b,Jp as c,Pe as d,ip as e,Ua as f,Ke as g,wt as h,bt as i,gn as j,G as k,Lp as l,Uc as m,wf as n,Xp as o,nm as p,jo as q,Fs as r,Rs as s,Sr as t,to as u,mt as v,Aa as w,$ as x,up as y,zp as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["workspace_web/ShareDialog-v08oH_7Y.js","workspace_web/input.js","workspace_web/index-pz0vT7Or.js","workspace_web/chunk-K7XRJ7NL-Vyo84f0U.js","workspace_web/IconCopy-a_e3GWzg.js","workspace_web/AppIsDirtyEventListener-h-RjyOhv.js","workspace_web/useDebounceFn-ld478fd0.js","workspace_web/ModelManagerTopbar-9vTfJIQ5.js","workspace_web/chunk-JARCRF6W-t0m5zeYw.js","workspace_web/chunk-3RSXBRAN-6iU_mN4b.js","workspace_web/assets/ModelManagerTopbar--iv3sdjQ.css","workspace_web/SpotlightSearch-xR_1HCZI.js","workspace_web/IconSearch-ZJtm5r3S.js","workspace_web/chunk-NTCQBYKE-JR6uufb0.js","workspace_web/RecentFilesDrawer-wX0u4Vce.js","workspace_web/MediaPreview-81OxFMo_.js","workspace_web/GalleryModal-tg9F_Ckt.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}