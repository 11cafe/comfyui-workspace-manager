import{b as $,f as j,l as q,o as Q,h as K,r as m,j as n,g as M,a0 as X,M as Z,O as ee,U as te,i as ne}from"./input.js";import{aI as se,au as re,a7 as ae,aE as T,ar as D,H as oe,o as ie,l as O,ac as ce,C as le,ad as ue,aJ as N,E as pe,p as A}from"./App-PTPvqEC2.js";import{u as de}from"./useDebounceFn-ld478fd0.js";import{I as he}from"./IconSearch-11tIHWXO.js";import{V as me}from"./chunk-NTCQBYKE-_hBLsm5I.js";import"/scripts/app.js";import"/scripts/api.js";var[ge,Se]=$({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),P=j(function(a,u){const r=q("Input",a),{children:c,className:l,...I}=Q(a),y=K("chakra-input__group",l),t={},x=se(c),o=r.field;x.forEach(s=>{var p,f;r&&(o&&s.type.id==="InputLeftElement"&&(t.paddingStart=(p=o.height)!=null?p:o.h),o&&s.type.id==="InputRightElement"&&(t.paddingEnd=(f=o.height)!=null?f:o.h),s.type.id==="InputRightAddon"&&(t.borderEndRadius=0),s.type.id==="InputLeftAddon"&&(t.borderStartRadius=0))});const S=x.map(s=>{var p,f;const b=re({size:((p=s.props)==null?void 0:p.size)||a.size,variant:((f=s.props)==null?void 0:f.variant)||a.variant});return s.type.id!=="Input"?m.cloneElement(s,b):m.cloneElement(s,Object.assign(b,t,s.props))});return n.jsx(M.div,{className:y,ref:u,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate",...r.group},"data-group":!0,...I,children:n.jsx(ge,{value:r,children:S})})});P.displayName="InputGroup";var fe=M("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),C=j(function(a,u){var r,c;const{placement:l="left",...I}=a,y=Se(),t=y.field,o={[l==="left"?"insetStart":"insetEnd"]:"0",width:(r=t==null?void 0:t.height)!=null?r:t==null?void 0:t.h,height:(c=t==null?void 0:t.height)!=null?c:t==null?void 0:t.h,fontSize:t==null?void 0:t.fontSize,...y.element};return n.jsx(fe,{ref:u,__css:o,...I})});C.id="InputElement";C.displayName="InputElement";var U=j(function(a,u){const{className:r,...c}=a,l=K("chakra-input__left-element",r);return n.jsx(C,{ref:u,placement:"left",className:l,...c})});U.id="InputLeftElement";U.displayName="InputLeftElement";var z=j(function(a,u){const{className:r,...c}=a,l=K("chakra-input__right-element",r);return n.jsx(C,{ref:u,placement:"right",className:l,...c})});z.id="InputRightElement";z.displayName="InputRightElement";function Le(){const{colorMode:g}=X(),{loadWorkflowID:a,setRoute:u}=m.useContext(ae),[r,c]=m.useState([]),[l,I,y]=T(""),t=m.useRef([]),[x,o,S]=T([]),[s,p]=m.useState(!1),[f,b,L]=T(0),E=m.useRef({lastPressedKey:"",spotlightSearchShortcutFirstKey:"",spotlightSearchShortcutLastKey:""}),F=()=>{u("root")},_=e=>{a(e.id),F()},H=()=>{const e=r.filter(i=>!!i.name.toLocaleLowerCase().includes(y.current.toLocaleLowerCase()));o(e),b(0),p(!1)},[V,B]=de(H,300),W=e=>{I(e.target.value),e.target.value?(V(),!s&&p(!0)):(p(!1),B(),o(t.current))},Y=()=>s?null:l&&x.length===0?n.jsx(O,{ml:2,children:"No matching results"}):n.jsx(n.Fragment,{children:x.map((e,i)=>n.jsxs(ne,{colorScheme:"teal",variant:"ghost",size:"sm",justifyContent:"start",px:2,color:g==="light"?"#1A202C":"rgba(255, 255, 255, 0.92)",onClick:()=>{_(e)},minH:"26px",isActive:i===f,children:[e.name,e.updateTime&&n.jsxs(O,{color:g==="light"?"GrayText":"rgb(255, 255, 255, 0.6)",ml:2,fontSize:"sm",children:["Updated: ",ce(e.updateTime)]})]},e.id))}),J=async()=>{var k;const e=h=>h.map(v=>({type:"workflow",updateTime:(v==null?void 0:v.updateTime)??Date.now(),id:v.id,name:v.name.replace(/\.json$/,"")}))??[],i=await((k=le)==null?void 0:k.listAll(ue.RECENTLY_OPENED))??[];c(e(i));const d=e(i.slice(0,20));t.current=d,o(d)},w=e=>{b(i=>{const d=i+e;return d<0?S.current.length-1:d>S.current.length-1?0:d})};return m.useEffect(()=>{var k;J(),(k=A)==null||k.getSetting("shortcuts").then(h=>{var G;const R=(h.openSpotlightSearch??((G=A)==null?void 0:G.defaultSettings.shortcuts.openSpotlightSearch)).split("+");E.current.spotlightSearchShortcutFirstKey=R[0]==="Command"?"Meta":R[0],E.current.spotlightSearchShortcutLastKey=R[R.length-1]});const e=h=>{h.key===E.current.spotlightSearchShortcutFirstKey&&E.current.lastPressedKey===E.current.spotlightSearchShortcutLastKey&&L.current>0&&S.current[L.current]&&_(S.current[L.current])},i=h=>{E.current.lastPressedKey=h.key.toUpperCase()},d=h=>{switch(h.detail.shortcutType){case pe.openSpotlightSearch:w(1);break;case N.ArrowDown:w(1);break;case N.ArrowUp:w(-1);break;case N.Enter:_(S.current[L.current]);break}};return document.addEventListener("keyup",e),document.addEventListener("keydown",i),window.addEventListener(D,d),()=>{document.removeEventListener("keyup",e),document.removeEventListener("keydown",i),window.removeEventListener(D,d)}},[]),n.jsx(Z,{isOpen:!0,onClose:F,size:"xl",children:n.jsxs(ee,{bg:g==="light"?"rgba(255, 255, 255, 0.8)":"rgb(45, 55, 72, 0.8)",backdropFilter:"auto",backdropBlur:"8px",children:[n.jsxs(oe,{spacing:1,px:4,py:2,borderBottom:"1px",borderColor:"gray.400",children:[n.jsx(he,{size:20}),n.jsxs(P,{children:[n.jsx(ie,{value:l,onChange:W,autoFocus:!0,variant:"unstyled",fontSize:18}),s&&n.jsx(z,{h:"27px",children:n.jsx(te,{size:"sm"})})]})]}),n.jsx(me,{spacing:1,align:"stretch",px:2,py:2,maxHeight:"calc(100vh - 200px)",overflowY:"auto",children:Y()})]})})}export{Le as default};
