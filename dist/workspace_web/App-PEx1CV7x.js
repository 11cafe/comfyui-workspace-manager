var xl=Object.defineProperty;var kl=(t,e,n)=>e in t?xl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Oe=(t,e,n)=>(kl(t,typeof e!="symbol"?e+"":e,n),n);import{u as El,a as Cl,r as j,c as Sl,b as et,m as Be,d as Tt,f as ve,e as Ee,j as I,B as Il,g as pe,h as Ue,i as Ol,o as tt,k as Pt,l as ot,I as Wr,n as Ur,p as oo,q as Ie,s as ja,t as Dl,v as Pl,w as jl,x as Kr,y as Al,z as Nl,A as Fl,C as Rl,D as Tl,E as hs,F as Aa,G as ps,H as Na,J as Bl,K as Ml,L as zl,P as Fa,M as $r,N as ms,O as qr,Q as ys,R as vs,S as gs,T as ws,_ as Hr,U as Ra,V as Ta,W as Yn,X as bs}from"./input.js";import{app as be}from"/scripts/app.js";import{api as Ys}from"/scripts/api.js";function Ll(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}function Ba(t){var e;return Ll(t)&&(e=t.ownerDocument)!=null?e:document}function Wl(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Ul=Wl();function Kl(t){const e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function Ma(t){const{theme:e}=El(),n=Cl();return j.useMemo(()=>Sl(e.direction,{...n,...t}),[t,e.direction,n])}var $l=Object.defineProperty,ql=(t,e,n)=>e in t?$l(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,De=(t,e,n)=>(ql(t,typeof e!="symbol"?e+"":e,n),n);function Xs(t){return t.sort((e,n)=>{const r=e.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var Hl=t=>typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE;function Qs(t,e,n){let r=t+1;return n&&r>=e&&(r=0),r}function ea(t,e,n){let r=t-1;return n&&r<0&&(r=e),r}var ko=typeof window<"u"?j.useLayoutEffect:j.useEffect,xr=t=>t,Vl=class{constructor(){De(this,"descendants",new Map),De(this,"register",t=>{if(t!=null)return Hl(t)?this.registerNode(t):e=>{this.registerNode(e,t)}}),De(this,"unregister",t=>{this.descendants.delete(t);const e=Xs(Array.from(this.descendants.keys()));this.assignIndex(e)}),De(this,"destroy",()=>{this.descendants.clear()}),De(this,"assignIndex",t=>{this.descendants.forEach(e=>{const n=t.indexOf(e.node);e.index=n,e.node.dataset.index=e.index.toString()})}),De(this,"count",()=>this.descendants.size),De(this,"enabledCount",()=>this.enabledValues().length),De(this,"values",()=>Array.from(this.descendants.values()).sort((e,n)=>e.index-n.index)),De(this,"enabledValues",()=>this.values().filter(t=>!t.disabled)),De(this,"item",t=>{if(this.count()!==0)return this.values()[t]}),De(this,"enabledItem",t=>{if(this.enabledCount()!==0)return this.enabledValues()[t]}),De(this,"first",()=>this.item(0)),De(this,"firstEnabled",()=>this.enabledItem(0)),De(this,"last",()=>this.item(this.descendants.size-1)),De(this,"lastEnabled",()=>{const t=this.enabledValues().length-1;return this.enabledItem(t)}),De(this,"indexOf",t=>{var e,n;return t&&(n=(e=this.descendants.get(t))==null?void 0:e.index)!=null?n:-1}),De(this,"enabledIndexOf",t=>t==null?-1:this.enabledValues().findIndex(e=>e.node.isSameNode(t))),De(this,"next",(t,e=!0)=>{const n=Qs(t,this.count(),e);return this.item(n)}),De(this,"nextEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=Qs(r,this.enabledCount(),e);return this.enabledItem(o)}),De(this,"prev",(t,e=!0)=>{const n=ea(t,this.count()-1,e);return this.item(n)}),De(this,"prevEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=ea(r,this.enabledCount()-1,e);return this.enabledItem(o)}),De(this,"registerNode",(t,e)=>{if(!t||this.descendants.has(t))return;const n=Array.from(this.descendants.keys()).concat(t),r=Xs(n);e!=null&&e.disabled&&(e.disabled=!!e.disabled);const o={node:t,index:-1,...e};this.descendants.set(t,o),this.assignIndex(r)})}};function Zl(){const t=j.useRef(new Vl);return ko(()=>()=>t.current.destroy()),t.current}var[Gl,za]=et({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function Jl(t){const e=za(),[n,r]=j.useState(-1),o=j.useRef(null);ko(()=>()=>{o.current&&e.unregister(o.current)},[]),ko(()=>{if(!o.current)return;const i=Number(o.current.dataset.index);n!=i&&!Number.isNaN(i)&&r(i)});const s=xr(t?e.register(t):e.register);return{descendants:e,index:n,enabledIndex:e.enabledIndexOf(o.current),register:Be(s,o)}}function La(){return[xr(Gl),()=>xr(za()),()=>Zl(),o=>Jl(o)]}function Wa(t){const{value:e,defaultValue:n,onChange:r,shouldUpdate:o=(p,h)=>p!==h}=t,s=Tt(r),i=Tt(o),[a,l]=j.useState(n),u=e!==void 0,c=u?e:a,f=Tt(p=>{const w=typeof p=="function"?p(c):p;i(c,w)&&(u||l(w),s(w))},[u,s,c,i]);return[c,f]}function _s(t){return j.Children.toArray(t).filter(e=>j.isValidElement(e))}var Yl={horizontal:{"> *:first-of-type:not(:last-of-type)":{borderEndRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderStartRadius:0}},vertical:{"> *:first-of-type:not(:last-of-type)":{borderBottomRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderTopRadius:0}}},Xl={horizontal:t=>({"& > *:not(style) ~ *:not(style)":{marginStart:t}}),vertical:t=>({"& > *:not(style) ~ *:not(style)":{marginTop:t}})},Ua=ve(function(e,n){const{size:r,colorScheme:o,variant:s,className:i,spacing:a="0.5rem",isAttached:l,isDisabled:u,orientation:c="horizontal",...f}=e,p=Ee("chakra-button__group",i),h=j.useMemo(()=>({size:r,colorScheme:o,variant:s,isDisabled:u}),[r,o,s,u]);let w={display:"inline-flex",...l?Yl[c]:Xl[c](a)};const d=c==="vertical";return I.jsx(Il,{value:h,children:I.jsx(pe.div,{ref:n,role:"group",__css:w,className:p,"data-attached":l?"":void 0,"data-orientation":c,flexDir:d?"column":void 0,...f})})});Ua.displayName="ButtonGroup";var jn=ve((t,e)=>{const{icon:n,children:r,isRound:o,"aria-label":s,...i}=t,a=n||r,l=j.isValidElement(a)?j.cloneElement(a,{"aria-hidden":!0,focusable:!1}):null;return I.jsx(Ue,{padding:"0",borderRadius:o?"full":void 0,ref:e,"aria-label":s,...i,children:l})});jn.displayName="IconButton";var[Ql,Ka]=Ol("Card"),ec=ve(function(e,n){const{className:r,...o}=e,s=Ka();return I.jsx(pe.div,{ref:n,className:Ee("chakra-card__body",r),__css:s.body,...o})}),tc=ve(function(e,n){const{className:r,...o}=e,s=Ka();return I.jsx(pe.div,{ref:n,className:Ee("chakra-card__header",r),__css:s.header,...o})}),nc=ve(function(e,n){const{className:r,children:o,direction:s="column",justify:i,align:a,...l}=tt(e),u=Pt("Card",e);return I.jsx(pe.div,{ref:n,className:Ee("chakra-card",r),__css:{display:"flex",flexDirection:s,justifyContent:i,alignItems:a,position:"relative",minWidth:0,wordWrap:"break-word",...u.container},...l,children:I.jsx(Ql,{value:u,children:o})})}),[rc,$a]=et({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[oc,dn]=et({strict:!1,name:"FormControlContext"});function sc(t){const{id:e,isRequired:n,isInvalid:r,isDisabled:o,isReadOnly:s,...i}=t,a=j.useId(),l=e||`field-${a}`,u=`${l}-label`,c=`${l}-feedback`,f=`${l}-helptext`,[p,h]=j.useState(!1),[w,d]=j.useState(!1),[y,m]=j.useState(!1),g=j.useCallback((k={},N=null)=>({id:f,...k,ref:Be(N,D=>{D&&d(!0)})}),[f]),_=j.useCallback((k={},N=null)=>({...k,ref:N,"data-focus":ot(y),"data-disabled":ot(o),"data-invalid":ot(r),"data-readonly":ot(s),id:k.id!==void 0?k.id:u,htmlFor:k.htmlFor!==void 0?k.htmlFor:l}),[l,o,y,r,s,u]),x=j.useCallback((k={},N=null)=>({id:c,...k,ref:Be(N,D=>{D&&h(!0)}),"aria-live":"polite"}),[c]),E=j.useCallback((k={},N=null)=>({...k,...i,ref:N,role:"group","data-focus":ot(y),"data-disabled":ot(o),"data-invalid":ot(r),"data-readonly":ot(s)}),[i,o,y,r,s]),S=j.useCallback((k={},N=null)=>({...k,ref:N,role:"presentation","aria-hidden":!0,children:k.children||"*"}),[]);return{isRequired:!!n,isInvalid:!!r,isReadOnly:!!s,isDisabled:!!o,isFocused:!!y,onFocus:()=>m(!0),onBlur:()=>m(!1),hasFeedbackText:p,setHasFeedbackText:h,hasHelpText:w,setHasHelpText:d,id:l,labelId:u,feedbackId:c,helpTextId:f,htmlProps:i,getHelpTextProps:g,getErrorMessageProps:x,getRootProps:E,getLabelProps:_,getRequiredIndicatorProps:S}}var Vr=ve(function(e,n){const r=Pt("Form",e),o=tt(e),{getRootProps:s,htmlProps:i,...a}=sc(o),l=Ee("chakra-form-control",e.className);return I.jsx(oc,{value:a,children:I.jsx(rc,{value:r,children:I.jsx(pe.div,{...s({},n),className:l,__css:r.container})})})});Vr.displayName="FormControl";var ac=ve(function(e,n){const r=dn(),o=$a(),s=Ee("chakra-form__helper-text",e.className);return I.jsx(pe.div,{...r==null?void 0:r.getHelpTextProps(e,n),__css:o.helperText,className:s})});ac.displayName="FormHelperText";var[ic,lc]=et({name:"FormErrorStylesContext",errorMessage:`useFormErrorStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormError />" `}),Zr=ve((t,e)=>{const n=Pt("FormError",t),r=tt(t),o=dn();return o!=null&&o.isInvalid?I.jsx(ic,{value:n,children:I.jsx(pe.div,{...o==null?void 0:o.getErrorMessageProps(r,e),className:Ee("chakra-form__error-message",t.className),__css:{display:"flex",alignItems:"center",...n.text}})}):null});Zr.displayName="FormErrorMessage";var cc=ve((t,e)=>{const n=lc(),r=dn();if(!(r!=null&&r.isInvalid))return null;const o=Ee("chakra-form__error-icon",t.className);return I.jsx(Wr,{ref:e,"aria-hidden":!0,...t,__css:n.icon,className:o,children:I.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})});cc.displayName="FormErrorIcon";var Gr=ve(function(e,n){var r;const o=Ur("FormLabel",e),s=tt(e),{className:i,children:a,requiredIndicator:l=I.jsx(qa,{}),optionalIndicator:u=null,...c}=s,f=dn(),p=(r=f==null?void 0:f.getLabelProps(c,n))!=null?r:{ref:n,...c};return I.jsxs(pe.label,{...p,className:Ee("chakra-form__label",s.className),__css:{display:"block",textAlign:"start",...o},children:[a,f!=null&&f.isRequired?l:u]})});Gr.displayName="FormLabel";var qa=ve(function(e,n){const r=dn(),o=$a();if(!(r!=null&&r.isRequired))return null;const s=Ee("chakra-form__required-indicator",e.className);return I.jsx(pe.span,{...r==null?void 0:r.getRequiredIndicatorProps(e,n),__css:o.requiredIndicator,className:s})});qa.displayName="RequiredIndicator";function uc(t){const{isDisabled:e,isInvalid:n,isReadOnly:r,isRequired:o,...s}=dc(t);return{...s,disabled:e,readOnly:r,required:o,"aria-invalid":oo(n),"aria-required":oo(o),"aria-readonly":oo(r)}}function dc(t){var e,n,r;const o=dn(),{id:s,disabled:i,readOnly:a,required:l,isRequired:u,isInvalid:c,isReadOnly:f,isDisabled:p,onFocus:h,onBlur:w,...d}=t,y=t["aria-describedby"]?[t["aria-describedby"]]:[];return o!=null&&o.hasFeedbackText&&(o!=null&&o.isInvalid)&&y.push(o.feedbackId),o!=null&&o.hasHelpText&&y.push(o.helpTextId),{...d,"aria-describedby":y.join(" ")||void 0,id:s??(o==null?void 0:o.id),isDisabled:(e=i??p)!=null?e:o==null?void 0:o.isDisabled,isReadOnly:(n=a??f)!=null?n:o==null?void 0:o.isReadOnly,isRequired:(r=l??u)!=null?r:o==null?void 0:o.isRequired,isInvalid:c??(o==null?void 0:o.isInvalid),onFocus:Ie(o==null?void 0:o.onFocus,h),onBlur:Ie(o==null?void 0:o.onBlur,w)}}function en(t,e,n,r){const o=Tt(n);return j.useEffect(()=>{const s=typeof t=="function"?t():t??document;if(!(!n||!s))return s.addEventListener(e,o,r),()=>{s.removeEventListener(e,o,r)}},[e,t,r,o,n]),()=>{const s=typeof t=="function"?t():t??document;s==null||s.removeEventListener(e,o,r)}}function fc(t){return"current"in t}var Ha=()=>typeof window<"u";function hc(){var t;const e=navigator.userAgentData;return(t=e==null?void 0:e.platform)!=null?t:navigator.platform}var pc=t=>Ha()&&t.test(navigator.vendor),mc=t=>Ha()&&t.test(hc()),yc=()=>mc(/mac|iphone|ipad|ipod/i),vc=()=>yc()&&pc(/apple/i);function gc(t){const{ref:e,elements:n,enabled:r}=t,o=()=>{var s,i;return(i=(s=e.current)==null?void 0:s.ownerDocument)!=null?i:document};en(o,"pointerdown",s=>{if(!vc()||!r)return;const i=s.target,l=(n??[e]).some(u=>{const c=fc(u)?u.current:u;return(c==null?void 0:c.contains(i))||c===i});o().activeElement!==i&&l&&(s.preventDefault(),i.focus())})}var Va={exports:{}},wc="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",bc=wc,_c=bc;function Za(){}function Ga(){}Ga.resetWarningCache=Za;var xc=function(){function t(r,o,s,i,a,l){if(l!==_c){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Ga,resetWarningCache:Za};return n.PropTypes=n,n};Va.exports=xc();var kc=Va.exports;const At=ja(kc);function Ec(t){const e=t.ownerDocument.defaultView||window,{overflow:n,overflowX:r,overflowY:o}=e.getComputedStyle(t);return/auto|scroll|overlay|hidden/.test(n+o+r)}function Cc(t){return t.localName==="html"?t:t.assignedSlot||t.parentElement||t.ownerDocument.documentElement}function Ja(t){return["html","body","#document"].includes(t.localName)?t.ownerDocument.body:Dl(t)&&Ec(t)?t:Ja(Cc(t))}var Sc=Ul?j.useLayoutEffect:j.useEffect;function Eo(t,e=[]){const n=j.useRef(t);return Sc(()=>{n.current=t}),j.useCallback((...r)=>{var o;return(o=n.current)==null?void 0:o.call(n,...r)},e)}function Ic(t){const{ref:e,handler:n,enabled:r=!0}=t,o=Eo(n),i=j.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;j.useEffect(()=>{if(!r)return;const a=f=>{so(f,e)&&(i.isPointerDown=!0)},l=f=>{if(i.ignoreEmulatedMouseEvents){i.ignoreEmulatedMouseEvents=!1;return}i.isPointerDown&&n&&so(f,e)&&(i.isPointerDown=!1,o(f))},u=f=>{i.ignoreEmulatedMouseEvents=!0,n&&i.isPointerDown&&so(f,e)&&(i.isPointerDown=!1,o(f))},c=Ba(e.current);return c.addEventListener("mousedown",a,!0),c.addEventListener("mouseup",l,!0),c.addEventListener("touchstart",a,!0),c.addEventListener("touchend",u,!0),()=>{c.removeEventListener("mousedown",a,!0),c.removeEventListener("mouseup",l,!0),c.removeEventListener("touchstart",a,!0),c.removeEventListener("touchend",u,!0)}},[n,e,o,i,r])}function so(t,e){var n;const r=t.target;return r&&!Ba(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function Oc(t,e){const n=j.useId();return j.useMemo(()=>t||[e,n].filter(Boolean).join("-"),[t,e,n])}function Dc(t,e){const n=t!==void 0;return[n,n&&typeof t<"u"?t:e]}function Pc(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=Eo(n),i=Eo(e),[a,l]=j.useState(t.defaultIsOpen||!1),[u,c]=Dc(r,a),f=Oc(o,"disclosure"),p=j.useCallback(()=>{u||l(!1),i==null||i()},[u,i]),h=j.useCallback(()=>{u||l(!0),s==null||s()},[u,s]),w=j.useCallback(()=>{(c?p:h)()},[c,h,p]);return{isOpen:!!c,onOpen:h,onClose:p,onToggle:w,isControlled:u,getButtonProps:(d={})=>({...d,"aria-expanded":c,"aria-controls":f,onClick:Pl(d.onClick,w)}),getDisclosureProps:(d={})=>({...d,hidden:!c,id:f})}}var Un=ve(function(e,n){const{htmlSize:r,...o}=e,s=Pt("Input",o),i=tt(o),a=uc(i),l=Ee("chakra-input",e.className);return I.jsx(pe.input,{size:r,...a,__css:s.field,ref:n,className:l})});Un.displayName="Input";Un.id="Input";var jc=Object.freeze(["base","sm","md","lg","xl","2xl"]);function Ac(t,e){return Array.isArray(t)?t.map(n=>n===null?null:e(n)):jl(t)?Object.keys(t).reduce((n,r)=>(n[r]=e(t[r]),n),{}):t!=null?e(t):null}function kp(t,e=jc){const n={};return t.forEach((r,o)=>{const s=e[o];r!=null&&(n[s]=r)}),n}var Bt=ve(function(e,n){const r=Ur("Text",e),{className:o,align:s,decoration:i,casing:a,...l}=tt(e),u=Kl({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return I.jsx(pe.p,{ref:n,className:Ee("chakra-text",e.className),...u,...l,__css:r})});Bt.displayName="Text";var Co=t=>I.jsx(pe.div,{className:"chakra-stack__divider",...t,__css:{...t.__css,borderWidth:0,alignSelf:"stretch",borderColor:"inherit",width:"auto",height:"auto"}});Co.displayName="StackDivider";var Ya=t=>I.jsx(pe.div,{className:"chakra-stack__item",...t,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...t.__css}});Ya.displayName="StackItem";function Nc(t){const{spacing:e,direction:n}=t,r={column:{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":Ac(n,o=>r[o])}}var tn=ve((t,e)=>{const{isInline:n,direction:r,align:o,justify:s,spacing:i="0.5rem",wrap:a,children:l,divider:u,className:c,shouldWrapChildren:f,...p}=t,h=n?"row":r??"column",w=j.useMemo(()=>Nc({spacing:i,direction:h}),[i,h]),d=!!u,y=!f&&!d,m=j.useMemo(()=>{const _=_s(l);return y?_:_.map((x,E)=>{const S=typeof x.key<"u"?x.key:E,k=E+1===_.length,D=f?I.jsx(Ya,{children:x},S):x;if(!d)return D;const R=j.cloneElement(u,{__css:w}),H=k?null:R;return I.jsxs(j.Fragment,{children:[D,H]},S)})},[u,w,d,y,f,l]),g=Ee("chakra-stack",c);return I.jsx(pe.div,{ref:e,display:"flex",alignItems:o,justifyContent:s,flexDirection:h,flexWrap:a,gap:d?void 0:i,className:g,...p,children:m})});tn.displayName="Stack";var Ft=ve((t,e)=>I.jsx(tn,{align:"center",...t,direction:"row",ref:e}));Ft.displayName="HStack";var xs=ve(function(e,n){const r=Ur("Heading",e),{className:o,...s}=tt(e);return I.jsx(pe.h2,{ref:n,className:Ee("chakra-heading",e.className),...s,__css:r})});xs.displayName="Heading";var pt=pe("div");pt.displayName="Box";var Xa=ve(function(e,n){const{size:r,centerContent:o=!0,...s}=e,i=o?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return I.jsx(pt,{ref:n,boxSize:r,__css:{...i,flexShrink:0,flexGrow:0},...s})});Xa.displayName="Square";var Fc=ve(function(e,n){const{size:r,...o}=e;return I.jsx(Xa,{size:r,ref:n,borderRadius:"9999px",...o})});Fc.displayName="Circle";var kn=ve(function(e,n){const{direction:r,align:o,justify:s,wrap:i,basis:a,grow:l,shrink:u,...c}=e,f={display:"flex",flexDirection:r,alignItems:o,justifyContent:s,flexWrap:i,flexBasis:a,flexGrow:l,flexShrink:u};return I.jsx(pe.div,{ref:n,__css:f,...c})});kn.displayName="Flex";function Rc(t){const{key:e}=t;return e.length===1||e.length>1&&/[^a-zA-Z0-9]/.test(e)}function Tc(t={}){const{timeout:e=300,preventDefault:n=()=>!0}=t,[r,o]=j.useState([]),s=j.useRef(),i=()=>{s.current&&(clearTimeout(s.current),s.current=null)},a=()=>{i(),s.current=setTimeout(()=>{o([]),s.current=null},e)};j.useEffect(()=>i,[]);function l(u){return c=>{if(c.key==="Backspace"){const f=[...r];f.pop(),o(f);return}if(Rc(c)){const f=r.concat(c.key);n(c)&&(c.preventDefault(),c.stopPropagation()),o(f),u(f.join("")),a()}}}return l}function Bc(t,e,n,r){if(e==null)return r;if(!r)return t.find(i=>n(i).toLowerCase().startsWith(e.toLowerCase()));const o=t.filter(s=>n(s).toLowerCase().startsWith(e.toLowerCase()));if(o.length>0){let s;return o.includes(r)?(s=o.indexOf(r)+1,s===o.length&&(s=0),o[s]):(s=t.indexOf(o[0]),t[s])}return r}function Mc(){const t=j.useRef(new Map),e=t.current,n=j.useCallback((o,s,i,a)=>{t.current.set(i,{type:s,el:o,options:a}),o.addEventListener(s,i,a)},[]),r=j.useCallback((o,s,i,a)=>{o.removeEventListener(s,i,a),t.current.delete(i)},[]);return j.useEffect(()=>()=>{e.forEach((o,s)=>{r(o.el,o.type,s,o.options)})},[r,e]),{add:n,remove:r}}function ao(t){const e=t.target,{tagName:n,isContentEditable:r}=e;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function Qa(t={}){const{ref:e,isDisabled:n,isFocusable:r,clickOnEnter:o=!0,clickOnSpace:s=!0,onMouseDown:i,onMouseUp:a,onClick:l,onKeyDown:u,onKeyUp:c,tabIndex:f,onMouseOver:p,onMouseLeave:h,...w}=t,[d,y]=j.useState(!0),[m,g]=j.useState(!1),_=Mc(),x=A=>{A&&A.tagName!=="BUTTON"&&y(!1)},E=d?f:f||0,S=n&&!r,k=j.useCallback(A=>{if(n){A.stopPropagation(),A.preventDefault();return}A.currentTarget.focus(),l==null||l(A)},[n,l]),N=j.useCallback(A=>{m&&ao(A)&&(A.preventDefault(),A.stopPropagation(),g(!1),_.remove(document,"keyup",N,!1))},[m,_]),D=j.useCallback(A=>{if(u==null||u(A),n||A.defaultPrevented||A.metaKey||!ao(A.nativeEvent)||d)return;const te=o&&A.key==="Enter";s&&A.key===" "&&(A.preventDefault(),g(!0)),te&&(A.preventDefault(),A.currentTarget.click()),_.add(document,"keyup",N,!1)},[n,d,u,o,s,_,N]),R=j.useCallback(A=>{if(c==null||c(A),n||A.defaultPrevented||A.metaKey||!ao(A.nativeEvent)||d)return;s&&A.key===" "&&(A.preventDefault(),g(!1),A.currentTarget.click())},[s,d,n,c]),H=j.useCallback(A=>{A.button===0&&(g(!1),_.remove(document,"mouseup",H,!1))},[_]),P=j.useCallback(A=>{if(A.button!==0)return;if(n){A.stopPropagation(),A.preventDefault();return}d||g(!0),A.currentTarget.focus({preventScroll:!0}),_.add(document,"mouseup",H,!1),i==null||i(A)},[n,d,i,_,H]),T=j.useCallback(A=>{A.button===0&&(d||g(!1),a==null||a(A))},[a,d]),b=j.useCallback(A=>{if(n){A.preventDefault();return}p==null||p(A)},[n,p]),q=j.useCallback(A=>{m&&(A.preventDefault(),g(!1)),h==null||h(A)},[m,h]),Q=Be(e,x);return d?{...w,ref:Q,type:"button","aria-disabled":S?void 0:n,disabled:S,onClick:k,onMouseDown:i,onMouseUp:a,onKeyUp:c,onKeyDown:u,onMouseOver:p,onMouseLeave:h}:{...w,ref:Q,role:"button","data-active":ot(m),"aria-disabled":n?"true":void 0,tabIndex:S?void 0:E,onClick:k,onMouseDown:P,onMouseUp:T,onKeyUp:R,onKeyDown:D,onMouseOver:b,onMouseLeave:q}}function zc(t){const e=t.current;if(!e)return!1;const n=Fl(e);return!n||e.contains(n)?!1:!!Rl(n)}function ei(t,e){const{shouldFocus:n,visible:r,focusRef:o}=e,s=n&&!r;Kr(()=>{if(!s||zc(t))return;const i=(o==null?void 0:o.current)||t.current;let a;if(i)return a=requestAnimationFrame(()=>{i.focus({preventScroll:!0})}),()=>{cancelAnimationFrame(a)}},[s,t,o])}var Lc={preventScroll:!0,shouldFocus:!1};function Wc(t,e=Lc){const{focusRef:n,preventScroll:r,shouldFocus:o,visible:s}=e,i=Uc(t)?t.current:t,a=o&&s,l=j.useRef(a),u=j.useRef(s);Al(()=>{!u.current&&s&&(l.current=a),u.current=s},[s,a]);const c=j.useCallback(()=>{if(!(!s||!i||!l.current)&&(l.current=!1,!i.contains(document.activeElement)))if(n!=null&&n.current)requestAnimationFrame(()=>{var f;(f=n.current)==null||f.focus({preventScroll:r})});else{const f=Nl(i);f.length>0&&requestAnimationFrame(()=>{f[0].focus({preventScroll:r})})}},[s,r,i,n]);Kr(()=>{c()},[c]),en(i,"transitionend",c)}function Uc(t){return"current"in t}var Gt=(t,e)=>({var:t,varRef:e?`var(${t}, ${e})`:`var(${t})`}),je={arrowShadowColor:Gt("--popper-arrow-shadow-color"),arrowSize:Gt("--popper-arrow-size","8px"),arrowSizeHalf:Gt("--popper-arrow-size-half"),arrowBg:Gt("--popper-arrow-bg"),transformOrigin:Gt("--popper-transform-origin"),arrowOffset:Gt("--popper-arrow-offset")};function Kc(t){if(t.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}var $c={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},qc=t=>$c[t],ta={scroll:!0,resize:!0};function Hc(t){let e;return typeof t=="object"?e={enabled:!0,options:{...ta,...t}}:e={enabled:t,options:ta},e}var Vc={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`},effect:({state:t})=>()=>{const e=t.elements.reference;t.elements.popper.style.width=`${e.offsetWidth}px`}},Zc={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:t})=>{na(t)},effect:({state:t})=>()=>{na(t)}},na=t=>{t.elements.popper.style.setProperty(je.transformOrigin.var,qc(t.placement))},Gc={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:t})=>{Jc(t)}},Jc=t=>{var e;if(!t.placement)return;const n=Yc(t.placement);if((e=t.elements)!=null&&e.arrow&&n){Object.assign(t.elements.arrow.style,{[n.property]:n.value,width:je.arrowSize.varRef,height:je.arrowSize.varRef,zIndex:-1});const r={[je.arrowSizeHalf.var]:`calc(${je.arrowSize.varRef} / 2 - 1px)`,[je.arrowOffset.var]:`calc(${je.arrowSizeHalf.varRef} * -1)`};for(const o in r)t.elements.arrow.style.setProperty(o,r[o])}},Yc=t=>{if(t.startsWith("top"))return{property:"bottom",value:je.arrowOffset.varRef};if(t.startsWith("bottom"))return{property:"top",value:je.arrowOffset.varRef};if(t.startsWith("left"))return{property:"right",value:je.arrowOffset.varRef};if(t.startsWith("right"))return{property:"left",value:je.arrowOffset.varRef}},Xc={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:t})=>{ra(t)},effect:({state:t})=>()=>{ra(t)}},ra=t=>{if(!t.elements.arrow)return;const e=t.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!e)return;const n=Kc(t.placement);n&&e.style.setProperty("--popper-arrow-default-shadow",n),Object.assign(e.style,{transform:"rotate(45deg)",background:je.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},Qc={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},eu={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function tu(t,e="ltr"){var n,r;const o=((n=Qc[t])==null?void 0:n[e])||t;return e==="ltr"?o:(r=eu[t])!=null?r:o}var $e="top",Xe="bottom",Qe="right",qe="left",ks="auto",Kn=[$e,Xe,Qe,qe],sn="start",An="end",nu="clippingParents",ti="viewport",gn="popper",ru="reference",oa=Kn.reduce(function(t,e){return t.concat([e+"-"+sn,e+"-"+An])},[]),ni=[].concat(Kn,[ks]).reduce(function(t,e){return t.concat([e,e+"-"+sn,e+"-"+An])},[]),ou="beforeRead",su="read",au="afterRead",iu="beforeMain",lu="main",cu="afterMain",uu="beforeWrite",du="write",fu="afterWrite",hu=[ou,su,au,iu,lu,cu,uu,du,fu];function it(t){return t?(t.nodeName||"").toLowerCase():null}function Ve(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function $t(t){var e=Ve(t).Element;return t instanceof e||t instanceof Element}function Ye(t){var e=Ve(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Es(t){if(typeof ShadowRoot>"u")return!1;var e=Ve(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function pu(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},o=e.attributes[n]||{},s=e.elements[n];!Ye(s)||!it(s)||(Object.assign(s.style,r),Object.keys(o).forEach(function(i){var a=o[i];a===!1?s.removeAttribute(i):s.setAttribute(i,a===!0?"":a)}))})}function mu(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var o=e.elements[r],s=e.attributes[r]||{},i=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),a=i.reduce(function(l,u){return l[u]="",l},{});!Ye(o)||!it(o)||(Object.assign(o.style,a),Object.keys(s).forEach(function(l){o.removeAttribute(l)}))})}}const yu={name:"applyStyles",enabled:!0,phase:"write",fn:pu,effect:mu,requires:["computeStyles"]};function at(t){return t.split("-")[0]}var Mt=Math.max,kr=Math.min,an=Math.round;function So(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function ri(){return!/^((?!chrome|android).)*safari/i.test(So())}function ln(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),o=1,s=1;e&&Ye(t)&&(o=t.offsetWidth>0&&an(r.width)/t.offsetWidth||1,s=t.offsetHeight>0&&an(r.height)/t.offsetHeight||1);var i=$t(t)?Ve(t):window,a=i.visualViewport,l=!ri()&&n,u=(r.left+(l&&a?a.offsetLeft:0))/o,c=(r.top+(l&&a?a.offsetTop:0))/s,f=r.width/o,p=r.height/s;return{width:f,height:p,top:c,right:u+f,bottom:c+p,left:u,x:u,y:c}}function Cs(t){var e=ln(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function oi(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Es(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function vt(t){return Ve(t).getComputedStyle(t)}function vu(t){return["table","td","th"].indexOf(it(t))>=0}function jt(t){return(($t(t)?t.ownerDocument:t.document)||window.document).documentElement}function Jr(t){return it(t)==="html"?t:t.assignedSlot||t.parentNode||(Es(t)?t.host:null)||jt(t)}function sa(t){return!Ye(t)||vt(t).position==="fixed"?null:t.offsetParent}function gu(t){var e=/firefox/i.test(So()),n=/Trident/i.test(So());if(n&&Ye(t)){var r=vt(t);if(r.position==="fixed")return null}var o=Jr(t);for(Es(o)&&(o=o.host);Ye(o)&&["html","body"].indexOf(it(o))<0;){var s=vt(o);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return o;o=o.parentNode}return null}function $n(t){for(var e=Ve(t),n=sa(t);n&&vu(n)&&vt(n).position==="static";)n=sa(n);return n&&(it(n)==="html"||it(n)==="body"&&vt(n).position==="static")?e:n||gu(t)||e}function Ss(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function En(t,e,n){return Mt(t,kr(e,n))}function wu(t,e,n){var r=En(t,e,n);return r>n?n:r}function si(){return{top:0,right:0,bottom:0,left:0}}function ai(t){return Object.assign({},si(),t)}function ii(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var bu=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,ai(typeof e!="number"?e:ii(e,Kn))};function _u(t){var e,n=t.state,r=t.name,o=t.options,s=n.elements.arrow,i=n.modifiersData.popperOffsets,a=at(n.placement),l=Ss(a),u=[qe,Qe].indexOf(a)>=0,c=u?"height":"width";if(!(!s||!i)){var f=bu(o.padding,n),p=Cs(s),h=l==="y"?$e:qe,w=l==="y"?Xe:Qe,d=n.rects.reference[c]+n.rects.reference[l]-i[l]-n.rects.popper[c],y=i[l]-n.rects.reference[l],m=$n(s),g=m?l==="y"?m.clientHeight||0:m.clientWidth||0:0,_=d/2-y/2,x=f[h],E=g-p[c]-f[w],S=g/2-p[c]/2+_,k=En(x,S,E),N=l;n.modifiersData[r]=(e={},e[N]=k,e.centerOffset=k-S,e)}}function xu(t){var e=t.state,n=t.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||oi(e.elements.popper,o)&&(e.elements.arrow=o))}const ku={name:"arrow",enabled:!0,phase:"main",fn:_u,effect:xu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function cn(t){return t.split("-")[1]}var Eu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Cu(t,e){var n=t.x,r=t.y,o=e.devicePixelRatio||1;return{x:an(n*o)/o||0,y:an(r*o)/o||0}}function aa(t){var e,n=t.popper,r=t.popperRect,o=t.placement,s=t.variation,i=t.offsets,a=t.position,l=t.gpuAcceleration,u=t.adaptive,c=t.roundOffsets,f=t.isFixed,p=i.x,h=p===void 0?0:p,w=i.y,d=w===void 0?0:w,y=typeof c=="function"?c({x:h,y:d}):{x:h,y:d};h=y.x,d=y.y;var m=i.hasOwnProperty("x"),g=i.hasOwnProperty("y"),_=qe,x=$e,E=window;if(u){var S=$n(n),k="clientHeight",N="clientWidth";if(S===Ve(n)&&(S=jt(n),vt(S).position!=="static"&&a==="absolute"&&(k="scrollHeight",N="scrollWidth")),S=S,o===$e||(o===qe||o===Qe)&&s===An){x=Xe;var D=f&&S===E&&E.visualViewport?E.visualViewport.height:S[k];d-=D-r.height,d*=l?1:-1}if(o===qe||(o===$e||o===Xe)&&s===An){_=Qe;var R=f&&S===E&&E.visualViewport?E.visualViewport.width:S[N];h-=R-r.width,h*=l?1:-1}}var H=Object.assign({position:a},u&&Eu),P=c===!0?Cu({x:h,y:d},Ve(n)):{x:h,y:d};if(h=P.x,d=P.y,l){var T;return Object.assign({},H,(T={},T[x]=g?"0":"",T[_]=m?"0":"",T.transform=(E.devicePixelRatio||1)<=1?"translate("+h+"px, "+d+"px)":"translate3d("+h+"px, "+d+"px, 0)",T))}return Object.assign({},H,(e={},e[x]=g?d+"px":"",e[_]=m?h+"px":"",e.transform="",e))}function Su(t){var e=t.state,n=t.options,r=n.gpuAcceleration,o=r===void 0?!0:r,s=n.adaptive,i=s===void 0?!0:s,a=n.roundOffsets,l=a===void 0?!0:a,u={placement:at(e.placement),variation:cn(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,aa(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:i,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,aa(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Iu={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Su,data:{}};var Xn={passive:!0};function Ou(t){var e=t.state,n=t.instance,r=t.options,o=r.scroll,s=o===void 0?!0:o,i=r.resize,a=i===void 0?!0:i,l=Ve(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&u.forEach(function(c){c.addEventListener("scroll",n.update,Xn)}),a&&l.addEventListener("resize",n.update,Xn),function(){s&&u.forEach(function(c){c.removeEventListener("scroll",n.update,Xn)}),a&&l.removeEventListener("resize",n.update,Xn)}}const Du={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Ou,data:{}};var Pu={left:"right",right:"left",bottom:"top",top:"bottom"};function cr(t){return t.replace(/left|right|bottom|top/g,function(e){return Pu[e]})}var ju={start:"end",end:"start"};function ia(t){return t.replace(/start|end/g,function(e){return ju[e]})}function Is(t){var e=Ve(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Os(t){return ln(jt(t)).left+Is(t).scrollLeft}function Au(t,e){var n=Ve(t),r=jt(t),o=n.visualViewport,s=r.clientWidth,i=r.clientHeight,a=0,l=0;if(o){s=o.width,i=o.height;var u=ri();(u||!u&&e==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}return{width:s,height:i,x:a+Os(t),y:l}}function Nu(t){var e,n=jt(t),r=Is(t),o=(e=t.ownerDocument)==null?void 0:e.body,s=Mt(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),i=Mt(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),a=-r.scrollLeft+Os(t),l=-r.scrollTop;return vt(o||n).direction==="rtl"&&(a+=Mt(n.clientWidth,o?o.clientWidth:0)-s),{width:s,height:i,x:a,y:l}}function Ds(t){var e=vt(t),n=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function li(t){return["html","body","#document"].indexOf(it(t))>=0?t.ownerDocument.body:Ye(t)&&Ds(t)?t:li(Jr(t))}function Cn(t,e){var n;e===void 0&&(e=[]);var r=li(t),o=r===((n=t.ownerDocument)==null?void 0:n.body),s=Ve(r),i=o?[s].concat(s.visualViewport||[],Ds(r)?r:[]):r,a=e.concat(i);return o?a:a.concat(Cn(Jr(i)))}function Io(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Fu(t,e){var n=ln(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function la(t,e,n){return e===ti?Io(Au(t,n)):$t(e)?Fu(e,n):Io(Nu(jt(t)))}function Ru(t){var e=Cn(Jr(t)),n=["absolute","fixed"].indexOf(vt(t).position)>=0,r=n&&Ye(t)?$n(t):t;return $t(r)?e.filter(function(o){return $t(o)&&oi(o,r)&&it(o)!=="body"}):[]}function Tu(t,e,n,r){var o=e==="clippingParents"?Ru(t):[].concat(e),s=[].concat(o,[n]),i=s[0],a=s.reduce(function(l,u){var c=la(t,u,r);return l.top=Mt(c.top,l.top),l.right=kr(c.right,l.right),l.bottom=kr(c.bottom,l.bottom),l.left=Mt(c.left,l.left),l},la(t,i,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function ci(t){var e=t.reference,n=t.element,r=t.placement,o=r?at(r):null,s=r?cn(r):null,i=e.x+e.width/2-n.width/2,a=e.y+e.height/2-n.height/2,l;switch(o){case $e:l={x:i,y:e.y-n.height};break;case Xe:l={x:i,y:e.y+e.height};break;case Qe:l={x:e.x+e.width,y:a};break;case qe:l={x:e.x-n.width,y:a};break;default:l={x:e.x,y:e.y}}var u=o?Ss(o):null;if(u!=null){var c=u==="y"?"height":"width";switch(s){case sn:l[u]=l[u]-(e[c]/2-n[c]/2);break;case An:l[u]=l[u]+(e[c]/2-n[c]/2);break}}return l}function Nn(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=r===void 0?t.placement:r,s=n.strategy,i=s===void 0?t.strategy:s,a=n.boundary,l=a===void 0?nu:a,u=n.rootBoundary,c=u===void 0?ti:u,f=n.elementContext,p=f===void 0?gn:f,h=n.altBoundary,w=h===void 0?!1:h,d=n.padding,y=d===void 0?0:d,m=ai(typeof y!="number"?y:ii(y,Kn)),g=p===gn?ru:gn,_=t.rects.popper,x=t.elements[w?g:p],E=Tu($t(x)?x:x.contextElement||jt(t.elements.popper),l,c,i),S=ln(t.elements.reference),k=ci({reference:S,element:_,strategy:"absolute",placement:o}),N=Io(Object.assign({},_,k)),D=p===gn?N:S,R={top:E.top-D.top+m.top,bottom:D.bottom-E.bottom+m.bottom,left:E.left-D.left+m.left,right:D.right-E.right+m.right},H=t.modifiersData.offset;if(p===gn&&H){var P=H[o];Object.keys(R).forEach(function(T){var b=[Qe,Xe].indexOf(T)>=0?1:-1,q=[$e,Xe].indexOf(T)>=0?"y":"x";R[T]+=P[q]*b})}return R}function Bu(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=n.boundary,s=n.rootBoundary,i=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,u=l===void 0?ni:l,c=cn(r),f=c?a?oa:oa.filter(function(w){return cn(w)===c}):Kn,p=f.filter(function(w){return u.indexOf(w)>=0});p.length===0&&(p=f);var h=p.reduce(function(w,d){return w[d]=Nn(t,{placement:d,boundary:o,rootBoundary:s,padding:i})[at(d)],w},{});return Object.keys(h).sort(function(w,d){return h[w]-h[d]})}function Mu(t){if(at(t)===ks)return[];var e=cr(t);return[ia(t),e,ia(e)]}function zu(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var o=n.mainAxis,s=o===void 0?!0:o,i=n.altAxis,a=i===void 0?!0:i,l=n.fallbackPlacements,u=n.padding,c=n.boundary,f=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,w=h===void 0?!0:h,d=n.allowedAutoPlacements,y=e.options.placement,m=at(y),g=m===y,_=l||(g||!w?[cr(y)]:Mu(y)),x=[y].concat(_).reduce(function(K,$){return K.concat(at($)===ks?Bu(e,{placement:$,boundary:c,rootBoundary:f,padding:u,flipVariations:w,allowedAutoPlacements:d}):$)},[]),E=e.rects.reference,S=e.rects.popper,k=new Map,N=!0,D=x[0],R=0;R<x.length;R++){var H=x[R],P=at(H),T=cn(H)===sn,b=[$e,Xe].indexOf(P)>=0,q=b?"width":"height",Q=Nn(e,{placement:H,boundary:c,rootBoundary:f,altBoundary:p,padding:u}),A=b?T?Qe:qe:T?Xe:$e;E[q]>S[q]&&(A=cr(A));var te=cr(A),Z=[];if(s&&Z.push(Q[P]<=0),a&&Z.push(Q[A]<=0,Q[te]<=0),Z.every(function(K){return K})){D=H,N=!1;break}k.set(H,Z)}if(N)for(var re=w?3:1,L=function($){var ie=x.find(function(me){var se=k.get(me);if(se)return se.slice(0,$).every(function(ae){return ae})});if(ie)return D=ie,"break"},B=re;B>0;B--){var U=L(B);if(U==="break")break}e.placement!==D&&(e.modifiersData[r]._skip=!0,e.placement=D,e.reset=!0)}}const Lu={name:"flip",enabled:!0,phase:"main",fn:zu,requiresIfExists:["offset"],data:{_skip:!1}};function ca(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function ua(t){return[$e,Qe,Xe,qe].some(function(e){return t[e]>=0})}function Wu(t){var e=t.state,n=t.name,r=e.rects.reference,o=e.rects.popper,s=e.modifiersData.preventOverflow,i=Nn(e,{elementContext:"reference"}),a=Nn(e,{altBoundary:!0}),l=ca(i,r),u=ca(a,o,s),c=ua(l),f=ua(u);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":f})}const Uu={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Wu};function Ku(t,e,n){var r=at(t),o=[qe,$e].indexOf(r)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,i=s[0],a=s[1];return i=i||0,a=(a||0)*o,[qe,Qe].indexOf(r)>=0?{x:a,y:i}:{x:i,y:a}}function $u(t){var e=t.state,n=t.options,r=t.name,o=n.offset,s=o===void 0?[0,0]:o,i=ni.reduce(function(c,f){return c[f]=Ku(f,e.rects,s),c},{}),a=i[e.placement],l=a.x,u=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[r]=i}const qu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:$u};function Hu(t){var e=t.state,n=t.name;e.modifiersData[n]=ci({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Vu={name:"popperOffsets",enabled:!0,phase:"read",fn:Hu,data:{}};function Zu(t){return t==="x"?"y":"x"}function Gu(t){var e=t.state,n=t.options,r=t.name,o=n.mainAxis,s=o===void 0?!0:o,i=n.altAxis,a=i===void 0?!1:i,l=n.boundary,u=n.rootBoundary,c=n.altBoundary,f=n.padding,p=n.tether,h=p===void 0?!0:p,w=n.tetherOffset,d=w===void 0?0:w,y=Nn(e,{boundary:l,rootBoundary:u,padding:f,altBoundary:c}),m=at(e.placement),g=cn(e.placement),_=!g,x=Ss(m),E=Zu(x),S=e.modifiersData.popperOffsets,k=e.rects.reference,N=e.rects.popper,D=typeof d=="function"?d(Object.assign({},e.rects,{placement:e.placement})):d,R=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),H=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,P={x:0,y:0};if(S){if(s){var T,b=x==="y"?$e:qe,q=x==="y"?Xe:Qe,Q=x==="y"?"height":"width",A=S[x],te=A+y[b],Z=A-y[q],re=h?-N[Q]/2:0,L=g===sn?k[Q]:N[Q],B=g===sn?-N[Q]:-k[Q],U=e.elements.arrow,K=h&&U?Cs(U):{width:0,height:0},$=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:si(),ie=$[b],me=$[q],se=En(0,k[Q],K[Q]),ae=_?k[Q]/2-re-se-ie-R.mainAxis:L-se-ie-R.mainAxis,ye=_?-k[Q]/2+re+se+me+R.mainAxis:B+se+me+R.mainAxis,he=e.elements.arrow&&$n(e.elements.arrow),de=he?x==="y"?he.clientTop||0:he.clientLeft||0:0,we=(T=H==null?void 0:H[x])!=null?T:0,v=A+ae-we-de,W=A+ye-we,z=En(h?kr(te,v):te,A,h?Mt(Z,W):Z);S[x]=z,P[x]=z-A}if(a){var O,C=x==="x"?$e:qe,F=x==="x"?Xe:Qe,G=S[E],Y=E==="y"?"height":"width",M=G+y[C],X=G-y[F],ne=[$e,qe].indexOf(m)!==-1,ee=(O=H==null?void 0:H[E])!=null?O:0,le=ne?M:G-k[Y]-N[Y]-ee+R.altAxis,_e=ne?G+k[Y]+N[Y]-ee-R.altAxis:X,ge=h&&ne?wu(le,G,_e):En(h?le:M,G,h?_e:X);S[E]=ge,P[E]=ge-G}e.modifiersData[r]=P}}const Ju={name:"preventOverflow",enabled:!0,phase:"main",fn:Gu,requiresIfExists:["offset"]};function Yu(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Xu(t){return t===Ve(t)||!Ye(t)?Is(t):Yu(t)}function Qu(t){var e=t.getBoundingClientRect(),n=an(e.width)/t.offsetWidth||1,r=an(e.height)/t.offsetHeight||1;return n!==1||r!==1}function ed(t,e,n){n===void 0&&(n=!1);var r=Ye(e),o=Ye(e)&&Qu(e),s=jt(e),i=ln(t,o,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((it(e)!=="body"||Ds(s))&&(a=Xu(e)),Ye(e)?(l=ln(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Os(s))),{x:i.left+a.scrollLeft-l.x,y:i.top+a.scrollTop-l.y,width:i.width,height:i.height}}function td(t){var e=new Map,n=new Set,r=[];t.forEach(function(s){e.set(s.name,s)});function o(s){n.add(s.name);var i=[].concat(s.requires||[],s.requiresIfExists||[]);i.forEach(function(a){if(!n.has(a)){var l=e.get(a);l&&o(l)}}),r.push(s)}return t.forEach(function(s){n.has(s.name)||o(s)}),r}function nd(t){var e=td(t);return hu.reduce(function(n,r){return n.concat(e.filter(function(o){return o.phase===r}))},[])}function rd(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function od(t){var e=t.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var da={placement:"bottom",modifiers:[],strategy:"absolute"};function fa(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function sd(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,o=e.defaultOptions,s=o===void 0?da:o;return function(a,l,u){u===void 0&&(u=s);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},da,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},f=[],p=!1,h={state:c,setOptions:function(m){var g=typeof m=="function"?m(c.options):m;d(),c.options=Object.assign({},s,c.options,g),c.scrollParents={reference:$t(a)?Cn(a):a.contextElement?Cn(a.contextElement):[],popper:Cn(l)};var _=nd(od([].concat(r,c.options.modifiers)));return c.orderedModifiers=_.filter(function(x){return x.enabled}),w(),h.update()},forceUpdate:function(){if(!p){var m=c.elements,g=m.reference,_=m.popper;if(fa(g,_)){c.rects={reference:ed(g,$n(_),c.options.strategy==="fixed"),popper:Cs(_)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(R){return c.modifiersData[R.name]=Object.assign({},R.data)});for(var x=0;x<c.orderedModifiers.length;x++){if(c.reset===!0){c.reset=!1,x=-1;continue}var E=c.orderedModifiers[x],S=E.fn,k=E.options,N=k===void 0?{}:k,D=E.name;typeof S=="function"&&(c=S({state:c,options:N,name:D,instance:h})||c)}}}},update:rd(function(){return new Promise(function(y){h.forceUpdate(),y(c)})}),destroy:function(){d(),p=!0}};if(!fa(a,l))return h;h.setOptions(u).then(function(y){!p&&u.onFirstUpdate&&u.onFirstUpdate(y)});function w(){c.orderedModifiers.forEach(function(y){var m=y.name,g=y.options,_=g===void 0?{}:g,x=y.effect;if(typeof x=="function"){var E=x({state:c,name:m,instance:h,options:_}),S=function(){};f.push(E||S)}})}function d(){f.forEach(function(y){return y()}),f=[]}return h}}var ad=[Du,Vu,Iu,yu,qu,Lu,Ju,ku,Uu],id=sd({defaultModifiers:ad});function Ps(t={}){const{enabled:e=!0,modifiers:n,placement:r="bottom",strategy:o="absolute",arrowPadding:s=8,eventListeners:i=!0,offset:a,gutter:l=8,flip:u=!0,boundary:c="clippingParents",preventOverflow:f=!0,matchWidth:p,direction:h="ltr"}=t,w=j.useRef(null),d=j.useRef(null),y=j.useRef(null),m=tu(r,h),g=j.useRef(()=>{}),_=j.useCallback(()=>{var R;!e||!w.current||!d.current||((R=g.current)==null||R.call(g),y.current=id(w.current,d.current,{placement:m,modifiers:[Xc,Gc,Zc,{...Vc,enabled:!!p},{name:"eventListeners",...Hc(i)},{name:"arrow",options:{padding:s}},{name:"offset",options:{offset:a??[0,l]}},{name:"flip",enabled:!!u,options:{padding:8}},{name:"preventOverflow",enabled:!!f,options:{boundary:c}},...n??[]],strategy:o}),y.current.forceUpdate(),g.current=y.current.destroy)},[m,e,n,p,i,s,a,l,u,f,c,o]);j.useEffect(()=>()=>{var R;!w.current&&!d.current&&((R=y.current)==null||R.destroy(),y.current=null)},[]);const x=j.useCallback(R=>{w.current=R,_()},[_]),E=j.useCallback((R={},H=null)=>({...R,ref:Be(x,H)}),[x]),S=j.useCallback(R=>{d.current=R,_()},[_]),k=j.useCallback((R={},H=null)=>({...R,ref:Be(S,H),style:{...R.style,position:o,minWidth:p?void 0:"max-content",inset:"0 auto auto 0"}}),[o,S,p]),N=j.useCallback((R={},H=null)=>{const{size:P,shadowColor:T,bg:b,style:q,...Q}=R;return{...Q,ref:H,"data-popper-arrow":"",style:ld(R)}},[]),D=j.useCallback((R={},H=null)=>({...R,ref:H,"data-popper-arrow-inner":""}),[]);return{update(){var R;(R=y.current)==null||R.update()},forceUpdate(){var R;(R=y.current)==null||R.forceUpdate()},transformOrigin:je.transformOrigin.varRef,referenceRef:x,popperRef:S,getPopperProps:k,getArrowProps:N,getArrowInnerProps:D,getReferenceProps:E}}function ld(t){const{size:e,shadowColor:n,bg:r,style:o}=t,s={...o,position:"absolute"};return e&&(s["--popper-arrow-size"]=e),n&&(s["--popper-arrow-shadow-color"]=n),r&&(s["--popper-arrow-bg"]=r),s}function js(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=Tt(n),i=Tt(e),[a,l]=j.useState(t.defaultIsOpen||!1),u=r!==void 0?r:a,c=r!==void 0,f=j.useId(),p=o??`disclosure-${f}`,h=j.useCallback(()=>{c||l(!1),i==null||i()},[c,i]),w=j.useCallback(()=>{c||l(!0),s==null||s()},[c,s]),d=j.useCallback(()=>{u?h():w()},[u,w,h]);function y(g={}){return{...g,"aria-expanded":u,"aria-controls":p,onClick(_){var x;(x=g.onClick)==null||x.call(g,_),d()}}}function m(g={}){return{...g,hidden:!u,id:p}}return{isOpen:u,onOpen:w,onClose:h,onToggle:d,isControlled:c,getButtonProps:y,getDisclosureProps:m}}function cd(t){const{ref:e,handler:n,enabled:r=!0}=t,o=Tt(n),i=j.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;j.useEffect(()=>{if(!r)return;const a=f=>{io(f,e)&&(i.isPointerDown=!0)},l=f=>{if(i.ignoreEmulatedMouseEvents){i.ignoreEmulatedMouseEvents=!1;return}i.isPointerDown&&n&&io(f,e)&&(i.isPointerDown=!1,o(f))},u=f=>{i.ignoreEmulatedMouseEvents=!0,n&&i.isPointerDown&&io(f,e)&&(i.isPointerDown=!1,o(f))},c=ui(e.current);return c.addEventListener("mousedown",a,!0),c.addEventListener("mouseup",l,!0),c.addEventListener("touchstart",a,!0),c.addEventListener("touchend",u,!0),()=>{c.removeEventListener("mousedown",a,!0),c.removeEventListener("mouseup",l,!0),c.removeEventListener("touchstart",a,!0),c.removeEventListener("touchend",u,!0)}},[n,e,o,i,r])}function io(t,e){var n;const r=t.target;return r&&!ui(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function ui(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function di(t){const{isOpen:e,ref:n}=t,[r,o]=j.useState(e),[s,i]=j.useState(!1);return j.useEffect(()=>{s||(o(e),i(!0))},[e,s,r]),en(()=>n.current,"animationend",()=>{o(e)}),{present:!(e?!1:!r),onComplete(){var l;const u=Tl(n.current),c=new u.CustomEvent("animationend",{bubbles:!0});(l=n.current)==null||l.dispatchEvent(c)}}}function As(t){const{wasSelected:e,enabled:n,isSelected:r,mode:o="unmount"}=t;return!!(!n||r||o==="keepMounted"&&e)}var[ud,dd,fd,hd]=La(),[pd,qn]=et({strict:!1,name:"MenuContext"});function md(t,...e){const n=j.useId(),r=t||n;return j.useMemo(()=>e.map(o=>`${o}-${r}`),[r,e])}function fi(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function ha(t){return fi(t).activeElement===t}function yd(t={}){const{id:e,closeOnSelect:n=!0,closeOnBlur:r=!0,initialFocusRef:o,autoSelect:s=!0,isLazy:i,isOpen:a,defaultIsOpen:l,onClose:u,onOpen:c,placement:f="bottom-start",lazyBehavior:p="unmount",direction:h,computePositionOnMount:w=!1,...d}=t,y=j.useRef(null),m=j.useRef(null),g=fd(),_=j.useCallback(()=>{requestAnimationFrame(()=>{var U;(U=y.current)==null||U.focus({preventScroll:!1})})},[]),x=j.useCallback(()=>{const U=setTimeout(()=>{var K;if(o)(K=o.current)==null||K.focus();else{const $=g.firstEnabled();$&&T($.index)}});te.current.add(U)},[g,o]),E=j.useCallback(()=>{const U=setTimeout(()=>{const K=g.lastEnabled();K&&T(K.index)});te.current.add(U)},[g]),S=j.useCallback(()=>{c==null||c(),s?x():_()},[s,x,_,c]),{isOpen:k,onOpen:N,onClose:D,onToggle:R}=js({isOpen:a,defaultIsOpen:l,onClose:u,onOpen:S});cd({enabled:k&&r,ref:y,handler:U=>{var K;(K=m.current)!=null&&K.contains(U.target)||D()}});const H=Ps({...d,enabled:k||w,placement:f,direction:h}),[P,T]=j.useState(-1);Kr(()=>{k||T(-1)},[k]),ei(y,{focusRef:m,visible:k,shouldFocus:!0});const b=di({isOpen:k,ref:y}),[q,Q]=md(e,"menu-button","menu-list"),A=j.useCallback(()=>{N(),_()},[N,_]),te=j.useRef(new Set([]));j.useEffect(()=>{const U=te.current;return()=>{U.forEach(K=>clearTimeout(K)),U.clear()}},[]);const Z=j.useCallback(()=>{N(),x()},[x,N]),re=j.useCallback(()=>{N(),E()},[N,E]),L=j.useCallback(()=>{var U,K;const $=fi(y.current),ie=(U=y.current)==null?void 0:U.contains($.activeElement);if(!(k&&!ie))return;const se=(K=g.item(P))==null?void 0:K.node;se==null||se.focus({preventScroll:!0})},[k,P,g]),B=j.useRef(null);return{openAndFocusMenu:A,openAndFocusFirstItem:Z,openAndFocusLastItem:re,onTransitionEnd:L,unstable__animationState:b,descendants:g,popper:H,buttonId:q,menuId:Q,forceUpdate:H.forceUpdate,orientation:"vertical",isOpen:k,onToggle:R,onOpen:N,onClose:D,menuRef:y,buttonRef:m,focusedIndex:P,closeOnSelect:n,closeOnBlur:r,autoSelect:s,setFocusedIndex:T,isLazy:i,lazyBehavior:p,initialFocusRef:o,rafId:B}}function Ep(t={},e=null){const n=qn(),{onToggle:r,popper:o,openAndFocusFirstItem:s,openAndFocusLastItem:i}=n,a=j.useCallback(l=>{const u=l.key,f={Enter:s,ArrowDown:s,ArrowUp:i}[u];f&&(l.preventDefault(),l.stopPropagation(),f(l))},[s,i]);return{...t,ref:Be(n.buttonRef,e,o.referenceRef),id:n.buttonId,"data-active":ot(n.isOpen),"aria-expanded":n.isOpen,"aria-haspopup":"menu","aria-controls":n.menuId,onClick:Ie(t.onClick,r),onKeyDown:Ie(t.onKeyDown,a)}}function Oo(t){var e;return wd(t)&&!!((e=t==null?void 0:t.getAttribute("role"))!=null&&e.startsWith("menuitem"))}function vd(t={},e=null){const n=qn();if(!n)throw new Error("useMenuContext: context is undefined. Seems you forgot to wrap component within <Menu>");const{focusedIndex:r,setFocusedIndex:o,menuRef:s,isOpen:i,onClose:a,menuId:l,isLazy:u,lazyBehavior:c,unstable__animationState:f}=n,p=dd(),h=Tc({preventDefault:m=>m.key!==" "&&Oo(m.target)}),w=j.useCallback(m=>{if(!m.currentTarget.contains(m.target))return;const g=m.key,x={Tab:S=>S.preventDefault(),Escape:a,ArrowDown:()=>{const S=p.nextEnabled(r);S&&o(S.index)},ArrowUp:()=>{const S=p.prevEnabled(r);S&&o(S.index)}}[g];if(x){m.preventDefault(),x(m);return}const E=h(S=>{const k=Bc(p.values(),S,N=>{var D,R;return(R=(D=N==null?void 0:N.node)==null?void 0:D.textContent)!=null?R:""},p.item(r));if(k){const N=p.indexOf(k.node);o(N)}});Oo(m.target)&&E(m)},[p,r,h,a,o]),d=j.useRef(!1);i&&(d.current=!0);const y=As({wasSelected:d.current,enabled:u,mode:c,isSelected:f.present});return{...t,ref:Be(s,e),children:y?t.children:null,tabIndex:-1,role:"menu",id:l,style:{...t.style,transformOrigin:"var(--popper-transform-origin)"},"aria-orientation":"vertical",onKeyDown:Ie(t.onKeyDown,w)}}function gd(t={}){const{popper:e,isOpen:n}=qn();return e.getPopperProps({...t,style:{visibility:n?"visible":"hidden",...t.style}})}function hi(t={},e=null){const{onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onClick:s,onFocus:i,isDisabled:a,isFocusable:l,closeOnSelect:u,type:c,...f}=t,p=qn(),{setFocusedIndex:h,focusedIndex:w,closeOnSelect:d,onClose:y,menuRef:m,isOpen:g,menuId:_,rafId:x}=p,E=j.useRef(null),S=`${_}-menuitem-${j.useId()}`,{index:k,register:N}=hd({disabled:a&&!l}),D=j.useCallback(A=>{n==null||n(A),!a&&h(k)},[h,k,a,n]),R=j.useCallback(A=>{r==null||r(A),E.current&&!ha(E.current)&&D(A)},[D,r]),H=j.useCallback(A=>{o==null||o(A),!a&&h(-1)},[h,a,o]),P=j.useCallback(A=>{s==null||s(A),Oo(A.currentTarget)&&(u??d)&&y()},[y,s,d,u]),T=j.useCallback(A=>{i==null||i(A),h(k)},[h,i,k]),b=k===w,q=a&&!l;Kr(()=>{if(g)return b&&!q&&E.current?(x.current&&cancelAnimationFrame(x.current),x.current=requestAnimationFrame(()=>{var A;(A=E.current)==null||A.focus({preventScroll:!0}),x.current=null})):m.current&&!ha(m.current)&&m.current.focus({preventScroll:!0}),()=>{x.current&&cancelAnimationFrame(x.current)}},[b,q,m,g]);const Q=Qa({onClick:P,onFocus:T,onMouseEnter:D,onMouseMove:R,onMouseLeave:H,ref:Be(N,E,e),isDisabled:a,isFocusable:l});return{...f,...Q,type:c??Q.type,id:S,role:"menuitem",tabIndex:b?0:-1}}function Cp(t={},e=null){const{type:n="radio",isChecked:r,...o}=t;return{...hi(o,e),role:`menuitem${n}`,"aria-checked":r}}function Sp(t={}){const{children:e,type:n="radio",value:r,defaultValue:o,onChange:s,...i}=t,l=n==="radio"?"":[],[u,c]=Wa({defaultValue:o??l,value:r,onChange:s}),f=j.useCallback(w=>{if(n==="radio"&&typeof u=="string"&&c(w),n==="checkbox"&&Array.isArray(u)){const d=u.includes(w)?u.filter(y=>y!==w):u.concat(w);c(d)}},[u,c,n]),h=_s(e).map(w=>{if(w.type.id!=="MenuItemOption")return w;const d=m=>{var g,_;f(w.props.value),(_=(g=w.props).onClick)==null||_.call(g,m)},y=n==="radio"?w.props.value===u:u.includes(w.props.value);return j.cloneElement(w,{type:n,onClick:d,isChecked:y})});return{...i,children:h}}function wd(t){var e;if(!bd(t))return!1;const n=(e=t.ownerDocument.defaultView)!=null?e:window;return t instanceof n.HTMLElement}function bd(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}var[_d,Yr]=et({name:"MenuStylesContext",errorMessage:`useMenuStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Menu />" `}),Ns=t=>{const{children:e}=t,n=Pt("Menu",t),r=tt(t),{direction:o}=hs(),{descendants:s,...i}=yd({...r,direction:o}),a=j.useMemo(()=>i,[i]),{isOpen:l,onClose:u,forceUpdate:c}=a;return I.jsx(ud,{value:s,children:I.jsx(pd,{value:a,children:I.jsx(_d,{value:n,children:Aa(e,{isOpen:l,onClose:u,forceUpdate:c})})})})};Ns.displayName="Menu";var pi=ve((t,e)=>{const n=Yr();return I.jsx(pe.span,{ref:e,...t,__css:n.command,className:"chakra-menu__command"})});pi.displayName="MenuCommand";var xd=ve((t,e)=>{const{type:n,...r}=t,o=Yr(),s=r.as||n?n??void 0:"button",i=j.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...o.item}),[o.item]);return I.jsx(pe.button,{ref:e,type:s,...r,__css:i})}),mi=t=>{const{className:e,children:n,...r}=t,o=Yr(),s=j.Children.only(n),i=j.isValidElement(s)?j.cloneElement(s,{focusable:"false","aria-hidden":!0,className:Ee("chakra-menu__icon",s.props.className)}):null,a=Ee("chakra-menu__icon-wrapper",e);return I.jsx(pe.span,{className:a,...r,__css:o.icon,children:i})};mi.displayName="MenuIcon";var bt=ve((t,e)=>{const{icon:n,iconSpacing:r="0.75rem",command:o,commandSpacing:s="0.75rem",children:i,...a}=t,l=hi(a,e),c=n||o?I.jsx("span",{style:{pointerEvents:"none",flex:1},children:i}):i;return I.jsxs(xd,{...l,className:Ee("chakra-menu__menuitem",l.className),children:[n&&I.jsx(mi,{fontSize:"0.8em",marginEnd:r,children:n}),c,o&&I.jsx(pi,{marginStart:s,children:o})]})});bt.displayName="MenuItem";var kd={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},Ed=pe(ps.div),Fs=ve(function(e,n){var r,o;const{rootProps:s,motionProps:i,...a}=e,{isOpen:l,onTransitionEnd:u,unstable__animationState:c}=qn(),f=vd(a,n),p=gd(s),h=Yr();return I.jsx(pe.div,{...p,__css:{zIndex:(o=e.zIndex)!=null?o:(r=h.list)==null?void 0:r.zIndex},children:I.jsx(Ed,{variants:kd,initial:!1,animate:l?"enter":"exit",__css:{outline:0,...h.list},...i,className:Ee("chakra-menu__menu-list",f.className),...f,onUpdate:u,onAnimationComplete:Na(c.onComplete,f.onAnimationComplete)})})});Fs.displayName="MenuList";var[Cd,fn]=et({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[Sd,Xr]=et({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `});function yi(t){const e=j.Children.only(t.children),{getTriggerProps:n}=fn();return j.cloneElement(e,n(e.props,e.ref))}yi.displayName="PopoverTrigger";var Jt={click:"click",hover:"hover"};function Id(t={}){const{closeOnBlur:e=!0,closeOnEsc:n=!0,initialFocusRef:r,id:o,returnFocusOnClose:s=!0,autoFocus:i=!0,arrowSize:a,arrowShadowColor:l,trigger:u=Jt.click,openDelay:c=200,closeDelay:f=200,isLazy:p,lazyBehavior:h="unmount",computePositionOnMount:w,...d}=t,{isOpen:y,onClose:m,onOpen:g,onToggle:_}=js(t),x=j.useRef(null),E=j.useRef(null),S=j.useRef(null),k=j.useRef(!1),N=j.useRef(!1);y&&(N.current=!0);const[D,R]=j.useState(!1),[H,P]=j.useState(!1),T=j.useId(),b=o??T,[q,Q,A,te]=["popover-trigger","popover-content","popover-header","popover-body"].map(W=>`${W}-${b}`),{referenceRef:Z,getArrowProps:re,getPopperProps:L,getArrowInnerProps:B,forceUpdate:U}=Ps({...d,enabled:y||!!w}),K=di({isOpen:y,ref:S});gc({enabled:y,ref:E}),ei(S,{focusRef:E,visible:y,shouldFocus:s&&u===Jt.click}),Wc(S,{focusRef:r,visible:y,shouldFocus:i&&u===Jt.click});const $=As({wasSelected:N.current,enabled:p,mode:h,isSelected:K.present}),ie=j.useCallback((W={},z=null)=>{const O={...W,style:{...W.style,transformOrigin:je.transformOrigin.varRef,[je.arrowSize.var]:a?`${a}px`:void 0,[je.arrowShadowColor.var]:l},ref:Be(S,z),children:$?W.children:null,id:Q,tabIndex:-1,role:"dialog",onKeyDown:Ie(W.onKeyDown,C=>{n&&C.key==="Escape"&&m()}),onBlur:Ie(W.onBlur,C=>{const F=pa(C),G=lo(S.current,F),Y=lo(E.current,F);y&&e&&(!G&&!Y)&&m()}),"aria-labelledby":D?A:void 0,"aria-describedby":H?te:void 0};return u===Jt.hover&&(O.role="tooltip",O.onMouseEnter=Ie(W.onMouseEnter,()=>{k.current=!0}),O.onMouseLeave=Ie(W.onMouseLeave,C=>{C.nativeEvent.relatedTarget!==null&&(k.current=!1,setTimeout(()=>m(),f))})),O},[$,Q,D,A,H,te,u,n,m,y,e,f,l,a]),me=j.useCallback((W={},z=null)=>L({...W,style:{visibility:y?"visible":"hidden",...W.style}},z),[y,L]),se=j.useCallback((W,z=null)=>({...W,ref:Be(z,x,Z)}),[x,Z]),ae=j.useRef(),ye=j.useRef(),he=j.useCallback(W=>{x.current==null&&Z(W)},[Z]),de=j.useCallback((W={},z=null)=>{const O={...W,ref:Be(E,z,he),id:q,"aria-haspopup":"dialog","aria-expanded":y,"aria-controls":Q};return u===Jt.click&&(O.onClick=Ie(W.onClick,_)),u===Jt.hover&&(O.onFocus=Ie(W.onFocus,()=>{ae.current===void 0&&g()}),O.onBlur=Ie(W.onBlur,C=>{const F=pa(C),G=!lo(S.current,F);y&&e&&G&&m()}),O.onKeyDown=Ie(W.onKeyDown,C=>{C.key==="Escape"&&m()}),O.onMouseEnter=Ie(W.onMouseEnter,()=>{k.current=!0,ae.current=window.setTimeout(()=>g(),c)}),O.onMouseLeave=Ie(W.onMouseLeave,()=>{k.current=!1,ae.current&&(clearTimeout(ae.current),ae.current=void 0),ye.current=window.setTimeout(()=>{k.current===!1&&m()},f)})),O},[q,y,Q,u,he,_,g,e,m,c,f]);j.useEffect(()=>()=>{ae.current&&clearTimeout(ae.current),ye.current&&clearTimeout(ye.current)},[]);const we=j.useCallback((W={},z=null)=>({...W,id:A,ref:Be(z,O=>{R(!!O)})}),[A]),v=j.useCallback((W={},z=null)=>({...W,id:te,ref:Be(z,O=>{P(!!O)})}),[te]);return{forceUpdate:U,isOpen:y,onAnimationComplete:K.onComplete,onClose:m,getAnchorProps:se,getArrowProps:re,getArrowInnerProps:B,getPopoverPositionerProps:me,getPopoverProps:ie,getTriggerProps:de,getHeaderProps:we,getBodyProps:v}}function lo(t,e){return t===e||(t==null?void 0:t.contains(e))}function pa(t){var e;const n=t.currentTarget.ownerDocument.activeElement;return(e=t.relatedTarget)!=null?e:n}function vi(t){const e=Pt("Popover",t),{children:n,...r}=tt(t),o=hs(),s=Id({...r,direction:o.direction});return I.jsx(Cd,{value:s,children:I.jsx(Sd,{value:e,children:Aa(n,{isOpen:s.isOpen,onClose:s.onClose,forceUpdate:s.forceUpdate})})})}vi.displayName="Popover";var co=(t,e)=>e?`${t}.${e}, ${e}`:void 0;function gi(t){var e;const{bg:n,bgColor:r,backgroundColor:o,shadow:s,boxShadow:i,shadowColor:a}=t,{getArrowProps:l,getArrowInnerProps:u}=fn(),c=Xr(),f=(e=n??r)!=null?e:o,p=s??i;return I.jsx(pe.div,{...l(),className:"chakra-popover__arrow-positioner",children:I.jsx(pe.div,{className:Ee("chakra-popover__arrow",t.className),...u(t),__css:{"--popper-arrow-shadow-color":co("colors",a),"--popper-arrow-bg":co("colors",f),"--popper-arrow-shadow":co("shadows",p),...c.arrow}})})}gi.displayName="PopoverArrow";var wi=ve(function(e,n){const{getBodyProps:r}=fn(),o=Xr();return I.jsx(pe.div,{...r(e,n),className:Ee("chakra-popover__body",e.className),__css:o.body})});wi.displayName="PopoverBody";var bi=ve(function(e,n){const{onClose:r}=fn(),o=Xr();return I.jsx(Bl,{size:"sm",onClick:r,className:Ee("chakra-popover__close-btn",e.className),__css:o.closeButton,ref:n,...e})});bi.displayName="PopoverCloseButton";function Od(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}var Dd={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},Pd=pe(ps.section),_i=ve(function(e,n){const{variants:r=Dd,...o}=e,{isOpen:s}=fn();return I.jsx(Pd,{ref:n,variants:Od(r),initial:!1,animate:s?"enter":"exit",...o})});_i.displayName="PopoverTransition";var xi=ve(function(e,n){const{rootProps:r,motionProps:o,...s}=e,{getPopoverProps:i,getPopoverPositionerProps:a,onAnimationComplete:l}=fn(),u=Xr(),c={position:"relative",display:"flex",flexDirection:"column",...u.content};return I.jsx(pe.div,{...a(r),__css:u.popper,className:"chakra-popover__popper",children:I.jsx(_i,{...o,...i(s,n),onAnimationComplete:Na(l,s.onAnimationComplete),className:Ee("chakra-popover__content",e.className),__css:c})})});xi.displayName="PopoverContent";var[jd,Ad,Nd,Fd]=La();function Rd(t){var e;const{defaultIndex:n,onChange:r,index:o,isManual:s,isLazy:i,lazyBehavior:a="unmount",orientation:l="horizontal",direction:u="ltr",...c}=t,[f,p]=j.useState(n??0),[h,w]=Wa({defaultValue:n??0,value:o,onChange:r});j.useEffect(()=>{o!=null&&p(o)},[o]);const d=Nd(),y=j.useId();return{id:`tabs-${(e=t.id)!=null?e:y}`,selectedIndex:h,focusedIndex:f,setSelectedIndex:w,setFocusedIndex:p,isManual:s,isLazy:i,lazyBehavior:a,orientation:l,descendants:d,direction:u,htmlProps:c}}var[Td,Qr]=et({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function Bd(t){const{focusedIndex:e,orientation:n,direction:r}=Qr(),o=Ad(),s=j.useCallback(i=>{const a=()=>{var g;const _=o.nextEnabled(e);_&&((g=_.node)==null||g.focus())},l=()=>{var g;const _=o.prevEnabled(e);_&&((g=_.node)==null||g.focus())},u=()=>{var g;const _=o.firstEnabled();_&&((g=_.node)==null||g.focus())},c=()=>{var g;const _=o.lastEnabled();_&&((g=_.node)==null||g.focus())},f=n==="horizontal",p=n==="vertical",h=i.key,w=r==="ltr"?"ArrowLeft":"ArrowRight",d=r==="ltr"?"ArrowRight":"ArrowLeft",m={[w]:()=>f&&l(),[d]:()=>f&&a(),ArrowDown:()=>p&&a(),ArrowUp:()=>p&&l(),Home:u,End:c}[h];m&&(i.preventDefault(),m(i))},[o,e,n,r]);return{...t,role:"tablist","aria-orientation":n,onKeyDown:Ie(t.onKeyDown,s)}}function Md(t){const{isDisabled:e=!1,isFocusable:n=!1,...r}=t,{setSelectedIndex:o,isManual:s,id:i,setFocusedIndex:a,selectedIndex:l}=Qr(),{index:u,register:c}=Fd({disabled:e&&!n}),f=u===l,p=()=>{o(u)},h=()=>{a(u),!s&&!(e&&n)&&o(u)},w=Qa({...r,ref:Be(c,t.ref),isDisabled:e,isFocusable:n,onClick:Ie(t.onClick,p)}),d="button";return{...w,id:ki(i,u),role:"tab",tabIndex:f?0:-1,type:d,"aria-selected":f,"aria-controls":Ei(i,u),onFocus:e?void 0:Ie(t.onFocus,h)}}var[zd,Ld]=et({});function Wd(t){const e=Qr(),{id:n,selectedIndex:r}=e,s=_s(t.children).map((i,a)=>j.createElement(zd,{key:a,value:{isSelected:a===r,id:Ei(n,a),tabId:ki(n,a),selectedIndex:r}},i));return{...t,children:s}}function Ud(t){const{children:e,...n}=t,{isLazy:r,lazyBehavior:o}=Qr(),{isSelected:s,id:i,tabId:a}=Ld(),l=j.useRef(!1);s&&(l.current=!0);const u=As({wasSelected:l.current,isSelected:s,enabled:r,mode:o});return{tabIndex:0,...n,children:u?e:null,role:"tabpanel","aria-labelledby":a,hidden:!s,id:i}}function ki(t,e){return`${t}--tab-${e}`}function Ei(t,e){return`${t}--tabpanel-${e}`}var[Kd,eo]=et({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),Ci=ve(function(e,n){const r=Pt("Tabs",e),{children:o,className:s,...i}=tt(e),{htmlProps:a,descendants:l,...u}=Rd(i),c=j.useMemo(()=>u,[u]),{isFitted:f,...p}=a,h={position:"relative",...r.root};return I.jsx(jd,{value:l,children:I.jsx(Td,{value:c,children:I.jsx(Kd,{value:r,children:I.jsx(pe.div,{className:Ee("chakra-tabs",s),ref:n,...p,__css:h,children:o})})})})});Ci.displayName="Tabs";var Si=ve(function(e,n){const r=Bd({...e,ref:n}),s={display:"flex",...eo().tablist};return I.jsx(pe.div,{...r,className:Ee("chakra-tabs__tablist",e.className),__css:s})});Si.displayName="TabList";var Do=ve(function(e,n){const r=Ud({...e,ref:n}),o=eo();return I.jsx(pe.div,{outline:"0",...r,className:Ee("chakra-tabs__tab-panel",e.className),__css:o.tabpanel})});Do.displayName="TabPanel";var Ii=ve(function(e,n){const r=Wd(e),o=eo();return I.jsx(pe.div,{...r,width:"100%",ref:n,className:Ee("chakra-tabs__tab-panels",e.className),__css:o.tabpanels})});Ii.displayName="TabPanels";var Po=ve(function(e,n){const r=eo(),o=Md({...e,ref:n}),s={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...r.tab};return I.jsx(pe.button,{...o,className:Ee("chakra-tabs__tab",e.className),__css:s})});Po.displayName="Tab";var[$d,Oi]=et({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),Rs=ve((t,e)=>{const n=Pt("Tag",t),r=tt(t),o={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...n.container};return I.jsx($d,{value:n,children:I.jsx(pe.span,{ref:e,...r,__css:o})})});Rs.displayName="Tag";var qd=ve((t,e)=>{const n=Oi();return I.jsx(pe.span,{ref:e,noOfLines:1,...t,__css:n.label})});qd.displayName="TagLabel";var Hd=ve((t,e)=>I.jsx(Wr,{ref:e,verticalAlign:"top",marginEnd:"0.5rem",...t}));Hd.displayName="TagLeftIcon";var Vd=ve((t,e)=>I.jsx(Wr,{ref:e,verticalAlign:"top",marginStart:"0.5rem",...t}));Vd.displayName="TagRightIcon";var Di=t=>I.jsx(Wr,{verticalAlign:"inherit",viewBox:"0 0 512 512",...t,children:I.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});Di.displayName="TagCloseIcon";var Zd=ve((t,e)=>{const{isDisabled:n,children:r,...o}=t,i={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...Oi().closeButton};return I.jsx(pe.button,{ref:e,"aria-label":"close",...o,type:"button",disabled:n,__css:i,children:r||I.jsx(Di,{})})});Zd.displayName="TagCloseButton";var Gd={exit:{scale:.85,opacity:0,transition:{opacity:{duration:.15,easings:"easeInOut"},scale:{duration:.2,easings:"easeInOut"}}},enter:{scale:1,opacity:1,transition:{opacity:{easings:"easeOut",duration:.2},scale:{duration:.2,ease:[.175,.885,.4,1.1]}}}},jo=t=>{var e;return((e=t.current)==null?void 0:e.ownerDocument)||document},ur=t=>{var e,n;return((n=(e=t.current)==null?void 0:e.ownerDocument)==null?void 0:n.defaultView)||window};function Jd(t={}){const{openDelay:e=0,closeDelay:n=0,closeOnClick:r=!0,closeOnMouseDown:o,closeOnScroll:s,closeOnPointerDown:i=o,closeOnEsc:a=!0,onOpen:l,onClose:u,placement:c,id:f,isOpen:p,defaultIsOpen:h,arrowSize:w=10,arrowShadowColor:d,arrowPadding:y,modifiers:m,isDisabled:g,gutter:_,offset:x,direction:E,...S}=t,{isOpen:k,onOpen:N,onClose:D}=js({isOpen:p,defaultIsOpen:h,onOpen:l,onClose:u}),{referenceRef:R,getPopperProps:H,getArrowInnerProps:P,getArrowProps:T}=Ps({enabled:k,placement:c,arrowPadding:y,modifiers:m,gutter:_,offset:x,direction:E}),b=j.useId(),Q=`tooltip-${f??b}`,A=j.useRef(null),te=j.useRef(),Z=j.useCallback(()=>{te.current&&(clearTimeout(te.current),te.current=void 0)},[]),re=j.useRef(),L=j.useCallback(()=>{re.current&&(clearTimeout(re.current),re.current=void 0)},[]),B=j.useCallback(()=>{L(),D()},[D,L]),U=Yd(A,B),K=j.useCallback(()=>{if(!g&&!te.current){k&&U();const de=ur(A);te.current=de.setTimeout(N,e)}},[U,g,k,N,e]),$=j.useCallback(()=>{Z();const de=ur(A);re.current=de.setTimeout(B,n)},[n,B,Z]),ie=j.useCallback(()=>{k&&r&&$()},[r,$,k]),me=j.useCallback(()=>{k&&i&&$()},[i,$,k]),se=j.useCallback(de=>{k&&de.key==="Escape"&&$()},[k,$]);en(()=>jo(A),"keydown",a?se:void 0),en(()=>{if(!s)return null;const de=A.current;if(!de)return null;const we=Ja(de);return we.localName==="body"?ur(A):we},"scroll",()=>{k&&s&&B()},{passive:!0,capture:!0}),j.useEffect(()=>{g&&(Z(),k&&D())},[g,k,D,Z]),j.useEffect(()=>()=>{Z(),L()},[Z,L]),en(()=>A.current,"pointerleave",$);const ae=j.useCallback((de={},we=null)=>({...de,ref:Be(A,we,R),onPointerEnter:Ie(de.onPointerEnter,W=>{W.pointerType!=="touch"&&K()}),onClick:Ie(de.onClick,ie),onPointerDown:Ie(de.onPointerDown,me),onFocus:Ie(de.onFocus,K),onBlur:Ie(de.onBlur,$),"aria-describedby":k?Q:void 0}),[K,$,me,k,Q,ie,R]),ye=j.useCallback((de={},we=null)=>H({...de,style:{...de.style,[je.arrowSize.var]:w?`${w}px`:void 0,[je.arrowShadowColor.var]:d}},we),[H,w,d]),he=j.useCallback((de={},we=null)=>{const v={...de.style,position:"relative",transformOrigin:je.transformOrigin.varRef};return{ref:we,...S,...de,id:Q,role:"tooltip",style:v}},[S,Q]);return{isOpen:k,show:K,hide:$,getTriggerProps:ae,getTooltipProps:he,getTooltipPositionerProps:ye,getArrowProps:T,getArrowInnerProps:P}}var uo="chakra-ui:close-tooltip";function Yd(t,e){return j.useEffect(()=>{const n=jo(t);return n.addEventListener(uo,e),()=>n.removeEventListener(uo,e)},[e,t]),()=>{const n=jo(t),r=ur(t);n.dispatchEvent(new r.CustomEvent(uo))}}function Xd(t,e=[]){const n=Object.assign({},t);for(const r of e)r in n&&delete n[r];return n}function Qd(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}var ef=pe(ps.div),zt=ve((t,e)=>{var n,r;const o=Ur("Tooltip",t),s=tt(t),i=hs(),{children:a,label:l,shouldWrapChildren:u,"aria-label":c,hasArrow:f,bg:p,portalProps:h,background:w,backgroundColor:d,bgColor:y,motionProps:m,...g}=s,_=(r=(n=w??d)!=null?n:p)!=null?r:y;if(_){o.bg=_;const H=Ml(i,"colors",_);o[je.arrowBg.var]=H}const x=Jd({...g,direction:i.direction}),E=typeof a=="string"||u;let S;if(E)S=I.jsx(pe.span,{display:"inline-block",tabIndex:0,...x.getTriggerProps(),children:a});else{const H=j.Children.only(a);S=j.cloneElement(H,x.getTriggerProps(H.props,H.ref))}const k=!!c,N=x.getTooltipProps({},e),D=k?Xd(N,["role","id"]):N,R=Qd(N,["role","id"]);return l?I.jsxs(I.Fragment,{children:[S,I.jsx(zl,{children:x.isOpen&&I.jsx(Fa,{...h,children:I.jsx(pe.div,{...x.getTooltipPositionerProps(),__css:{zIndex:o.zIndex,pointerEvents:"none"},children:I.jsxs(ef,{variants:Gd,initial:"exit",animate:"enter",exit:"exit",...m,...D,__css:o,children:[l,k&&I.jsx(pe.span,{srOnly:!0,...R,children:c}),f&&I.jsx(pe.div,{"data-popper-arrow":!0,className:"chakra-tooltip__arrow-wrapper",children:I.jsx(pe.div,{"data-popper-arrow-inner":!0,className:"chakra-tooltip__arrow",__css:{bg:o.bg}})})]})})})})]}):I.jsx(I.Fragment,{children:a})});zt.displayName="Tooltip";let Qn;const tf=new Uint8Array(16);function nf(){if(!Qn&&(Qn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Qn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Qn(tf)}const Re=[];for(let t=0;t<256;++t)Re.push((t+256).toString(16).slice(1));function rf(t,e=0){return Re[t[e+0]]+Re[t[e+1]]+Re[t[e+2]]+Re[t[e+3]]+"-"+Re[t[e+4]]+Re[t[e+5]]+"-"+Re[t[e+6]]+Re[t[e+7]]+"-"+Re[t[e+8]]+Re[t[e+9]]+"-"+Re[t[e+10]]+Re[t[e+11]]+Re[t[e+12]]+Re[t[e+13]]+Re[t[e+14]]+Re[t[e+15]]}const of=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ma={randomUUID:of};function Fn(t,e,n){if(ma.randomUUID&&!e&&!t)return ma.randomUUID();t=t||{};const r=t.random||(t.rng||nf)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let o=0;o<16;++o)e[n+o]=r[o];return e}return rf(r)}async function sf(t){console.warn("[workspace deprecated] getDB is deprecated",t);try{const e=await fetch(`/workspace/get_db?table=${t}`);return e.ok?await e.json():void 0}catch(e){console.error("Error fetching workspace:",e);return}}async function af(t,e){try{return await(await fetch("/workspace/save_db",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table:t,json:e})})).text()}catch(n){console.error("Error saving workspace:",n)}}async function lf(t,e){try{return await(await fetch("/workspace/update_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,json_str:e})})).text()}catch(n){alert("Error saving workflow .json file: "+n),console.error("Error saving workspace:",n)}}async function Pi(t,e=!1){try{return await(await fetch("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,deleteEmptyFolder:e})})).text()}catch(n){console.error("Error deleting file:",n)}}async function Ip(t){try{return await(await fetch("/workspace/get_system_dir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absolute_dir:t??""})})).json()}catch(e){console.error("Error getting workflows dir:",e)}}async function Op(){try{return await(await fetch("/workspace/open_workflow_file_browser",{method:"POST",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error open workflows folder:",t)}}async function cf(){const e=await(await fetch("/workspace/get_my_workflows_dir")).json();return e.error&&alert(`Failed to fetch my workflows path: ${e.error}`),e.path}async function Dp(){try{return await(await fetch("/model_manager/get_model_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function Pp(){try{return await(await fetch("/model_manager/get_folder_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function jp(t){try{return await(await fetch("/model_manager/cancel_installation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({save_path:t})})).text()}catch(e){console.error("Error move file:",e)}}async function Ap(t,e){try{return await(await fetch("/workspace/copy_json_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({src:t,dst:e})})).json()}catch(n){console.error("Error copy flows to new directory:",n)}}const uf="backup",Er="workspace";let er=null;function df(){return new Promise((t,e)=>{const n=indexedDB.open("WorkspaceDB",3);n.onupgradeneeded=r=>{const o=r.target.result;o.objectStoreNames.contains(Er)||o.createObjectStore(Er,{keyPath:"id"})},n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{e(r.target.error)}})}async function ff(){try{return er==null&&(er=await df()),new Promise((t,e)=>{if(er==null)return e("indexDB is null");const o=er.transaction([Er],"readonly").objectStore(Er).get(uf);o.onsuccess=()=>{o.result?t(o.result.value):t(void 0)},o.onerror=()=>e(o.error)})}catch(t){console.error("Error while reading from database:",t)}}async function hf(){try{return await ff()}catch(t){console.error("Error retrieving data from IndexedDB:",t)}}const Ce=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ae=Object.keys,ze=Array.isArray;function Ke(t,e){return typeof e!="object"||Ae(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||Ce.Promise||(Ce.Promise=Promise);const Rn=Object.getPrototypeOf,pf={}.hasOwnProperty;function Ze(t,e){return pf.call(t,e)}function un(t,e){typeof e=="function"&&(e=e(Rn(t))),(typeof Reflect>"u"?Ae:Reflect.ownKeys)(e).forEach(n=>{mt(t,n,e[n])})}const ji=Object.defineProperty;function mt(t,e,n,r){ji(t,e,Ke(n&&Ze(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function nn(t){return{from:function(e){return t.prototype=Object.create(e.prototype),mt(t.prototype,"constructor",t),{extend:un.bind(null,t.prototype)}}}}const mf=Object.getOwnPropertyDescriptor;function Ts(t,e){let n;return mf(t,e)||(n=Rn(t))&&Ts(n,e)}const yf=[].slice;function Cr(t,e,n){return yf.call(t,e,n)}function Ai(t,e){return e(t)}function bn(t){if(!t)throw new Error("Assertion Failed")}function Ni(t){Ce.setImmediate?setImmediate(t):setTimeout(t,0)}function Fi(t,e){return t.reduce((n,r,o)=>{var s=e(r,o);return s&&(n[s[0]]=s[1]),n},{})}function yt(t,e){if(Ze(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,o=e.length;r<o;++r){var s=yt(t,e[r]);n.push(s)}return n}var i=e.indexOf(".");if(i!==-1){var a=t[e.substr(0,i)];return a===void 0?void 0:yt(a,e.substr(i+1))}}function nt(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){bn(typeof n!="string"&&"length"in n);for(var r=0,o=e.length;r<o;++r)nt(t,e[r],n[r])}else{var s=e.indexOf(".");if(s!==-1){var i=e.substr(0,s),a=e.substr(s+1);if(a==="")n===void 0?ze(t)&&!isNaN(parseInt(i))?t.splice(i,1):delete t[i]:t[i]=n;else{var l=t[i];l&&Ze(t,i)||(l=t[i]={}),nt(l,a,n)}}else n===void 0?ze(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Ri(t){var e={};for(var n in t)Ze(t,n)&&(e[n]=t[n]);return e}const vf=[].concat;function Ti(t){return vf.apply([],t)}const Bi="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ti([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>Ce[t]),gf=Bi.map(t=>Ce[t]);Fi(Bi,t=>[t,!0]);let xt=null;function Hn(t){xt=typeof WeakMap<"u"&&new WeakMap;const e=Ao(t);return xt=null,e}function Ao(t){if(!t||typeof t!="object")return t;let e=xt&&xt.get(t);if(e)return e;if(ze(t)){e=[],xt&&xt.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Ao(t[n]))}else if(gf.indexOf(t.constructor)>=0)e=t;else{const s=Rn(t);for(var o in e=s===Object.prototype?{}:Object.create(s),xt&&xt.set(t,e),t)Ze(t,o)&&(e[o]=Ao(t[o]))}return e}const{toString:wf}={};function No(t){return wf.call(t).slice(8,-1)}const Fo=typeof Symbol<"u"?Symbol.iterator:"@@iterator",bf=typeof Fo=="symbol"?function(t){var e;return t!=null&&(e=t[Fo])&&e.apply(t)}:function(){return null},Qt={};function ft(t){var e,n,r,o;if(arguments.length===1){if(ze(t))return t.slice();if(this===Qt&&typeof t=="string")return[t];if(o=bf(t)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const Bs=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var lt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Mi(t,e){lt=t,zi=e}var zi=()=>!0;const _f=!new Error("").stack;function Vt(){if(_f)try{throw Vt.arguments,new Error}catch(t){return t}return new Error}function Ro(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(zi).map(r=>`
`+r).join("")):""}var Li=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ms=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Li),xf={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function rn(t,e){this._e=Vt(),this.name=t,this.message=e}function Wi(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,o)=>o.indexOf(n)===r).join(`
`)}function Sr(t,e,n,r){this._e=Vt(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Wi(t,e)}function Sn(t,e){this._e=Vt(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Wi(t,e)}nn(rn).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Ro(this._e,2))}},toString:function(){return this.name+": "+this.message}}),nn(Sr).from(rn),nn(Sn).from(rn);var zs=Ms.reduce((t,e)=>(t[e]=e+"Error",t),{});const kf=rn;var ue=Ms.reduce((t,e)=>{var n=e+"Error";function r(o,s){this._e=Vt(),this.name=n,o?typeof o=="string"?(this.message=`${o}${s?`
 `+s:""}`,this.inner=s||null):typeof o=="object"&&(this.message=`${o.name} ${o.message}`,this.inner=o):(this.message=xf[e]||n,this.inner=null)}return nn(r).from(kf),t[e]=r,t},{});ue.Syntax=SyntaxError,ue.Type=TypeError,ue.Range=RangeError;var ya=Li.reduce((t,e)=>(t[e+"Error"]=ue[e],t),{}),dr=Ms.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=ue[e]),t),{});function ke(){}function Tn(t){return t}function Ef(t,e){return t==null||t===Tn?e:function(n){return e(t(n))}}function qt(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Cf(t,e){return t===ke?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?qt(r,this.onsuccess):r),o&&(this.onerror=this.onerror?qt(o,this.onerror):o),s!==void 0?s:n}}function Sf(t,e){return t===ke?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?qt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?qt(r,this.onerror):r)}}function If(t,e){return t===ke?e:function(n){var r=t.apply(this,arguments);Ke(n,r);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?qt(o,this.onsuccess):o),s&&(this.onerror=this.onerror?qt(s,this.onerror):s),r===void 0?i===void 0?void 0:i:Ke(r,i)}}function Of(t,e){return t===ke?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function Ls(t,e){return t===ke?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return n.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}dr.ModifyError=Sr,dr.DexieError=rn,dr.BulkError=Sn;var Bn={};const Ui=100,[To,Ir,Bo]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,Rn(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Rn(e),t]})(),Ki=Ir&&Ir.then,fr=To&&To.constructor,Ws=!!Bo;var Mo=!1,Df=Bo?()=>{Bo.then(tr)}:Ce.setImmediate?setImmediate.bind(null,tr):Ce.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{tr(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(tr,0)},In=function(t,e){_n.push([t,e]),Or&&(Df(),Or=!1)},zo=!0,Or=!0,Lt=[],hr=[],Lo=null,Wo=Tn,on={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:wa,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{wa(t[0],t[1])}catch{}})}},ce=on,_n=[],Wt=0,pr=[];function oe(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ke,this._lib=!1;var e=this._PSD=ce;if(lt&&(this._stackHolder=Vt(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Bn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ko(this,this._value))}this._state=null,this._value=null,++e.ref,qi(this,t)}const Uo={get:function(){var t=ce,e=Dr;function n(r,o){var s=!t.global&&(t!==ce||e!==Dr);const i=s&&!gt();var a=new oe((l,u)=>{Us(this,new $i(Pr(r,t,s,i),Pr(o,t,s,i),l,u,t))});return lt&&Zi(a,this),a}return n.prototype=Bn,n},set:function(t){mt(this,"then",t&&t.prototype===Bn?Uo:{get:function(){return t},set:Uo.set})}};function $i(t,e,n,r,o){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=o}function qi(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Vn();n&&typeof n.then=="function"?qi(t,(o,s)=>{n instanceof oe?n._then(o,s):n.then(o,s)}):(t._state=!0,t._value=n,Hi(t)),r&&Zn()}},Ko.bind(null,t))}catch(n){Ko(t,n)}}function Ko(t,e){if(hr.push(e),t._state===null){var n=t._lib&&Vn();e=Wo(e),t._state=!1,t._value=e,lt&&e!==null&&typeof e=="object"&&!e._promise&&function(r,o,s){try{r.apply(null,s)}catch(i){o&&o(i)}}(()=>{var r=Ts(e,"stack");e._promise=t,mt(e,"stack",{get:()=>Mo?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){Lt.some(o=>o._value===r._value)||Lt.push(r)}(t),Hi(t),n&&Zn()}}function Hi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Us(t,e[n]);var o=t._PSD;--o.ref||o.finalize(),Wt===0&&(++Wt,In(()=>{--Wt==0&&Ks()},[]))}function Us(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Wt,In(Pf,[n,t,e])}else t._listeners.push(e)}function Pf(t,e,n){try{Lo=e;var r,o=e._value;e._state?r=t(o):(hr.length&&(hr=[]),r=t(o),hr.indexOf(o)===-1&&function(s){for(var i=Lt.length;i;)if(Lt[--i]._value===s._value)return void Lt.splice(i,1)}(e)),n.resolve(r)}catch(s){n.reject(s)}finally{Lo=null,--Wt==0&&Ks(),--n.psd.ref||n.psd.finalize()}}function Vi(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var o,s,i=t._value;i!=null?(o=i.name||"Error",s=i.message||i,r=Ro(i,0)):(o=i,s=""),e.push(o+(s?": "+s:"")+r)}return lt&&((r=Ro(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&Vi(t._prev,e,n)),e}function Zi(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function tr(){Vn()&&Zn()}function Vn(){var t=zo;return zo=!1,Or=!1,t}function Zn(){var t,e,n;do for(;_n.length>0;)for(t=_n,_n=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(_n.length>0);zo=!0,Or=!0}function Ks(){var t=Lt;Lt=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=pr.slice(0),n=e.length;n;)e[--n]()}function nr(t){return new oe(Bn,!1,t)}function Se(t,e){var n=ce;return function(){var r=Vn(),o=ce;try{return It(n,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{It(o,!1),r&&Zn()}}}un(oe.prototype,{then:Uo,_then:function(t,e){Us(this,new $i(null,null,t,e,ce))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):nr(r)):this.then(null,r=>r&&r.name===e?n(r):nr(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),nr(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Mo=!0;var t=Vi(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Mo=!1}}},timeout:function(t,e){return t<1/0?new oe((n,r)=>{var o=setTimeout(()=>r(new ue.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&mt(oe.prototype,Symbol.toStringTag,"Dexie.Promise"),on.env=Gi(),un(oe,{all:function(){var t=ft.apply(null,arguments).map(rr);return new oe(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((o,s)=>oe.resolve(o).then(i=>{t[s]=i,--r||e(t)},n))})},resolve:t=>{if(t instanceof oe)return t;if(t&&typeof t.then=="function")return new oe((n,r)=>{t.then(n,r)});var e=new oe(Bn,!0,t);return Zi(e,Lo),e},reject:nr,race:function(){var t=ft.apply(null,arguments).map(rr);return new oe((e,n)=>{t.map(r=>oe.resolve(r).then(e,n))})},PSD:{get:()=>ce,set:t=>ce=t},totalEchoes:{get:()=>Dr},newPSD:St,usePSD:pn,scheduler:{get:()=>In,set:t=>{In=t}},rejectionMapper:{get:()=>Wo,set:t=>{Wo=t}},follow:(t,e)=>new oe((n,r)=>St((o,s)=>{var i=ce;i.unhandleds=[],i.onunhandled=s,i.finalize=qt(function(){(function(a){function l(){a(),pr.splice(pr.indexOf(l),1)}pr.push(l),++Wt,In(()=>{--Wt==0&&Ks()},[])})(()=>{this.unhandleds.length===0?o():s(this.unhandleds[0])})},i.finalize),t()},e,n,r))}),fr&&(fr.allSettled&&mt(oe,"allSettled",function(){const t=ft.apply(null,arguments).map(rr);return new oe(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((o,s)=>oe.resolve(o).then(i=>r[s]={status:"fulfilled",value:i},i=>r[s]={status:"rejected",reason:i}).then(()=>--n||e(r)))})}),fr.any&&typeof AggregateError<"u"&&mt(oe,"any",function(){const t=ft.apply(null,arguments).map(rr);return new oe((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const o=new Array(r);t.forEach((s,i)=>oe.resolve(s).then(a=>e(a),a=>{o[i]=a,--r||n(new AggregateError(o))}))})}));const Me={awaits:0,echoes:0,id:0};var jf=0,mr=[],fo=0,Dr=0,Af=0;function St(t,e,n,r){var o=ce,s=Object.create(o);s.parent=o,s.ref=0,s.global=!1,s.id=++Af;var i=on.env;s.env=Ws?{Promise:oe,PromiseProp:{value:oe,configurable:!0,writable:!0},all:oe.all,race:oe.race,allSettled:oe.allSettled,any:oe.any,resolve:oe.resolve,reject:oe.reject,nthen:va(i.nthen,s),gthen:va(i.gthen,s)}:{},e&&Ke(s,e),++o.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=pn(s,t,n,r);return s.ref===0&&s.finalize(),a}function hn(){return Me.id||(Me.id=++jf),++Me.awaits,Me.echoes+=Ui,Me.id}function gt(){return!!Me.awaits&&(--Me.awaits==0&&(Me.id=0),Me.echoes=Me.awaits*Ui,!0)}function rr(t){return Me.echoes&&t&&t.constructor===fr?(hn(),t.then(e=>(gt(),e),e=>(gt(),Ne(e)))):t}function Nf(t){++Dr,Me.echoes&&--Me.echoes!=0||(Me.echoes=Me.id=0),mr.push(ce),It(t,!0)}function Ff(){var t=mr[mr.length-1];mr.pop(),It(t,!1)}function It(t,e){var n=ce;if((e?!Me.echoes||fo++&&t===ce:!fo||--fo&&t===ce)||Ji(e?Nf.bind(null,t):Ff),t!==ce&&(ce=t,n===on&&(on.env=Gi()),Ws)){var r=on.env.Promise,o=t.env;Ir.then=o.nthen,r.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(Ce,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function Gi(){var t=Ce.Promise;return Ws?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(Ce,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Ir.then,gthen:t.prototype.then}:{}}function pn(t,e,n,r,o){var s=ce;try{return It(t,!0),e(n,r,o)}finally{It(s,!1)}}function Ji(t){Ki.call(To,t)}function Pr(t,e,n,r){return typeof t!="function"?t:function(){var o=ce;n&&hn(),It(e,!0);try{return t.apply(this,arguments)}finally{It(o,!1),r&&Ji(gt)}}}function va(t,e){return function(n,r){return t.call(this,Pr(n,e),Pr(r,e))}}(""+Ki).indexOf("[native code]")===-1&&(hn=gt=ke);const ga="unhandledrejection";function wa(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,o={promise:e,reason:t};if(Ce.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(ga,!0,!0),Ke(r,o)):Ce.CustomEvent&&Ke(r=new CustomEvent(ga,{detail:o}),o),r&&Ce.dispatchEvent&&(dispatchEvent(r),!Ce.PromiseRejectionEvent&&Ce.onunhandledrejection))try{Ce.onunhandledrejection(r)}catch{}lt&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var Ne=oe.reject;function $o(t,e,n,r){if(t.idbdb&&(t._state.openComplete||ce.letThrough||t._vip)){var o=t._createTransaction(e,n,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===zs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>$o(t,e,n,r))):Ne(s)}return o._promise(e,(s,i)=>St(()=>(ce.trans=o,r(s,i,o)))).then(s=>o._completion.then(()=>s))}if(t._state.openComplete)return Ne(new ue.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Ne(new ue.DatabaseClosed);t.open().catch(ke)}return t._state.dbReadyPromise.then(()=>$o(t,e,n,r))}const ba="3.2.4",Rt="￿",qo=-1/0,ut="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Yi="String expected.",On=[],to=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Rf=to,Tf=to,Xi=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),no="__dbnames",ho="readonly",po="readwrite";function Ht(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const Qi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function or(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=Hn(e))[t],e)}class Bf{_trans(e,n,r){const o=this._tx||ce.trans,s=this.name;function i(l,u,c){if(!c.schema[s])throw new ue.NotFound("Table "+s+" not part of transaction");return n(c.idbtrans,c)}const a=Vn();try{return o&&o.db===this.db?o===ce.trans?o._promise(e,i,r):St(()=>o._promise(e,i,r),{trans:o,transless:ce.transless||ce}):$o(this.db,e,[this.name],i)}finally{a&&Zn()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(o=>this.hook.reading.fire(o))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(ze(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=Ae(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(u=>u.compound&&n.every(c=>u.keyPath.indexOf(c)>=0)&&u.keyPath.every(c=>n.indexOf(c)>=0))[0];if(r&&this.db._maxKey!==Rt)return this.where(r.name).equals(r.keyPath.map(u=>e[u]));!r&&lt&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:o}=this.schema,s=this.db._deps.indexedDB;function i(u,c){try{return s.cmp(u,c)===0}catch{return!1}}const[a,l]=n.reduce(([u,c],f)=>{const p=o[f],h=e[f];return[u||p,u||!p?Ht(c,p&&p.multi?w=>{const d=yt(w,f);return ze(d)&&d.some(y=>i(h,y))}:w=>i(h,yt(w,f))):c]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,ze(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=r=>{if(!r)return r;const o=Object.create(e.prototype);for(var s in r)if(Ze(r,s))try{o[s]=r[s]}catch{}return o};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){Ke(this,e)})}add(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=or(o)(e)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"add",keys:n!=null?[n]:null,values:[s]})).then(i=>i.numFailures?oe.reject(i.failures[0]):i.lastResult).then(i=>{if(o)try{nt(e,o,i)}catch{}return i})}update(e,n){if(typeof e!="object"||ze(e))return this.where(":id").equals(e).modify(n);{const r=yt(e,this.schema.primKey.keyPath);if(r===void 0)return Ne(new ue.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?Ae(n).forEach(o=>{nt(e,o,n[o])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=or(o)(e)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"put",values:[s],keys:n!=null?[n]:null})).then(i=>i.numFailures?oe.reject(i.failures[0]):i.lastResult).then(i=>{if(o)try{nt(e,o,i)}catch{}return i})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?oe.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Qi})).then(e=>e.numFailures?oe.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(o=>this.hook.reading.fire(o))))}bulkAdd(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&o)throw new ue.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new ue.InvalidArgument("Arguments objects and keys must have the same length");const u=e.length;let c=l&&a?e.map(or(l)):e;return this.core.mutate({trans:i,type:"add",keys:o,values:c,wantResults:s}).then(({numFailures:f,results:p,lastResult:h,failures:w})=>{if(f===0)return s?p:h;throw new Sn(`${this.name}.bulkAdd(): ${f} of ${u} operations failed`,w)})})}bulkPut(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&o)throw new ue.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new ue.InvalidArgument("Arguments objects and keys must have the same length");const u=e.length;let c=l&&a?e.map(or(l)):e;return this.core.mutate({trans:i,type:"put",keys:o,values:c,wantResults:s}).then(({numFailures:f,results:p,lastResult:h,failures:w})=>{if(f===0)return s?p:h;throw new Sn(`${this.name}.bulkPut(): ${f} of ${u} operations failed`,w)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:o,failures:s})=>{if(r===0)return o;throw new Sn(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,s)})}}function Dn(t){var e={},n=function(i,a){if(a){for(var l=arguments.length,u=new Array(l-1);--l;)u[l-1]=arguments[l];return e[i].subscribe.apply(null,u),t}if(typeof i=="string")return e[i]};n.addEventType=s;for(var r=1,o=arguments.length;r<o;++r)s(arguments[r]);return n;function s(i,a,l){if(typeof i!="object"){var u;a||(a=Of),l||(l=ke);var c={subscribers:[],fire:l,subscribe:function(f){c.subscribers.indexOf(f)===-1&&(c.subscribers.push(f),c.fire=a(c.fire,f))},unsubscribe:function(f){c.subscribers=c.subscribers.filter(function(p){return p!==f}),c.fire=c.subscribers.reduce(a,l)}};return e[i]=n[i]=c,c}Ae(u=i).forEach(function(f){var p=u[f];if(ze(p))s(f,u[f][0],u[f][1]);else{if(p!=="asap")throw new ue.InvalidArgument("Invalid event config");var h=s(f,Tn,function(){for(var w=arguments.length,d=new Array(w);w--;)d[w]=arguments[w];h.subscribers.forEach(function(y){Ni(function(){y.apply(null,d)})})})}})}}function wn(t,e){return nn(e).from({prototype:t}),e}function Yt(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function mo(t,e){t.filter=Ht(t.filter,e)}function yo(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>Ht(r(),e()):e,t.justLimit=n&&!r}function yr(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new ue.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function _a(t,e,n){const r=yr(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function sr(t,e,n,r){const o=t.replayFilter?Ht(t.filter,t.replayFilter()):t.filter;if(t.or){const s={},i=(a,l,u)=>{if(!o||o(l,u,p=>l.stop(p),p=>l.fail(p))){var c=l.primaryKey,f=""+c;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(c)),Ze(s,f)||(s[f]=!0,e(a,l,u))}};return Promise.all([t.or._iterate(i,n),xa(_a(t,r,n),t.algorithm,i,!t.keysOnly&&t.valueMapper)])}return xa(_a(t,r,n),Ht(t.algorithm,o),e,!t.keysOnly&&t.valueMapper)}function xa(t,e,n,r){var o=Se(r?(s,i,a)=>n(r(s),i,a):n);return t.then(s=>{if(s)return s.start(()=>{var i=()=>s.continue();e&&!e(s,a=>i=a,a=>{s.stop(a),i=ke},a=>{s.fail(a),i=ke})||o(s.value,s,a=>i=a),i()})})}function We(t,e){try{const n=ka(t),r=ka(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(o,s){const i=o.length,a=s.length,l=i<a?i:a;for(let u=0;u<l;++u)if(o[u]!==s[u])return o[u]<s[u]?-1:1;return i===a?0:i<a?-1:1}(Ea(t),Ea(e));case"Array":return function(o,s){const i=o.length,a=s.length,l=i<a?i:a;for(let u=0;u<l;++u){const c=We(o[u],s[u]);if(c!==0)return c}return i===a?0:i<a?-1:1}(t,e)}}catch{}return NaN}function ka(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=No(t);return n==="ArrayBuffer"?"binary":n}function Ea(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class Mf{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,Ne.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,Ne.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=Ht(n.algorithm,e)}_iterate(e,n){return sr(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Ke(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>sr(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,o=r.table.core;if(Yt(r,!0))return o.count({trans:n,query:{index:yr(r,o.schema),range:r.range}}).then(i=>Math.min(i,r.limit));var s=0;return sr(r,()=>(++s,!1),n,o).then(()=>s)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),o=r[0],s=r.length-1;function i(u,c){return c?i(u[r[c]],c-1):u[o]}var a=this._ctx.dir==="next"?1:-1;function l(u,c){var f=i(u,s),p=i(c,s);return f<p?-a:f>p?a:0}return this.toArray(function(u){return u.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&Yt(r,!0)&&r.limit>0){const{valueMapper:o}=r,s=yr(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:s,range:r.range}}).then(({result:i})=>o?i.map(o):i)}{const o=[];return sr(r,s=>o.push(s),n,r.table.core).then(()=>o)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,Yt(n)?yo(n,()=>{var r=e;return(o,s)=>r===0||(r===1?(--r,!1):(s(()=>{o.advance(r),r=0}),!1))}):yo(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),yo(this._ctx,()=>{var n=e;return function(r,o,s){return--n<=0&&o(s),n>=0}},!0),this}until(e,n){return mo(this._ctx,function(r,o,s){return!e(r.value)||(o(s),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return mo(this._ctx,function(o){return e(o.value)}),n=this._ctx,r=e,n.isMatch=Ht(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.key,o)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.primaryKey,o)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&Yt(n,!0)&&n.limit>0)return this._read(o=>{var s=yr(n,n.table.core.schema);return n.table.core.query({trans:o,values:!1,limit:n.limit,query:{index:s,range:n.range}})}).then(({result:o})=>o).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return mo(this._ctx,function(o){var s=o.primaryKey.toString(),i=Ze(r,s);return r[s]=!0,!i}),this}modify(e){var n=this._ctx;return this._write(r=>{var o;if(typeof e=="function")o=e;else{var s=Ae(e),i=s.length;o=function(d){for(var y=!1,m=0;m<i;++m){var g=s[m],_=e[g];yt(d,g)!==_&&(nt(d,g,_),y=!0)}return y}}const a=n.table.core,{outbound:l,extractKey:u}=a.schema.primaryKey,c=this.db._options.modifyChunkSize||200,f=[];let p=0;const h=[],w=(d,y)=>{const{failures:m,numFailures:g}=y;p+=d-g;for(let _ of Ae(m))f.push(m[_])};return this.clone().primaryKeys().then(d=>{const y=m=>{const g=Math.min(c,d.length-m);return a.getMany({trans:r,keys:d.slice(m,m+g),cache:"immutable"}).then(_=>{const x=[],E=[],S=l?[]:null,k=[];for(let D=0;D<g;++D){const R=_[D],H={value:Hn(R),primKey:d[m+D]};o.call(H,H.value,H)!==!1&&(H.value==null?k.push(d[m+D]):l||We(u(R),u(H.value))===0?(E.push(H.value),l&&S.push(d[m+D])):(k.push(d[m+D]),x.push(H.value)))}const N=Yt(n)&&n.limit===1/0&&(typeof e!="function"||e===vo)&&{index:n.index,range:n.range};return Promise.resolve(x.length>0&&a.mutate({trans:r,type:"add",values:x}).then(D=>{for(let R in D.failures)k.splice(parseInt(R),1);w(x.length,D)})).then(()=>(E.length>0||N&&typeof e=="object")&&a.mutate({trans:r,type:"put",keys:S,values:E,criteria:N,changeSpec:typeof e!="function"&&e}).then(D=>w(E.length,D))).then(()=>(k.length>0||N&&e===vo)&&a.mutate({trans:r,type:"delete",keys:k,criteria:N}).then(D=>w(k.length,D))).then(()=>d.length>m+g&&y(m+c))})};return y(0).then(()=>{if(f.length>0)throw new Sr("Error modifying one or more objects",f,p,h);return d.length})})})}delete(){var e=this._ctx,n=e.range;return Yt(e)&&(e.isPrimKey&&!Tf||n.type===3)?this._write(r=>{const{primaryKey:o}=e.table.core.schema,s=n;return e.table.core.count({trans:r,query:{index:o,range:s}}).then(i=>e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(({failures:a,lastResult:l,results:u,numFailures:c})=>{if(c)throw new Sr("Could not delete some values",Object.keys(a).map(f=>a[f]),i-c);return i-c}))}):this.modify(vo)}}const vo=(t,e)=>e.value=null;function zf(t,e){return t<e?-1:t===e?0:1}function Lf(t,e){return t>e?-1:t===e?0:1}function He(t,e,n){var r=t instanceof tl?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function Xt(t){return new t.Collection(t,()=>el("")).limit(0)}function Wf(t,e,n,r,o,s){for(var i=Math.min(t.length,r.length),a=-1,l=0;l<i;++l){var u=e[l];if(u!==r[l])return o(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):o(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;o(t[l],u)<0&&(a=l)}return i<r.length&&s==="next"?t+n.substr(t.length):i<t.length&&s==="prev"?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function ar(t,e,n,r){var o,s,i,a,l,u,c,f=n.length;if(!n.every(d=>typeof d=="string"))return He(t,Yi);function p(d){o=function(m){return m==="next"?g=>g.toUpperCase():g=>g.toLowerCase()}(d),s=function(m){return m==="next"?g=>g.toLowerCase():g=>g.toUpperCase()}(d),i=d==="next"?zf:Lf;var y=n.map(function(m){return{lower:s(m),upper:o(m)}}).sort(function(m,g){return i(m.lower,g.lower)});a=y.map(function(m){return m.upper}),l=y.map(function(m){return m.lower}),u=d,c=d==="next"?"":r}p("next");var h=new t.Collection(t,()=>_t(a[0],l[f-1]+r));h._ondirectionchange=function(d){p(d)};var w=0;return h._addAlgorithm(function(d,y,m){var g=d.key;if(typeof g!="string")return!1;var _=s(g);if(e(_,l,w))return!0;for(var x=null,E=w;E<f;++E){var S=Wf(g,_,a[E],l[E],i,u);S===null&&x===null?w=E+1:(x===null||i(x,S)>0)&&(x=S)}return y(x!==null?function(){d.continue(x+c)}:m),!1}),h}function _t(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function el(t){return{type:1,lower:t,upper:t}}class tl{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,o){r=r!==!1,o=o===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||o)&&(!r||!o)?Xt(this):new this.Collection(this,()=>_t(e,n,!r,!o))}catch{return He(this,ut)}}equals(e){return e==null?He(this,ut):new this.Collection(this,()=>el(e))}above(e){return e==null?He(this,ut):new this.Collection(this,()=>_t(e,void 0,!0))}aboveOrEqual(e){return e==null?He(this,ut):new this.Collection(this,()=>_t(e,void 0,!1))}below(e){return e==null?He(this,ut):new this.Collection(this,()=>_t(void 0,e,!1,!0))}belowOrEqual(e){return e==null?He(this,ut):new this.Collection(this,()=>_t(void 0,e))}startsWith(e){return typeof e!="string"?He(this,Yi):this.between(e,e+Rt,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):ar(this,(n,r)=>n.indexOf(r[0])===0,[e],Rt)}equalsIgnoreCase(e){return ar(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=ft.apply(Qt,arguments);return e.length===0?Xt(this):ar(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=ft.apply(Qt,arguments);return e.length===0?Xt(this):ar(this,(n,r)=>r.some(o=>n.indexOf(o)===0),e,Rt)}anyOf(){const e=ft.apply(Qt,arguments);let n=this._cmp;try{e.sort(n)}catch{return He(this,ut)}if(e.length===0)return Xt(this);const r=new this.Collection(this,()=>_t(e[0],e[e.length-1]));r._ondirectionchange=s=>{n=s==="next"?this._ascending:this._descending,e.sort(n)};let o=0;return r._addAlgorithm((s,i,a)=>{const l=s.key;for(;n(l,e[o])>0;)if(++o,o===e.length)return i(a),!1;return n(l,e[o])===0||(i(()=>{s.continue(e[o])}),!1)}),r}notEqual(e){return this.inAnyRange([[qo,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=ft.apply(Qt,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return He(this,ut)}const n=e.reduce((r,o)=>r?r.concat([[r[r.length-1][1],o]]):[[qo,o]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,o=this._ascending,s=this._descending,i=this._min,a=this._max;if(e.length===0)return Xt(this);if(!e.every(g=>g[0]!==void 0&&g[1]!==void 0&&o(g[0],g[1])<=0))return He(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ue.InvalidArgument);const l=!n||n.includeLowers!==!1,u=n&&n.includeUppers===!0;let c,f=o;function p(g,_){return f(g[0],_[0])}try{c=e.reduce(function(g,_){let x=0,E=g.length;for(;x<E;++x){const S=g[x];if(r(_[0],S[1])<0&&r(_[1],S[0])>0){S[0]=i(S[0],_[0]),S[1]=a(S[1],_[1]);break}}return x===E&&g.push(_),g},[]),c.sort(p)}catch{return He(this,ut)}let h=0;const w=u?g=>o(g,c[h][1])>0:g=>o(g,c[h][1])>=0,d=l?g=>s(g,c[h][0])>0:g=>s(g,c[h][0])>=0;let y=w;const m=new this.Collection(this,()=>_t(c[0][0],c[c.length-1][1],!l,!u));return m._ondirectionchange=g=>{g==="next"?(y=w,f=o):(y=d,f=s),c.sort(p)},m._addAlgorithm((g,_,x)=>{for(var E=g.key;y(E);)if(++h,h===c.length)return _(x),!1;return!!function(S){return!w(S)&&!d(S)}(E)||(this._cmp(E,c[h][1])===0||this._cmp(E,c[h][0])===0||_(()=>{f===o?g.continue(c[h][0]):g.continue(c[h][1])}),!1)}),m}startsWithAnyOf(){const e=ft.apply(Qt,arguments);return e.every(n=>typeof n=="string")?e.length===0?Xt(this):this.inAnyRange(e.map(n=>[n,n+Rt])):He(this,"startsWithAnyOf() only works with strings")}}function st(t){return Se(function(e){return Mn(e),t(e.target.error),!1})}function Mn(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const zn="storagemutated",kt="x-storagemutated-1",Ot=Dn(null,zn);class Uf{_lock(){return bn(!ce.global),++this._reculock,this._reculock!==1||ce.global||(ce.lockOwnerFor=this),this}_unlock(){if(bn(!ce.global),--this._reculock==0)for(ce.global||(ce.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{pn(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&ce.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(bn(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new ue.DatabaseClosed(r);case"MissingAPIError":throw new ue.MissingAPI(r.message,r);default:throw new ue.OpenFailed(r)}if(!this.active)throw new ue.TransactionInactive;return bn(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Se(o=>{Mn(o),this._reject(e.error)}),e.onabort=Se(o=>{Mn(o),this.active&&this._reject(new ue.Abort(e.error)),this.active=!1,this.on("abort").fire(o)}),e.oncomplete=Se(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Ot.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return Ne(new ue.ReadOnly("Transaction is readonly"));if(!this.active)return Ne(new ue.TransactionInactive);if(this._locked())return new oe((s,i)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(s,i)},ce])});if(r)return St(()=>{var s=new oe((i,a)=>{this._lock();const l=n(i,a,this);l&&l.then&&l.then(i,a)});return s.finally(()=>this._unlock()),s._lib=!0,s});var o=new oe((s,i)=>{var a=n(s,i,this);a&&a.then&&a.then(s,i)});return o._lib=!0,o}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=oe.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var o=n.idbtrans.objectStore(n.storeNames[0]);(function i(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(o.get(-1/0).onsuccess=i)})()}var s=n._waitingFor;return new oe((i,a)=>{r.then(l=>n._waitingQueue.push(Se(i.bind(null,l))),l=>n._waitingQueue.push(Se(a.bind(null,l)))).finally(()=>{n._waitingFor===s&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ue.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(Ze(n,e))return n[e];const r=this.schema[e];if(!r)throw new ue.NotFound("Table "+e+" not part of transaction");const o=new this.db.Table(e,r,this);return o.core=this.db.core.table(e),n[e]=o,o}}function Ho(t,e,n,r,o,s,i){return{name:t,keyPath:e,unique:n,multi:r,auto:o,compound:s,src:(n&&!i?"&":"")+(r?"*":"")+(o?"++":"")+nl(e)}}function nl(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function rl(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Fi(n,r=>[r.name,r])}}let Ln=t=>{try{return t.only([[]]),Ln=()=>[[]],[[]]}catch{return Ln=()=>Rt,Rt}};function Vo(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?r=>r[e]:r=>yt(r,e)}(t):e=>yt(e,t)}function Ca(t){return[].slice.call(t)}let Kf=0;function Pn(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function $f(t,e,n){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:c,lowerOpen:f,upperOpen:p}=l;return u===void 0?c===void 0?null:e.upperBound(c,!!p):c===void 0?e.lowerBound(u,!!f):e.bound(u,c,!!f,!!p)}const{schema:o,hasGetAll:s}=function(l,u){const c=Ca(l.objectStoreNames);return{schema:{name:l.name,tables:c.map(f=>u.objectStore(f)).map(f=>{const{keyPath:p,autoIncrement:h}=f,w=ze(p),d=p==null,y={},m={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:d,compound:w,keyPath:p,autoIncrement:h,unique:!0,extractKey:Vo(p)},indexes:Ca(f.indexNames).map(g=>f.index(g)).map(g=>{const{name:_,unique:x,multiEntry:E,keyPath:S}=g,k={name:_,compound:ze(S),keyPath:S,unique:x,multiEntry:E,extractKey:Vo(S)};return y[Pn(S)]=k,k}),getIndexByKeyPath:g=>y[Pn(g)]};return y[":id"]=m.primaryKey,p!=null&&(y[Pn(p)]=m.primaryKey),m})},hasGetAll:c.length>0&&"getAll"in u.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),i=o.tables.map(l=>function(u){const c=u.name;return{name:c,schema:u,mutate:function({trans:f,type:p,keys:h,values:w,range:d}){return new Promise((y,m)=>{y=Se(y);const g=f.objectStore(c),_=g.keyPath==null,x=p==="put"||p==="add";if(!x&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:E}=h||w||{length:1};if(h&&w&&h.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(E===0)return y({numFailures:0,failures:{},results:[],lastResult:void 0});let S;const k=[],N=[];let D=0;const R=P=>{++D,Mn(P)};if(p==="deleteRange"){if(d.type===4)return y({numFailures:D,failures:N,results:[],lastResult:void 0});d.type===3?k.push(S=g.clear()):k.push(S=g.delete(r(d)))}else{const[P,T]=x?_?[w,h]:[w,null]:[h,null];if(x)for(let b=0;b<E;++b)k.push(S=T&&T[b]!==void 0?g[p](P[b],T[b]):g[p](P[b])),S.onerror=R;else for(let b=0;b<E;++b)k.push(S=g[p](P[b])),S.onerror=R}const H=P=>{const T=P.target.result;k.forEach((b,q)=>b.error!=null&&(N[q]=b.error)),y({numFailures:D,failures:N,results:p==="delete"?h:k.map(b=>b.result),lastResult:T})};S.onerror=P=>{R(P),H(P)},S.onsuccess=H})},getMany:({trans:f,keys:p})=>new Promise((h,w)=>{h=Se(h);const d=f.objectStore(c),y=p.length,m=new Array(y);let g,_=0,x=0;const E=k=>{const N=k.target;m[N._pos]=N.result,++x===_&&h(m)},S=st(w);for(let k=0;k<y;++k)p[k]!=null&&(g=d.get(p[k]),g._pos=k,g.onsuccess=E,g.onerror=S,++_);_===0&&h(m)}),get:({trans:f,key:p})=>new Promise((h,w)=>{h=Se(h);const d=f.objectStore(c).get(p);d.onsuccess=y=>h(y.target.result),d.onerror=st(w)}),query:function(f){return p=>new Promise((h,w)=>{h=Se(h);const{trans:d,values:y,limit:m,query:g}=p,_=m===1/0?void 0:m,{index:x,range:E}=g,S=d.objectStore(c),k=x.isPrimaryKey?S:S.index(x.name),N=r(E);if(m===0)return h({result:[]});if(f){const D=y?k.getAll(N,_):k.getAllKeys(N,_);D.onsuccess=R=>h({result:R.target.result}),D.onerror=st(w)}else{let D=0;const R=y||!("openKeyCursor"in k)?k.openCursor(N):k.openKeyCursor(N),H=[];R.onsuccess=P=>{const T=R.result;return T?(H.push(y?T.value:T.primaryKey),++D===m?h({result:H}):void T.continue()):h({result:H})},R.onerror=st(w)}})}(s),openCursor:function({trans:f,values:p,query:h,reverse:w,unique:d}){return new Promise((y,m)=>{y=Se(y);const{index:g,range:_}=h,x=f.objectStore(c),E=g.isPrimaryKey?x:x.index(g.name),S=w?d?"prevunique":"prev":d?"nextunique":"next",k=p||!("openKeyCursor"in E)?E.openCursor(r(_),S):E.openKeyCursor(r(_),S);k.onerror=st(m),k.onsuccess=Se(N=>{const D=k.result;if(!D)return void y(null);D.___id=++Kf,D.done=!1;const R=D.continue.bind(D);let H=D.continuePrimaryKey;H&&(H=H.bind(D));const P=D.advance.bind(D),T=()=>{throw new Error("Cursor not stopped")};D.trans=f,D.stop=D.continue=D.continuePrimaryKey=D.advance=()=>{throw new Error("Cursor not started")},D.fail=Se(m),D.next=function(){let b=1;return this.start(()=>b--?this.continue():this.stop()).then(()=>this)},D.start=b=>{const q=new Promise((A,te)=>{A=Se(A),k.onerror=st(te),D.fail=te,D.stop=Z=>{D.stop=D.continue=D.continuePrimaryKey=D.advance=T,A(Z)}}),Q=()=>{if(k.result)try{b()}catch(A){D.fail(A)}else D.done=!0,D.start=()=>{throw new Error("Cursor behind last entry")},D.stop()};return k.onsuccess=Se(A=>{k.onsuccess=Q,Q()}),D.continue=R,D.continuePrimaryKey=H,D.advance=P,Q(),q},y(D)},m)})},count({query:f,trans:p}){const{index:h,range:w}=f;return new Promise((d,y)=>{const m=p.objectStore(c),g=h.isPrimaryKey?m:m.index(h.name),_=r(w),x=_?g.count(_):g.count();x.onsuccess=Se(E=>d(E.target.result)),x.onerror=st(y)})}}}(l)),a={};return i.forEach(l=>a[l.name]=l),{stack:"dbcore",transaction:t.transaction.bind(t),table(l){if(!a[l])throw new Error(`Table '${l}' not found`);return a[l]},MIN_KEY:-1/0,MAX_KEY:Ln(e),schema:o}}function Zo({_novip:t},e){const n=e.db,r=function(o,s,{IDBKeyRange:i,indexedDB:a},l){return{dbcore:function(c,f){return f.reduce((p,{create:h})=>({...p,...h(p)}),c)}($f(s,i,l),o.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(o=>{const s=o.name;t.core.schema.tables.some(i=>i.name===s)&&(o.core=t.core.table(s),t[s]instanceof t.Table&&(t[s].core=o.core))})}function jr({_novip:t},e,n,r){n.forEach(o=>{const s=r[o];e.forEach(i=>{const a=Ts(i,o);(!a||"value"in a&&a.value===void 0)&&(i===t.Transaction.prototype||i instanceof t.Transaction?mt(i,o,{get(){return this.table(o)},set(l){ji(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):i[o]=new t.Table(o,s))})})}function Go({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function qf(t,e){return t._cfg.version-e._cfg.version}function Hf(t,e,n,r){const o=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,o);s.create(n),s._completion.catch(r);const i=s._reject.bind(s),a=ce.transless||ce;St(()=>{ce.trans=s,ce.transless=a,e===0?(Ae(o).forEach(l=>{go(n,l,o[l].primKey,o[l].indexes)}),Zo(t,n),oe.follow(()=>t.on.populate.fire(s)).catch(i)):function({_novip:l},u,c,f){const p=[],h=l._versions;let w=l._dbSchema=Yo(l,l.idbdb,f),d=!1;const y=h.filter(g=>g._cfg.version>=u);function m(){return p.length?oe.resolve(p.shift()(c.idbtrans)).then(m):oe.resolve()}return y.forEach(g=>{p.push(()=>{const _=w,x=g._cfg.dbschema;Xo(l,_,f),Xo(l,x,f),w=l._dbSchema=x;const E=ol(_,x);E.add.forEach(k=>{go(f,k[0],k[1].primKey,k[1].indexes)}),E.change.forEach(k=>{if(k.recreate)throw new ue.Upgrade("Not yet support for changing primary key");{const N=f.objectStore(k.name);k.add.forEach(D=>Jo(N,D)),k.change.forEach(D=>{N.deleteIndex(D.name),Jo(N,D)}),k.del.forEach(D=>N.deleteIndex(D))}});const S=g._cfg.contentUpgrade;if(S&&g._cfg.version>u){Zo(l,f),c._memoizedTables={},d=!0;let k=Ri(x);E.del.forEach(H=>{k[H]=_[H]}),Go(l,[l.Transaction.prototype]),jr(l,[l.Transaction.prototype],Ae(k),k),c.schema=k;const N=Bs(S);let D;N&&hn();const R=oe.follow(()=>{if(D=S(c),D&&N){var H=gt.bind(null,null);D.then(H,H)}});return D&&typeof D.then=="function"?oe.resolve(D):R.then(()=>D)}}),p.push(_=>{(!d||!Rf)&&function(x,E){[].slice.call(E.db.objectStoreNames).forEach(S=>x[S]==null&&E.db.deleteObjectStore(S))}(g._cfg.dbschema,_),Go(l,[l.Transaction.prototype]),jr(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),c.schema=l._dbSchema})}),m().then(()=>{var g,_;_=f,Ae(g=w).forEach(x=>{_.db.objectStoreNames.contains(x)||go(_,x,g[x].primKey,g[x].indexes)})})}(t,e,s,n).catch(i)})}function ol(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const o=t[r],s=e[r];if(o){const i={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||o.primKey.auto!==s.primKey.auto&&!to)i.recreate=!0,n.change.push(i);else{const a=o.idxByName,l=s.idxByName;let u;for(u in a)l[u]||i.del.push(u);for(u in l){const c=a[u],f=l[u];c?c.src!==f.src&&i.change.push(f):i.add.push(f)}(i.del.length>0||i.add.length>0||i.change.length>0)&&n.change.push(i)}}else n.add.push([r,s])}return n}function go(t,e,n,r){const o=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(s=>Jo(o,s)),o}function Jo(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Yo(t,e,n){const r={};return Cr(e.objectStoreNames,0).forEach(o=>{const s=n.objectStore(o);let i=s.keyPath;const a=Ho(nl(i),i||"",!1,!1,!!s.autoIncrement,i&&typeof i!="string",!0),l=[];for(let c=0;c<s.indexNames.length;++c){const f=s.index(s.indexNames[c]);i=f.keyPath;var u=Ho(f.name,i,!!f.unique,!!f.multiEntry,!1,i&&typeof i!="string",!1);l.push(u)}r[o]=rl(o,a,l)}),r}function Xo({_novip:t},e,n){const r=n.db.objectStoreNames;for(let o=0;o<r.length;++o){const s=r[o],i=n.objectStore(s);t._hasGetAll="getAll"in i;for(let a=0;a<i.indexNames.length;++a){const l=i.indexNames[a],u=i.index(l).keyPath,c=typeof u=="string"?u:"["+Cr(u).join("+")+"]";if(e[s]){const f=e[s].idxByName[c];f&&(f.name=l,delete e[s].idxByName[c],e[s].idxByName[l]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Ce.WorkerGlobalScope&&Ce instanceof Ce.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class Vf{_parseStoresSpec(e,n){Ae(e).forEach(r=>{if(e[r]!==null){var o=e[r].split(",").map((i,a)=>{const l=(i=i.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Ho(l,u||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),ze(u),a===0)}),s=o.shift();if(s.multi)throw new ue.Schema("Primary key cannot be multi-valued");o.forEach(i=>{if(i.auto)throw new ue.Schema("Only primary key can be marked as autoIncrement (++)");if(!i.keyPath)throw new ue.Schema("Index must have a name and cannot be an empty string")}),n[r]=rl(r,s,o)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?Ke(this._cfg.storesSource,e):e;const r=n._versions,o={};let s={};return r.forEach(i=>{Ke(o,i._cfg.storesSource),s=i._cfg.dbschema={},i._parseStoresSpec(o,s)}),n._dbSchema=s,Go(n,[n._allTables,n,n.Transaction.prototype]),jr(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],Ae(s),s),n._storeNames=Ae(s),this}upgrade(e){return this._cfg.contentUpgrade=Ls(this._cfg.contentUpgrade||ke,e),this}}function $s(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Ut(no,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function qs(t){return t&&typeof t.databases=="function"}function Qo(t){return St(function(){return ce.letThrough=!0,t()})}function Zf(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function Gf(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?Ne(e.dbOpenError):t);lt&&(e.openCanceller._stackHolder=Vt()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function o(){if(e.openCanceller!==r)throw new ue.DatabaseClosed("db.open() was cancelled")}let s=e.dbReadyResolve,i=null,a=!1;return oe.race([r,(typeof navigator>"u"?oe.resolve():Zf()).then(()=>new oe((l,u)=>{if(o(),!n)throw new ue.MissingAPI;const c=t.name,f=e.autoSchema?n.open(c):n.open(c,Math.round(10*t.verno));if(!f)throw new ue.MissingAPI;f.onerror=st(u),f.onblocked=Se(t._fireOnBlocked),f.onupgradeneeded=Se(p=>{if(i=f.transaction,e.autoSchema&&!t._options.allowEmptyDB){f.onerror=Mn,i.abort(),f.result.close();const w=n.deleteDatabase(c);w.onsuccess=w.onerror=Se(()=>{u(new ue.NoSuchDatabase(`Database ${c} doesnt exist`))})}else{i.onerror=st(u);var h=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;a=h<1,t._novip.idbdb=f.result,Hf(t,h/10,i,u)}},u),f.onsuccess=Se(()=>{i=null;const p=t._novip.idbdb=f.result,h=Cr(p.objectStoreNames);if(h.length>0)try{const d=p.transaction((w=h).length===1?w[0]:w,"readonly");e.autoSchema?function({_novip:y},m,g){y.verno=m.version/10;const _=y._dbSchema=Yo(0,m,g);y._storeNames=Cr(m.objectStoreNames,0),jr(y,[y._allTables],Ae(_),_)}(t,p,d):(Xo(t,t._dbSchema,d),function(y,m){const g=ol(Yo(0,y.idbdb,m),y._dbSchema);return!(g.add.length||g.change.some(_=>_.add.length||_.change.length))}(t,d)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Zo(t,d)}catch{}var w;On.push(t),p.onversionchange=Se(d=>{e.vcFired=!0,t.on("versionchange").fire(d)}),p.onclose=Se(d=>{t.on("close").fire(d)}),a&&function({indexedDB:d,IDBKeyRange:y},m){!qs(d)&&m!==no&&$s(d,y).put({name:m}).catch(ke)}(t._deps,c),l()},u)}))]).then(()=>(o(),e.onReadyBeingFired=[],oe.resolve(Qo(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let u=e.onReadyBeingFired.reduce(Ls,ke);return e.onReadyBeingFired=[],oe.resolve(Qo(()=>u(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{i&&i.abort()}catch{}return r===e.openCanceller&&t._close(),Ne(l)}).finally(()=>{e.openComplete=!0,s()})}function es(t){var e=s=>t.next(s),n=o(e),r=o(s=>t.throw(s));function o(s){return i=>{var a=s(i),l=a.value;return a.done?l:l&&typeof l.then=="function"?l.then(n,r):ze(l)?Promise.all(l).then(n,r):n(l)}}return o(e)()}function Jf(t,e,n){var r=arguments.length;if(r<2)throw new ue.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return n=o.pop(),[t,Ti(o),n]}function sl(t,e,n,r,o){return oe.resolve().then(()=>{const s=ce.transless||ce,i=t._createTransaction(e,n,t._dbSchema,r),a={trans:i,transless:s};if(r)i.idbtrans=r.idbtrans;else try{i.create(),t._state.PR1398_maxLoop=3}catch(f){return f.name===zs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>sl(t,e,n,null,o))):Ne(f)}const l=Bs(o);let u;l&&hn();const c=oe.follow(()=>{if(u=o.call(i,i),u)if(l){var f=gt.bind(null,null);u.then(f,f)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=es(u))},a);return(u&&typeof u.then=="function"?oe.resolve(u).then(f=>i.active?f:Ne(new ue.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>u)).then(f=>(r&&i._resolve(),i._completion.then(()=>f))).catch(f=>(i._reject(f),Ne(f)))})}function ir(t,e,n){const r=ze(t)?t.slice():[t];for(let o=0;o<n;++o)r.push(e);return r}const Yf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,o={},s=[];function i(c,f,p){const h=Pn(c),w=o[h]=o[h]||[],d=c==null?0:typeof c=="string"?1:c.length,y=f>0,m={...p,isVirtual:y,keyTail:f,keyLength:d,extractKey:Vo(c),unique:!y&&p.unique};return w.push(m),m.isPrimaryKey||s.push(m),d>1&&i(d===2?c[0]:c.slice(0,d-1),f+1,p),w.sort((g,_)=>g.keyTail-_.keyTail),m}const a=i(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[a];for(const c of r.indexes)i(c.keyPath,0,c);function l(c){const f=c.query.index;return f.isVirtual?{...c,query:{index:f,range:(p=c.query.range,h=f.keyTail,{type:p.type===1?2:p.type,lower:ir(p.lower,p.lowerOpen?t.MAX_KEY:t.MIN_KEY,h),lowerOpen:!0,upper:ir(p.upper,p.upperOpen?t.MIN_KEY:t.MAX_KEY,h),upperOpen:!0})}}:c;var p,h}return{...n,schema:{...r,primaryKey:a,indexes:s,getIndexByKeyPath:function(c){const f=o[Pn(c)];return f&&f[0]}},count:c=>n.count(l(c)),query:c=>n.query(l(c)),openCursor(c){const{keyTail:f,isVirtual:p,keyLength:h}=c.query.index;return p?n.openCursor(l(c)).then(w=>w&&function(d){return Object.create(d,{continue:{value:function(m){m!=null?d.continue(ir(m,c.reverse?t.MAX_KEY:t.MIN_KEY,f)):c.unique?d.continue(d.key.slice(0,h).concat(c.reverse?t.MIN_KEY:t.MAX_KEY,f)):d.continue()}},continuePrimaryKey:{value(m,g){d.continuePrimaryKey(ir(m,t.MAX_KEY,f),g)}},primaryKey:{get:()=>d.primaryKey},key:{get(){const m=d.key;return h===1?m[0]:m.slice(0,h)}},value:{get:()=>d.value}})}(w)):n.openCursor(c)}}}}}};function Hs(t,e,n,r){return n=n||{},r=r||"",Ae(t).forEach(o=>{if(Ze(e,o)){var s=t[o],i=e[o];if(typeof s=="object"&&typeof i=="object"&&s&&i){const a=No(s);a!==No(i)?n[r+o]=e[o]:a==="Object"?Hs(s,i,n,r+o+"."):s!==i&&(n[r+o]=e[o])}else s!==i&&(n[r+o]=e[o])}else n[r+o]=void 0}),Ae(e).forEach(o=>{Ze(t,o)||(n[r+o]=e[o])}),n}const Xf={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(s){const i=ce.trans,{deleting:a,creating:l,updating:u}=i.table(e).hook;switch(s.type){case"add":if(l.fire===ke)break;return i._promise("readwrite",()=>c(s),!0);case"put":if(l.fire===ke&&u.fire===ke)break;return i._promise("readwrite",()=>c(s),!0);case"delete":if(a.fire===ke)break;return i._promise("readwrite",()=>c(s),!0);case"deleteRange":if(a.fire===ke)break;return i._promise("readwrite",()=>function(p){return f(p.trans,p.range,1e4)}(s),!0)}return n.mutate(s);function c(p){const h=ce.trans,w=p.keys||function(d,y){return y.type==="delete"?y.keys:y.keys||y.values.map(d.extractKey)}(r,p);if(!w)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:w}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(d,y,m){return y.type==="add"?Promise.resolve([]):d.getMany({trans:y.trans,keys:m,cache:"immutable"})}(n,p,w).then(d=>{const y=w.map((m,g)=>{const _=d[g],x={onerror:null,onsuccess:null};if(p.type==="delete")a.fire.call(x,m,_,h);else if(p.type==="add"||_===void 0){const E=l.fire.call(x,m,p.values[g],h);m==null&&E!=null&&(m=E,p.keys[g]=m,r.outbound||nt(p.values[g],r.keyPath,m))}else{const E=Hs(_,p.values[g]),S=u.fire.call(x,E,m,_,h);if(S){const k=p.values[g];Object.keys(S).forEach(N=>{Ze(k,N)?k[N]=S[N]:nt(k,N,S[N])})}}return x});return n.mutate(p).then(({failures:m,results:g,numFailures:_,lastResult:x})=>{for(let E=0;E<w.length;++E){const S=g?g[E]:w[E],k=y[E];S==null?k.onerror&&k.onerror(m[E]):k.onsuccess&&k.onsuccess(p.type==="put"&&d[E]?p.values[E]:S)}return{failures:m,results:g,numFailures:_,lastResult:x}}).catch(m=>(y.forEach(g=>g.onerror&&g.onerror(m)),Promise.reject(m)))})}function f(p,h,w){return n.query({trans:p,values:!1,query:{index:r,range:h},limit:w}).then(({result:d})=>c({type:"delete",keys:d,trans:p}).then(y=>y.numFailures>0?Promise.reject(y.failures[0]):d.length<w?{failures:[],numFailures:0,lastResult:void 0}:f(p,{...h,lower:d[d.length-1],lowerOpen:!0},w)))}}}}})};function al(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let o=0,s=0;o<e.keys.length&&s<t.length;++o)We(e.keys[o],t[s])===0&&(r.push(n?Hn(e.values[o]):e.values[o]),++s);return r.length===t.length?r:null}catch{return null}}const Qf={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const o=al(r.keys,r.trans._cache,r.cache==="clone");return o?oe.resolve(o):n.getMany(r).then(s=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?Hn(s):s},s))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function Vs(t){return!("from"in t)}const dt=function(t,e){if(!this){const n=new dt;return t&&"d"in t&&Ke(n,t),n}Ke(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function Wn(t,e,n){const r=We(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(Vs(t))return Ke(t,{from:e,to:n,d:1});const o=t.l,s=t.r;if(We(n,t.from)<0)return o?Wn(o,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Sa(t);if(We(e,t.to)>0)return s?Wn(s,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Sa(t);We(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),We(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const i=!t.r;o&&!t.l&&Ar(t,o),s&&i&&Ar(t,s)}function Ar(t,e){Vs(e)||function n(r,{from:o,to:s,l:i,r:a}){Wn(r,o,s),i&&n(r,i),a&&n(r,a)}(t,e)}function eh(t,e){const n=ts(e);let r=n.next();if(r.done)return!1;let o=r.value;const s=ts(t);let i=s.next(o.from),a=i.value;for(;!r.done&&!i.done;){if(We(a.from,o.to)<=0&&We(a.to,o.from)>=0)return!0;We(o.from,a.from)<0?o=(r=n.next(a.from)).value:a=(i=s.next(o.from)).value}return!1}function ts(t){let e=Vs(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&We(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||We(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Sa(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){const s=o==="r"?"l":"r",i={...t},a=t[o];t.from=a.from,t.to=a.to,t[o]=a[o],i[o]=a[s],t[s]=i,i.d=Ia(i)}t.d=Ia(t)}function Ia({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}un(dt.prototype,{add(t){return Ar(this,t),this},addKey(t){return Wn(this,t,t),this},addKeys(t){return t.forEach(e=>Wn(this,e,e)),this},[Fo](){return ts(this)}});const th={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new dt(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const o=t.table(r),{schema:s}=o,{primaryKey:i}=s,{extractKey:a,outbound:l}=i,u={...o,mutate:p=>{const h=p.trans,w=h.mutatedParts||(h.mutatedParts={}),d=S=>{const k=`idb://${e}/${r}/${S}`;return w[k]||(w[k]=new dt)},y=d(""),m=d(":dels"),{type:g}=p;let[_,x]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const E=p.trans._cache;return o.mutate(p).then(S=>{if(ze(_)){g!=="delete"&&(_=S.results),y.addKeys(_);const k=al(_,E);k||g==="add"||m.addKeys(_),(k||x)&&function(N,D,R,H){function P(T){const b=N(T.name||"");function q(A){return A!=null?T.extractKey(A):null}const Q=A=>T.multiEntry&&ze(A)?A.forEach(te=>b.addKey(te)):b.addKey(A);(R||H).forEach((A,te)=>{const Z=R&&q(R[te]),re=H&&q(H[te]);We(Z,re)!==0&&(Z!=null&&Q(Z),re!=null&&Q(re))})}D.indexes.forEach(P)}(d,s,k,x)}else if(_){const k={from:_.lower,to:_.upper};m.add(k),y.add(k)}else y.add(n),m.add(n),s.indexes.forEach(k=>d(k.name).add(n));return S})}},c=({query:{index:p,range:h}})=>{var w,d;return[p,new dt((w=h.lower)!==null&&w!==void 0?w:t.MIN_KEY,(d=h.upper)!==null&&d!==void 0?d:t.MAX_KEY)]},f={get:p=>[i,new dt(p.key)],getMany:p=>[i,new dt().addKeys(p.keys)],count:c,query:c,openCursor:c};return Ae(f).forEach(p=>{u[p]=function(h){const{subscr:w}=ce;if(w){const d=x=>{const E=`idb://${e}/${r}/${x}`;return w[E]||(w[E]=new dt)},y=d(""),m=d(":dels"),[g,_]=f[p](h);if(d(g.name||"").add(_),!g.isPrimaryKey){if(p!=="count"){const x=p==="query"&&l&&h.values&&o.query({...h,values:!1});return o[p].apply(this,arguments).then(E=>{if(p==="query"){if(l&&h.values)return x.then(({result:k})=>(y.addKeys(k),E));const S=h.values?E.result.map(a):E.result;h.values?y.addKeys(S):m.addKeys(S)}else if(p==="openCursor"){const S=E,k=h.values;return S&&Object.create(S,{key:{get:()=>(m.addKey(S.primaryKey),S.key)},primaryKey:{get(){const N=S.primaryKey;return m.addKey(N),N}},value:{get:()=>(k&&y.addKey(S.primaryKey),S.value)}})}return E})}m.add(n)}}return o[p].apply(this,arguments)}}),u}}}};class Ut{constructor(e,n){this._middlewares={},this.verno=0;const r=Ut.dependencies;this._options=n={addons:Ut.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:o}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var i;s.dbReadyPromise=new oe(a=>{s.dbReadyResolve=a}),s.openCanceller=new oe((a,l)=>{s.cancelOpen=l}),this._state=s,this.name=e,this.on=Dn(this,"populate","blocked","versionchange","close",{ready:[Ls,ke]}),this.on.ready.subscribe=Ai(this.on.ready.subscribe,a=>(l,u)=>{Ut.vip(()=>{const c=this._state;if(c.openComplete)c.dbOpenError||oe.resolve().then(l),u&&a(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),u&&a(l);else{a(l);const f=this;u||a(function p(){f.on.ready.unsubscribe(l),f.on.ready.unsubscribe(p)})}})}),this.Collection=(i=this,wn(Mf.prototype,function(a,l){this.db=i;let u=Qi,c=null;if(l)try{u=l()}catch(w){c=w}const f=a._ctx,p=f.table,h=p.hook.reading.fire;this._ctx={table:p,index:f.index,isPrimKey:!f.index||p.schema.primKey.keyPath&&f.index===p.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:f.or,valueMapper:h!==Tn?h:null}})),this.Table=function(a){return wn(Bf.prototype,function(l,u,c){this.db=a,this._tx=c,this.name=l,this.schema=u,this.hook=a._allTables[l]?a._allTables[l].hook:Dn(null,{creating:[Cf,ke],reading:[Ef,Tn],updating:[If,ke],deleting:[Sf,ke]})})}(this),this.Transaction=function(a){return wn(Uf.prototype,function(l,u,c,f,p){this.db=a,this.mode=l,this.storeNames=u,this.schema=c,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=Dn(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new oe((h,w)=>{this._resolve=h,this._reject=w}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},h=>{var w=this.active;return this.active=!1,this.on.error.fire(h),this.parent?this.parent._reject(h):w&&this.idbtrans&&this.idbtrans.abort(),Ne(h)})})}(this),this.Version=function(a){return wn(Vf.prototype,function(l){this.db=a,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(a){return wn(tl.prototype,function(l,u,c){this.db=a,this._ctx={table:l,index:u===":id"?null:u,or:c};const f=a._deps.indexedDB;if(!f)throw new ue.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(p,h)=>f.cmp(h,p),this._max=(p,h)=>f.cmp(p,h)>0?p:h,this._min=(p,h)=>f.cmp(p,h)<0?p:h,this._IDBKeyRange=a._deps.IDBKeyRange})}(this),this.on("versionchange",a=>{a.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",a=>{!a.newVersion||a.newVersion<a.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${a.oldVersion/10}`)}),this._maxKey=Ln(n.IDBKeyRange),this._createTransaction=(a,l,u,c)=>new this.Transaction(a,l,u,this._options.chromeTransactionDurability,c),this._fireOnBlocked=a=>{this.on("blocked").fire(a),On.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(a))},this.use(Yf),this.use(Xf),this.use(th),this.use(Qf),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(a=>a(this))}version(e){if(isNaN(e)||e<.1)throw new ue.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ue.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(o=>o._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(qf),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||ce.letThrough||this._vip)?e():new oe((n,r)=>{if(this._state.openComplete)return r(new ue.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new ue.DatabaseClosed);this.open().catch(ke)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:o}){o&&this.unuse({stack:e,name:o});const s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:n,level:r??10,name:o}),s.sort((i,a)=>i.level-a.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(o=>r?o.create!==r:!!n&&o.name!==n)),this}open(){return Gf(this)}_close(){const e=this._state,n=On.indexOf(this);if(n>=0&&On.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new oe(r=>{e.dbReadyResolve=r}),e.openCanceller=new oe((r,o)=>{e.cancelOpen=o})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new ue.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new oe((r,o)=>{const s=()=>{this.close();var i=this._deps.indexedDB.deleteDatabase(this.name);i.onsuccess=Se(()=>{(function({indexedDB:a,IDBKeyRange:l},u){!qs(a)&&u!==no&&$s(a,l).delete(u).catch(ke)})(this._deps,this.name),r()}),i.onerror=st(o),i.onblocked=this._fireOnBlocked};if(e)throw new ue.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Ae(this._allTables).map(e=>this._allTables[e])}transaction(){const e=Jf.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let o=ce.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);const s=e.indexOf("?")!==-1;let i,a;e=e.replace("!","").replace("?","");try{if(a=n.map(u=>{var c=u instanceof this.Table?u.name:u;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),e=="r"||e===ho)i=ho;else{if(e!="rw"&&e!=po)throw new ue.InvalidArgument("Invalid transaction mode: "+e);i=po}if(o){if(o.mode===ho&&i===po){if(!s)throw new ue.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&a.forEach(u=>{if(o&&o.storeNames.indexOf(u)===-1){if(!s)throw new ue.SubTransaction("Table "+u+" not included in parent transaction.");o=null}}),s&&o&&!o.active&&(o=null)}}catch(u){return o?o._promise(null,(c,f)=>{f(u)}):Ne(u)}const l=sl.bind(null,this,i,a,o,r);return o?o._promise(i,l,"lock"):ce.trans?pn(ce.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!Ze(this._allTables,e))throw new ue.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const nh=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class rh{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[nh](){return this}}function il(t,e){return Ae(e).forEach(n=>{Ar(t[n]||(t[n]=new dt),e[n])}),t}function oh(t){let e,n=!1;const r=new rh(o=>{const s=Bs(t);let i=!1,a={},l={};const u={get closed(){return i},unsubscribe:()=>{i=!0,Ot.storagemutated.unsubscribe(h)}};o.start&&o.start(u);let c=!1,f=!1;function p(){return Ae(l).some(d=>a[d]&&eh(a[d],l[d]))}const h=d=>{il(a,d),p()&&w()},w=()=>{if(c||i)return;a={};const d={},y=function(m){s&&hn();const g=()=>St(t,{subscr:m,trans:null}),_=ce.trans?pn(ce.transless,g):g();return s&&_.then(gt,gt),_}(d);f||(Ot(zn,h),f=!0),c=!0,Promise.resolve(y).then(m=>{n=!0,e=m,c=!1,i||(p()?w():(a={},l=d,o.next&&o.next(m)))},m=>{c=!1,n=!1,o.error&&o.error(m),u.unsubscribe()})};return w(),u});return r.hasValue=()=>n,r.getValue=()=>e,r}let ns;try{ns={indexedDB:Ce.indexedDB||Ce.mozIndexedDB||Ce.webkitIndexedDB||Ce.msIndexedDB,IDBKeyRange:Ce.IDBKeyRange||Ce.webkitIDBKeyRange}}catch{ns={indexedDB:null,IDBKeyRange:null}}const Nt=Ut;function vr(t){let e=ht;try{ht=!0,Ot.storagemutated.fire(t)}finally{ht=e}}un(Nt,{...dr,delete:t=>new Nt(t,{addons:[]}).delete(),exists:t=>new Nt(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return qs(e)?Promise.resolve(e.databases()).then(r=>r.map(o=>o.name).filter(o=>o!==no)):$s(e,n).toCollection().primaryKeys()}(Nt.dependencies).then(t)}catch{return Ne(new ue.MissingAPI)}},defineClass:()=>function(t){Ke(this,t)},ignoreTransaction:t=>ce.trans?pn(ce.transless,t):t(),vip:Qo,async:function(t){return function(){try{var e=es(t.apply(this,arguments));return e&&typeof e.then=="function"?e:oe.resolve(e)}catch(n){return Ne(n)}}},spawn:function(t,e,n){try{var r=es(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:oe.resolve(r)}catch(o){return Ne(o)}},currentTransaction:{get:()=>ce.trans||null},waitFor:function(t,e){const n=oe.resolve(typeof t=="function"?Nt.ignoreTransaction(t):t).timeout(e||6e4);return ce.trans?ce.trans.waitFor(n):n},Promise:oe,debug:{get:()=>lt,set:t=>{Mi(t,t==="dexie"?()=>!0:Xi)}},derive:nn,extend:Ke,props:un,override:Ai,Events:Dn,on:Ot,liveQuery:oh,extendObservabilitySet:il,getByKeyPath:yt,setByKeyPath:nt,delByKeyPath:function(t,e){typeof e=="string"?nt(t,e,void 0):"length"in e&&[].map.call(e,function(n){nt(t,n,void 0)})},shallowClone:Ri,deepClone:Hn,getObjectDiff:Hs,cmp:We,asap:Ni,minKey:qo,addons:[],connections:On,errnames:zs,dependencies:ns,semVer:ba,version:ba.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),Nt.maxKey=Ln(Nt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ot(zn,t=>{if(!ht){let e;to?(e=document.createEvent("CustomEvent"),e.initCustomEvent(kt,!0,!0,t)):e=new CustomEvent(kt,{detail:t}),ht=!0,dispatchEvent(e),ht=!1}}),addEventListener(kt,({detail:t})=>{ht||vr(t)}));let ht=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(kt);typeof t.unref=="function"&&t.unref(),Ot(zn,e=>{ht||t.postMessage(e)}),t.onmessage=e=>{e.data&&vr(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Ot(zn,e=>{try{ht||(typeof localStorage<"u"&&localStorage.setItem(kt,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:kt,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===kt){const n=JSON.parse(e.newValue);n&&vr(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===kt&&vr(e.changedParts)})}oe.rejectionMapper=function(t,e){if(!t||t instanceof rn||t instanceof TypeError||t instanceof SyntaxError||!t.name||!ya[t.name])return t;var n=new ya[t.name](e||t.message,t);return"stack"in t&&mt(n,"stack",{get:function(){return this.inner.stack}}),n},Mi(lt,Xi);var rs=(t=>(t.SAVE="save",t.SAVE_AS="saveAs",t))(rs||{}),gr=(t=>(t.MOVE_TO_ROOT_FOLDER="moveToRootFolder",t.DELETE="delete",t))(gr||{});const sh="comfyui_workspace_db";class ah extends Ut{constructor(){super(sh);Oe(this,"workflows");Oe(this,"changelogs");Oe(this,"media");Oe(this,"folders");Oe(this,"tags");Oe(this,"userSettings");Oe(this,"models");Oe(this,"cache");Oe(this,"workflowVersions");this.version(1).stores({workflows:"&id, name, parentFolderID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id"}).upgrade(n=>{}),this.version(2).stores({workflows:"&id, name, parentFolderID,cloudID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id",workflowVersions:"&id, name, workflowID,cloudID"}).upgrade(n=>{})}}const fe=new ah,ih="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let os=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=ih[n[t]&63];return e};class Zt{constructor(e){Oe(this,"tableName");this.tableName=e}async saveDiskDB(){const e=await fe[this.tableName].toArray(),n={};e.forEach(r=>{r.id?n[r.id]=r:r.name?n[r.name]=r:console.error("TableBaseModel should have id or name")}),af(this.tableName,JSON.stringify(n))}async add(e){return e.id||(e.id=os()),e.createTime||(e.createTime=Date.now()),await fe[this.tableName].add(e),await this.saveDiskDB(),e}async put(e){return await fe[this.tableName].put(e),await this.saveDiskDB(),e}async bulkPut(e){await fe[this.tableName].bulkPut(e),this.saveDiskDB()}async update(e,n){return await fe[this.tableName].update(e,n),await this.saveDiskDB(),await this.get(e)??null}async listAll(){return await fe[this.tableName].toArray()}async batchQuery(e){return await fe[this.tableName].bulkGet(e)}async getRecords(){console.warn("[DEPRECATED] getRecords() call, should only be used for one-time backfill for indexdb",this.tableName);const e=await sf(this.tableName);let n;try{n=e!=null?JSON.parse(e):null}catch{}if(n==null){const r=await hf()??"{}";n=JSON.parse(r)[this.tableName]}return n??{}}async get(e){return await fe[this.tableName].get(e)}async delete(e){await fe[this.tableName].delete(e),await this.saveDiskDB()}async listByIndex(e,n){return await fe[this.tableName].where(e).equals(n).toArray()}}const lh=150,Rr=class Rr extends Zt{constructor(){super("changelogs")}static async load(){return new Rr}async listByWorkflowID(e){return await fe.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime")}async getLastestByWorkflowID(e){return(await this.listByWorkflowID(e))[0]}async create(e){const n=await this.getLastestByWorkflowID(e.workflowID);if(n!=null&&n.json===e.json)return null;const r={id:Fn(),json:e.json,workflowID:e.workflowID,createTime:Date.now()};return await fe.changelogs.add(r),await this.saveDiskDB(),r}async deleteLogsExceedLimit(e,n=lh){const r=await fe.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime"),o=r.filter(i=>i.isAutoSave===!0),s=r.filter(i=>i.isAutoSave==null||i.isAutoSave==!1);if(o.length>n){const i=o.slice(n);await fe.changelogs.bulkDelete(i.map(a=>a.id)),await this.saveDiskDB()}if(s.length>n){const i=s.slice(n);await fe.changelogs.bulkDelete(i.map(a=>a.id)),await this.saveDiskDB()}}};Oe(Rr,"TABLE_NAME","changelogs");let ss=Rr;const Np="CWM_WORKFLOWS_SORT_TYPE";var Et=(t=>(t.RECENTLY_MODIFIED="newest",t.OLDEST_MODIFIED="oldest",t.AZ="name A-Z",t.ZA="name Z-A",t))(Et||{});const Fp=[{title:"Import Workflows",type:"file"},{title:"Import Folder",type:"folder"}],ch="comfyspace_tracking",Nr="workspace_info",uh=9999999,wo="upgrade_to_2way_sync";function wr(...t){const e=t.filter(n=>n!=="").join("/");return Dt(e)}function Dt(t){let n=t.split("/").filter(r=>r!=="").join("/").replace(/\\/g,"/");return n=n.replace(/^\/+/,""),n}function bo(t){return wr(t.parentFolderID??"",t.name+".json")}var Ct;(t=>{async function e({parentFolderID:a,name:l}){return Dt(`${a??""}/${l}`)}t.genFolderRelPath=e;async function n(a){await fetch("/workspace/folder/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Dt(a.id)})})}t.createFolder=n;async function r(a,l){const c=await(await fetch("/workspace/folder/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folder:a,newParentPath:l})})).json();c.error&&alert("Failed to move folder: "+c.error)}t.moveFolder=r;async function o(a){try{return await(await fetch("/workspace/folder/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a})})).text()}catch(l){console.error("Error deleting file:",l)}}t.deleteFolder=o;async function s(a){try{const u=await(await fetch("/workspace/file/count_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a})})).json();return u.error&&console.error("Error counting files:",u.error),u.count}catch(l){console.error("Error renaming file:",l)}return null}t.genFilesCountInFolder=s;async function i(a,l){try{const c=await(await fetch("/workspace/folder/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absPath:a,newName:l})})).json();c.error&&alert("Failed to rename folder: "+c.error)}catch(u){console.error("Error renaming file:",u)}}t.renameFolder=i})(Ct||(Ct={}));async function xn(t){const e=await Zs(t);if(e==null)return;const n=await ll(t);await(V==null?void 0:V.updateMetaInfo(t.id,{filePath:n??void 0}));const r=t.json,o=JSON.parse(r);o.extra[Nr]={id:t.id,name:t.name},delete o.extra[ch],await lf(e,JSON.stringify(o))}async function _o(t){if(t.name==null)return;const e=await Zs(t);e!=null&&Pi(e)}async function Zs(t){let e=fh(t.name)+".json",n=t.parentFolderID;for(;n!=null;){const r=await(Le==null?void 0:Le.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??void 0}return e??null}async function dh(t){let e="",n=t;for(;n!=null;){const r=await(Le==null?void 0:Le.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??null}return e}async function ll(t){const e=await Zs(t);let n=await(J==null?void 0:J.getSetting("myWorkflowsDir"));return n?(n.endsWith("/")||(n=n+"/"),n+e):(console.error("myWorkflowsDir is not set"),null)}async function Rp(t){if(await(J==null?void 0:J.getSetting("twoWaySync")))return await Ct.genFilesCountInFolder(t)??0;const n=await(V==null?void 0:V.listAll())??[],r=await(Le==null?void 0:Le.listAll())??[],o=[t];let s=0;for(;o.length>0;){const i=o.shift();if(i){for(const l of n)l.parentFolderID===i&&s++;const a=r.filter(l=>l.parentFolderID===i).map(l=>l.id);a.length&&o.push(...a)}}return s}function fh(t){return t=t.replace(/[\\/:*?"<>|]/g,"_"),t.trim()}function as(t,e=!0,n=!1){const r=new Date(t),o=String(r.getDate()).padStart(2,"0"),s=String(r.getMonth()+1).padStart(2,"0"),i=r.getFullYear(),a=String(r.getHours()).padStart(2,"0"),l=String(r.getMinutes()).padStart(2,"0"),u=String(r.getSeconds()).padStart(2,"0"),c=`${s}-${o}-${i}`;return e?c+` ${a}:${l}`:n?c+`:${u}`:c}async function cl(t=!1){if(await(J==null?void 0:J.getSetting("twoWaySync")))return;const n=await(V==null?void 0:V.listAll())??[];for(const r of n){const o=await ll(r);r.filePath!=o&&(r.filePath!=null&&await Pi(r.filePath,t),await xn(r))}}const ul=(t,e=Et.RECENTLY_MODIFIED)=>{const n=[...t];switch(e){case Et.AZ:n.sort((r,o)=>r.name.localeCompare(o.name));break;case Et.ZA:n.sort((r,o)=>o.name.localeCompare(r.name));break;case Et.RECENTLY_MODIFIED:n.sort((r,o)=>o.updateTime-r.updateTime);break;case Et.OLDEST_MODIFIED:n.sort((r,o)=>r.updateTime-o.updateTime);break}return n};function Tp(t,e){let n=JSON.parse(t);typeof structuredClone>"u"?n=JSON.parse(JSON.stringify(n)):n=structuredClone(n);let r=new LGraph;const o=document.createElement("canvas");o.style.display="none",document.body.appendChild(o);let s=new LGraphCanvas(o,r);const i=localStorage.getItem("litegrapheditor_clipboard"),a=be.graph,l=be.canvas;be.canvas=s,be.graph=r,r.configure(n),be.canvas.copyToClipboard(r._nodes),s.graph.clear(),document.body.removeChild(o),be.graph=a,be.canvas=l;const u=be.canvas.graph_mouse;e&&(e[0]-=15,e[1]-=15,be.canvas.graph_mouse=e),be.canvas.pasteFromClipboard(),be.canvas.graph_mouse=u,i&&localStorage.setItem("litegrapheditor_clipboard",i),r=null,s=null}const hh=async t=>{const e=await(J==null?void 0:J.getSetting("shortcuts"))??(J==null?void 0:J.defaultSettings.shortcuts);if(!e)return!1;for(const n in e){const o=e[n].split("+"),s={Control:t.ctrlKey,Shift:t.shiftKey,Alt:t.altKey,Command:t.metaKey,[t.key.toUpperCase()]:!0};for(const i in s)s[i]||delete s[i];if(o.length===Object.keys(s).length&&o.every(i=>s[i]))return n}};function Bp(t){const e=["png","jpg","jpeg","gif","bmp","webp"],n=t.split(".").pop();return n!=null&&e.includes(n)}function ph(t){return`/workspace/view_media?filename=${t}`}function Oa(){const e=window.location.hash.slice(1).split("/").find(n=>n.includes("workspaceId@"));return e?e.split("@")[1]:null}function dl(t){const e=window.location.hash.slice(1).split("/"),n=e.findIndex(o=>o.includes("workspaceId@")),r=`workspaceId@${t}`;return n>=0?e[n]=r:e.push(r),`${e.join("/")}`}const mh=t=>{const e=dl(t);window.open(`${window.location.origin}/#${e}`)},br={last_node_id:9,last_link_id:9,nodes:[{id:7,type:"CLIPTextEncode",pos:[413,389],size:{0:425.27801513671875,1:180.6060791015625},flags:{},order:3,mode:0,inputs:[{name:"clip",type:"CLIP",link:5}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[6],slot_index:0}],properties:{},widgets_values:["text, watermark"]},{id:6,type:"CLIPTextEncode",pos:[415,186],size:{0:422.84503173828125,1:164.31304931640625},flags:{},order:2,mode:0,inputs:[{name:"clip",type:"CLIP",link:3}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[4],slot_index:0}],properties:{},widgets_values:["beautiful scenery nature glass bottle landscape, , purple galaxy bottle,"]},{id:5,type:"EmptyLatentImage",pos:[473,609],size:{0:315,1:106},flags:{},order:1,mode:0,outputs:[{name:"LATENT",type:"LATENT",links:[2],slot_index:0}],properties:{},widgets_values:[512,512,1]},{id:3,type:"KSampler",pos:[863,186],size:{0:315,1:262},flags:{},order:4,mode:0,inputs:[{name:"model",type:"MODEL",link:1},{name:"positive",type:"CONDITIONING",link:4},{name:"negative",type:"CONDITIONING",link:6},{name:"latent_image",type:"LATENT",link:2}],outputs:[{name:"LATENT",type:"LATENT",links:[7],slot_index:0}],properties:{},widgets_values:[0x8e7ff42ed37e,!0,20,8,"euler","normal",1]},{id:8,type:"VAEDecode",pos:[1209,188],size:{0:210,1:46},flags:{},order:5,mode:0,inputs:[{name:"samples",type:"LATENT",link:7},{name:"vae",type:"VAE",link:8}],outputs:[{name:"IMAGE",type:"IMAGE",links:[9],slot_index:0}],properties:{}},{id:9,type:"SaveImage",pos:[1451,189],size:{0:210,1:26},flags:{},order:6,mode:0,inputs:[{name:"images",type:"IMAGE",link:9}],properties:{}},{id:4,type:"CheckpointLoaderSimple",pos:[26,474],size:{0:315,1:98},flags:{},order:0,mode:0,outputs:[{name:"MODEL",type:"MODEL",links:[1],slot_index:0},{name:"CLIP",type:"CLIP",links:[3,5],slot_index:1},{name:"VAE",type:"VAE",links:[8],slot_index:2}],properties:{},widgets_values:["v1-5-pruned-emaonly.ckpt"]}],links:[[1,4,0,3,0,"MODEL"],[2,5,0,3,3,"LATENT"],[3,4,1,6,0,"CLIP"],[4,6,0,3,1,"CONDITIONING"],[5,4,1,7,0,"CLIP"],[6,7,0,3,2,"CONDITIONING"],[7,3,0,8,0,"LATENT"],[8,4,2,8,1,"VAE"],[9,8,0,9,0,"IMAGE"]],groups:[],config:{},extra:{},version:.4};var Je;(t=>{async function e(l,u){try{const f=await(await fetch("/workspace/file/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:bo(l),newParentPath:u})})).json();return f.error?(alert("Error moving file: "+f.error),!1):!0}catch(c){console.error("Error deleting file:",c)}}t.moveWorkflow=e;async function n(l,u){try{const f=await(await fetch("/workspace/file/gen_unique_name",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:wr(u??"",l)})})).json();return f.error?(console.error("Error getting unique name:",f.error),null):f.uniqueName}catch(c){console.error("Error deleting file:",c)}return null}t.genFileUniqueName=n;async function r({parentFolderID:l,name:u},c){try{const p=await(await fetch("/workspace/file/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:wr(l??"",u+".json"),newName:c})})).json();return p.error?(alert("Error rename file: "+p.error),!1):!0}catch(f){console.error("Error deleting file:",f)}}t.renameWorkflow=r;async function o(l){const u=l.json,c=JSON.parse(u);c.extra[Nr]={id:l.id};const p=await(await fetch("/workspace/file/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:bo(l),json:JSON.stringify(c)})})).json();if(p.error)throw console.error("Error saving file:",p.error),alert(`"Error saving file: ${p.error}
      
      👉Please try "Save as" from "Files" dropdown menu
      `),new Error(p.error);return p}t.saveWorkflow=o;async function s(l){try{return await(await fetch("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:bo(l),deleteEmptyFolder:!1})})).text()}catch(u){alert("Error deleting workflow .json file: "+u),console.error("Error deleting file:",u)}}t.deleteWorkflow=s;async function i({parentFolderID:l,name:u,json:c,id:f}){var w;let p=JSON.parse(c);p={...p,extra:{[Nr]:{id:f}}};const h={parentFolderPath:Dt(l??""),name:u,json:JSON.stringify(p)};console.log("createWorkflow",h);try{const y=await(await fetch("/workspace/create_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).json();return y.name&&await((w=fe.workflows)==null?void 0:w.update(f,{name:y.name})),y}catch(d){return console.error(`Error creating file <${f}> at "${l}"`,d),alert(`Error creating file <${f}> at "${l}"`),{}}}t.createWorkflow=i;async function a({parentFolderID:l,name:u,id:c}){const f=wr(l??"",u+".json");try{const h=await(await fetch("/workspace/get_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:f,id:c})})).json();return h.error&&(console.error(`Error getting file <${c}> at "${f}"`,h.error),alert({message:`Error getting file <${c}> at "${f}"`,level:"error"})),h}catch(p){return console.error(`Erro finding file <${c}> at "${f}"`,p),{}}}t.getFile=a})(Je||(Je={}));async function fl(t,e=!1,n=!1){try{return await(await fetch("/workspace/file/scan_my_workflows_folder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Dt(t),recursive:e,metaInfoOnly:n})})).json()}catch(r){return console.error("Error scan local new files:",r),[]}}async function yh(t,e){const n=Dt(t??""),o=(await fl(n)).map(async a=>{var c;const l=a.name,u=[n,l].join("/");return vh(a)?{id:Dt(u),name:a.name,parentFolderID:n,type:"folder",createTime:Date.now(),updateTime:Date.now()}:{...await((c=fe.workflows)==null?void 0:c.get(a.id))??{createTime:Date.now(),updateTime:Date.now()},id:a.id,lastSavedJson:a.json??"{}",json:a.json??"{}",name:l.replace(/\.json$/,""),parentFolderID:n,createTime:a.createTime}}),s=await Promise.all(o);fe.workflows.bulkPut(s.filter(a=>!bh(a)));const i=s.filter(a=>a!=null);return ul(i,e??Et.RECENTLY_MODIFIED)}function vh(t){return"type"in t&&t.type==="folder"}const Tr=class Tr extends Zt{constructor(){super("workflows");Oe(this,"_curWorkflow",null)}get curWorkflow(){return this._curWorkflow}static async load(){return new Tr}updateCurWorkflowID(n){if(n==null){this._curWorkflow=null;return}this.get(n).then(r=>{this._curWorkflow=r??null})}updateCurWorkflow(n){this._curWorkflow=n}async latestVersionCheck(){if(this._curWorkflow){const n=await fe.workflows.get(this._curWorkflow.id);return n?(n==null?void 0:n.updateTime)===this._curWorkflow.updateTime:!0}return!0}async listByIndex(n,r){const o=await super.listByIndex(n,r);return await(J==null?void 0:J.getSetting("twoWaySync"))?(await Promise.all(o.map(async a=>await this.get(a.id)))).filter(a=>a!=null):o}async generateUniqueName(n,r){if(await(J==null?void 0:J.getSetting("twoWaySync"))){const l=await Je.genFileUniqueName((n??"Untitled Flow")+".json",r??"");return(l==null?void 0:l.replace(/\.json$/,""))??"Untitled Flow"}let s=n??"Untitled Flow";const a=(await this.listAll()??[]).filter(l=>l.parentFolderID==r).map(l=>l.name);if(a.includes(s)){let l=2,u=!0;for(;u;)a.includes(`${s} ${l}`)?l++:(s=`${s} ${l}`,u=!1)}return s}async createFlow(n){const{id:r,json:o,name:s}=n,i=await this.generateUniqueName(s,n.parentFolderID??void 0),a=r??os(),l=Date.now(),u={...n,id:a,json:o??JSON.stringify(br),name:i,updateTime:l,createTime:l};return await fe.workflows.add(u),this.saveDiskDB(),await(J==null?void 0:J.getSetting("twoWaySync"))?(await Je.createWorkflow(u),await this.get(u.id)):(xn(u),u)}async update(n,r){throw new Error("Method not allowed.")}async updateMetaInfo(n,r){return this._update(n,r)}async _update(n,r){await fe.workflows.update(n,r);const o=await fe.workflows.get(n)??null;return this._curWorkflow&&this._curWorkflow.id===n&&(this._curWorkflow=o),this.saveDiskDB(),o}async updateFolder(n,r){var a;const o=await(J==null?void 0:J.getSetting("twoWaySync")),s=await this.get(n),i=await this.updateMetaInfo(n,r);!i||!s||(o?await Je.moveWorkflow(s,r.parentFolderID):(await xn(i),await _o(s),(i==null?void 0:i.parentFolderID)!=null&&await((a=fe.folders)==null?void 0:a.update(i.parentFolderID,{updateTime:Date.now()}))))}async genLastManualSavedJson(n){const r=await(Te==null?void 0:Te.getLastestByWorkflowID(n));return r==null?void 0:r.json}async updateName(n,r){const o=await this.get(n);return await(J==null?void 0:J.getSetting("twoWaySync"))&&o&&await Je.renameWorkflow(o,r.name+".json"),await this.updateMetaInfo(n,r)}async updateFlow(n,r){const o=await this.get(n,!1);if(o==null)return;const s=JSON.stringify(o.json),i=JSON.stringify(r.json);if(s===i)return;const a=await this._update(n,{updateTime:Date.now(),json:r.json});await(J==null?void 0:J.getSetting("twoWaySync"))?a&&await Je.saveWorkflow(a):a&&await xn(a)}async batchCreateFlows(n=[],r=!1,o){var i,a;const s=[];for(const l of n){const u=l.name&&r?l.name:await this.generateUniqueName(l.name,o),c=os(),f=Date.now(),p={id:c,name:u,json:l.json,parentFolderID:o,updateTime:f,createTime:f,tags:[]};if(s.push(p),await(J==null?void 0:J.getSetting("twoWaySync")))try{const w=JSON.parse(l.json),d=(a=(i=w==null?void 0:w.extra)==null?void 0:i[Nr])==null?void 0:a.id;d&&(await this.get(d)||(p.id=d)),Je.createWorkflow(p)}catch(w){console.error("batchCreateFlows error",w)}else await xn(p)}try{await fe.workflows.bulkAdd(s),this.saveDiskDB()}catch(l){console.error("batchCreateFlows error",l)}}async deleteFlow(n){const r=await this.get(n);r&&(await(J==null?void 0:J.getSetting("twoWaySync"))?await Je.deleteWorkflow(r):_o({...r})),await fe.workflows.delete(n),this.saveDiskDB()}async batchDeleteFlow(n){const r=await fe.workflows.bulkGet(n);for(const o of r){if(!o)return;await(J==null?void 0:J.getSetting("twoWaySync"))?await Je.deleteWorkflow(o):_o({...o})}await fe.workflows.bulkDelete(n),this.saveDiskDB()}async listFolderContent(n,r){if(await(J==null?void 0:J.getSetting("twoWaySync")))return await yh(n??null);const s=await this.listAll().then(l=>l.filter(u=>u.parentFolderID==n))??[],i=await(Le==null?void 0:Le.listAll().then(l=>l.filter(u=>u.parentFolderID==n)))??[],a=[...s,...i];return ul(a,r??Et.RECENTLY_MODIFIED)}async get(n,r=!0){const o=await(J==null?void 0:J.getSetting("twoWaySync")),s=await fe.workflows.get(n);if(!o||!r)return s;if(s==null)return;const i=await Je.getFile({parentFolderID:s.parentFolderID??null,name:s.name,id:s.id});if(i.json)return{...s,json:JSON.stringify(i.json)}}};Oe(Tr,"TABLE_NAME","workflows");let is=Tr;const Br=class Br extends Zt{constructor(){super("folders")}static async load(){return new Br}async create(e){const n=await this.generateUniqueName(e.name,e.parentFolderID),r=await(J==null?void 0:J.getSetting("twoWaySync")),o=await Ct.genFolderRelPath({name:n,parentFolderID:e.parentFolderID??""}),s={id:r?o:Fn(),name:n,parentFolderID:e.parentFolderID??null,updateTime:Date.now(),createTime:Date.now(),type:"folder"};return r?await Ct.createFolder(s):(await fe.folders.add(s),this.saveDiskDB()),s}async update(e,n){if(await(J==null?void 0:J.getSetting("twoWaySync")))return"parentFolderID"in n&&await Ct.moveFolder(e,n.parentFolderID??""),"name"in n&&await Ct.renameFolder(e,n.name??""),null;const o=await this.get(e);if(o==null)return null;const s="name"in n&&n.name!=o.name,i="parentFolderID"in n&&n.parentFolderID!=o.parentFolderID,a={...o,...n};return n.name!=null&&(a.updateTime=Date.now()),i&&(n.name=await this.generateUniqueName(a.name,a.parentFolderID??void 0)),await fe.folders.update(e,n),this.saveDiskDB(),(s||i)&&cl(!0),a}async deleteFolder(e,n=gr.DELETE){if(await(J==null?void 0:J.getSetting("twoWaySync"))){await fl(e,!0,!0).then(a=>{a.forEach(l=>{l.type==="workflow"&&(console.log("delete workflow",l),V==null||V.deleteFlow(l.id))})}),await Ct.deleteFolder(e);return}const o=await(V==null?void 0:V.listAll())??[],s=await this.listAll(),i=[e];for(;i.length>0;){const a=i.shift();if(a){for(const u of o)if(u.parentFolderID===a)switch(n){case gr.DELETE:await(V==null?void 0:V.deleteFlow(u.id));break;case gr.MOVE_TO_ROOT_FOLDER:await(V==null?void 0:V.updateFolder(u.id,{parentFolderID:void 0}));break}await fe.folders.delete(a);const l=s.filter(u=>u.parentFolderID===a).map(u=>u.id);l.length&&i.push(...l)}}this.saveDiskDB()}async generateUniqueName(e,n){if(await(J==null?void 0:J.getSetting("twoWaySync")))return await Je.genFileUniqueName(e??"New folder",n??"")??"New folder";let o=e??"New folder";const s=await this.listAll().then(i=>i.filter(a=>a.parentFolderID==n).map(a=>a.name));if(s.includes(o)){let i=2,a=!0;for(;a;)s.includes(`${o} ${i}`)?i++:(o=`${o} ${i}`,a=!1)}return o}};Oe(Br,"TABLE_NAME","folders");let ls=Br;class hl extends Zt{constructor(){super("media")}async listByWorkflowID(e){return await fe.media.where("workflowID").equals(e).reverse().sortBy("createTime")}async create(e){const n=e.localPath.split(".").pop();if(n==null)return null;const r={id:Fn(),localPath:e.localPath,workflowID:e.workflowID,createTime:Date.now(),format:n},o=await(V==null?void 0:V.get(e.workflowID)),s=new Set((o==null?void 0:o.mediaIDs)??[]).add(r.id);return await(V==null?void 0:V.updateMetaInfo(e.workflowID,{mediaIDs:Array.from(s),coverMediaPath:r.localPath})),fe.media.add(r),this.saveDiskDB(),r}}Oe(hl,"TABLE_NAME","media");const Mp=["Checkpoint","TextualInversion","Hypernetwork","LORA","Controlnet","Upscaler","VAE"],gh={Checkpoint:"checkpoints",TextualInversion:"embeddings",Hypernetwork:"hypernetworks",LORA:"loras",Controlnet:"controlnet",Upscaler:"upscale_models",VAE:"vae"};function zp(t){return t.modelVersions!==void 0}function wh(t){var e;return((e=t.files)==null?void 0:e[0])!==void 0}function Lp(t,e){var r,o,s,i,a,l;if(!t)return;let n;return wh(t)?n={id:t.id,SHA256:(o=(r=t.files)==null?void 0:r[0].hashes)==null?void 0:o.SHA256,name:(s=t.files)==null?void 0:s[0].name,sizeKB:(a=(i=t.files)==null?void 0:i[0])==null?void 0:a.sizeKB}:n={id:t.id,SHA256:(l=t.hashes)==null?void 0:l[2],name:`${e} ${t.name}`},n}const Mr=class Mr extends Zt{constructor(){super("userSettings");Oe(this,"defaultSettings");Oe(this,"DEFAULT_USER","guest");Oe(this,"_autoSave",!1);this.defaultSettings={id:this.DEFAULT_USER,topBarStyle:{top:0,left:0},modelManagerTopBarStyle:{top:0,right:0},myWorkflowsDir:"",shortcuts:{save:"Shift+S",saveAs:"Control+Alt+S"},defaultFolders:gh,autoSave:!0,twoWaySync:!1,foldersOnTop:!1,cloudHost:"https://www.comfyspace.art",overwriteCurWorkflowWhenDroppingFileToCanvas:!1}}get autoSave(){return this._autoSave}__TEMP_OVERRIDE_ONLY_disableAutoSave(){this._autoSave&&(this._autoSave=!1,setTimeout(async()=>{this._autoSave=await this.getSetting("autoSave")??this.defaultSettings.autoSave??!0},3e3))}async getSetting(n){const r=await this.get(this.DEFAULT_USER);return(r==null?void 0:r[n])??this.defaultSettings[n]}async upsert(n){const o={...await this.get(this.DEFAULT_USER)??this.defaultSettings,...n};await this.put(o),Object.hasOwn(n,"autoSave")&&n.autoSave!==void 0&&(this._autoSave=n.autoSave)}static async load(){const n=new Mr,r=await cf();return n.defaultSettings.myWorkflowsDir=r,await n.getSetting("autoSave").then(o=>{n._autoSave=o??!0}),n}};Oe(Mr,"TABLE_NAME","userSettings");let cs=Mr;const zr=class zr extends Zt{constructor(){super("tags")}static async load(){return new zr}};Oe(zr,"TABLE_NAME","tags");let us=zr;const Lr=class Lr extends Zt{constructor(){super("workflowVersions")}static async load(){return new Lr}async listByWorkflowID(e){return await fe[this.tableName].where("workflowID").equals(e).reverse().sortBy("createTime")??[]}async getLatestByWorkflowID(e){const n=await this.listByWorkflowID(e);return n!=null&&n.length?n[0]:null}};Oe(Lr,"TABLE_NAME","workflowVersions");let ds=Lr;function bh(t){return"type"in t&&t.type==="folder"}let V=null,_r=null,J=null,Le=null,Te=null,Kt=null,xe=null;async function _h(){const t=async()=>{V=await is.load()},e=async()=>{_r=await us.load()},n=async()=>{J=await cs.load()},r=async()=>{Le=await ls.load()},o=async()=>{Te=await ss.load()},s=async()=>{Kt=new hl},i=async()=>{xe=await ds.load()};await Promise.all([t(),e(),n(),r(),o(),s(),i()]),localStorage.getItem("WORKSPACE_INDEXDB_BACKFILL")!=="true"&&(await xh(),localStorage.setItem("WORKSPACE_INDEXDB_BACKFILL","true"))}async function xh(){const t=async()=>{try{const a=await(V==null?void 0:V.getRecords());a&&await fe.workflows.bulkPut(Object.values(a))}catch(a){console.error(a)}},e=async()=>{try{const a=await(Le==null?void 0:Le.getRecords());a&&await fe.folders.bulkPut(Object.values(a))}catch(a){console.error(a)}},n=async()=>{try{const a=await(Kt==null?void 0:Kt.getRecords());a&&await fe.media.bulkPut(Object.values(a))}catch(a){console.error(a)}},r=async()=>{try{const a=await(Te==null?void 0:Te.getRecords());a&&await fe.changelogs.bulkPut(Object.values(a))}catch(a){console.error(a)}},o=async()=>{try{const a=await(_r==null?void 0:_r.getRecords());a&&await fe.tags.bulkPut(Object.values(a))}catch(a){console.error(a)}},s=async()=>{try{const a=J,l=await a.getRecords().then(u=>u[a.DEFAULT_USER]?u[a.DEFAULT_USER]:u);await fe.userSettings.put({...a.defaultSettings,...l})}catch(a){console.error(a)}},i=async()=>{try{const a=await(xe==null?void 0:xe.getRecords());a&&await fe.workflowVersions.bulkPut(Object.values(a))}catch(a){console.error(a)}};await Promise.all([t(),e(),n(),r(),o(),s(),i()])}const wt=j.createContext({curFlowID:null,loadWorkflowID:()=>{},saveCurWorkflow:()=>{},discardUnsavedChanges:async()=>{},isDirty:!1,loadNewWorkflow:()=>{},loadFilePath:()=>{},setRoute:()=>{},route:"root",jsonDiff:null,compareJson:()=>{},curVersion:null}),Wp=j.createContext({refreshFolderStamp:0,setRefreshFolderStamp:()=>{}}),xo={x:0,y:0};function kh({children:t,onDragEnd:e,dragIconId:n}){const r=j.useRef(xo),o=j.useRef(!1),[s,i]=j.useState(xo),a=f=>{var p,h,w;if(!(!(f.target instanceof Element)||!(f.target.parentNode instanceof Element))&&[(p=f.target)==null?void 0:p.id,(w=(h=f.target)==null?void 0:h.parentNode)==null?void 0:w.id].includes(n)){r.current={x:f.clientX,y:f.clientY},o.current=!0,window.addEventListener("mousemove",l),window.addEventListener("mouseup",u);const d=document.getElementsByTagName("body")[0];d.style.userSelect="none"}},l=j.useCallback(f=>{const p={x:f.clientX-r.current.x,y:f.clientY-r.current.y};i(p)},[]),u=j.useCallback(()=>{i(p=>(setTimeout(()=>{e(p)},0),xo)),o.current=!1;const f=document.getElementsByTagName("body")[0];f.style.userSelect="auto",window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",u)},[e,l]),c={transform:`translate(${s.x}px, ${s.y}px)`,zIndex:o.current?1e3:1};return I.jsx("div",{style:c,onMouseDown:a,children:t})}var Eh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},Ch=Object.defineProperty,Sh=Object.defineProperties,Ih=Object.getOwnPropertyDescriptors,Fr=Object.getOwnPropertySymbols,pl=Object.prototype.hasOwnProperty,ml=Object.prototype.propertyIsEnumerable,Da=(t,e,n)=>e in t?Ch(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pa=(t,e)=>{for(var n in e||(e={}))pl.call(e,n)&&Da(t,n,e[n]);if(Fr)for(var n of Fr(e))ml.call(e,n)&&Da(t,n,e[n]);return t},Oh=(t,e)=>Sh(t,Ih(e)),Dh=(t,e)=>{var n={};for(var r in t)pl.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Fr)for(var r of Fr(t))e.indexOf(r)<0&&ml.call(t,r)&&(n[r]=t[r]);return n},Fe=(t,e,n)=>{const r=j.forwardRef((o,s)=>{var i=o,{color:a="currentColor",size:l=24,stroke:u=2,children:c}=i,f=Dh(i,["color","size","stroke","children"]);return j.createElement("svg",Pa(Oh(Pa({ref:s},Eh),{width:l,height:l,stroke:a,strokeWidth:u,className:`tabler-icon tabler-icon-${t}`}),f),[...n.map(([p,h])=>j.createElement(p,h)),...c||[]])});return r.propTypes={color:At.string,size:At.oneOfType([At.string,At.number]),stroke:At.oneOfType([At.string,At.number])},r.displayName=`${e}`,r},Ph=Fe("arrow-back-up-double","IconArrowBackUpDouble",[["path",{d:"M13 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M8 14l-4 -4l4 -4",key:"svg-1"}],["path",{d:"M9 10h7a4 4 0 1 1 0 8h-1",key:"svg-2"}]]),jh=Fe("chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),fs=Fe("device-floppy","IconDeviceFloppy",[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]]),Ah=Fe("download","IconDownload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 11l5 5l5 -5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]),Nh=Fe("external-link","IconExternalLink",[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]]),Fh=Fe("folder","IconFolder",[["path",{d:"M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2",key:"svg-0"}]]),Rh=Fe("grip-vertical","IconGripVertical",[["path",{d:"M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}],["path",{d:"M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-4"}],["path",{d:"M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-5"}]]),Th=Fe("history","IconHistory",[["path",{d:"M12 8l0 4l2 2",key:"svg-0"}],["path",{d:"M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5",key:"svg-1"}]]),Bh=Fe("link","IconLink",[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]]),yl=Fe("lock","IconLock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]),Mh=Fe("photo","IconPhoto",[["path",{d:"M15 8h.01",key:"svg-0"}],["path",{d:"M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z",key:"svg-1"}],["path",{d:"M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5",key:"svg-2"}],["path",{d:"M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3",key:"svg-3"}]]),zh=Fe("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),Lh=Fe("share-2","IconShare2",[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]]),Wh=Fe("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]),vl=Fe("triangle-inverted-filled","IconTriangleInvertedFilled",[["path",{d:"M20.118 3h-16.225a2.914 2.914 0 0 0 -2.503 4.371l8.116 13.549a2.917 2.917 0 0 0 4.987 .005l8.11 -13.539a2.914 2.914 0 0 0 -2.486 -4.386z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}]]),Uh=Fe("versions","IconVersions",[["path",{d:"M10 5m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 7l0 10",key:"svg-1"}],["path",{d:"M4 8l0 8",key:"svg-2"}]]),Kh=Fe("world","IconWorld",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]]),$h=Fe("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);function qh(t){const{promptMessage:e="Are you sure you want to delete this?",variant:n="ghost",onDelete:r,isDisabled:o=!1,tooltipText:s}=t;return I.jsx(vi,{isLazy:!0,placement:"auto",children:({onClose:i})=>I.jsxs(I.Fragment,{children:[I.jsx(yi,{children:I.jsx(pt,{children:I.jsx(zt,{hasArrow:!0,label:s,placement:"bottom",children:I.jsx(jn,{"aria-label":"Delete confirm",size:"sm",icon:I.jsx(Wh,{color:"#F56565"}),isDisabled:o,variant:n})})})}),I.jsxs(xi,{children:[I.jsx(gi,{}),I.jsx(bi,{onClick:i}),I.jsxs(wi,{children:[I.jsx(Bt,{mb:4,pr:4,fontWeight:600,children:e}),I.jsx(Ue,{colorScheme:"red",size:"sm",onClick:()=>{r(),i()},children:"Yes, delete"})]})]})]})})}function Hh({onClose:t}){Ma();const{curFlowID:e,isDirty:n,loadWorkflowID:r}=j.useContext(wt),[o,s]=j.useState(0),[i,a]=j.useState(null),[l,u]=j.useState([]),[c,f]=j.useState([]),p=async d=>{var x;const y=await(V==null?void 0:V.get(d)),m=await(Te==null?void 0:Te.listByWorkflowID(d));u(m??[]);const g=m==null?void 0:m.filter(E=>E.json===(y==null?void 0:y.json)),_=(x=g==null?void 0:g[0])==null?void 0:x.id;_&&a(_)},h=async()=>{var _;const d=await(xe==null?void 0:xe.listByWorkflowID(e))??[];f(d);const y=JSON.stringify(be.graph.serialize()),m=d==null?void 0:d.filter(x=>x.json===y),g=(_=m==null?void 0:m[0])==null?void 0:_.id;g&&a(g)},w=d=>{xe==null||xe.delete(d).then(()=>{h()})};return j.useEffect(()=>{switch(o){case 0:h();break;case 1:p(e);break}},[o]),j.useEffect(()=>(be.canvasEl.addEventListener("click",t),()=>{be.canvasEl.removeEventListener("click",t)}),[o]),I.jsxs(nc,{width:400,height:"100vh",gap:0,position:"fixed",top:0,left:0,zIndex:1e3,children:[I.jsx(tc,{pb:1,mb:0,children:I.jsxs(kn,{justifyContent:"space-between",alignItems:"center",children:[I.jsx(xs,{size:"md",children:"Version History"}),I.jsx(jn,{size:"sm",icon:I.jsx($h,{}),onClick:t,variant:"ghost","aria-label":"close version history"})]})}),I.jsx(ec,{overflowY:"auto",gap:0,children:I.jsxs(Ci,{isFitted:!0,variant:"enclosed",onChange:s,colorScheme:"teal",children:[I.jsxs(Si,{mb:"1em",children:[I.jsx(Po,{children:"Versions"}),I.jsx(Po,{children:"Change History"})]}),I.jsxs(Ii,{children:[I.jsx(Do,{children:I.jsx(tn,{divider:I.jsx(Co,{}),spacing:2,children:c==null?void 0:c.map(d=>I.jsxs(kn,{w:"100%",mb:1,justify:"space-between",backgroundColor:d.id===i?"teal.300":void 0,borderRadius:4,children:[I.jsxs(tn,{textAlign:"left",gap:0,children:[I.jsx(Bt,{fontWeight:"500",children:d.name??"untitled"}),I.jsxs(Bt,{color:"GrayText",fontSize:"sm",children:["Created: ",as(d.createTime)]})]}),I.jsxs(kn,{alignItems:"center",gap:2,children:[I.jsx(Ue,{size:"sm",onClick:()=>{if(n){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}be.loadGraphData(JSON.parse(d.json)),r(e,d.id),t()},children:"Load"}),I.jsx(qh,{promptMessage:"Are you sure you want to delete this version?",onDelete:()=>{w(d.id)}})]})]},d.id))})}),I.jsxs(Do,{children:[I.jsx(Bt,{mb:4,children:"All the saved changes of this workflow"}),I.jsx(tn,{divider:I.jsx(Co,{}),spacing:2,children:l==null?void 0:l.map(d=>I.jsxs(Ue,{size:"sm",variant:"ghost",onClick:()=>{if(n){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}be.loadGraphData(JSON.parse(d.json)),V==null||V.updateFlow(e,{json:d.json}),t()},isActive:d.id===i,children:["Saved at ",as(d.createTime,!0)]},d.id))})]})]})]})})]})}function Vh({workflowId:t,onClose:e}){const[n,r]=j.useState(""),[o,s]=j.useState(""),i=l=>{r(l.target.value),o&&s("")},a=async()=>{const l=n.trim();if(r(l),(await(xe==null?void 0:xe.listByWorkflowID(t))??[]).some(c=>c.name===l))s("The name is duplicated, please modify it and submit again.");else{const c=JSON.stringify(be.graph.serialize());await(xe==null?void 0:xe.add({name:n,workflowID:t,createTime:Date.now(),json:c})),e()}};return I.jsxs($r,{isOpen:!0,onClose:e,children:[I.jsx(ms,{}),I.jsxs(qr,{children:[I.jsx(ys,{children:"Create Version"}),I.jsx(vs,{}),I.jsx(gs,{children:I.jsxs(Vr,{isInvalid:!!o,children:[I.jsx(Gr,{children:"Name"}),I.jsx(Un,{value:n,onChange:i,autoFocus:!0,onKeyUp:l=>{l.code==="Enter"&&!o&&n&&a()}}),o&&I.jsx(Zr,{children:o})]})}),I.jsxs(ws,{children:[I.jsx(Ue,{colorScheme:"teal",mr:3,onClick:a,isDisabled:!n||!!o,children:"Create"}),I.jsx(Ue,{onClick:e,children:"Cancel"})]})]})]})}function Zh({options:t,menuButton:e,isOpen:n,onClose:r}){const o=j.useRef(null);return Ic({ref:o,handler:()=>r()}),I.jsxs(pt,{position:"relative",children:[I.jsx(pt,{children:e}),n&&I.jsx(pt,{ref:o,mt:"8px",shadow:"md",p:"2",position:"absolute",zIndex:"dropdown",children:t})]})}function Gh({menuButton:t,menuContent:e,onClose:n}){const r=j.useRef(),[o,s]=j.useState(!1),i=()=>{r.current=setTimeout(()=>s(!1),400)},a=()=>{s(!0),clearTimeout(r.current),r.current=void 0};return I.jsx(Zh,{isOpen:o,onClose:i,menuButton:I.jsx(pt,{"aria-label":"menu",onClick:a,onMouseEnter:a,onMouseLeave:i,children:t}),options:I.jsx(Ns,{isOpen:!0,children:I.jsx(Fs,{minWidth:150,zIndex:1e3,onMouseEnter:a,onMouseLeave:i,children:e})})})}function Jh(){const{jsonDiff:t,compareJson:e}=j.useContext(wt);return t==null?null:I.jsx($r,{isOpen:!0,onClose:()=>{e(null)},children:I.jsx(qr,{children:I.jsx(pt,{height:"80vh",width:"90%",overflow:"scroll"})})})}const Yh=j.lazy(()=>Hr(()=>import("./ShareDialog-0cQf3wfl.js"),__vite__mapDeps([0,1,2,3,4])));function Xh(){const{curFlowID:t,loadWorkflowID:e,discardUnsavedChanges:n,saveCurWorkflow:r,setRoute:o,route:s}=j.useContext(wt),[i,a]=j.useState(!1),[l,u]=j.useState(""),[c,f]=j.useState(""),[p,h]=j.useState(),[w,d]=j.useState({save:"",saveAs:""}),[y,m]=j.useState(!1);j.useEffect(()=>{t&&(V==null||V.get(t).then(S=>{u((S==null?void 0:S.name)??""),h(S)})),J==null||J.getSetting("shortcuts").then(S=>{d(S)})},[t]);const g=S=>{u(S.target.value),c&&f("")},_=async()=>{if(!t){alert("Flow ID is required");return}const S=JSON.stringify(be.graph.serialize()),k=await(V==null?void 0:V.createFlow({json:S,lastSavedJson:S,name:l,parentFolderID:p==null?void 0:p.parentFolderID}));k&&await e(k.id,null,!0),x()},x=()=>{o("root")},E=j.useCallback(async()=>{const S=t?await(V==null?void 0:V.get(t)):null;if(!S){alert("Workspace does not exist");return}const k=new Blob([S.json],{type:"application/json"}),N=URL.createObjectURL(k),D=document.createElement("a");D.href=N,D.download=`${S.name}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(N)},[t]);return I.jsxs(I.Fragment,{children:[I.jsx(Gh,{menuButton:I.jsx(Ra,{children:I.jsxs(Ue,{px:1,height:"29px","aria-label":"menu",size:"sm",backgroundColor:"teal.600",children:["File",I.jsx(jh,{size:20})]})}),menuContent:I.jsx(Ns,{isOpen:!0,children:I.jsxs(Fs,{minWidth:150,zIndex:1e3,children:[I.jsx(bt,{onClick:r,icon:I.jsx(fs,{size:20}),iconSpacing:1,command:w.save,children:"Save"}),I.jsx(zt,{label:"Revert workflow to your last saved version. You will lose all changes made since your last save.",children:I.jsx(bt,{onClick:n,icon:I.jsx(Ph,{size:20}),iconSpacing:1,children:"Discard unsaved changes"})}),I.jsx(bt,{onClick:E,icon:I.jsx(Ah,{size:20}),iconSpacing:1,children:"Download"}),I.jsx(bt,{onClick:()=>o("saveAsModal"),icon:I.jsx(fs,{size:20}),iconSpacing:1,command:w.saveAs,children:"Save As"}),I.jsx(bt,{onClick:()=>a(!0),icon:I.jsx(Uh,{size:20}),iconSpacing:1,children:"Create Version"}),I.jsx(bt,{onClick:()=>o("versionHistory"),icon:I.jsx(Th,{size:20}),iconSpacing:1,children:"Versions History"}),I.jsx(bt,{onClick:()=>m(!0),icon:I.jsx(Lh,{size:20}),iconSpacing:1,alignItems:"center",children:I.jsxs(Ft,{children:[I.jsx("p",{children:"Share"})," ",I.jsx(Rs,{size:"sm",children:"🧪🧪beta"})]})})]})})}),y&&I.jsx(Yh,{onClose:()=>m(!1)}),s=="versionHistory"&&I.jsx(Hh,{onClose:()=>o("root")}),I.jsx(Jh,{}),s==="saveAsModal"&&I.jsxs($r,{isOpen:!0,onClose:x,children:[I.jsx(ms,{}),I.jsxs(qr,{children:[I.jsx(ys,{children:"Save As"}),I.jsx(vs,{}),I.jsx(gs,{children:I.jsxs(Vr,{isInvalid:!!c,children:[I.jsx(Gr,{children:"Workflow name"}),I.jsx(Un,{value:l,onChange:g,autoFocus:!0,onKeyUp:S=>{S.code==="Enter"&&!c&&l&&_()}}),c&&I.jsx(Zr,{children:c})]})}),I.jsxs(ws,{children:[I.jsx(Ue,{colorScheme:"teal",mr:3,onClick:_,isDisabled:!l||!!c,children:"Save"}),I.jsx(Ue,{onClick:x,children:"Cancel"})]})]})]}),i&&I.jsx(Vh,{workflowId:t,onClose:()=>a(!1)})]})}function Qh({displayName:t,updateFlowName:e,isDirty:n}){const{isOpen:r,onOpen:o,onClose:s}=Pc(),{curFlowID:i}=j.useContext(wt),[a,l]=j.useState(t),[u,c]=j.useState(""),f=()=>{l(t),o()},p=d=>{l(d.target.value),u&&c("")},h=async()=>{var d;if(i){const y=a.trim();if(l(y),t===y)return w();await(V==null?void 0:V.generateUniqueName(y,((d=V.curWorkflow)==null?void 0:d.parentFolderID)??""))!==y?c("The name is duplicated, please modify it and submit again."):(await(V==null?void 0:V.updateName(i,{name:y})),e(y),w())}},w=()=>{c(""),s()};return i==null?null:I.jsxs(Ft,{children:[I.jsx(zt,{label:t,placement:"bottom",children:I.jsxs(Bt,{as:"div",color:"white",onClick:f,maxW:200,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:[I.jsx("div",{style:{width:8,display:"inline-block"},children:I.jsx(Bt,{as:"span",children:n&&"* "})}),t]})}),I.jsxs($r,{isOpen:r,onClose:w,children:[I.jsx(ms,{}),I.jsxs(qr,{children:[I.jsx(ys,{children:"Edit workflow name"}),I.jsx(vs,{}),I.jsx(gs,{children:I.jsxs(Vr,{isInvalid:!!u,children:[I.jsx(Gr,{children:"Workflow name"}),I.jsx(Un,{value:a,onChange:p,autoFocus:!0,onKeyUp:d=>{d.code==="Enter"&&!u&&a&&h()}}),u&&I.jsx(Zr,{children:u})]})}),I.jsxs(ws,{children:[I.jsx(Ue,{colorScheme:"teal",mr:3,onClick:h,isDisabled:!a||!!u,children:"Save"}),I.jsx(Ue,{onClick:w,children:"Cancel"})]})]})]})]})}function Up(t){const e=new Uint8Array(t);return window.crypto.getRandomValues(e),Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}const Kp=[{label:"Private",value:"PRIVATE",icon:I.jsx(yl,{})},{label:"Unlisted, anyone with the link can view",value:"UNLISTED",icon:I.jsx(Bh,{})},{label:"Public",value:"PUBLIC",icon:I.jsx(Kh,{})}],$p=()=>{const t=be.graph._nodes,e={};for(let n of t)if(n.type in LiteGraph.registered_node_types){const r=structuredClone(LiteGraph.registered_node_types[n.type].nodeData);if(r==null)continue;for(let o in r.input){const s=r.input[o];for(let i in s){const a=s[i];Array.isArray(a[0])&&(a[0]=["value_1","value_2"])}}e[n.type]=r}return e};async function ep(t){const e=t.cloudOrigin;if(!e)throw Error("cloudURL is required");return fetch(e+`/api/getWorkflow?id=${t.cloudID}`).then(n=>n.json()).then(n=>{var o;return((o=n.data)==null?void 0:o.privacy)??"PRIVATE"})}function tp({privacy:t,showEmoji:e=!1}){let n;return t==="PRIVATE"?(n="Private",e&&(n="🔒 Private")):t==="UNLISTED"?(n="Unlisted",e&&(n="🔗 Unlisted")):t==="PUBLIC"&&(n="Public",e&&(n="🌐 Public")),I.jsx("span",{children:n})}function np({}){const[t,e]=j.useState(),[n,r]=j.useState(),{curFlowID:o}=j.useContext(wt);return j.useEffect(()=>{o&&(V==null||V.get(o).then(s=>{s!=null&&s.cloudID?(e(s.cloudOrigin+"/workflow/"+s.cloudID),ep(s).then(i=>{r(i)})):e(void 0)}))},[o]),t?I.jsx("a",{href:t,style:{textDecoration:"none"},target:"_blank",children:I.jsx(Ra,{children:I.jsx(Rs,{children:n?I.jsx(tp,{privacy:n,showEmoji:!0}):"Shared"})})}):null}function rp({}){const{route:t,setRoute:e,curVersion:n}=j.useContext(wt);return n?I.jsx(kn,{alignItems:"center",children:I.jsx(Ua,{size:"sm",isAttached:!0,variant:"outline",children:I.jsx(Ue,{rightIcon:I.jsx(vl,{size:10}),onClick:()=>e("versionHistory"),children:(n==null?void 0:n.name)??"latest*"})})}):null}function op({curFlowName:t,setCurFlowName:e}){var c;const{isDirty:n,loadNewWorkflow:r,saveCurWorkflow:o,setRoute:s,curFlowID:i}=j.useContext(wt),[a,l]=j.useState(),u=j.useCallback((f,p=!1)=>{const{top:h=0,left:w=0}=a||{};let{top:d=0,left:y=0}=f??{};d+=h,y+=w;const m=document.documentElement.clientWidth,g=document.documentElement.clientHeight,_=document.getElementById("workspaceManagerPanel"),x=(_==null?void 0:_.offsetWidth)||392;d+36>g&&(d=g-36),y+x>=m&&(y=m-x),l({top:Math.max(0,d),left:Math.max(0,y)}),p&&(J==null||J.upsert({topBarStyle:{top:d,left:y}}))},[a]);return j.useEffect(()=>{J==null||J.getSetting("topBarStyle").then(f=>{u(f,!1)})},[]),a?I.jsx(kh,{onDragEnd:f=>{u({top:f.y,left:f.x},!0)},dragIconId:"dragPanelIcon",children:I.jsxs(Ft,{style:{padding:2,position:"fixed",...a},justifyContent:"space-between",alignItems:"center",gap:2,draggable:!1,id:"workspaceManagerPanel",className:"workspaceManagerPanel",children:[I.jsx(Ue,{size:"sm","aria-label":"workspace folder",onClick:()=>s("recentFlows"),px:2,children:I.jsxs(Ft,{gap:1,children:[I.jsx(Fh,{size:21}),I.jsx(vl,{size:8})]})}),I.jsx(zt,{label:"New workflow",children:I.jsx(Ue,{size:"sm",variant:"outline",colorScheme:"teal","aria-label":"new workflow",onClick:()=>r(),px:2,py:2,children:I.jsx(Ft,{gap:0,children:I.jsx(zh,{size:16,color:"white"})})})}),I.jsx(Qh,{isDirty:n,displayName:t??"",updateFlowName:f=>{e(f),requestAnimationFrame(()=>{u()})}}),((c=V==null?void 0:V.curWorkflow)==null?void 0:c.saveLock)&&I.jsx(yl,{color:"#FFF",size:20}),i&&I.jsxs(Ft,{gap:"4px",children:[I.jsx(zt,{label:"Open gallery",children:I.jsx(jn,{onClick:()=>s("gallery"),icon:I.jsx(Mh,{size:22,color:"white"}),size:"sm","aria-label":"open gallery",variant:"ghost"})}),I.jsx(Xh,{})]}),i&&n?I.jsx(zt,{label:"Save workflow",children:I.jsx(jn,{onClick:o,icon:I.jsx(fs,{size:23,color:"white"}),size:"xs",paddingY:4,"aria-label":"save workspace",variant:"ghost"})}):I.jsx("div",{style:{width:1}}),I.jsx(np,{}),I.jsx(rp,{}),I.jsx(Rh,{id:"dragPanelIcon",className:"dragPanelIcon",cursor:"move",size:15,color:"#FFF"})]})}):null}function sp(){const{showDialog:t}=Ta(),{loadWorkflowID:e}=j.useContext(wt),n=async(o,s)=>{var u,c;const{workflow:i,version:a}=o.detail;if(!i.id||!a.id)return;const l=(u=await(V==null?void 0:V.listByIndex("cloudID",i.id)))==null?void 0:u.at(0);if(l){const f=(c=await(xe==null?void 0:xe.listByIndex("cloudID",a.id)))==null?void 0:c.at(0);if(f)await e(l.id,f.id);else{const p=await(xe==null?void 0:xe.add({id:a.id,cloudID:a.id,workflowID:l.id,cloudOrigin:s,name:a.name,authorID:a.authorID,json:a.json}));p&&e(l.id,p.id)}}else{const f=await(V==null?void 0:V.createFlow({cloudID:i.id,cloudOrigin:s,name:i.name,json:a.json,updateTime:Date.now()}));if(!f){alert("Failed to add workflow to local db");return}const p=await(xe==null?void 0:xe.put({id:a.id,cloudID:a.id,workflowID:f.id,cloudOrigin:s,name:a.name,json:a.json,authorID:a.authorID,createTime:Date.now()}));await e(f.id,p==null?void 0:p.id)}},r=async o=>{const s=o.data;if(ap(s)){const i=o.origin;t(`Open workflow "${s.detail.workflow.name}", version "${s.detail.version.name}" from ${i}`,[{label:"Open",colorScheme:"teal",onClick:()=>{n(s,i)}}])}};return j.useEffect(()=>{window.opener&&window.opener.postMessage("comfyui_workspace_manager_connected","*"),window.addEventListener("message",r)},[]),null}function ap(t){return t.type==="workspace_open_workflow"}const ip=t=>typeof t=="function",lp=t=>{const[e,n]=j.useState(t),r=j.useRef(e),o=j.useCallback(s=>{r.current=ip(s)?s(r.current):s,n(r.current)},[]);return[e,o,r]};function lr(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var gl={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,o,s){function i(u,c){if(!o[u]){if(!r[u]){var f=typeof lr=="function"&&lr;if(!c&&f)return f(u,!0);if(a)return a(u,!0);var p=new Error("Cannot find module '"+u+"'");throw p.code="MODULE_NOT_FOUND",p}var h=o[u]={exports:{}};r[u][0].call(h.exports,function(w){var d=r[u][1][w];return i(d||w)},h,h.exports,n,r,o,s)}return o[u].exports}for(var a=typeof lr=="function"&&lr,l=0;l<s.length;l++)i(s[l]);return i}({1:[function(n,r,o){var s=n("./utils"),i=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var u,c,f,p,h,w,d,y=[],m=0,g=l.length,_=g,x=s.getTypeOf(l)!=="string";m<l.length;)_=g-m,f=x?(u=l[m++],c=m<g?l[m++]:0,m<g?l[m++]:0):(u=l.charCodeAt(m++),c=m<g?l.charCodeAt(m++):0,m<g?l.charCodeAt(m++):0),p=u>>2,h=(3&u)<<4|c>>4,w=1<_?(15&c)<<2|f>>6:64,d=2<_?63&f:64,y.push(a.charAt(p)+a.charAt(h)+a.charAt(w)+a.charAt(d));return y.join("")},o.decode=function(l){var u,c,f,p,h,w,d=0,y=0,m="data:";if(l.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var g,_=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&_--,l.charAt(l.length-2)===a.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=i.uint8array?new Uint8Array(0|_):new Array(0|_);d<l.length;)u=a.indexOf(l.charAt(d++))<<2|(p=a.indexOf(l.charAt(d++)))>>4,c=(15&p)<<4|(h=a.indexOf(l.charAt(d++)))>>2,f=(3&h)<<6|(w=a.indexOf(l.charAt(d++))),g[y++]=u,h!==64&&(g[y++]=c),w!==64&&(g[y++]=f);return g}},{"./support":30,"./utils":32}],2:[function(n,r,o){var s=n("./external"),i=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function u(c,f,p,h,w){this.compressedSize=c,this.uncompressedSize=f,this.crc32=p,this.compression=h,this.compressedContent=w}u.prototype={getContentWorker:function(){var c=new i(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return c.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new i(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,f,p){return c.pipe(new a).pipe(new l("uncompressedSize")).pipe(f.compressWorker(p)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},r.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,o){var s=n("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},o.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,o){var s=n("./utils"),i=function(){for(var a,l=[],u=0;u<256;u++){a=u;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;l[u]=a}return l}();r.exports=function(a,l){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?function(u,c,f,p){var h=i,w=p+f;u^=-1;for(var d=p;d<w;d++)u=u>>>8^h[255&(u^c[d])];return-1^u}(0|l,a,a.length,0):function(u,c,f,p){var h=i,w=p+f;u^=-1;for(var d=p;d<w;d++)u=u>>>8^h[255&(u^c.charCodeAt(d))];return-1^u}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(n,r,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(n,r,o){var s=null;s=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:s}},{lie:37}],7:[function(n,r,o){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=n("pako"),a=n("./utils"),l=n("./stream/GenericWorker"),u=s?"uint8array":"array";function c(f,p){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=p,this.meta={}}o.magic="\b\0",a.inherits(c,l),c.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(u,f.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(p){f.push({data:p,meta:f.meta})}},o.compressWorker=function(f){return new c("Deflate",f)},o.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,o){function s(h,w){var d,y="";for(d=0;d<w;d++)y+=String.fromCharCode(255&h),h>>>=8;return y}function i(h,w,d,y,m,g){var _,x,E=h.file,S=h.compression,k=g!==u.utf8encode,N=a.transformTo("string",g(E.name)),D=a.transformTo("string",u.utf8encode(E.name)),R=E.comment,H=a.transformTo("string",g(R)),P=a.transformTo("string",u.utf8encode(R)),T=D.length!==E.name.length,b=P.length!==R.length,q="",Q="",A="",te=E.dir,Z=E.date,re={crc32:0,compressedSize:0,uncompressedSize:0};w&&!d||(re.crc32=h.crc32,re.compressedSize=h.compressedSize,re.uncompressedSize=h.uncompressedSize);var L=0;w&&(L|=8),k||!T&&!b||(L|=2048);var B=0,U=0;te&&(B|=16),m==="UNIX"?(U=798,B|=function($,ie){var me=$;return $||(me=ie?16893:33204),(65535&me)<<16}(E.unixPermissions,te)):(U=20,B|=function($){return 63&($||0)}(E.dosPermissions)),_=Z.getUTCHours(),_<<=6,_|=Z.getUTCMinutes(),_<<=5,_|=Z.getUTCSeconds()/2,x=Z.getUTCFullYear()-1980,x<<=4,x|=Z.getUTCMonth()+1,x<<=5,x|=Z.getUTCDate(),T&&(Q=s(1,1)+s(c(N),4)+D,q+="up"+s(Q.length,2)+Q),b&&(A=s(1,1)+s(c(H),4)+P,q+="uc"+s(A.length,2)+A);var K="";return K+=`
\0`,K+=s(L,2),K+=S.magic,K+=s(_,2),K+=s(x,2),K+=s(re.crc32,4),K+=s(re.compressedSize,4),K+=s(re.uncompressedSize,4),K+=s(N.length,2),K+=s(q.length,2),{fileRecord:f.LOCAL_FILE_HEADER+K+N+q,dirRecord:f.CENTRAL_FILE_HEADER+s(U,2)+K+s(H.length,2)+"\0\0\0\0"+s(B,4)+s(y,4)+N+q+H}}var a=n("../utils"),l=n("../stream/GenericWorker"),u=n("../utf8"),c=n("../crc32"),f=n("../signature");function p(h,w,d,y){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=d,this.encodeFileName=y,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(p,l),p.prototype.push=function(h){var w=h.meta.percent||0,d=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,l.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:d?(w+100*(d-y-1))/d:100}}))},p.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var w=this.streamFiles&&!h.file.dir;if(w){var d=i(h,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(h){this.accumulate=!1;var w=this.streamFiles&&!h.file.dir,d=i(h,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),w)this.push({data:function(y){return f.DATA_DESCRIPTOR+s(y.crc32,4)+s(y.compressedSize,4)+s(y.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var h=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var d=this.bytesWritten-h,y=function(m,g,_,x,E){var S=a.transformTo("string",E(x));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(m,2)+s(m,2)+s(g,4)+s(_,4)+s(S.length,2)+S}(this.dirRecords.length,d,h,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(h){this._sources.push(h);var w=this;return h.on("data",function(d){w.processChunk(d)}),h.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),h.on("error",function(d){w.error(d)}),this},p.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(h){var w=this._sources;if(!l.prototype.error.call(this,h))return!1;for(var d=0;d<w.length;d++)try{w[d].error(h)}catch{}return!0},p.prototype.lock=function(){l.prototype.lock.call(this);for(var h=this._sources,w=0;w<h.length;w++)h[w].lock()},r.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,o){var s=n("../compressions"),i=n("./ZipFileWorker");o.generateWorker=function(a,l,u){var c=new i(l.streamFiles,u,l.platform,l.encodeFileName),f=0;try{a.forEach(function(p,h){f++;var w=function(g,_){var x=g||_,E=s[x];if(!E)throw new Error(x+" is not a valid compression method !");return E}(h.options.compression,l.compression),d=h.options.compressionOptions||l.compressionOptions||{},y=h.dir,m=h.date;h._compressWorker(w,d).withStreamInfo("file",{name:p,dir:y,date:m,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(c)}),c.entriesCount=f}catch(p){c.error(p)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,o){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new s;for(var a in this)typeof this[a]!="function"&&(i[a]=this[a]);return i}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(i,a){return new s().loadAsync(i,a)},s.external=n("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,o){var s=n("./utils"),i=n("./external"),a=n("./utf8"),l=n("./zipEntries"),u=n("./stream/Crc32Probe"),c=n("./nodejsUtils");function f(p){return new i.Promise(function(h,w){var d=p.decompressed.getContentWorker().pipe(new u);d.on("error",function(y){w(y)}).on("end",function(){d.streamInfo.crc32!==p.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}r.exports=function(p,h){var w=this;return h=s.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(p)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",p,!0,h.optimizedBinaryString,h.base64).then(function(d){var y=new l(h);return y.load(d),y}).then(function(d){var y=[i.Promise.resolve(d)],m=d.files;if(h.checkCRC32)for(var g=0;g<m.length;g++)y.push(f(m[g]));return i.Promise.all(y)}).then(function(d){for(var y=d.shift(),m=y.files,g=0;g<m.length;g++){var _=m[g],x=_.fileNameStr,E=s.resolve(_.fileNameStr);w.file(E,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:h.createFolders}),_.dir||(w.file(E).unsafeOriginalName=x)}return y.zipComment.length&&(w.comment=y.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,o){var s=n("../utils"),i=n("../stream/GenericWorker");function a(l,u){i.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}s.inherits(a,i),a.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,o){var s=n("readable-stream").Readable;function i(a,l,u){s.call(this,l),this._helper=a;var c=this;a.on("data",function(f,p){c.push(f)||c._helper.pause(),u&&u(p)}).on("error",function(f){c.emit("error",f)}).on("end",function(){c.push(null)})}n("../utils").inherits(i,s),i.prototype._read=function(){this._helper.resume()},r.exports=i},{"../utils":32,"readable-stream":16}],14:[function(n,r,o){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,i);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,i)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var i=new Buffer(s);return i.fill(0),i},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,r,o){function s(E,S,k){var N,D=a.getTypeOf(S),R=a.extend(k||{},c);R.date=R.date||new Date,R.compression!==null&&(R.compression=R.compression.toUpperCase()),typeof R.unixPermissions=="string"&&(R.unixPermissions=parseInt(R.unixPermissions,8)),R.unixPermissions&&16384&R.unixPermissions&&(R.dir=!0),R.dosPermissions&&16&R.dosPermissions&&(R.dir=!0),R.dir&&(E=m(E)),R.createFolders&&(N=y(E))&&g.call(this,N,!0);var H=D==="string"&&R.binary===!1&&R.base64===!1;k&&k.binary!==void 0||(R.binary=!H),(S instanceof f&&S.uncompressedSize===0||R.dir||!S||S.length===0)&&(R.base64=!1,R.binary=!0,S="",R.compression="STORE",D="string");var P=null;P=S instanceof f||S instanceof l?S:w.isNode&&w.isStream(S)?new d(E,S):a.prepareContent(E,S,R.binary,R.optimizedBinaryString,R.base64);var T=new p(E,P,R);this.files[E]=T}var i=n("./utf8"),a=n("./utils"),l=n("./stream/GenericWorker"),u=n("./stream/StreamHelper"),c=n("./defaults"),f=n("./compressedObject"),p=n("./zipObject"),h=n("./generate"),w=n("./nodejsUtils"),d=n("./nodejs/NodejsStreamInputAdapter"),y=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var S=E.lastIndexOf("/");return 0<S?E.substring(0,S):""},m=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},g=function(E,S){return S=S!==void 0?S:c.createFolders,E=m(E),this.files[E]||s.call(this,E,null,{dir:!0,createFolders:S}),this.files[E]};function _(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var S,k,N;for(S in this.files)N=this.files[S],(k=S.slice(this.root.length,S.length))&&S.slice(0,this.root.length)===this.root&&E(k,N)},filter:function(E){var S=[];return this.forEach(function(k,N){E(k,N)&&S.push(N)}),S},file:function(E,S,k){if(arguments.length!==1)return E=this.root+E,s.call(this,E,S,k),this;if(_(E)){var N=E;return this.filter(function(R,H){return!H.dir&&N.test(R)})}var D=this.files[this.root+E];return D&&!D.dir?D:null},folder:function(E){if(!E)return this;if(_(E))return this.filter(function(D,R){return R.dir&&E.test(D)});var S=this.root+E,k=g.call(this,S),N=this.clone();return N.root=k.name,N},remove:function(E){E=this.root+E;var S=this.files[E];if(S||(E.slice(-1)!=="/"&&(E+="/"),S=this.files[E]),S&&!S.dir)delete this.files[E];else for(var k=this.filter(function(D,R){return R.name.slice(0,E.length)===E}),N=0;N<k.length;N++)delete this.files[k[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var S,k={};try{if((k=a.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),k.type==="binarystring"&&(k.type="string"),!k.type)throw new Error("No output type specified.");a.checkSupport(k.type),k.platform!=="darwin"&&k.platform!=="freebsd"&&k.platform!=="linux"&&k.platform!=="sunos"||(k.platform="UNIX"),k.platform==="win32"&&(k.platform="DOS");var N=k.comment||this.comment||"";S=h.generateWorker(this,k,N)}catch(D){(S=new l("error")).error(D)}return new u(S,k.type||"string",k.mimeType)},generateAsync:function(E,S){return this.generateInternalStream(E).accumulate(S)},generateNodeStream:function(E,S){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(S)}};r.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,o){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,o){var s=n("./DataReader");function i(a){s.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}n("../utils").inherits(i,s),i.prototype.byteAt=function(a){return this.data[this.zero+a]},i.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),u=a.charCodeAt(1),c=a.charCodeAt(2),f=a.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===l&&this.data[p+1]===u&&this.data[p+2]===c&&this.data[p+3]===f)return p-this.zero;return-1},i.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),u=a.charCodeAt(1),c=a.charCodeAt(2),f=a.charCodeAt(3),p=this.readData(4);return l===p[0]&&u===p[1]&&c===p[2]&&f===p[3]},i.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=i},{"../utils":32,"./DataReader":18}],18:[function(n,r,o){var s=n("../utils");function i(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,u=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=a,u},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},r.exports=i},{"../utils":32}],19:[function(n,r,o){var s=n("./Uint8ArrayReader");function i(a){s.call(this,a)}n("../utils").inherits(i,s),i.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,o){var s=n("./DataReader");function i(a){s.call(this,a)}n("../utils").inherits(i,s),i.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},i.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},i.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},i.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=i},{"../utils":32,"./DataReader":18}],21:[function(n,r,o){var s=n("./ArrayReader");function i(a){s.call(this,a)}n("../utils").inherits(i,s),i.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,o){var s=n("../utils"),i=n("../support"),a=n("./ArrayReader"),l=n("./StringReader"),u=n("./NodeBufferReader"),c=n("./Uint8ArrayReader");r.exports=function(f){var p=s.getTypeOf(f);return s.checkSupport(p),p!=="string"||i.uint8array?p==="nodebuffer"?new u(f):i.uint8array?new c(s.transformTo("uint8array",f)):new a(s.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,o){var s=n("./GenericWorker"),i=n("../utils");function a(l){s.call(this,"ConvertWorker to "+l),this.destType=l}i.inherits(a,s),a.prototype.processChunk=function(l){this.push({data:i.transformTo(this.destType,l.data),meta:l.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,o){var s=n("./GenericWorker"),i=n("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(a,s),a.prototype.processChunk=function(l){this.streamInfo.crc32=i(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,o){var s=n("../utils"),i=n("./GenericWorker");function a(l){i.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(a,i),a.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}i.prototype.processChunk.call(this,l)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,o){var s=n("../utils"),i=n("./GenericWorker");function a(l){i.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){u.dataIsReady=!0,u.data=c,u.max=c&&c.length||0,u.type=s.getTypeOf(c),u.isPaused||u._tickAndRepeat()},function(c){u.error(c)})}s.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,o){function s(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,a){return this._listeners[i].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,a){if(this._listeners[i])for(var l=0;l<this._listeners[i].length;l++)this._listeners[i][l].call(this,a)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var a=this;return i.on("data",function(l){a.processChunk(l)}),i.on("end",function(){a.end()}),i.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,a){return this.extraStreamInfo[i]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},r.exports=s},{}],29:[function(n,r,o){var s=n("../utils"),i=n("./ConvertWorker"),a=n("./GenericWorker"),l=n("../base64"),u=n("../support"),c=n("../external"),f=null;if(u.nodestream)try{f=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(w,d){return new c.Promise(function(y,m){var g=[],_=w._internalType,x=w._outputType,E=w._mimeType;w.on("data",function(S,k){g.push(S),d&&d(k)}).on("error",function(S){g=[],m(S)}).on("end",function(){try{var S=function(k,N,D){switch(k){case"blob":return s.newBlob(s.transformTo("arraybuffer",N),D);case"base64":return l.encode(N);default:return s.transformTo(k,N)}}(x,function(k,N){var D,R=0,H=null,P=0;for(D=0;D<N.length;D++)P+=N[D].length;switch(k){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(H=new Uint8Array(P),D=0;D<N.length;D++)H.set(N[D],R),R+=N[D].length;return H;case"nodebuffer":return Buffer.concat(N);default:throw new Error("concat : unsupported type '"+k+"'")}}(_,g),E);y(S)}catch(k){m(k)}g=[]}).resume()})}function h(w,d,y){var m=d;switch(d){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=d,this._mimeType=y,s.checkSupport(m),this._worker=w.pipe(new i(m)),w.lock()}catch(g){this._worker=new a("error"),this._worker.error(g)}}h.prototype={accumulate:function(w){return p(this,w)},on:function(w,d){var y=this;return w==="data"?this._worker.on(w,function(m){d.call(y,m.data,m.meta)}):this._worker.on(w,function(){s.delay(d,arguments,y)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},w)}},r.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var s=new ArrayBuffer(0);try{o.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(s),o.blob=i.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!n("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,o){for(var s=n("./utils"),i=n("./support"),a=n("./nodejsUtils"),l=n("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;u[254]=u[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function p(){l.call(this,"utf-8 encode")}o.utf8encode=function(h){return i.nodebuffer?a.newBufferFrom(h,"utf-8"):function(w){var d,y,m,g,_,x=w.length,E=0;for(g=0;g<x;g++)(64512&(y=w.charCodeAt(g)))==55296&&g+1<x&&(64512&(m=w.charCodeAt(g+1)))==56320&&(y=65536+(y-55296<<10)+(m-56320),g++),E+=y<128?1:y<2048?2:y<65536?3:4;for(d=i.uint8array?new Uint8Array(E):new Array(E),g=_=0;_<E;g++)(64512&(y=w.charCodeAt(g)))==55296&&g+1<x&&(64512&(m=w.charCodeAt(g+1)))==56320&&(y=65536+(y-55296<<10)+(m-56320),g++),y<128?d[_++]=y:(y<2048?d[_++]=192|y>>>6:(y<65536?d[_++]=224|y>>>12:(d[_++]=240|y>>>18,d[_++]=128|y>>>12&63),d[_++]=128|y>>>6&63),d[_++]=128|63&y);return d}(h)},o.utf8decode=function(h){return i.nodebuffer?s.transformTo("nodebuffer",h).toString("utf-8"):function(w){var d,y,m,g,_=w.length,x=new Array(2*_);for(d=y=0;d<_;)if((m=w[d++])<128)x[y++]=m;else if(4<(g=u[m]))x[y++]=65533,d+=g-1;else{for(m&=g===2?31:g===3?15:7;1<g&&d<_;)m=m<<6|63&w[d++],g--;1<g?x[y++]=65533:m<65536?x[y++]=m:(m-=65536,x[y++]=55296|m>>10&1023,x[y++]=56320|1023&m)}return x.length!==y&&(x.subarray?x=x.subarray(0,y):x.length=y),s.applyFromCharCode(x)}(h=s.transformTo(i.uint8array?"uint8array":"array",h))},s.inherits(f,l),f.prototype.processChunk=function(h){var w=s.transformTo(i.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var d=w;(w=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),w.set(d,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var y=function(g,_){var x;for((_=_||g.length)>g.length&&(_=g.length),x=_-1;0<=x&&(192&g[x])==128;)x--;return x<0||x===0?_:x+u[g[x]]>_?x:_}(w),m=w;y!==w.length&&(i.uint8array?(m=w.subarray(0,y),this.leftOver=w.subarray(y,w.length)):(m=w.slice(0,y),this.leftOver=w.slice(y,w.length))),this.push({data:o.utf8decode(m),meta:h.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=f,s.inherits(p,l),p.prototype.processChunk=function(h){this.push({data:o.utf8encode(h.data),meta:h.meta})},o.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,o){var s=n("./support"),i=n("./base64"),a=n("./nodejsUtils"),l=n("./external");function u(d){return d}function c(d,y){for(var m=0;m<d.length;++m)y[m]=255&d.charCodeAt(m);return y}n("setimmediate"),o.newBlob=function(d,y){o.checkSupport("blob");try{return new Blob([d],{type:y})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(d),m.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(d,y,m){var g=[],_=0,x=d.length;if(x<=m)return String.fromCharCode.apply(null,d);for(;_<x;)y==="array"||y==="nodebuffer"?g.push(String.fromCharCode.apply(null,d.slice(_,Math.min(_+m,x)))):g.push(String.fromCharCode.apply(null,d.subarray(_,Math.min(_+m,x)))),_+=m;return g.join("")},stringifyByChar:function(d){for(var y="",m=0;m<d.length;m++)y+=String.fromCharCode(d[m]);return y},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function p(d){var y=65536,m=o.getTypeOf(d),g=!0;if(m==="uint8array"?g=f.applyCanBeUsed.uint8array:m==="nodebuffer"&&(g=f.applyCanBeUsed.nodebuffer),g)for(;1<y;)try{return f.stringifyByChunk(d,m,y)}catch{y=Math.floor(y/2)}return f.stringifyByChar(d)}function h(d,y){for(var m=0;m<d.length;m++)y[m]=d[m];return y}o.applyFromCharCode=p;var w={};w.string={string:u,array:function(d){return c(d,new Array(d.length))},arraybuffer:function(d){return w.string.uint8array(d).buffer},uint8array:function(d){return c(d,new Uint8Array(d.length))},nodebuffer:function(d){return c(d,a.allocBuffer(d.length))}},w.array={string:p,array:u,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return a.newBufferFrom(d)}},w.arraybuffer={string:function(d){return p(new Uint8Array(d))},array:function(d){return h(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:u,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return a.newBufferFrom(new Uint8Array(d))}},w.uint8array={string:p,array:function(d){return h(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:u,nodebuffer:function(d){return a.newBufferFrom(d)}},w.nodebuffer={string:p,array:function(d){return h(d,new Array(d.length))},arraybuffer:function(d){return w.nodebuffer.uint8array(d).buffer},uint8array:function(d){return h(d,new Uint8Array(d.length))},nodebuffer:u},o.transformTo=function(d,y){if(y=y||"",!d)return y;o.checkSupport(d);var m=o.getTypeOf(y);return w[m][d](y)},o.resolve=function(d){for(var y=d.split("/"),m=[],g=0;g<y.length;g++){var _=y[g];_==="."||_===""&&g!==0&&g!==y.length-1||(_===".."?m.pop():m.push(_))}return m.join("/")},o.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(d)?"nodebuffer":s.uint8array&&d instanceof Uint8Array?"uint8array":s.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(d){if(!s[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(d){var y,m,g="";for(m=0;m<(d||"").length;m++)g+="\\x"+((y=d.charCodeAt(m))<16?"0":"")+y.toString(16).toUpperCase();return g},o.delay=function(d,y,m){setImmediate(function(){d.apply(m||null,y||[])})},o.inherits=function(d,y){function m(){}m.prototype=y.prototype,d.prototype=new m},o.extend=function(){var d,y,m={};for(d=0;d<arguments.length;d++)for(y in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],y)&&m[y]===void 0&&(m[y]=arguments[d][y]);return m},o.prepareContent=function(d,y,m,g,_){return l.Promise.resolve(y).then(function(x){return s.blob&&(x instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x))!==-1)&&typeof FileReader<"u"?new l.Promise(function(E,S){var k=new FileReader;k.onload=function(N){E(N.target.result)},k.onerror=function(N){S(N.target.error)},k.readAsArrayBuffer(x)}):x}).then(function(x){var E=o.getTypeOf(x);return E?(E==="arraybuffer"?x=o.transformTo("uint8array",x):E==="string"&&(_?x=i.decode(x):m&&g!==!0&&(x=function(S){return c(S,s.uint8array?new Uint8Array(S.length):new Array(S.length))}(x))),x):l.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,o){var s=n("./reader/readerFor"),i=n("./utils"),a=n("./signature"),l=n("./zipEntry"),u=n("./support");function c(f){this.files=[],this.loadOptions=f}c.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(p)+", expected "+i.pretty(f)+")")}},isSignature:function(f,p){var h=this.reader.index;this.reader.setIndex(f);var w=this.reader.readString(4)===p;return this.reader.setIndex(h),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),p=u.uint8array?"uint8array":"array",h=i.transformTo(p,f);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,p,h,w=this.zip64EndOfCentralSize-44;0<w;)f=this.reader.readInt(2),p=this.reader.readInt(4),h=this.reader.readData(p),this.zip64ExtensibleData[f]={id:f,length:p,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,p;for(f=0;f<this.files.length;f++)p=this.files[f],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var p=f;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var w=p-h;if(0<w)this.isSignature(p,a.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,o){var s=n("./reader/readerFor"),i=n("./utils"),a=n("./compressedObject"),l=n("./crc32"),u=n("./utf8"),c=n("./compressions"),f=n("./support");function p(h,w){this.options=h,this.loadOptions=w}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var w,d;if(h.skip(22),this.fileNameLength=h.readInt(2),d=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(y){for(var m in c)if(Object.prototype.hasOwnProperty.call(c,m)&&c[m].magic===y)return c[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,w,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var w=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(w),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=s(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var w,d,y,m=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<m;)w=h.readInt(2),d=h.readInt(2),y=h.readData(d),this.extraFields[w]={id:w,length:d,value:y};h.setIndex(m)},handleUTF8:function(){var h=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var d=i.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var m=i.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var w=s(h.value);return w.readInt(1)!==1||l(this.fileName)!==w.readInt(4)?null:u.utf8decode(w.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var w=s(h.value);return w.readInt(1)!==1||l(this.fileComment)!==w.readInt(4)?null:u.utf8decode(w.readData(h.length-5))}return null}},r.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,o){function s(w,d,y){this.name=w,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=d,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var i=n("./stream/StreamHelper"),a=n("./stream/DataWorker"),l=n("./utf8"),u=n("./compressedObject"),c=n("./stream/GenericWorker");s.prototype={internalStream:function(w){var d=null,y="string";try{if(!w)throw new Error("No output type specified.");var m=(y=w.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),d=this._decompressWorker();var g=!this._dataBinary;g&&!m&&(d=d.pipe(new l.Utf8EncodeWorker)),!g&&m&&(d=d.pipe(new l.Utf8DecodeWorker))}catch(_){(d=new c("error")).error(_)}return new i(d,y,"")},async:function(w,d){return this.internalStream(w).accumulate(d)},nodeStream:function(w,d){return this.internalStream(w||"nodebuffer").toNodejsStream(d)},_compressWorker:function(w,d){if(this._data instanceof u&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(y,w,d)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof c?this._data:new a(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<f.length;h++)s.prototype[f[h]]=p;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,o){(function(s){var i,a,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var u=0,c=new l(w),f=s.document.createTextNode("");c.observe(f,{characterData:!0}),i=function(){f.data=u=++u%2}}else if(s.setImmediate||s.MessageChannel===void 0)i="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var d=s.document.createElement("script");d.onreadystatechange=function(){w(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},s.document.documentElement.appendChild(d)}:function(){setTimeout(w,0)};else{var p=new s.MessageChannel;p.port1.onmessage=w,i=function(){p.port2.postMessage(0)}}var h=[];function w(){var d,y;a=!0;for(var m=h.length;m;){for(y=h,h=[],d=-1;++d<m;)y[d]();m=h.length}a=!1}r.exports=function(d){h.push(d)!==1||a||i()}}).call(this,typeof Yn<"u"?Yn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,o){var s=n("immediate");function i(){}var a={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function f(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,m!==i&&d(this,m)}function p(m,g,_){this.promise=m,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function h(m,g,_){s(function(){var x;try{x=g(_)}catch(E){return a.reject(m,E)}x===m?a.reject(m,new TypeError("Cannot resolve promise with itself")):a.resolve(m,x)})}function w(m){var g=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof g=="function")return function(){g.apply(m,arguments)}}function d(m,g){var _=!1;function x(k){_||(_=!0,a.reject(m,k))}function E(k){_||(_=!0,a.resolve(m,k))}var S=y(function(){g(E,x)});S.status==="error"&&x(S.value)}function y(m,g){var _={};try{_.value=m(g),_.status="success"}catch(x){_.status="error",_.value=x}return _}(r.exports=f).prototype.finally=function(m){if(typeof m!="function")return this;var g=this.constructor;return this.then(function(_){return g.resolve(m()).then(function(){return _})},function(_){return g.resolve(m()).then(function(){throw _})})},f.prototype.catch=function(m){return this.then(null,m)},f.prototype.then=function(m,g){if(typeof m!="function"&&this.state===u||typeof g!="function"&&this.state===l)return this;var _=new this.constructor(i);return this.state!==c?h(_,this.state===u?m:g,this.outcome):this.queue.push(new p(_,m,g)),_},p.prototype.callFulfilled=function(m){a.resolve(this.promise,m)},p.prototype.otherCallFulfilled=function(m){h(this.promise,this.onFulfilled,m)},p.prototype.callRejected=function(m){a.reject(this.promise,m)},p.prototype.otherCallRejected=function(m){h(this.promise,this.onRejected,m)},a.resolve=function(m,g){var _=y(w,g);if(_.status==="error")return a.reject(m,_.value);var x=_.value;if(x)d(m,x);else{m.state=u,m.outcome=g;for(var E=-1,S=m.queue.length;++E<S;)m.queue[E].callFulfilled(g)}return m},a.reject=function(m,g){m.state=l,m.outcome=g;for(var _=-1,x=m.queue.length;++_<x;)m.queue[_].callRejected(g);return m},f.resolve=function(m){return m instanceof this?m:a.resolve(new this(i),m)},f.reject=function(m){var g=new this(i);return a.reject(g,m)},f.all=function(m){var g=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=m.length,x=!1;if(!_)return this.resolve([]);for(var E=new Array(_),S=0,k=-1,N=new this(i);++k<_;)D(m[k],k);return N;function D(R,H){g.resolve(R).then(function(P){E[H]=P,++S!==_||x||(x=!0,a.resolve(N,E))},function(P){x||(x=!0,a.reject(N,P))})}},f.race=function(m){var g=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=m.length,x=!1;if(!_)return this.resolve([]);for(var E=-1,S=new this(i);++E<_;)k=m[E],g.resolve(k).then(function(N){x||(x=!0,a.resolve(S,N))},function(N){x||(x=!0,a.reject(S,N))});var k;return S}},{immediate:36}],38:[function(n,r,o){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,o){var s=n("./zlib/deflate"),i=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/messages"),u=n("./zlib/zstream"),c=Object.prototype.toString,f=0,p=-1,h=0,w=8;function d(m){if(!(this instanceof d))return new d(m);this.options=i.assign({level:p,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},m||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var _=s.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(_!==f)throw new Error(l[_]);if(g.header&&s.deflateSetHeader(this.strm,g.header),g.dictionary){var x;if(x=typeof g.dictionary=="string"?a.string2buf(g.dictionary):c.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(_=s.deflateSetDictionary(this.strm,x))!==f)throw new Error(l[_]);this._dict_set=!0}}function y(m,g){var _=new d(g);if(_.push(m,!0),_.err)throw _.msg||l[_.err];return _.result}d.prototype.push=function(m,g){var _,x,E=this.strm,S=this.options.chunkSize;if(this.ended)return!1;x=g===~~g?g:g===!0?4:0,typeof m=="string"?E.input=a.string2buf(m):c.call(m)==="[object ArrayBuffer]"?E.input=new Uint8Array(m):E.input=m,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new i.Buf8(S),E.next_out=0,E.avail_out=S),(_=s.deflate(E,x))!==1&&_!==f)return this.onEnd(_),!(this.ended=!0);E.avail_out!==0&&(E.avail_in!==0||x!==4&&x!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(i.shrinkBuf(E.output,E.next_out))):this.onData(i.shrinkBuf(E.output,E.next_out)))}while((0<E.avail_in||E.avail_out===0)&&_!==1);return x===4?(_=s.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===f):x!==2||(this.onEnd(f),!(E.avail_out=0))},d.prototype.onData=function(m){this.chunks.push(m)},d.prototype.onEnd=function(m){m===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},o.Deflate=d,o.deflate=y,o.deflateRaw=function(m,g){return(g=g||{}).raw=!0,y(m,g)},o.gzip=function(m,g){return(g=g||{}).gzip=!0,y(m,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,o){var s=n("./zlib/inflate"),i=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/constants"),u=n("./zlib/messages"),c=n("./zlib/zstream"),f=n("./zlib/gzheader"),p=Object.prototype.toString;function h(d){if(!(this instanceof h))return new h(d);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},d||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||d&&d.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&!(15&y.windowBits)&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var m=s.inflateInit2(this.strm,y.windowBits);if(m!==l.Z_OK)throw new Error(u[m]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function w(d,y){var m=new h(y);if(m.push(d,!0),m.err)throw m.msg||u[m.err];return m.result}h.prototype.push=function(d,y){var m,g,_,x,E,S,k=this.strm,N=this.options.chunkSize,D=this.options.dictionary,R=!1;if(this.ended)return!1;g=y===~~y?y:y===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof d=="string"?k.input=a.binstring2buf(d):p.call(d)==="[object ArrayBuffer]"?k.input=new Uint8Array(d):k.input=d,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new i.Buf8(N),k.next_out=0,k.avail_out=N),(m=s.inflate(k,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&D&&(S=typeof D=="string"?a.string2buf(D):p.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,m=s.inflateSetDictionary(this.strm,S)),m===l.Z_BUF_ERROR&&R===!0&&(m=l.Z_OK,R=!1),m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),!(this.ended=!0);k.next_out&&(k.avail_out!==0&&m!==l.Z_STREAM_END&&(k.avail_in!==0||g!==l.Z_FINISH&&g!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=a.utf8border(k.output,k.next_out),x=k.next_out-_,E=a.buf2string(k.output,_),k.next_out=x,k.avail_out=N-x,x&&i.arraySet(k.output,k.output,_,x,0),this.onData(E)):this.onData(i.shrinkBuf(k.output,k.next_out)))),k.avail_in===0&&k.avail_out===0&&(R=!0)}while((0<k.avail_in||k.avail_out===0)&&m!==l.Z_STREAM_END);return m===l.Z_STREAM_END&&(g=l.Z_FINISH),g===l.Z_FINISH?(m=s.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK):g!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(k.avail_out=0))},h.prototype.onData=function(d){this.chunks.push(d)},h.prototype.onEnd=function(d){d===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},o.Inflate=h,o.inflate=w,o.inflateRaw=function(d,y){return(y=y||{}).raw=!0,w(d,y)},o.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,o){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var f in c)c.hasOwnProperty(f)&&(l[f]=c[f])}}return l},o.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var i={arraySet:function(l,u,c,f,p){if(u.subarray&&l.subarray)l.set(u.subarray(c,c+f),p);else for(var h=0;h<f;h++)l[p+h]=u[c+h]},flattenChunks:function(l){var u,c,f,p,h,w;for(u=f=0,c=l.length;u<c;u++)f+=l[u].length;for(w=new Uint8Array(f),u=p=0,c=l.length;u<c;u++)h=l[u],w.set(h,p),p+=h.length;return w}},a={arraySet:function(l,u,c,f,p){for(var h=0;h<f;h++)l[p+h]=u[c+h]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,i)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,a))},o.setTyped(s)},{}],42:[function(n,r,o){var s=n("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new s.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(f,p){if(p<65537&&(f.subarray&&a||!f.subarray&&i))return String.fromCharCode.apply(null,s.shrinkBuf(f,p));for(var h="",w=0;w<p;w++)h+=String.fromCharCode(f[w]);return h}l[254]=l[254]=1,o.string2buf=function(f){var p,h,w,d,y,m=f.length,g=0;for(d=0;d<m;d++)(64512&(h=f.charCodeAt(d)))==55296&&d+1<m&&(64512&(w=f.charCodeAt(d+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),d++),g+=h<128?1:h<2048?2:h<65536?3:4;for(p=new s.Buf8(g),d=y=0;y<g;d++)(64512&(h=f.charCodeAt(d)))==55296&&d+1<m&&(64512&(w=f.charCodeAt(d+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),d++),h<128?p[y++]=h:(h<2048?p[y++]=192|h>>>6:(h<65536?p[y++]=224|h>>>12:(p[y++]=240|h>>>18,p[y++]=128|h>>>12&63),p[y++]=128|h>>>6&63),p[y++]=128|63&h);return p},o.buf2binstring=function(f){return c(f,f.length)},o.binstring2buf=function(f){for(var p=new s.Buf8(f.length),h=0,w=p.length;h<w;h++)p[h]=f.charCodeAt(h);return p},o.buf2string=function(f,p){var h,w,d,y,m=p||f.length,g=new Array(2*m);for(h=w=0;h<m;)if((d=f[h++])<128)g[w++]=d;else if(4<(y=l[d]))g[w++]=65533,h+=y-1;else{for(d&=y===2?31:y===3?15:7;1<y&&h<m;)d=d<<6|63&f[h++],y--;1<y?g[w++]=65533:d<65536?g[w++]=d:(d-=65536,g[w++]=55296|d>>10&1023,g[w++]=56320|1023&d)}return c(g,w)},o.utf8border=function(f,p){var h;for((p=p||f.length)>f.length&&(p=f.length),h=p-1;0<=h&&(192&f[h])==128;)h--;return h<0||h===0?p:h+l[f[h]]>p?h:p}},{"./common":41}],43:[function(n,r,o){r.exports=function(s,i,a,l){for(var u=65535&s|0,c=s>>>16&65535|0,f=0;a!==0;){for(a-=f=2e3<a?2e3:a;c=c+(u=u+i[l++]|0)|0,--f;);u%=65521,c%=65521}return u|c<<16|0}},{}],44:[function(n,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,o){var s=function(){for(var i,a=[],l=0;l<256;l++){i=l;for(var u=0;u<8;u++)i=1&i?3988292384^i>>>1:i>>>1;a[l]=i}return a}();r.exports=function(i,a,l,u){var c=s,f=u+l;i^=-1;for(var p=u;p<f;p++)i=i>>>8^c[255&(i^a[p])];return-1^i}},{}],46:[function(n,r,o){var s,i=n("../utils/common"),a=n("./trees"),l=n("./adler32"),u=n("./crc32"),c=n("./messages"),f=0,p=4,h=0,w=-2,d=-1,y=4,m=2,g=8,_=9,x=286,E=30,S=19,k=2*x+1,N=15,D=3,R=258,H=R+D+1,P=42,T=113,b=1,q=2,Q=3,A=4;function te(v,W){return v.msg=c[W],W}function Z(v){return(v<<1)-(4<v?9:0)}function re(v){for(var W=v.length;0<=--W;)v[W]=0}function L(v){var W=v.state,z=W.pending;z>v.avail_out&&(z=v.avail_out),z!==0&&(i.arraySet(v.output,W.pending_buf,W.pending_out,z,v.next_out),v.next_out+=z,W.pending_out+=z,v.total_out+=z,v.avail_out-=z,W.pending-=z,W.pending===0&&(W.pending_out=0))}function B(v,W){a._tr_flush_block(v,0<=v.block_start?v.block_start:-1,v.strstart-v.block_start,W),v.block_start=v.strstart,L(v.strm)}function U(v,W){v.pending_buf[v.pending++]=W}function K(v,W){v.pending_buf[v.pending++]=W>>>8&255,v.pending_buf[v.pending++]=255&W}function $(v,W){var z,O,C=v.max_chain_length,F=v.strstart,G=v.prev_length,Y=v.nice_match,M=v.strstart>v.w_size-H?v.strstart-(v.w_size-H):0,X=v.window,ne=v.w_mask,ee=v.prev,le=v.strstart+R,_e=X[F+G-1],ge=X[F+G];v.prev_length>=v.good_match&&(C>>=2),Y>v.lookahead&&(Y=v.lookahead);do if(X[(z=W)+G]===ge&&X[z+G-1]===_e&&X[z]===X[F]&&X[++z]===X[F+1]){F+=2,z++;do;while(X[++F]===X[++z]&&X[++F]===X[++z]&&X[++F]===X[++z]&&X[++F]===X[++z]&&X[++F]===X[++z]&&X[++F]===X[++z]&&X[++F]===X[++z]&&X[++F]===X[++z]&&F<le);if(O=R-(le-F),F=le-R,G<O){if(v.match_start=W,Y<=(G=O))break;_e=X[F+G-1],ge=X[F+G]}}while((W=ee[W&ne])>M&&--C!=0);return G<=v.lookahead?G:v.lookahead}function ie(v){var W,z,O,C,F,G,Y,M,X,ne,ee=v.w_size;do{if(C=v.window_size-v.lookahead-v.strstart,v.strstart>=ee+(ee-H)){for(i.arraySet(v.window,v.window,ee,ee,0),v.match_start-=ee,v.strstart-=ee,v.block_start-=ee,W=z=v.hash_size;O=v.head[--W],v.head[W]=ee<=O?O-ee:0,--z;);for(W=z=ee;O=v.prev[--W],v.prev[W]=ee<=O?O-ee:0,--z;);C+=ee}if(v.strm.avail_in===0)break;if(G=v.strm,Y=v.window,M=v.strstart+v.lookahead,X=C,ne=void 0,ne=G.avail_in,X<ne&&(ne=X),z=ne===0?0:(G.avail_in-=ne,i.arraySet(Y,G.input,G.next_in,ne,M),G.state.wrap===1?G.adler=l(G.adler,Y,ne,M):G.state.wrap===2&&(G.adler=u(G.adler,Y,ne,M)),G.next_in+=ne,G.total_in+=ne,ne),v.lookahead+=z,v.lookahead+v.insert>=D)for(F=v.strstart-v.insert,v.ins_h=v.window[F],v.ins_h=(v.ins_h<<v.hash_shift^v.window[F+1])&v.hash_mask;v.insert&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[F+D-1])&v.hash_mask,v.prev[F&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=F,F++,v.insert--,!(v.lookahead+v.insert<D)););}while(v.lookahead<H&&v.strm.avail_in!==0)}function me(v,W){for(var z,O;;){if(v.lookahead<H){if(ie(v),v.lookahead<H&&W===f)return b;if(v.lookahead===0)break}if(z=0,v.lookahead>=D&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+D-1])&v.hash_mask,z=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),z!==0&&v.strstart-z<=v.w_size-H&&(v.match_length=$(v,z)),v.match_length>=D)if(O=a._tr_tally(v,v.strstart-v.match_start,v.match_length-D),v.lookahead-=v.match_length,v.match_length<=v.max_lazy_match&&v.lookahead>=D){for(v.match_length--;v.strstart++,v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+D-1])&v.hash_mask,z=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart,--v.match_length!=0;);v.strstart++}else v.strstart+=v.match_length,v.match_length=0,v.ins_h=v.window[v.strstart],v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+1])&v.hash_mask;else O=a._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++;if(O&&(B(v,!1),v.strm.avail_out===0))return b}return v.insert=v.strstart<D-1?v.strstart:D-1,W===p?(B(v,!0),v.strm.avail_out===0?Q:A):v.last_lit&&(B(v,!1),v.strm.avail_out===0)?b:q}function se(v,W){for(var z,O,C;;){if(v.lookahead<H){if(ie(v),v.lookahead<H&&W===f)return b;if(v.lookahead===0)break}if(z=0,v.lookahead>=D&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+D-1])&v.hash_mask,z=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),v.prev_length=v.match_length,v.prev_match=v.match_start,v.match_length=D-1,z!==0&&v.prev_length<v.max_lazy_match&&v.strstart-z<=v.w_size-H&&(v.match_length=$(v,z),v.match_length<=5&&(v.strategy===1||v.match_length===D&&4096<v.strstart-v.match_start)&&(v.match_length=D-1)),v.prev_length>=D&&v.match_length<=v.prev_length){for(C=v.strstart+v.lookahead-D,O=a._tr_tally(v,v.strstart-1-v.prev_match,v.prev_length-D),v.lookahead-=v.prev_length-1,v.prev_length-=2;++v.strstart<=C&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+D-1])&v.hash_mask,z=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),--v.prev_length!=0;);if(v.match_available=0,v.match_length=D-1,v.strstart++,O&&(B(v,!1),v.strm.avail_out===0))return b}else if(v.match_available){if((O=a._tr_tally(v,0,v.window[v.strstart-1]))&&B(v,!1),v.strstart++,v.lookahead--,v.strm.avail_out===0)return b}else v.match_available=1,v.strstart++,v.lookahead--}return v.match_available&&(O=a._tr_tally(v,0,v.window[v.strstart-1]),v.match_available=0),v.insert=v.strstart<D-1?v.strstart:D-1,W===p?(B(v,!0),v.strm.avail_out===0?Q:A):v.last_lit&&(B(v,!1),v.strm.avail_out===0)?b:q}function ae(v,W,z,O,C){this.good_length=v,this.max_lazy=W,this.nice_length=z,this.max_chain=O,this.func=C}function ye(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*k),this.dyn_dtree=new i.Buf16(2*(2*E+1)),this.bl_tree=new i.Buf16(2*(2*S+1)),re(this.dyn_ltree),re(this.dyn_dtree),re(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(N+1),this.heap=new i.Buf16(2*x+1),re(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*x+1),re(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function he(v){var W;return v&&v.state?(v.total_in=v.total_out=0,v.data_type=m,(W=v.state).pending=0,W.pending_out=0,W.wrap<0&&(W.wrap=-W.wrap),W.status=W.wrap?P:T,v.adler=W.wrap===2?0:1,W.last_flush=f,a._tr_init(W),h):te(v,w)}function de(v){var W=he(v);return W===h&&function(z){z.window_size=2*z.w_size,re(z.head),z.max_lazy_match=s[z.level].max_lazy,z.good_match=s[z.level].good_length,z.nice_match=s[z.level].nice_length,z.max_chain_length=s[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=D-1,z.match_available=0,z.ins_h=0}(v.state),W}function we(v,W,z,O,C,F){if(!v)return w;var G=1;if(W===d&&(W=6),O<0?(G=0,O=-O):15<O&&(G=2,O-=16),C<1||_<C||z!==g||O<8||15<O||W<0||9<W||F<0||y<F)return te(v,w);O===8&&(O=9);var Y=new ye;return(v.state=Y).strm=v,Y.wrap=G,Y.gzhead=null,Y.w_bits=O,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=C+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+D-1)/D),Y.window=new i.Buf8(2*Y.w_size),Y.head=new i.Buf16(Y.hash_size),Y.prev=new i.Buf16(Y.w_size),Y.lit_bufsize=1<<C+6,Y.pending_buf_size=4*Y.lit_bufsize,Y.pending_buf=new i.Buf8(Y.pending_buf_size),Y.d_buf=1*Y.lit_bufsize,Y.l_buf=3*Y.lit_bufsize,Y.level=W,Y.strategy=F,Y.method=z,de(v)}s=[new ae(0,0,0,0,function(v,W){var z=65535;for(z>v.pending_buf_size-5&&(z=v.pending_buf_size-5);;){if(v.lookahead<=1){if(ie(v),v.lookahead===0&&W===f)return b;if(v.lookahead===0)break}v.strstart+=v.lookahead,v.lookahead=0;var O=v.block_start+z;if((v.strstart===0||v.strstart>=O)&&(v.lookahead=v.strstart-O,v.strstart=O,B(v,!1),v.strm.avail_out===0)||v.strstart-v.block_start>=v.w_size-H&&(B(v,!1),v.strm.avail_out===0))return b}return v.insert=0,W===p?(B(v,!0),v.strm.avail_out===0?Q:A):(v.strstart>v.block_start&&(B(v,!1),v.strm.avail_out),b)}),new ae(4,4,8,4,me),new ae(4,5,16,8,me),new ae(4,6,32,32,me),new ae(4,4,16,16,se),new ae(8,16,32,32,se),new ae(8,16,128,128,se),new ae(8,32,128,256,se),new ae(32,128,258,1024,se),new ae(32,258,258,4096,se)],o.deflateInit=function(v,W){return we(v,W,g,15,8,0)},o.deflateInit2=we,o.deflateReset=de,o.deflateResetKeep=he,o.deflateSetHeader=function(v,W){return v&&v.state?v.state.wrap!==2?w:(v.state.gzhead=W,h):w},o.deflate=function(v,W){var z,O,C,F;if(!v||!v.state||5<W||W<0)return v?te(v,w):w;if(O=v.state,!v.output||!v.input&&v.avail_in!==0||O.status===666&&W!==p)return te(v,v.avail_out===0?-5:w);if(O.strm=v,z=O.last_flush,O.last_flush=W,O.status===P)if(O.wrap===2)v.adler=0,U(O,31),U(O,139),U(O,8),O.gzhead?(U(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),U(O,255&O.gzhead.time),U(O,O.gzhead.time>>8&255),U(O,O.gzhead.time>>16&255),U(O,O.gzhead.time>>24&255),U(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),U(O,255&O.gzhead.os),O.gzhead.extra&&O.gzhead.extra.length&&(U(O,255&O.gzhead.extra.length),U(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(v.adler=u(v.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=69):(U(O,0),U(O,0),U(O,0),U(O,0),U(O,0),U(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),U(O,3),O.status=T);else{var G=g+(O.w_bits-8<<4)<<8;G|=(2<=O.strategy||O.level<2?0:O.level<6?1:O.level===6?2:3)<<6,O.strstart!==0&&(G|=32),G+=31-G%31,O.status=T,K(O,G),O.strstart!==0&&(K(O,v.adler>>>16),K(O,65535&v.adler)),v.adler=1}if(O.status===69)if(O.gzhead.extra){for(C=O.pending;O.gzindex<(65535&O.gzhead.extra.length)&&(O.pending!==O.pending_buf_size||(O.gzhead.hcrc&&O.pending>C&&(v.adler=u(v.adler,O.pending_buf,O.pending-C,C)),L(v),C=O.pending,O.pending!==O.pending_buf_size));)U(O,255&O.gzhead.extra[O.gzindex]),O.gzindex++;O.gzhead.hcrc&&O.pending>C&&(v.adler=u(v.adler,O.pending_buf,O.pending-C,C)),O.gzindex===O.gzhead.extra.length&&(O.gzindex=0,O.status=73)}else O.status=73;if(O.status===73)if(O.gzhead.name){C=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>C&&(v.adler=u(v.adler,O.pending_buf,O.pending-C,C)),L(v),C=O.pending,O.pending===O.pending_buf_size)){F=1;break}F=O.gzindex<O.gzhead.name.length?255&O.gzhead.name.charCodeAt(O.gzindex++):0,U(O,F)}while(F!==0);O.gzhead.hcrc&&O.pending>C&&(v.adler=u(v.adler,O.pending_buf,O.pending-C,C)),F===0&&(O.gzindex=0,O.status=91)}else O.status=91;if(O.status===91)if(O.gzhead.comment){C=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>C&&(v.adler=u(v.adler,O.pending_buf,O.pending-C,C)),L(v),C=O.pending,O.pending===O.pending_buf_size)){F=1;break}F=O.gzindex<O.gzhead.comment.length?255&O.gzhead.comment.charCodeAt(O.gzindex++):0,U(O,F)}while(F!==0);O.gzhead.hcrc&&O.pending>C&&(v.adler=u(v.adler,O.pending_buf,O.pending-C,C)),F===0&&(O.status=103)}else O.status=103;if(O.status===103&&(O.gzhead.hcrc?(O.pending+2>O.pending_buf_size&&L(v),O.pending+2<=O.pending_buf_size&&(U(O,255&v.adler),U(O,v.adler>>8&255),v.adler=0,O.status=T)):O.status=T),O.pending!==0){if(L(v),v.avail_out===0)return O.last_flush=-1,h}else if(v.avail_in===0&&Z(W)<=Z(z)&&W!==p)return te(v,-5);if(O.status===666&&v.avail_in!==0)return te(v,-5);if(v.avail_in!==0||O.lookahead!==0||W!==f&&O.status!==666){var Y=O.strategy===2?function(M,X){for(var ne;;){if(M.lookahead===0&&(ie(M),M.lookahead===0)){if(X===f)return b;break}if(M.match_length=0,ne=a._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++,ne&&(B(M,!1),M.strm.avail_out===0))return b}return M.insert=0,X===p?(B(M,!0),M.strm.avail_out===0?Q:A):M.last_lit&&(B(M,!1),M.strm.avail_out===0)?b:q}(O,W):O.strategy===3?function(M,X){for(var ne,ee,le,_e,ge=M.window;;){if(M.lookahead<=R){if(ie(M),M.lookahead<=R&&X===f)return b;if(M.lookahead===0)break}if(M.match_length=0,M.lookahead>=D&&0<M.strstart&&(ee=ge[le=M.strstart-1])===ge[++le]&&ee===ge[++le]&&ee===ge[++le]){_e=M.strstart+R;do;while(ee===ge[++le]&&ee===ge[++le]&&ee===ge[++le]&&ee===ge[++le]&&ee===ge[++le]&&ee===ge[++le]&&ee===ge[++le]&&ee===ge[++le]&&le<_e);M.match_length=R-(_e-le),M.match_length>M.lookahead&&(M.match_length=M.lookahead)}if(M.match_length>=D?(ne=a._tr_tally(M,1,M.match_length-D),M.lookahead-=M.match_length,M.strstart+=M.match_length,M.match_length=0):(ne=a._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++),ne&&(B(M,!1),M.strm.avail_out===0))return b}return M.insert=0,X===p?(B(M,!0),M.strm.avail_out===0?Q:A):M.last_lit&&(B(M,!1),M.strm.avail_out===0)?b:q}(O,W):s[O.level].func(O,W);if(Y!==Q&&Y!==A||(O.status=666),Y===b||Y===Q)return v.avail_out===0&&(O.last_flush=-1),h;if(Y===q&&(W===1?a._tr_align(O):W!==5&&(a._tr_stored_block(O,0,0,!1),W===3&&(re(O.head),O.lookahead===0&&(O.strstart=0,O.block_start=0,O.insert=0))),L(v),v.avail_out===0))return O.last_flush=-1,h}return W!==p?h:O.wrap<=0?1:(O.wrap===2?(U(O,255&v.adler),U(O,v.adler>>8&255),U(O,v.adler>>16&255),U(O,v.adler>>24&255),U(O,255&v.total_in),U(O,v.total_in>>8&255),U(O,v.total_in>>16&255),U(O,v.total_in>>24&255)):(K(O,v.adler>>>16),K(O,65535&v.adler)),L(v),0<O.wrap&&(O.wrap=-O.wrap),O.pending!==0?h:1)},o.deflateEnd=function(v){var W;return v&&v.state?(W=v.state.status)!==P&&W!==69&&W!==73&&W!==91&&W!==103&&W!==T&&W!==666?te(v,w):(v.state=null,W===T?te(v,-3):h):w},o.deflateSetDictionary=function(v,W){var z,O,C,F,G,Y,M,X,ne=W.length;if(!v||!v.state||(F=(z=v.state).wrap)===2||F===1&&z.status!==P||z.lookahead)return w;for(F===1&&(v.adler=l(v.adler,W,ne,0)),z.wrap=0,ne>=z.w_size&&(F===0&&(re(z.head),z.strstart=0,z.block_start=0,z.insert=0),X=new i.Buf8(z.w_size),i.arraySet(X,W,ne-z.w_size,z.w_size,0),W=X,ne=z.w_size),G=v.avail_in,Y=v.next_in,M=v.input,v.avail_in=ne,v.next_in=0,v.input=W,ie(z);z.lookahead>=D;){for(O=z.strstart,C=z.lookahead-(D-1);z.ins_h=(z.ins_h<<z.hash_shift^z.window[O+D-1])&z.hash_mask,z.prev[O&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=O,O++,--C;);z.strstart=O,z.lookahead=D-1,ie(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=D-1,z.match_available=0,v.next_in=Y,v.input=M,v.avail_in=G,z.wrap=F,h},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,o){r.exports=function(s,i){var a,l,u,c,f,p,h,w,d,y,m,g,_,x,E,S,k,N,D,R,H,P,T,b,q;a=s.state,l=s.next_in,b=s.input,u=l+(s.avail_in-5),c=s.next_out,q=s.output,f=c-(i-s.avail_out),p=c+(s.avail_out-257),h=a.dmax,w=a.wsize,d=a.whave,y=a.wnext,m=a.window,g=a.hold,_=a.bits,x=a.lencode,E=a.distcode,S=(1<<a.lenbits)-1,k=(1<<a.distbits)-1;e:do{_<15&&(g+=b[l++]<<_,_+=8,g+=b[l++]<<_,_+=8),N=x[g&S];t:for(;;){if(g>>>=D=N>>>24,_-=D,(D=N>>>16&255)===0)q[c++]=65535&N;else{if(!(16&D)){if(!(64&D)){N=x[(65535&N)+(g&(1<<D)-1)];continue t}if(32&D){a.mode=12;break e}s.msg="invalid literal/length code",a.mode=30;break e}R=65535&N,(D&=15)&&(_<D&&(g+=b[l++]<<_,_+=8),R+=g&(1<<D)-1,g>>>=D,_-=D),_<15&&(g+=b[l++]<<_,_+=8,g+=b[l++]<<_,_+=8),N=E[g&k];n:for(;;){if(g>>>=D=N>>>24,_-=D,!(16&(D=N>>>16&255))){if(!(64&D)){N=E[(65535&N)+(g&(1<<D)-1)];continue n}s.msg="invalid distance code",a.mode=30;break e}if(H=65535&N,_<(D&=15)&&(g+=b[l++]<<_,(_+=8)<D&&(g+=b[l++]<<_,_+=8)),h<(H+=g&(1<<D)-1)){s.msg="invalid distance too far back",a.mode=30;break e}if(g>>>=D,_-=D,(D=c-f)<H){if(d<(D=H-D)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break e}if(T=m,(P=0)===y){if(P+=w-D,D<R){for(R-=D;q[c++]=m[P++],--D;);P=c-H,T=q}}else if(y<D){if(P+=w+y-D,(D-=y)<R){for(R-=D;q[c++]=m[P++],--D;);if(P=0,y<R){for(R-=D=y;q[c++]=m[P++],--D;);P=c-H,T=q}}}else if(P+=y-D,D<R){for(R-=D;q[c++]=m[P++],--D;);P=c-H,T=q}for(;2<R;)q[c++]=T[P++],q[c++]=T[P++],q[c++]=T[P++],R-=3;R&&(q[c++]=T[P++],1<R&&(q[c++]=T[P++]))}else{for(P=c-H;q[c++]=q[P++],q[c++]=q[P++],q[c++]=q[P++],2<(R-=3););R&&(q[c++]=q[P++],1<R&&(q[c++]=q[P++]))}break}}break}}while(l<u&&c<p);l-=R=_>>3,g&=(1<<(_-=R<<3))-1,s.next_in=l,s.next_out=c,s.avail_in=l<u?u-l+5:5-(l-u),s.avail_out=c<p?p-c+257:257-(c-p),a.hold=g,a.bits=_}},{}],49:[function(n,r,o){var s=n("../utils/common"),i=n("./adler32"),a=n("./crc32"),l=n("./inffast"),u=n("./inftrees"),c=1,f=2,p=0,h=-2,w=1,d=852,y=592;function m(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(P){var T;return P&&P.state?(T=P.state,P.total_in=P.total_out=T.total=0,P.msg="",T.wrap&&(P.adler=1&T.wrap),T.mode=w,T.last=0,T.havedict=0,T.dmax=32768,T.head=null,T.hold=0,T.bits=0,T.lencode=T.lendyn=new s.Buf32(d),T.distcode=T.distdyn=new s.Buf32(y),T.sane=1,T.back=-1,p):h}function x(P){var T;return P&&P.state?((T=P.state).wsize=0,T.whave=0,T.wnext=0,_(P)):h}function E(P,T){var b,q;return P&&P.state?(q=P.state,T<0?(b=0,T=-T):(b=1+(T>>4),T<48&&(T&=15)),T&&(T<8||15<T)?h:(q.window!==null&&q.wbits!==T&&(q.window=null),q.wrap=b,q.wbits=T,x(P))):h}function S(P,T){var b,q;return P?(q=new g,(P.state=q).window=null,(b=E(P,T))!==p&&(P.state=null),b):h}var k,N,D=!0;function R(P){if(D){var T;for(k=new s.Buf32(512),N=new s.Buf32(32),T=0;T<144;)P.lens[T++]=8;for(;T<256;)P.lens[T++]=9;for(;T<280;)P.lens[T++]=7;for(;T<288;)P.lens[T++]=8;for(u(c,P.lens,0,288,k,0,P.work,{bits:9}),T=0;T<32;)P.lens[T++]=5;u(f,P.lens,0,32,N,0,P.work,{bits:5}),D=!1}P.lencode=k,P.lenbits=9,P.distcode=N,P.distbits=5}function H(P,T,b,q){var Q,A=P.state;return A.window===null&&(A.wsize=1<<A.wbits,A.wnext=0,A.whave=0,A.window=new s.Buf8(A.wsize)),q>=A.wsize?(s.arraySet(A.window,T,b-A.wsize,A.wsize,0),A.wnext=0,A.whave=A.wsize):(q<(Q=A.wsize-A.wnext)&&(Q=q),s.arraySet(A.window,T,b-q,Q,A.wnext),(q-=Q)?(s.arraySet(A.window,T,b-q,q,0),A.wnext=q,A.whave=A.wsize):(A.wnext+=Q,A.wnext===A.wsize&&(A.wnext=0),A.whave<A.wsize&&(A.whave+=Q))),0}o.inflateReset=x,o.inflateReset2=E,o.inflateResetKeep=_,o.inflateInit=function(P){return S(P,15)},o.inflateInit2=S,o.inflate=function(P,T){var b,q,Q,A,te,Z,re,L,B,U,K,$,ie,me,se,ae,ye,he,de,we,v,W,z,O,C=0,F=new s.Buf8(4),G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return h;(b=P.state).mode===12&&(b.mode=13),te=P.next_out,Q=P.output,re=P.avail_out,A=P.next_in,q=P.input,Z=P.avail_in,L=b.hold,B=b.bits,U=Z,K=re,W=p;e:for(;;)switch(b.mode){case w:if(b.wrap===0){b.mode=13;break}for(;B<16;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if(2&b.wrap&&L===35615){F[b.check=0]=255&L,F[1]=L>>>8&255,b.check=a(b.check,F,2,0),B=L=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&L)<<8)+(L>>8))%31){P.msg="incorrect header check",b.mode=30;break}if((15&L)!=8){P.msg="unknown compression method",b.mode=30;break}if(B-=4,v=8+(15&(L>>>=4)),b.wbits===0)b.wbits=v;else if(v>b.wbits){P.msg="invalid window size",b.mode=30;break}b.dmax=1<<v,P.adler=b.check=1,b.mode=512&L?10:12,B=L=0;break;case 2:for(;B<16;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if(b.flags=L,(255&b.flags)!=8){P.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){P.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=L>>8&1),512&b.flags&&(F[0]=255&L,F[1]=L>>>8&255,b.check=a(b.check,F,2,0)),B=L=0,b.mode=3;case 3:for(;B<32;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}b.head&&(b.head.time=L),512&b.flags&&(F[0]=255&L,F[1]=L>>>8&255,F[2]=L>>>16&255,F[3]=L>>>24&255,b.check=a(b.check,F,4,0)),B=L=0,b.mode=4;case 4:for(;B<16;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}b.head&&(b.head.xflags=255&L,b.head.os=L>>8),512&b.flags&&(F[0]=255&L,F[1]=L>>>8&255,b.check=a(b.check,F,2,0)),B=L=0,b.mode=5;case 5:if(1024&b.flags){for(;B<16;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}b.length=L,b.head&&(b.head.extra_len=L),512&b.flags&&(F[0]=255&L,F[1]=L>>>8&255,b.check=a(b.check,F,2,0)),B=L=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(Z<($=b.length)&&($=Z),$&&(b.head&&(v=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),s.arraySet(b.head.extra,q,A,$,v)),512&b.flags&&(b.check=a(b.check,q,$,A)),Z-=$,A+=$,b.length-=$),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(Z===0)break e;for($=0;v=q[A+$++],b.head&&v&&b.length<65536&&(b.head.name+=String.fromCharCode(v)),v&&$<Z;);if(512&b.flags&&(b.check=a(b.check,q,$,A)),Z-=$,A+=$,v)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(Z===0)break e;for($=0;v=q[A+$++],b.head&&v&&b.length<65536&&(b.head.comment+=String.fromCharCode(v)),v&&$<Z;);if(512&b.flags&&(b.check=a(b.check,q,$,A)),Z-=$,A+=$,v)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;B<16;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if(L!==(65535&b.check)){P.msg="header crc mismatch",b.mode=30;break}B=L=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),P.adler=b.check=0,b.mode=12;break;case 10:for(;B<32;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}P.adler=b.check=m(L),B=L=0,b.mode=11;case 11:if(b.havedict===0)return P.next_out=te,P.avail_out=re,P.next_in=A,P.avail_in=Z,b.hold=L,b.bits=B,2;P.adler=b.check=1,b.mode=12;case 12:if(T===5||T===6)break e;case 13:if(b.last){L>>>=7&B,B-=7&B,b.mode=27;break}for(;B<3;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}switch(b.last=1&L,B-=1,3&(L>>>=1)){case 0:b.mode=14;break;case 1:if(R(b),b.mode=20,T!==6)break;L>>>=2,B-=2;break e;case 2:b.mode=17;break;case 3:P.msg="invalid block type",b.mode=30}L>>>=2,B-=2;break;case 14:for(L>>>=7&B,B-=7&B;B<32;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if((65535&L)!=(L>>>16^65535)){P.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&L,B=L=0,b.mode=15,T===6)break e;case 15:b.mode=16;case 16:if($=b.length){if(Z<$&&($=Z),re<$&&($=re),$===0)break e;s.arraySet(Q,q,A,$,te),Z-=$,A+=$,re-=$,te+=$,b.length-=$;break}b.mode=12;break;case 17:for(;B<14;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if(b.nlen=257+(31&L),L>>>=5,B-=5,b.ndist=1+(31&L),L>>>=5,B-=5,b.ncode=4+(15&L),L>>>=4,B-=4,286<b.nlen||30<b.ndist){P.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;B<3;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}b.lens[G[b.have++]]=7&L,L>>>=3,B-=3}for(;b.have<19;)b.lens[G[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,z={bits:b.lenbits},W=u(0,b.lens,0,19,b.lencode,0,b.work,z),b.lenbits=z.bits,W){P.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;ae=(C=b.lencode[L&(1<<b.lenbits)-1])>>>16&255,ye=65535&C,!((se=C>>>24)<=B);){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if(ye<16)L>>>=se,B-=se,b.lens[b.have++]=ye;else{if(ye===16){for(O=se+2;B<O;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if(L>>>=se,B-=se,b.have===0){P.msg="invalid bit length repeat",b.mode=30;break}v=b.lens[b.have-1],$=3+(3&L),L>>>=2,B-=2}else if(ye===17){for(O=se+3;B<O;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}B-=se,v=0,$=3+(7&(L>>>=se)),L>>>=3,B-=3}else{for(O=se+7;B<O;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}B-=se,v=0,$=11+(127&(L>>>=se)),L>>>=7,B-=7}if(b.have+$>b.nlen+b.ndist){P.msg="invalid bit length repeat",b.mode=30;break}for(;$--;)b.lens[b.have++]=v}}if(b.mode===30)break;if(b.lens[256]===0){P.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,z={bits:b.lenbits},W=u(c,b.lens,0,b.nlen,b.lencode,0,b.work,z),b.lenbits=z.bits,W){P.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,z={bits:b.distbits},W=u(f,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,z),b.distbits=z.bits,W){P.msg="invalid distances set",b.mode=30;break}if(b.mode=20,T===6)break e;case 20:b.mode=21;case 21:if(6<=Z&&258<=re){P.next_out=te,P.avail_out=re,P.next_in=A,P.avail_in=Z,b.hold=L,b.bits=B,l(P,K),te=P.next_out,Q=P.output,re=P.avail_out,A=P.next_in,q=P.input,Z=P.avail_in,L=b.hold,B=b.bits,b.mode===12&&(b.back=-1);break}for(b.back=0;ae=(C=b.lencode[L&(1<<b.lenbits)-1])>>>16&255,ye=65535&C,!((se=C>>>24)<=B);){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if(ae&&!(240&ae)){for(he=se,de=ae,we=ye;ae=(C=b.lencode[we+((L&(1<<he+de)-1)>>he)])>>>16&255,ye=65535&C,!(he+(se=C>>>24)<=B);){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}L>>>=he,B-=he,b.back+=he}if(L>>>=se,B-=se,b.back+=se,b.length=ye,ae===0){b.mode=26;break}if(32&ae){b.back=-1,b.mode=12;break}if(64&ae){P.msg="invalid literal/length code",b.mode=30;break}b.extra=15&ae,b.mode=22;case 22:if(b.extra){for(O=b.extra;B<O;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}b.length+=L&(1<<b.extra)-1,L>>>=b.extra,B-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;ae=(C=b.distcode[L&(1<<b.distbits)-1])>>>16&255,ye=65535&C,!((se=C>>>24)<=B);){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if(!(240&ae)){for(he=se,de=ae,we=ye;ae=(C=b.distcode[we+((L&(1<<he+de)-1)>>he)])>>>16&255,ye=65535&C,!(he+(se=C>>>24)<=B);){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}L>>>=he,B-=he,b.back+=he}if(L>>>=se,B-=se,b.back+=se,64&ae){P.msg="invalid distance code",b.mode=30;break}b.offset=ye,b.extra=15&ae,b.mode=24;case 24:if(b.extra){for(O=b.extra;B<O;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}b.offset+=L&(1<<b.extra)-1,L>>>=b.extra,B-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){P.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(re===0)break e;if($=K-re,b.offset>$){if(($=b.offset-$)>b.whave&&b.sane){P.msg="invalid distance too far back",b.mode=30;break}ie=$>b.wnext?($-=b.wnext,b.wsize-$):b.wnext-$,$>b.length&&($=b.length),me=b.window}else me=Q,ie=te-b.offset,$=b.length;for(re<$&&($=re),re-=$,b.length-=$;Q[te++]=me[ie++],--$;);b.length===0&&(b.mode=21);break;case 26:if(re===0)break e;Q[te++]=b.length,re--,b.mode=21;break;case 27:if(b.wrap){for(;B<32;){if(Z===0)break e;Z--,L|=q[A++]<<B,B+=8}if(K-=re,P.total_out+=K,b.total+=K,K&&(P.adler=b.check=b.flags?a(b.check,Q,K,te-K):i(b.check,Q,K,te-K)),K=re,(b.flags?L:m(L))!==b.check){P.msg="incorrect data check",b.mode=30;break}B=L=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;B<32;){if(Z===0)break e;Z--,L+=q[A++]<<B,B+=8}if(L!==(4294967295&b.total)){P.msg="incorrect length check",b.mode=30;break}B=L=0}b.mode=29;case 29:W=1;break e;case 30:W=-3;break e;case 31:return-4;case 32:default:return h}return P.next_out=te,P.avail_out=re,P.next_in=A,P.avail_in=Z,b.hold=L,b.bits=B,(b.wsize||K!==P.avail_out&&b.mode<30&&(b.mode<27||T!==4))&&H(P,P.output,P.next_out,K-P.avail_out)?(b.mode=31,-4):(U-=P.avail_in,K-=P.avail_out,P.total_in+=U,P.total_out+=K,b.total+=K,b.wrap&&K&&(P.adler=b.check=b.flags?a(b.check,Q,K,P.next_out-K):i(b.check,Q,K,P.next_out-K)),P.data_type=b.bits+(b.last?64:0)+(b.mode===12?128:0)+(b.mode===20||b.mode===15?256:0),(U==0&&K===0||T===4)&&W===p&&(W=-5),W)},o.inflateEnd=function(P){if(!P||!P.state)return h;var T=P.state;return T.window&&(T.window=null),P.state=null,p},o.inflateGetHeader=function(P,T){var b;return P&&P.state&&2&(b=P.state).wrap?((b.head=T).done=!1,p):h},o.inflateSetDictionary=function(P,T){var b,q=T.length;return P&&P.state?(b=P.state).wrap!==0&&b.mode!==11?h:b.mode===11&&i(1,T,q,0)!==b.check?-3:H(P,T,q,q)?(b.mode=31,-4):(b.havedict=1,p):h},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,o){var s=n("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(c,f,p,h,w,d,y,m){var g,_,x,E,S,k,N,D,R,H=m.bits,P=0,T=0,b=0,q=0,Q=0,A=0,te=0,Z=0,re=0,L=0,B=null,U=0,K=new s.Buf16(16),$=new s.Buf16(16),ie=null,me=0;for(P=0;P<=15;P++)K[P]=0;for(T=0;T<h;T++)K[f[p+T]]++;for(Q=H,q=15;1<=q&&K[q]===0;q--);if(q<Q&&(Q=q),q===0)return w[d++]=20971520,w[d++]=20971520,m.bits=1,0;for(b=1;b<q&&K[b]===0;b++);for(Q<b&&(Q=b),P=Z=1;P<=15;P++)if(Z<<=1,(Z-=K[P])<0)return-1;if(0<Z&&(c===0||q!==1))return-1;for($[1]=0,P=1;P<15;P++)$[P+1]=$[P]+K[P];for(T=0;T<h;T++)f[p+T]!==0&&(y[$[f[p+T]]++]=T);if(k=c===0?(B=ie=y,19):c===1?(B=i,U-=257,ie=a,me-=257,256):(B=l,ie=u,-1),P=b,S=d,te=T=L=0,x=-1,E=(re=1<<(A=Q))-1,c===1&&852<re||c===2&&592<re)return 1;for(;;){for(N=P-te,R=y[T]<k?(D=0,y[T]):y[T]>k?(D=ie[me+y[T]],B[U+y[T]]):(D=96,0),g=1<<P-te,b=_=1<<A;w[S+(L>>te)+(_-=g)]=N<<24|D<<16|R|0,_!==0;);for(g=1<<P-1;L&g;)g>>=1;if(g!==0?(L&=g-1,L+=g):L=0,T++,--K[P]==0){if(P===q)break;P=f[p+y[T]]}if(Q<P&&(L&E)!==x){for(te===0&&(te=Q),S+=b,Z=1<<(A=P-te);A+te<q&&!((Z-=K[A+te])<=0);)A++,Z<<=1;if(re+=1<<A,c===1&&852<re||c===2&&592<re)return 1;w[x=L&E]=Q<<24|A<<16|S-d|0}}return L!==0&&(w[S+L]=P-te<<24|64<<16|0),m.bits=Q,0}},{"../utils/common":41}],51:[function(n,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,o){var s=n("../utils/common"),i=0,a=1;function l(C){for(var F=C.length;0<=--F;)C[F]=0}var u=0,c=29,f=256,p=f+1+c,h=30,w=19,d=2*p+1,y=15,m=16,g=7,_=256,x=16,E=17,S=18,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=new Array(2*(p+2));l(H);var P=new Array(2*h);l(P);var T=new Array(512);l(T);var b=new Array(256);l(b);var q=new Array(c);l(q);var Q,A,te,Z=new Array(h);function re(C,F,G,Y,M){this.static_tree=C,this.extra_bits=F,this.extra_base=G,this.elems=Y,this.max_length=M,this.has_stree=C&&C.length}function L(C,F){this.dyn_tree=C,this.max_code=0,this.stat_desc=F}function B(C){return C<256?T[C]:T[256+(C>>>7)]}function U(C,F){C.pending_buf[C.pending++]=255&F,C.pending_buf[C.pending++]=F>>>8&255}function K(C,F,G){C.bi_valid>m-G?(C.bi_buf|=F<<C.bi_valid&65535,U(C,C.bi_buf),C.bi_buf=F>>m-C.bi_valid,C.bi_valid+=G-m):(C.bi_buf|=F<<C.bi_valid&65535,C.bi_valid+=G)}function $(C,F,G){K(C,G[2*F],G[2*F+1])}function ie(C,F){for(var G=0;G|=1&C,C>>>=1,G<<=1,0<--F;);return G>>>1}function me(C,F,G){var Y,M,X=new Array(y+1),ne=0;for(Y=1;Y<=y;Y++)X[Y]=ne=ne+G[Y-1]<<1;for(M=0;M<=F;M++){var ee=C[2*M+1];ee!==0&&(C[2*M]=ie(X[ee]++,ee))}}function se(C){var F;for(F=0;F<p;F++)C.dyn_ltree[2*F]=0;for(F=0;F<h;F++)C.dyn_dtree[2*F]=0;for(F=0;F<w;F++)C.bl_tree[2*F]=0;C.dyn_ltree[2*_]=1,C.opt_len=C.static_len=0,C.last_lit=C.matches=0}function ae(C){8<C.bi_valid?U(C,C.bi_buf):0<C.bi_valid&&(C.pending_buf[C.pending++]=C.bi_buf),C.bi_buf=0,C.bi_valid=0}function ye(C,F,G,Y){var M=2*F,X=2*G;return C[M]<C[X]||C[M]===C[X]&&Y[F]<=Y[G]}function he(C,F,G){for(var Y=C.heap[G],M=G<<1;M<=C.heap_len&&(M<C.heap_len&&ye(F,C.heap[M+1],C.heap[M],C.depth)&&M++,!ye(F,Y,C.heap[M],C.depth));)C.heap[G]=C.heap[M],G=M,M<<=1;C.heap[G]=Y}function de(C,F,G){var Y,M,X,ne,ee=0;if(C.last_lit!==0)for(;Y=C.pending_buf[C.d_buf+2*ee]<<8|C.pending_buf[C.d_buf+2*ee+1],M=C.pending_buf[C.l_buf+ee],ee++,Y===0?$(C,M,F):($(C,(X=b[M])+f+1,F),(ne=k[X])!==0&&K(C,M-=q[X],ne),$(C,X=B(--Y),G),(ne=N[X])!==0&&K(C,Y-=Z[X],ne)),ee<C.last_lit;);$(C,_,F)}function we(C,F){var G,Y,M,X=F.dyn_tree,ne=F.stat_desc.static_tree,ee=F.stat_desc.has_stree,le=F.stat_desc.elems,_e=-1;for(C.heap_len=0,C.heap_max=d,G=0;G<le;G++)X[2*G]!==0?(C.heap[++C.heap_len]=_e=G,C.depth[G]=0):X[2*G+1]=0;for(;C.heap_len<2;)X[2*(M=C.heap[++C.heap_len]=_e<2?++_e:0)]=1,C.depth[M]=0,C.opt_len--,ee&&(C.static_len-=ne[2*M+1]);for(F.max_code=_e,G=C.heap_len>>1;1<=G;G--)he(C,X,G);for(M=le;G=C.heap[1],C.heap[1]=C.heap[C.heap_len--],he(C,X,1),Y=C.heap[1],C.heap[--C.heap_max]=G,C.heap[--C.heap_max]=Y,X[2*M]=X[2*G]+X[2*Y],C.depth[M]=(C.depth[G]>=C.depth[Y]?C.depth[G]:C.depth[Y])+1,X[2*G+1]=X[2*Y+1]=M,C.heap[1]=M++,he(C,X,1),2<=C.heap_len;);C.heap[--C.heap_max]=C.heap[1],function(ge,Ge){var mn,rt,yn,Pe,Gn,ro,ct=Ge.dyn_tree,Gs=Ge.max_code,wl=Ge.stat_desc.static_tree,bl=Ge.stat_desc.has_stree,_l=Ge.stat_desc.extra_bits,Js=Ge.stat_desc.extra_base,vn=Ge.stat_desc.max_length,Jn=0;for(Pe=0;Pe<=y;Pe++)ge.bl_count[Pe]=0;for(ct[2*ge.heap[ge.heap_max]+1]=0,mn=ge.heap_max+1;mn<d;mn++)vn<(Pe=ct[2*ct[2*(rt=ge.heap[mn])+1]+1]+1)&&(Pe=vn,Jn++),ct[2*rt+1]=Pe,Gs<rt||(ge.bl_count[Pe]++,Gn=0,Js<=rt&&(Gn=_l[rt-Js]),ro=ct[2*rt],ge.opt_len+=ro*(Pe+Gn),bl&&(ge.static_len+=ro*(wl[2*rt+1]+Gn)));if(Jn!==0){do{for(Pe=vn-1;ge.bl_count[Pe]===0;)Pe--;ge.bl_count[Pe]--,ge.bl_count[Pe+1]+=2,ge.bl_count[vn]--,Jn-=2}while(0<Jn);for(Pe=vn;Pe!==0;Pe--)for(rt=ge.bl_count[Pe];rt!==0;)Gs<(yn=ge.heap[--mn])||(ct[2*yn+1]!==Pe&&(ge.opt_len+=(Pe-ct[2*yn+1])*ct[2*yn],ct[2*yn+1]=Pe),rt--)}}(C,F),me(X,_e,C.bl_count)}function v(C,F,G){var Y,M,X=-1,ne=F[1],ee=0,le=7,_e=4;for(ne===0&&(le=138,_e=3),F[2*(G+1)+1]=65535,Y=0;Y<=G;Y++)M=ne,ne=F[2*(Y+1)+1],++ee<le&&M===ne||(ee<_e?C.bl_tree[2*M]+=ee:M!==0?(M!==X&&C.bl_tree[2*M]++,C.bl_tree[2*x]++):ee<=10?C.bl_tree[2*E]++:C.bl_tree[2*S]++,X=M,_e=(ee=0)===ne?(le=138,3):M===ne?(le=6,3):(le=7,4))}function W(C,F,G){var Y,M,X=-1,ne=F[1],ee=0,le=7,_e=4;for(ne===0&&(le=138,_e=3),Y=0;Y<=G;Y++)if(M=ne,ne=F[2*(Y+1)+1],!(++ee<le&&M===ne)){if(ee<_e)for(;$(C,M,C.bl_tree),--ee!=0;);else M!==0?(M!==X&&($(C,M,C.bl_tree),ee--),$(C,x,C.bl_tree),K(C,ee-3,2)):ee<=10?($(C,E,C.bl_tree),K(C,ee-3,3)):($(C,S,C.bl_tree),K(C,ee-11,7));X=M,_e=(ee=0)===ne?(le=138,3):M===ne?(le=6,3):(le=7,4)}}l(Z);var z=!1;function O(C,F,G,Y){K(C,(u<<1)+(Y?1:0),3),function(M,X,ne,ee){ae(M),ee&&(U(M,ne),U(M,~ne)),s.arraySet(M.pending_buf,M.window,X,ne,M.pending),M.pending+=ne}(C,F,G,!0)}o._tr_init=function(C){z||(function(){var F,G,Y,M,X,ne=new Array(y+1);for(M=Y=0;M<c-1;M++)for(q[M]=Y,F=0;F<1<<k[M];F++)b[Y++]=M;for(b[Y-1]=M,M=X=0;M<16;M++)for(Z[M]=X,F=0;F<1<<N[M];F++)T[X++]=M;for(X>>=7;M<h;M++)for(Z[M]=X<<7,F=0;F<1<<N[M]-7;F++)T[256+X++]=M;for(G=0;G<=y;G++)ne[G]=0;for(F=0;F<=143;)H[2*F+1]=8,F++,ne[8]++;for(;F<=255;)H[2*F+1]=9,F++,ne[9]++;for(;F<=279;)H[2*F+1]=7,F++,ne[7]++;for(;F<=287;)H[2*F+1]=8,F++,ne[8]++;for(me(H,p+1,ne),F=0;F<h;F++)P[2*F+1]=5,P[2*F]=ie(F,5);Q=new re(H,k,f+1,p,y),A=new re(P,N,0,h,y),te=new re(new Array(0),D,0,w,g)}(),z=!0),C.l_desc=new L(C.dyn_ltree,Q),C.d_desc=new L(C.dyn_dtree,A),C.bl_desc=new L(C.bl_tree,te),C.bi_buf=0,C.bi_valid=0,se(C)},o._tr_stored_block=O,o._tr_flush_block=function(C,F,G,Y){var M,X,ne=0;0<C.level?(C.strm.data_type===2&&(C.strm.data_type=function(ee){var le,_e=4093624447;for(le=0;le<=31;le++,_e>>>=1)if(1&_e&&ee.dyn_ltree[2*le]!==0)return i;if(ee.dyn_ltree[18]!==0||ee.dyn_ltree[20]!==0||ee.dyn_ltree[26]!==0)return a;for(le=32;le<f;le++)if(ee.dyn_ltree[2*le]!==0)return a;return i}(C)),we(C,C.l_desc),we(C,C.d_desc),ne=function(ee){var le;for(v(ee,ee.dyn_ltree,ee.l_desc.max_code),v(ee,ee.dyn_dtree,ee.d_desc.max_code),we(ee,ee.bl_desc),le=w-1;3<=le&&ee.bl_tree[2*R[le]+1]===0;le--);return ee.opt_len+=3*(le+1)+5+5+4,le}(C),M=C.opt_len+3+7>>>3,(X=C.static_len+3+7>>>3)<=M&&(M=X)):M=X=G+5,G+4<=M&&F!==-1?O(C,F,G,Y):C.strategy===4||X===M?(K(C,2+(Y?1:0),3),de(C,H,P)):(K(C,4+(Y?1:0),3),function(ee,le,_e,ge){var Ge;for(K(ee,le-257,5),K(ee,_e-1,5),K(ee,ge-4,4),Ge=0;Ge<ge;Ge++)K(ee,ee.bl_tree[2*R[Ge]+1],3);W(ee,ee.dyn_ltree,le-1),W(ee,ee.dyn_dtree,_e-1)}(C,C.l_desc.max_code+1,C.d_desc.max_code+1,ne+1),de(C,C.dyn_ltree,C.dyn_dtree)),se(C),Y&&ae(C)},o._tr_tally=function(C,F,G){return C.pending_buf[C.d_buf+2*C.last_lit]=F>>>8&255,C.pending_buf[C.d_buf+2*C.last_lit+1]=255&F,C.pending_buf[C.l_buf+C.last_lit]=255&G,C.last_lit++,F===0?C.dyn_ltree[2*G]++:(C.matches++,F--,C.dyn_ltree[2*(b[G]+f+1)]++,C.dyn_dtree[2*B(F)]++),C.last_lit===C.lit_bufsize-1},o._tr_align=function(C){K(C,2,3),$(C,_,H),function(F){F.bi_valid===16?(U(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):8<=F.bi_valid&&(F.pending_buf[F.pending++]=255&F.bi_buf,F.bi_buf>>=8,F.bi_valid-=8)}(C)}},{"../utils/common":41}],53:[function(n,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,o){(function(s){(function(i,a){if(!i.setImmediate){var l,u,c,f,p=1,h={},w=!1,d=i.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(i);y=y&&y.setTimeout?y:i,l={}.toString.call(i.process)==="[object process]"?function(x){process.nextTick(function(){g(x)})}:function(){if(i.postMessage&&!i.importScripts){var x=!0,E=i.onmessage;return i.onmessage=function(){x=!1},i.postMessage("","*"),i.onmessage=E,x}}()?(f="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",_,!1):i.attachEvent("onmessage",_),function(x){i.postMessage(f+x,"*")}):i.MessageChannel?((c=new MessageChannel).port1.onmessage=function(x){g(x.data)},function(x){c.port2.postMessage(x)}):d&&"onreadystatechange"in d.createElement("script")?(u=d.documentElement,function(x){var E=d.createElement("script");E.onreadystatechange=function(){g(x),E.onreadystatechange=null,u.removeChild(E),E=null},u.appendChild(E)}):function(x){setTimeout(g,0,x)},y.setImmediate=function(x){typeof x!="function"&&(x=new Function(""+x));for(var E=new Array(arguments.length-1),S=0;S<E.length;S++)E[S]=arguments[S+1];var k={callback:x,args:E};return h[p]=k,l(p),p++},y.clearImmediate=m}function m(x){delete h[x]}function g(x){if(w)setTimeout(g,0,x);else{var E=h[x];if(E){w=!0;try{(function(S){var k=S.callback,N=S.args;switch(N.length){case 0:k();break;case 1:k(N[0]);break;case 2:k(N[0],N[1]);break;case 3:k(N[0],N[1],N[2]);break;default:k.apply(a,N)}})(E)}finally{m(x),w=!1}}}}function _(x){x.source===i&&typeof x.data=="string"&&x.data.indexOf(f)===0&&g(+x.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Yn<"u"?Yn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(gl);var cp=gl.exports;const up=ja(cp),dp=async t=>{const e=`ComfyUI workspace workflows ${as(Date.now())}`,n=new up,r=await(J==null?void 0:J.getSetting("twoWaySync"));for(const o of t){let s;r?s=o.parentFolderID??"":s=await dh(o.parentFolderID??null).then(async a=>Dt(a??""));const i=n.folder(s);i==null||i.file(`${o.name}.json`,o.json)}n.generateAsync({type:"blob"}).then(function(o){const s=document.createElement("a");s.href=window.URL.createObjectURL(o),s.download=`${e}.zip`,document.body.appendChild(s),s.click(),document.body.removeChild(s)})};function fp({myWorkflowsDir:t}){return I.jsxs(tn,{gap:3,children:[I.jsx(xs,{size:"md",children:"🦄 Upgrade to 2.0 - enable two way sync!"}),I.jsx("p",{children:"Your workflows will be synced to and from path:"}),I.jsx("p",{children:I.jsx("b",{children:t})}),I.jsxs("p",{children:["You can manually put workflow files into this folder using File Explorer to sync them with your workspace. You can change this path anytime in Settings ",">"," Workspace Save Directory"]}),I.jsxs("p",{children:[I.jsx("b",{children:"Please download all your workflows before enabling two way sync as a backup!"})," ","So you can manually import some workflows into your workspace in case something unexpected happens."]}),I.jsx(Ue,{colorScheme:"teal",variant:"outline",width:"fit-content",onClick:async()=>{const e=await(V==null?void 0:V.listAll());dp(e??[])},children:"👉 Download All My Workflows"})]})}const hp=(t,e)=>{const n=t.nodes==null?[]:t.nodes,r=e.nodes==null?[]:e.nodes;t.nodes=[],e.nodes=[];let o=JSON.stringify(t)===JSON.stringify(e);if(o&&n.length==r.length){const s=n.reduce((a,l)=>(a.set(l.id,JSON.stringify(l)),a),new Map),i=r.reduce((a,l)=>(a.set(l.id,JSON.stringify(l)),a),new Map);for(let[a,l]of s)if(!i.has(a)||i.get(a)!==l){o=!1;break}}return t.nodes=n,e.nodes=r,o},pp=bs.lazy(()=>Hr(()=>import("./RecentFilesDrawer-fq0hc2Wu.js"),__vite__mapDeps([5,1,6,2,7,8,4]))),mp=bs.lazy(()=>Hr(()=>import("./GalleryModal-lhQLQXfc.js"),__vite__mapDeps([9,1,8,6,2,10,3]))),yp=bs.lazy(()=>Hr(()=>import("./ModelManagerTopbar-XY6ict4r.js").then(t=>t.M),__vite__mapDeps([11,1,6,2,10,12]))),vp=["download_progress","download_error","model_list"];function gp(){const[t,e]=j.useState(null),[n,r]=j.useState("root"),[o,s]=j.useState(!0),[i,a]=j.useState(null),l=j.useRef(null),[u,c]=j.useState(!1),f=j.useRef(null),{showDialog:p}=Ta(),[h,w]=j.useState(!1);j.useRef(!1);const d=j.useRef(0),y=Ma(),m=j.useRef("hide"),[g,_]=j.useState(null),[x,E,S]=lp(null),k=j.useCallback(async()=>{var U;if(l.current){if((U=V==null?void 0:V.curWorkflow)!=null&&U.saveLock){y({title:"The workflow is locked and cannot be saved",status:"warning",duration:3e3});return}const K=JSON.stringify(be.graph.serialize());await Promise.all([V==null?void 0:V.updateFlow(l.current,{json:K}),Te==null?void 0:Te.create({workflowID:l.current,json:K})]),J!=null&&J.autoSave&&y({title:"Saved",status:"success",duration:1e3,isClosable:!0}),c(!1)}},[]),N=async()=>{l.current&&confirm("Are you sure you want to delete this workflow?")&&(await(V==null?void 0:V.delete(l.current)),R(null))},D=async()=>{var K,$,ie;if(confirm("Are you sure you want to discard unsaved changes? This will revert current workflow to your last saved version. You will lose all changes made since your last save.")){const me=(K=V==null?void 0:V.curWorkflow)==null?void 0:K.id;if(me==null)return;let se;J!=null&&J.autoSave?se=($=await(Te==null?void 0:Te.getLastestByWorkflowID(me)))==null?void 0:$.json:se=(ie=await(V==null?void 0:V.get(me)))==null?void 0:ie.json,se?(V==null||V.updateCurWorkflow({...V.curWorkflow,json:se}),await be.loadGraphData(JSON.parse(se))):alert("Error: No last saved version found")}},R=U=>{const K=(U==null?void 0:U.id)??null;if(V==null||V.updateCurWorkflow(U),l.current=K,a(K),e((U==null?void 0:U.name)??""),K==null){document.title="ComfyUI",window.location.hash="",localStorage.removeItem("curFlowID");return}if(Oa()){const $=dl(K);window.location.hash=$,document.title=U.name+" - ComfyUI"}else localStorage.setItem("curFlowID",K),document.title="ComfyUI - "+U.name},H=async()=>{P(),localStorage.removeItem("workspace"),localStorage.removeItem("comfyspace");try{await _h()}catch(K){console.error("error loading db",K)}s(!1);let U=null;U=Oa(),U==null&&(U=localStorage.getItem("curFlowID")),U&&b(U),await cl(),fe.cache.get(wo).then(async K=>{if((K==null?void 0:K.value)!=="true"){if(await fe.workflows.count()==0){await(J==null?void 0:J.upsert({twoWaySync:!0})),await fe.cache.put({id:wo,value:"true"});return}const ie=await(J==null?void 0:J.getSetting("myWorkflowsDir"));p(I.jsx(fp,{myWorkflowsDir:ie??"undefined"}),[{label:"I have downloaded all my workflows and ready to enable",onClick:async()=>{await(J==null?void 0:J.upsert({twoWaySync:!0})),await(J==null?void 0:J.getSetting("twoWaySync"))&&(fe.cache.put({id:wo,value:"true"}),location.reload())},colorScheme:"red"}],{closeOnOverlayClick:!1})}})},P=()=>{vp.forEach(U=>{Ys.addEventListener(U,()=>null)})},T=()=>{if(l.current==null)return!1;const U=V==null?void 0:V.curWorkflow;if(U==null)return!1;if(U.json==null)return!0;const K=be.graph.serialize()??{};let $={};try{$=U!=null&&U.json?JSON.parse(U==null?void 0:U.json):{}}catch(me){console.error("error parsing json",me)}return!hp(K,$)},b=async(U,K)=>{if(be.graph==null){console.error("app.graph is null cannot load workflow");return}const $=await(V==null?void 0:V.get(U));if($==null){alert("Error: Workflow not found! id: "+U),R(null);return}const ie=K?await(xe==null?void 0:xe.get(K)):null;be.ui.dialog.close(),ie?(E(ie),R({...$,json:ie.json}),be.loadGraphData(JSON.parse(ie.json))):(R($),E(null),be.loadGraphData(JSON.parse($.json))),r("root"),u&&c(!1)},q=U=>{_(U)},Q=async(U,K,$=!1)=>{if(U===null){R(null),be.graph.clear();return}if(!u||$||await(J==null?void 0:J.getSetting("autoSave"))){b(U,K);return}A(U)},A=async U=>{var $,ie;const K=[U?{label:"Open in new tab",icon:I.jsx(Nh,{}),onClick:()=>{mh(U)}}:null,{label:"Save",colorScheme:"teal",onClick:async()=>{await k(),U&&b(U)}}];(($=V==null?void 0:V.curWorkflow)==null?void 0:$.lastSavedJson)!=null?K.push({label:"Discard",colorScheme:"red",onClick:async()=>{U&&b(U)}}):K.push({label:"Delete",colorScheme:"red",onClick:async()=>{await N(),U&&b(U)}}),p(`Please save or discard your changes to "${(ie=V==null?void 0:V.curWorkflow)==null?void 0:ie.name}" before leaving, or your changes will be lost.`,K)},te=async U=>{const K=(U==null?void 0:U.json)??JSON.stringify(br),$=await(V==null?void 0:V.createFlow({json:K,name:U==null?void 0:U.name}));$&&await Q($.id),r("root")},Z=async(U,K=!1)=>{const $=U.split("/").pop()??U;K?k():te({name:$});const ie=await fetch(ph(U)),me=await ie.blob(),se=new File([me],$,{type:ie.headers.get("Content-Type")||""});await be.handleFile(se),r("root")},re=async(U,K)=>{const $=await(V==null?void 0:V.get(U));if($==null)return;const ie=await(V==null?void 0:V.createFlow({json:$.json,lastSavedJson:$.lastSavedJson,name:K||$.name,parentFolderID:$.parentFolderID,tags:$.tags}));ie&&await Q(ie.id)},L=j.useCallback(U=>{if(l.current==null)return;let K=U.filename;U.subfolder!=null&&U.subfolder!==""&&(K=U.subfolder+"/"+K),Kt==null||Kt.create({workflowID:l.current,localPath:K})},[]),B=j.useCallback(()=>{r("root")},[]);return j.useEffect(()=>{H(),w(!0),d.current=setInterval(async()=>{var he;const ae=J==null?void 0:J.autoSave;if((he=V==null?void 0:V.curWorkflow)!=null&&he.saveLock)return;const ye=T();if(c(!!ye),!!ye&&(S.current!=null&&S.current.json!==JSON.stringify(be.graph.serialize())&&E(null),l.current!=null&&ae)){const de=await(V==null?void 0:V.latestVersionCheck());if(m.current!=="disabled"&&!de)m.current="show",p(`This notification is to inform you that it appears you've opened the same workflow in multiple tabs. If all tabs are set to auto-save, this may lead to conflicts and potential data loss.

You might want to consider disabling auto-save to prevent this. We will remind you to save changes if you leave a page with unsaved work.`,[{label:"Do Not Remind Again",onClick:()=>{m.current="disabled"}},{label:"Disable Auto-Save",colorScheme:"teal",onClick:()=>{J==null||J.upsert({autoSave:!1})}}]);else{const we=JSON.stringify(be.graph.serialize());we!=null&&await(V==null?void 0:V.updateFlow(l.current,{json:we}))}}},1e3);const U=async ae=>{if(document.visibilityState==="hidden")return;switch(await hh(ae)){case rs.SAVE:k();break;case rs.SAVE_AS:r("saveAsModal");break}};window.addEventListener("keydown",U);const K=document.getElementById("comfy-file-input"),$=async()=>{if(K&&K.files&&K.files.length>0){const ae={id:Fn(),name:K.files[0].name,json:JSON.stringify(br),updateTime:Date.now(),createTime:Date.now()};R(ae),await(V==null?void 0:V.createFlow(ae))}};K==null||K.addEventListener("change",$);const ie=ae=>{var de;const ye=(J==null?void 0:J.autoSave)??!0;if((de=V==null?void 0:V.curWorkflow)!=null&&de.saveLock)return;const he=T();!ye&&he&&(ae.preventDefault(),ae.returnValue="You have unsaved changes!",A())};window.addEventListener("beforeunload",ie);const me=ae=>{var ye,he,de,we,v,W;(de=(he=(ye=ae.detail)==null?void 0:ye.output)==null?void 0:he.images)==null||de.forEach(z=>{z.type==="output"&&L(z)}),(W=(v=(we=ae.detail)==null?void 0:we.output)==null?void 0:v.gifs)==null||W.forEach(z=>{z.type==="output"&&L(z)})};Ys.addEventListener("executed",me);const se=async ae=>{var we,v;const ye=(v=(we=ae.dataTransfer)==null?void 0:we.files[0])==null?void 0:v.name,he=be.dragOverNode;if(he&&he.onDragDrop)return;if(!(await(J==null?void 0:J.getSetting("overwriteCurWorkflowWhenDroppingFileToCanvas"))??!1)&&ye){const W={id:Fn(),name:ye,json:JSON.stringify(br),updateTime:Date.now(),createTime:Date.now()};R(W),await(V==null?void 0:V.createFlow(W))}};return be.canvasEl.addEventListener("drop",se),()=>{window.removeEventListener("keydown",U),window.removeEventListener("change",$),window.removeEventListener("beforeunload",ie),window.removeEventListener("executed",me),be.canvasEl.removeEventListener("drop",se),clearInterval(d.current)}},[]),o?null:I.jsx(wt.Provider,{value:{curFlowID:i,onDuplicateWorkflow:re,loadWorkflowID:Q,discardUnsavedChanges:D,saveCurWorkflow:k,isDirty:u,loadNewWorkflow:te,loadFilePath:Z,setRoute:r,route:n,jsonDiff:g,compareJson:q,curVersion:x},children:I.jsx("div",{ref:f,className:"workspace_manager",children:I.jsxs(Fa,{containerRef:f,children:[I.jsxs(pt,{style:{position:"absolute",top:0,right:0,left:0},zIndex:uh,draggable:!1,children:[I.jsx(op,{curFlowName:t,setCurFlowName:e}),h&&I.jsx(j.Suspense,{children:I.jsx(yp,{})}),h&&n==="recentFlows"&&I.jsx(j.Suspense,{children:I.jsx(pp,{onClose:B,onClickNewFlow:()=>{te(),r("root")}})}),n==="gallery"&&I.jsx(j.Suspense,{children:I.jsx(mp,{onclose:()=>r("root")})})]}),I.jsx(sp,{})]})})})}const qp=Object.freeze(Object.defineProperty({__proto__:null,default:gp},Symbol.toStringTag,{value:"Module"}));export{vi as $,V as A,pt as B,$h as C,qh as D,rs as E,kn as F,dp as G,Ft as H,jn as I,jh as J,Fp as K,Fh as L,mi as M,Le as N,Vr as O,Gr as P,Zr as Q,Wp as R,xd as S,Rs as T,zh as U,br as V,Rp as W,gr as X,bh as Y,Np as Z,uc as _,kp as a,yi as a0,xi as a1,gi as a2,bi as a3,wi as a4,wt as a5,yl as a6,as as a7,mh as a8,Nh as a9,Rh as aA,dn as aB,Kp as aC,xe as aD,Up as aE,$p as aF,ep as aG,tp as aH,tc as aI,qp as aJ,Et as aa,nc as ab,uh as ac,Op as ad,ul as ae,Tp as af,La as ag,Wa as ah,en as ai,dc as aj,Bp as ak,Kt as al,xs as am,Ac as an,Kl as ao,fe as ap,zp as aq,Lp as ar,Pp as as,jp as at,Pc as au,lp as av,gh as aw,Mp as ax,Dp as ay,kh as az,jc as b,Sp as c,Ep as d,Cp as e,fn as f,Xr as g,Fe as h,Wh as i,Ma as j,tn as k,Bt as l,zt as m,Un as n,J as o,fp as p,cf as q,Ip as r,Ap as s,_r as t,Yr as u,Co as v,Ns as w,Fs as x,bt as y,Ah as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["workspace_web/ShareDialog-0cQf3wfl.js","workspace_web/input.js","workspace_web/index-pz0vT7Or.js","workspace_web/chunk-K7XRJ7NL-DRLDc1uk.js","workspace_web/IconCopy-WkAIl9eH.js","workspace_web/RecentFilesDrawer-fq0hc2Wu.js","workspace_web/chunk-JARCRF6W-jACX-GXt.js","workspace_web/chunk-NTCQBYKE-SHdLDKPa.js","workspace_web/MediaPreview-Y6b1bLN0.js","workspace_web/GalleryModal-lhQLQXfc.js","workspace_web/chunk-3RSXBRAN-FDf0ncKM.js","workspace_web/ModelManagerTopbar-XY6ict4r.js","workspace_web/assets/ModelManagerTopbar--iv3sdjQ.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}