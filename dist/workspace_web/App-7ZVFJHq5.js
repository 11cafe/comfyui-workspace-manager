var El=Object.defineProperty;var Sl=(t,e,n)=>e in t?El(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var je=(t,e,n)=>(Sl(t,typeof e!="symbol"?e+"":e,n),n);import{u as Cl,a as Il,r as P,c as Ol,b as nt,m as Le,d as Mt,f as _e,e as Ee,j as O,B as Dl,g as we,h as qe,i as jl,o as rt,k as At,l as st,I as Wr,n as Ur,p as oo,q as Oe,s as fa,t as Pl,v as Al,w as Nl,x as Kr,y as Fl,z as Rl,A as Tl,C as Bl,D as Ml,E as ha,F as Ns,G as pa,H as Fs,J as zl,K as Ll,L as Wl,P as Rs,M as $r,N as ma,O as qr,Q as ya,R as va,S as ga,T as wa,_ as Hr,U as Ts,V as Bs,W as Xn,X as ba}from"./input.js";import{app as Se}from"/scripts/app.js";import{api as Xa}from"/scripts/api.js";function Ul(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}function Ms(t){var e;return Ul(t)&&(e=t.ownerDocument)!=null?e:document}function Kl(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var $l=Kl();function ql(t){const e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function zs(t){const{theme:e}=Cl(),n=Il();return P.useMemo(()=>Ol(e.direction,{...n,...t}),[t,e.direction,n])}var Hl=Object.defineProperty,Vl=(t,e,n)=>e in t?Hl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pe=(t,e,n)=>(Vl(t,typeof e!="symbol"?e+"":e,n),n);function Qa(t){return t.sort((e,n)=>{const r=e.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var Zl=t=>typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE;function es(t,e,n){let r=t+1;return n&&r>=e&&(r=0),r}function ts(t,e,n){let r=t-1;return n&&r<0&&(r=e),r}var xo=typeof window<"u"?P.useLayoutEffect:P.useEffect,kr=t=>t,Gl=class{constructor(){Pe(this,"descendants",new Map),Pe(this,"register",t=>{if(t!=null)return Zl(t)?this.registerNode(t):e=>{this.registerNode(e,t)}}),Pe(this,"unregister",t=>{this.descendants.delete(t);const e=Qa(Array.from(this.descendants.keys()));this.assignIndex(e)}),Pe(this,"destroy",()=>{this.descendants.clear()}),Pe(this,"assignIndex",t=>{this.descendants.forEach(e=>{const n=t.indexOf(e.node);e.index=n,e.node.dataset.index=e.index.toString()})}),Pe(this,"count",()=>this.descendants.size),Pe(this,"enabledCount",()=>this.enabledValues().length),Pe(this,"values",()=>Array.from(this.descendants.values()).sort((e,n)=>e.index-n.index)),Pe(this,"enabledValues",()=>this.values().filter(t=>!t.disabled)),Pe(this,"item",t=>{if(this.count()!==0)return this.values()[t]}),Pe(this,"enabledItem",t=>{if(this.enabledCount()!==0)return this.enabledValues()[t]}),Pe(this,"first",()=>this.item(0)),Pe(this,"firstEnabled",()=>this.enabledItem(0)),Pe(this,"last",()=>this.item(this.descendants.size-1)),Pe(this,"lastEnabled",()=>{const t=this.enabledValues().length-1;return this.enabledItem(t)}),Pe(this,"indexOf",t=>{var e,n;return t&&(n=(e=this.descendants.get(t))==null?void 0:e.index)!=null?n:-1}),Pe(this,"enabledIndexOf",t=>t==null?-1:this.enabledValues().findIndex(e=>e.node.isSameNode(t))),Pe(this,"next",(t,e=!0)=>{const n=es(t,this.count(),e);return this.item(n)}),Pe(this,"nextEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=es(r,this.enabledCount(),e);return this.enabledItem(o)}),Pe(this,"prev",(t,e=!0)=>{const n=ts(t,this.count()-1,e);return this.item(n)}),Pe(this,"prevEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=ts(r,this.enabledCount()-1,e);return this.enabledItem(o)}),Pe(this,"registerNode",(t,e)=>{if(!t||this.descendants.has(t))return;const n=Array.from(this.descendants.keys()).concat(t),r=Qa(n);e!=null&&e.disabled&&(e.disabled=!!e.disabled);const o={node:t,index:-1,...e};this.descendants.set(t,o),this.assignIndex(r)})}};function Jl(){const t=P.useRef(new Gl);return xo(()=>()=>t.current.destroy()),t.current}var[Yl,Ls]=nt({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function Xl(t){const e=Ls(),[n,r]=P.useState(-1),o=P.useRef(null);xo(()=>()=>{o.current&&e.unregister(o.current)},[]),xo(()=>{if(!o.current)return;const i=Number(o.current.dataset.index);n!=i&&!Number.isNaN(i)&&r(i)});const a=kr(t?e.register(t):e.register);return{descendants:e,index:n,enabledIndex:e.enabledIndexOf(o.current),register:Le(a,o)}}function Ws(){return[kr(Yl),()=>kr(Ls()),()=>Jl(),o=>Xl(o)]}function Us(t){const{value:e,defaultValue:n,onChange:r,shouldUpdate:o=(p,h)=>p!==h}=t,a=Mt(r),i=Mt(o),[s,l]=P.useState(n),c=e!==void 0,u=c?e:s,d=Mt(p=>{const v=typeof p=="function"?p(u):p;i(u,v)&&(c||l(v),a(v))},[c,a,u,i]);return[u,d]}function _a(t){return P.Children.toArray(t).filter(e=>P.isValidElement(e))}var Ql={horizontal:{"> *:first-of-type:not(:last-of-type)":{borderEndRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderStartRadius:0}},vertical:{"> *:first-of-type:not(:last-of-type)":{borderBottomRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderTopRadius:0}}},ec={horizontal:t=>({"& > *:not(style) ~ *:not(style)":{marginStart:t}}),vertical:t=>({"& > *:not(style) ~ *:not(style)":{marginTop:t}})},Ks=_e(function(e,n){const{size:r,colorScheme:o,variant:a,className:i,spacing:s="0.5rem",isAttached:l,isDisabled:c,orientation:u="horizontal",...d}=e,p=Ee("chakra-button__group",i),h=P.useMemo(()=>({size:r,colorScheme:o,variant:a,isDisabled:c}),[r,o,a,c]);let v={display:"inline-flex",...l?Ql[u]:ec[u](s)};const f=u==="vertical";return O.jsx(Dl,{value:h,children:O.jsx(we.div,{ref:n,role:"group",__css:v,className:p,"data-attached":l?"":void 0,"data-orientation":u,flexDir:f?"column":void 0,...d})})});Ks.displayName="ButtonGroup";var Pn=_e((t,e)=>{const{icon:n,children:r,isRound:o,"aria-label":a,...i}=t,s=n||r,l=P.isValidElement(s)?P.cloneElement(s,{"aria-hidden":!0,focusable:!1}):null;return O.jsx(qe,{padding:"0",borderRadius:o?"full":void 0,ref:e,"aria-label":a,...i,children:l})});Pn.displayName="IconButton";var[tc,$s]=jl("Card"),nc=_e(function(e,n){const{className:r,...o}=e,a=$s();return O.jsx(we.div,{ref:n,className:Ee("chakra-card__body",r),__css:a.body,...o})}),rc=_e(function(e,n){const{className:r,...o}=e,a=$s();return O.jsx(we.div,{ref:n,className:Ee("chakra-card__header",r),__css:a.header,...o})}),oc=_e(function(e,n){const{className:r,children:o,direction:a="column",justify:i,align:s,...l}=rt(e),c=At("Card",e);return O.jsx(we.div,{ref:n,className:Ee("chakra-card",r),__css:{display:"flex",flexDirection:a,justifyContent:i,alignItems:s,position:"relative",minWidth:0,wordWrap:"break-word",...c.container},...l,children:O.jsx(tc,{value:c,children:o})})}),[ac,qs]=nt({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[sc,hn]=nt({strict:!1,name:"FormControlContext"});function ic(t){const{id:e,isRequired:n,isInvalid:r,isDisabled:o,isReadOnly:a,...i}=t,s=P.useId(),l=e||`field-${s}`,c=`${l}-label`,u=`${l}-feedback`,d=`${l}-helptext`,[p,h]=P.useState(!1),[v,f]=P.useState(!1),[y,m]=P.useState(!1),w=P.useCallback((k={},R=null)=>({id:d,...k,ref:Le(R,D=>{D&&f(!0)})}),[d]),_=P.useCallback((k={},R=null)=>({...k,ref:R,"data-focus":st(y),"data-disabled":st(o),"data-invalid":st(r),"data-readonly":st(a),id:k.id!==void 0?k.id:c,htmlFor:k.htmlFor!==void 0?k.htmlFor:l}),[l,o,y,r,a,c]),x=P.useCallback((k={},R=null)=>({id:u,...k,ref:Le(R,D=>{D&&h(!0)}),"aria-live":"polite"}),[u]),E=P.useCallback((k={},R=null)=>({...k,...i,ref:R,role:"group","data-focus":st(y),"data-disabled":st(o),"data-invalid":st(r),"data-readonly":st(a)}),[i,o,y,r,a]),I=P.useCallback((k={},R=null)=>({...k,ref:R,role:"presentation","aria-hidden":!0,children:k.children||"*"}),[]);return{isRequired:!!n,isInvalid:!!r,isReadOnly:!!a,isDisabled:!!o,isFocused:!!y,onFocus:()=>m(!0),onBlur:()=>m(!1),hasFeedbackText:p,setHasFeedbackText:h,hasHelpText:v,setHasHelpText:f,id:l,labelId:c,feedbackId:u,helpTextId:d,htmlProps:i,getHelpTextProps:w,getErrorMessageProps:x,getRootProps:E,getLabelProps:_,getRequiredIndicatorProps:I}}var Vr=_e(function(e,n){const r=At("Form",e),o=rt(e),{getRootProps:a,htmlProps:i,...s}=ic(o),l=Ee("chakra-form-control",e.className);return O.jsx(sc,{value:s,children:O.jsx(ac,{value:r,children:O.jsx(we.div,{...a({},n),className:l,__css:r.container})})})});Vr.displayName="FormControl";var lc=_e(function(e,n){const r=hn(),o=qs(),a=Ee("chakra-form__helper-text",e.className);return O.jsx(we.div,{...r==null?void 0:r.getHelpTextProps(e,n),__css:o.helperText,className:a})});lc.displayName="FormHelperText";var[cc,uc]=nt({name:"FormErrorStylesContext",errorMessage:`useFormErrorStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormError />" `}),Zr=_e((t,e)=>{const n=At("FormError",t),r=rt(t),o=hn();return o!=null&&o.isInvalid?O.jsx(cc,{value:n,children:O.jsx(we.div,{...o==null?void 0:o.getErrorMessageProps(r,e),className:Ee("chakra-form__error-message",t.className),__css:{display:"flex",alignItems:"center",...n.text}})}):null});Zr.displayName="FormErrorMessage";var dc=_e((t,e)=>{const n=uc(),r=hn();if(!(r!=null&&r.isInvalid))return null;const o=Ee("chakra-form__error-icon",t.className);return O.jsx(Wr,{ref:e,"aria-hidden":!0,...t,__css:n.icon,className:o,children:O.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})});dc.displayName="FormErrorIcon";var Gr=_e(function(e,n){var r;const o=Ur("FormLabel",e),a=rt(e),{className:i,children:s,requiredIndicator:l=O.jsx(Hs,{}),optionalIndicator:c=null,...u}=a,d=hn(),p=(r=d==null?void 0:d.getLabelProps(u,n))!=null?r:{ref:n,...u};return O.jsxs(we.label,{...p,className:Ee("chakra-form__label",a.className),__css:{display:"block",textAlign:"start",...o},children:[s,d!=null&&d.isRequired?l:c]})});Gr.displayName="FormLabel";var Hs=_e(function(e,n){const r=hn(),o=qs();if(!(r!=null&&r.isRequired))return null;const a=Ee("chakra-form__required-indicator",e.className);return O.jsx(we.span,{...r==null?void 0:r.getRequiredIndicatorProps(e,n),__css:o.requiredIndicator,className:a})});Hs.displayName="RequiredIndicator";function fc(t){const{isDisabled:e,isInvalid:n,isReadOnly:r,isRequired:o,...a}=hc(t);return{...a,disabled:e,readOnly:r,required:o,"aria-invalid":oo(n),"aria-required":oo(o),"aria-readonly":oo(r)}}function hc(t){var e,n,r;const o=hn(),{id:a,disabled:i,readOnly:s,required:l,isRequired:c,isInvalid:u,isReadOnly:d,isDisabled:p,onFocus:h,onBlur:v,...f}=t,y=t["aria-describedby"]?[t["aria-describedby"]]:[];return o!=null&&o.hasFeedbackText&&(o!=null&&o.isInvalid)&&y.push(o.feedbackId),o!=null&&o.hasHelpText&&y.push(o.helpTextId),{...f,"aria-describedby":y.join(" ")||void 0,id:a??(o==null?void 0:o.id),isDisabled:(e=i??p)!=null?e:o==null?void 0:o.isDisabled,isReadOnly:(n=s??d)!=null?n:o==null?void 0:o.isReadOnly,isRequired:(r=l??c)!=null?r:o==null?void 0:o.isRequired,isInvalid:u??(o==null?void 0:o.isInvalid),onFocus:Oe(o==null?void 0:o.onFocus,h),onBlur:Oe(o==null?void 0:o.onBlur,v)}}function nn(t,e,n,r){const o=Mt(n);return P.useEffect(()=>{const a=typeof t=="function"?t():t??document;if(!(!n||!a))return a.addEventListener(e,o,r),()=>{a.removeEventListener(e,o,r)}},[e,t,r,o,n]),()=>{const a=typeof t=="function"?t():t??document;a==null||a.removeEventListener(e,o,r)}}function pc(t){return"current"in t}var Vs=()=>typeof window<"u";function mc(){var t;const e=navigator.userAgentData;return(t=e==null?void 0:e.platform)!=null?t:navigator.platform}var yc=t=>Vs()&&t.test(navigator.vendor),vc=t=>Vs()&&t.test(mc()),gc=()=>vc(/mac|iphone|ipad|ipod/i),wc=()=>gc()&&yc(/apple/i);function bc(t){const{ref:e,elements:n,enabled:r}=t,o=()=>{var a,i;return(i=(a=e.current)==null?void 0:a.ownerDocument)!=null?i:document};nn(o,"pointerdown",a=>{if(!wc()||!r)return;const i=a.target,l=(n??[e]).some(c=>{const u=pc(c)?c.current:c;return(u==null?void 0:u.contains(i))||u===i});o().activeElement!==i&&l&&(a.preventDefault(),i.focus())})}var Zs={exports:{}},_c="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",xc=_c,kc=xc;function Gs(){}function Js(){}Js.resetWarningCache=Gs;var Ec=function(){function t(r,o,a,i,s,l){if(l!==kc){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Js,resetWarningCache:Gs};return n.PropTypes=n,n};Zs.exports=Ec();var Sc=Zs.exports;const Ft=fa(Sc);function Cc(t){const e=t.ownerDocument.defaultView||window,{overflow:n,overflowX:r,overflowY:o}=e.getComputedStyle(t);return/auto|scroll|overlay|hidden/.test(n+o+r)}function Ic(t){return t.localName==="html"?t:t.assignedSlot||t.parentElement||t.ownerDocument.documentElement}function Ys(t){return["html","body","#document"].includes(t.localName)?t.ownerDocument.body:Pl(t)&&Cc(t)?t:Ys(Ic(t))}var Oc=$l?P.useLayoutEffect:P.useEffect;function ko(t,e=[]){const n=P.useRef(t);return Oc(()=>{n.current=t}),P.useCallback((...r)=>{var o;return(o=n.current)==null?void 0:o.call(n,...r)},e)}function Dc(t){const{ref:e,handler:n,enabled:r=!0}=t,o=ko(n),i=P.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;P.useEffect(()=>{if(!r)return;const s=d=>{ao(d,e)&&(i.isPointerDown=!0)},l=d=>{if(i.ignoreEmulatedMouseEvents){i.ignoreEmulatedMouseEvents=!1;return}i.isPointerDown&&n&&ao(d,e)&&(i.isPointerDown=!1,o(d))},c=d=>{i.ignoreEmulatedMouseEvents=!0,n&&i.isPointerDown&&ao(d,e)&&(i.isPointerDown=!1,o(d))},u=Ms(e.current);return u.addEventListener("mousedown",s,!0),u.addEventListener("mouseup",l,!0),u.addEventListener("touchstart",s,!0),u.addEventListener("touchend",c,!0),()=>{u.removeEventListener("mousedown",s,!0),u.removeEventListener("mouseup",l,!0),u.removeEventListener("touchstart",s,!0),u.removeEventListener("touchend",c,!0)}},[n,e,o,i,r])}function ao(t,e){var n;const r=t.target;return r&&!Ms(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function jc(t,e){const n=P.useId();return P.useMemo(()=>t||[e,n].filter(Boolean).join("-"),[t,e,n])}function Pc(t,e){const n=t!==void 0;return[n,n&&typeof t<"u"?t:e]}function Ac(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,a=ko(n),i=ko(e),[s,l]=P.useState(t.defaultIsOpen||!1),[c,u]=Pc(r,s),d=jc(o,"disclosure"),p=P.useCallback(()=>{c||l(!1),i==null||i()},[c,i]),h=P.useCallback(()=>{c||l(!0),a==null||a()},[c,a]),v=P.useCallback(()=>{(u?p:h)()},[u,h,p]);return{isOpen:!!u,onOpen:h,onClose:p,onToggle:v,isControlled:c,getButtonProps:(f={})=>({...f,"aria-expanded":u,"aria-controls":d,onClick:Al(f.onClick,v)}),getDisclosureProps:(f={})=>({...f,hidden:!u,id:d})}}var Kn=_e(function(e,n){const{htmlSize:r,...o}=e,a=At("Input",o),i=rt(o),s=fc(i),l=Ee("chakra-input",e.className);return O.jsx(we.input,{size:r,...s,__css:a.field,ref:n,className:l})});Kn.displayName="Input";Kn.id="Input";var Nc=Object.freeze(["base","sm","md","lg","xl","2xl"]);function Fc(t,e){return Array.isArray(t)?t.map(n=>n===null?null:e(n)):Nl(t)?Object.keys(t).reduce((n,r)=>(n[r]=e(t[r]),n),{}):t!=null?e(t):null}function Cp(t,e=Nc){const n={};return t.forEach((r,o)=>{const a=e[o];r!=null&&(n[a]=r)}),n}var zt=_e(function(e,n){const r=Ur("Text",e),{className:o,align:a,decoration:i,casing:s,...l}=rt(e),c=ql({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return O.jsx(we.p,{ref:n,className:Ee("chakra-text",e.className),...c,...l,__css:r})});zt.displayName="Text";var Eo=t=>O.jsx(we.div,{className:"chakra-stack__divider",...t,__css:{...t.__css,borderWidth:0,alignSelf:"stretch",borderColor:"inherit",width:"auto",height:"auto"}});Eo.displayName="StackDivider";var Xs=t=>O.jsx(we.div,{className:"chakra-stack__item",...t,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...t.__css}});Xs.displayName="StackItem";function Rc(t){const{spacing:e,direction:n}=t,r={column:{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":Fc(n,o=>r[o])}}var rn=_e((t,e)=>{const{isInline:n,direction:r,align:o,justify:a,spacing:i="0.5rem",wrap:s,children:l,divider:c,className:u,shouldWrapChildren:d,...p}=t,h=n?"row":r??"column",v=P.useMemo(()=>Rc({spacing:i,direction:h}),[i,h]),f=!!c,y=!d&&!f,m=P.useMemo(()=>{const _=_a(l);return y?_:_.map((x,E)=>{const I=typeof x.key<"u"?x.key:E,k=E+1===_.length,D=d?O.jsx(Xs,{children:x},I):x;if(!f)return D;const T=P.cloneElement(c,{__css:v}),H=k?null:T;return O.jsxs(P.Fragment,{children:[D,H]},I)})},[c,v,f,y,d,l]),w=Ee("chakra-stack",u);return O.jsx(we.div,{ref:e,display:"flex",alignItems:o,justifyContent:a,flexDirection:h,flexWrap:s,gap:f?void 0:i,className:w,...p,children:m})});rn.displayName="Stack";var Tt=_e((t,e)=>O.jsx(rn,{align:"center",...t,direction:"row",ref:e}));Tt.displayName="HStack";var xa=_e(function(e,n){const r=Ur("Heading",e),{className:o,...a}=rt(e);return O.jsx(we.h2,{ref:n,className:Ee("chakra-heading",e.className),...a,__css:r})});xa.displayName="Heading";var yt=we("div");yt.displayName="Box";var Qs=_e(function(e,n){const{size:r,centerContent:o=!0,...a}=e,i=o?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return O.jsx(yt,{ref:n,boxSize:r,__css:{...i,flexShrink:0,flexGrow:0},...a})});Qs.displayName="Square";var Tc=_e(function(e,n){const{size:r,...o}=e;return O.jsx(Qs,{size:r,ref:n,borderRadius:"9999px",...o})});Tc.displayName="Circle";var kn=_e(function(e,n){const{direction:r,align:o,justify:a,wrap:i,basis:s,grow:l,shrink:c,...u}=e,d={display:"flex",flexDirection:r,alignItems:o,justifyContent:a,flexWrap:i,flexBasis:s,flexGrow:l,flexShrink:c};return O.jsx(we.div,{ref:n,__css:d,...u})});kn.displayName="Flex";function Bc(t){const{key:e}=t;return e.length===1||e.length>1&&/[^a-zA-Z0-9]/.test(e)}function Mc(t={}){const{timeout:e=300,preventDefault:n=()=>!0}=t,[r,o]=P.useState([]),a=P.useRef(),i=()=>{a.current&&(clearTimeout(a.current),a.current=null)},s=()=>{i(),a.current=setTimeout(()=>{o([]),a.current=null},e)};P.useEffect(()=>i,[]);function l(c){return u=>{if(u.key==="Backspace"){const d=[...r];d.pop(),o(d);return}if(Bc(u)){const d=r.concat(u.key);n(u)&&(u.preventDefault(),u.stopPropagation()),o(d),c(d.join("")),s()}}}return l}function zc(t,e,n,r){if(e==null)return r;if(!r)return t.find(i=>n(i).toLowerCase().startsWith(e.toLowerCase()));const o=t.filter(a=>n(a).toLowerCase().startsWith(e.toLowerCase()));if(o.length>0){let a;return o.includes(r)?(a=o.indexOf(r)+1,a===o.length&&(a=0),o[a]):(a=t.indexOf(o[0]),t[a])}return r}function Lc(){const t=P.useRef(new Map),e=t.current,n=P.useCallback((o,a,i,s)=>{t.current.set(i,{type:a,el:o,options:s}),o.addEventListener(a,i,s)},[]),r=P.useCallback((o,a,i,s)=>{o.removeEventListener(a,i,s),t.current.delete(i)},[]);return P.useEffect(()=>()=>{e.forEach((o,a)=>{r(o.el,o.type,a,o.options)})},[r,e]),{add:n,remove:r}}function so(t){const e=t.target,{tagName:n,isContentEditable:r}=e;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function ei(t={}){const{ref:e,isDisabled:n,isFocusable:r,clickOnEnter:o=!0,clickOnSpace:a=!0,onMouseDown:i,onMouseUp:s,onClick:l,onKeyDown:c,onKeyUp:u,tabIndex:d,onMouseOver:p,onMouseLeave:h,...v}=t,[f,y]=P.useState(!0),[m,w]=P.useState(!1),_=Lc(),x=N=>{N&&N.tagName!=="BUTTON"&&y(!1)},E=f?d:d||0,I=n&&!r,k=P.useCallback(N=>{if(n){N.stopPropagation(),N.preventDefault();return}N.currentTarget.focus(),l==null||l(N)},[n,l]),R=P.useCallback(N=>{m&&so(N)&&(N.preventDefault(),N.stopPropagation(),w(!1),_.remove(document,"keyup",R,!1))},[m,_]),D=P.useCallback(N=>{if(c==null||c(N),n||N.defaultPrevented||N.metaKey||!so(N.nativeEvent)||f)return;const ae=o&&N.key==="Enter";a&&N.key===" "&&(N.preventDefault(),w(!0)),ae&&(N.preventDefault(),N.currentTarget.click()),_.add(document,"keyup",R,!1)},[n,f,c,o,a,_,R]),T=P.useCallback(N=>{if(u==null||u(N),n||N.defaultPrevented||N.metaKey||!so(N.nativeEvent)||f)return;a&&N.key===" "&&(N.preventDefault(),w(!1),N.currentTarget.click())},[a,f,n,u]),H=P.useCallback(N=>{N.button===0&&(w(!1),_.remove(document,"mouseup",H,!1))},[_]),j=P.useCallback(N=>{if(N.button!==0)return;if(n){N.stopPropagation(),N.preventDefault();return}f||w(!0),N.currentTarget.focus({preventScroll:!0}),_.add(document,"mouseup",H,!1),i==null||i(N)},[n,f,i,_,H]),L=P.useCallback(N=>{N.button===0&&(f||w(!1),s==null||s(N))},[s,f]),b=P.useCallback(N=>{if(n){N.preventDefault();return}p==null||p(N)},[n,p]),q=P.useCallback(N=>{m&&(N.preventDefault(),w(!1)),h==null||h(N)},[m,h]),te=Le(e,x);return f?{...v,ref:te,type:"button","aria-disabled":I?void 0:n,disabled:I,onClick:k,onMouseDown:i,onMouseUp:s,onKeyUp:u,onKeyDown:c,onMouseOver:p,onMouseLeave:h}:{...v,ref:te,role:"button","data-active":st(m),"aria-disabled":n?"true":void 0,tabIndex:I?void 0:E,onClick:k,onMouseDown:j,onMouseUp:L,onKeyUp:T,onKeyDown:D,onMouseOver:b,onMouseLeave:q}}function Wc(t){const e=t.current;if(!e)return!1;const n=Tl(e);return!n||e.contains(n)?!1:!!Bl(n)}function ti(t,e){const{shouldFocus:n,visible:r,focusRef:o}=e,a=n&&!r;Kr(()=>{if(!a||Wc(t))return;const i=(o==null?void 0:o.current)||t.current;let s;if(i)return s=requestAnimationFrame(()=>{i.focus({preventScroll:!0})}),()=>{cancelAnimationFrame(s)}},[a,t,o])}var Uc={preventScroll:!0,shouldFocus:!1};function Kc(t,e=Uc){const{focusRef:n,preventScroll:r,shouldFocus:o,visible:a}=e,i=$c(t)?t.current:t,s=o&&a,l=P.useRef(s),c=P.useRef(a);Fl(()=>{!c.current&&a&&(l.current=s),c.current=a},[a,s]);const u=P.useCallback(()=>{if(!(!a||!i||!l.current)&&(l.current=!1,!i.contains(document.activeElement)))if(n!=null&&n.current)requestAnimationFrame(()=>{var d;(d=n.current)==null||d.focus({preventScroll:r})});else{const d=Rl(i);d.length>0&&requestAnimationFrame(()=>{d[0].focus({preventScroll:r})})}},[a,r,i,n]);Kr(()=>{u()},[u]),nn(i,"transitionend",u)}function $c(t){return"current"in t}var Yt=(t,e)=>({var:t,varRef:e?`var(${t}, ${e})`:`var(${t})`}),Fe={arrowShadowColor:Yt("--popper-arrow-shadow-color"),arrowSize:Yt("--popper-arrow-size","8px"),arrowSizeHalf:Yt("--popper-arrow-size-half"),arrowBg:Yt("--popper-arrow-bg"),transformOrigin:Yt("--popper-transform-origin"),arrowOffset:Yt("--popper-arrow-offset")};function qc(t){if(t.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}var Hc={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},Vc=t=>Hc[t],ns={scroll:!0,resize:!0};function Zc(t){let e;return typeof t=="object"?e={enabled:!0,options:{...ns,...t}}:e={enabled:t,options:ns},e}var Gc={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`},effect:({state:t})=>()=>{const e=t.elements.reference;t.elements.popper.style.width=`${e.offsetWidth}px`}},Jc={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:t})=>{rs(t)},effect:({state:t})=>()=>{rs(t)}},rs=t=>{t.elements.popper.style.setProperty(Fe.transformOrigin.var,Vc(t.placement))},Yc={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:t})=>{Xc(t)}},Xc=t=>{var e;if(!t.placement)return;const n=Qc(t.placement);if((e=t.elements)!=null&&e.arrow&&n){Object.assign(t.elements.arrow.style,{[n.property]:n.value,width:Fe.arrowSize.varRef,height:Fe.arrowSize.varRef,zIndex:-1});const r={[Fe.arrowSizeHalf.var]:`calc(${Fe.arrowSize.varRef} / 2 - 1px)`,[Fe.arrowOffset.var]:`calc(${Fe.arrowSizeHalf.varRef} * -1)`};for(const o in r)t.elements.arrow.style.setProperty(o,r[o])}},Qc=t=>{if(t.startsWith("top"))return{property:"bottom",value:Fe.arrowOffset.varRef};if(t.startsWith("bottom"))return{property:"top",value:Fe.arrowOffset.varRef};if(t.startsWith("left"))return{property:"right",value:Fe.arrowOffset.varRef};if(t.startsWith("right"))return{property:"left",value:Fe.arrowOffset.varRef}},eu={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:t})=>{os(t)},effect:({state:t})=>()=>{os(t)}},os=t=>{if(!t.elements.arrow)return;const e=t.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!e)return;const n=qc(t.placement);n&&e.style.setProperty("--popper-arrow-default-shadow",n),Object.assign(e.style,{transform:"rotate(45deg)",background:Fe.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},tu={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},nu={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function ru(t,e="ltr"){var n,r;const o=((n=tu[t])==null?void 0:n[e])||t;return e==="ltr"?o:(r=nu[t])!=null?r:o}var Ve="top",et="bottom",tt="right",Ze="left",ka="auto",$n=[Ve,et,tt,Ze],ln="start",An="end",ou="clippingParents",ni="viewport",gn="popper",au="reference",as=$n.reduce(function(t,e){return t.concat([e+"-"+ln,e+"-"+An])},[]),ri=[].concat($n,[ka]).reduce(function(t,e){return t.concat([e,e+"-"+ln,e+"-"+An])},[]),su="beforeRead",iu="read",lu="afterRead",cu="beforeMain",uu="main",du="afterMain",fu="beforeWrite",hu="write",pu="afterWrite",mu=[su,iu,lu,cu,uu,du,fu,hu,pu];function ct(t){return t?(t.nodeName||"").toLowerCase():null}function Je(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Ht(t){var e=Je(t).Element;return t instanceof e||t instanceof Element}function Qe(t){var e=Je(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Ea(t){if(typeof ShadowRoot>"u")return!1;var e=Je(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function yu(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},o=e.attributes[n]||{},a=e.elements[n];!Qe(a)||!ct(a)||(Object.assign(a.style,r),Object.keys(o).forEach(function(i){var s=o[i];s===!1?a.removeAttribute(i):a.setAttribute(i,s===!0?"":s)}))})}function vu(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var o=e.elements[r],a=e.attributes[r]||{},i=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),s=i.reduce(function(l,c){return l[c]="",l},{});!Qe(o)||!ct(o)||(Object.assign(o.style,s),Object.keys(a).forEach(function(l){o.removeAttribute(l)}))})}}const gu={name:"applyStyles",enabled:!0,phase:"write",fn:yu,effect:vu,requires:["computeStyles"]};function lt(t){return t.split("-")[0]}var Lt=Math.max,Er=Math.min,cn=Math.round;function So(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function oi(){return!/^((?!chrome|android).)*safari/i.test(So())}function un(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),o=1,a=1;e&&Qe(t)&&(o=t.offsetWidth>0&&cn(r.width)/t.offsetWidth||1,a=t.offsetHeight>0&&cn(r.height)/t.offsetHeight||1);var i=Ht(t)?Je(t):window,s=i.visualViewport,l=!oi()&&n,c=(r.left+(l&&s?s.offsetLeft:0))/o,u=(r.top+(l&&s?s.offsetTop:0))/a,d=r.width/o,p=r.height/a;return{width:d,height:p,top:u,right:c+d,bottom:u+p,left:c,x:c,y:u}}function Sa(t){var e=un(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function ai(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Ea(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function wt(t){return Je(t).getComputedStyle(t)}function wu(t){return["table","td","th"].indexOf(ct(t))>=0}function Nt(t){return((Ht(t)?t.ownerDocument:t.document)||window.document).documentElement}function Jr(t){return ct(t)==="html"?t:t.assignedSlot||t.parentNode||(Ea(t)?t.host:null)||Nt(t)}function ss(t){return!Qe(t)||wt(t).position==="fixed"?null:t.offsetParent}function bu(t){var e=/firefox/i.test(So()),n=/Trident/i.test(So());if(n&&Qe(t)){var r=wt(t);if(r.position==="fixed")return null}var o=Jr(t);for(Ea(o)&&(o=o.host);Qe(o)&&["html","body"].indexOf(ct(o))<0;){var a=wt(o);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return o;o=o.parentNode}return null}function qn(t){for(var e=Je(t),n=ss(t);n&&wu(n)&&wt(n).position==="static";)n=ss(n);return n&&(ct(n)==="html"||ct(n)==="body"&&wt(n).position==="static")?e:n||bu(t)||e}function Ca(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function En(t,e,n){return Lt(t,Er(e,n))}function _u(t,e,n){var r=En(t,e,n);return r>n?n:r}function si(){return{top:0,right:0,bottom:0,left:0}}function ii(t){return Object.assign({},si(),t)}function li(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var xu=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,ii(typeof e!="number"?e:li(e,$n))};function ku(t){var e,n=t.state,r=t.name,o=t.options,a=n.elements.arrow,i=n.modifiersData.popperOffsets,s=lt(n.placement),l=Ca(s),c=[Ze,tt].indexOf(s)>=0,u=c?"height":"width";if(!(!a||!i)){var d=xu(o.padding,n),p=Sa(a),h=l==="y"?Ve:Ze,v=l==="y"?et:tt,f=n.rects.reference[u]+n.rects.reference[l]-i[l]-n.rects.popper[u],y=i[l]-n.rects.reference[l],m=qn(a),w=m?l==="y"?m.clientHeight||0:m.clientWidth||0:0,_=f/2-y/2,x=d[h],E=w-p[u]-d[v],I=w/2-p[u]/2+_,k=En(x,I,E),R=l;n.modifiersData[r]=(e={},e[R]=k,e.centerOffset=k-I,e)}}function Eu(t){var e=t.state,n=t.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||ai(e.elements.popper,o)&&(e.elements.arrow=o))}const Su={name:"arrow",enabled:!0,phase:"main",fn:ku,effect:Eu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function dn(t){return t.split("-")[1]}var Cu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Iu(t,e){var n=t.x,r=t.y,o=e.devicePixelRatio||1;return{x:cn(n*o)/o||0,y:cn(r*o)/o||0}}function is(t){var e,n=t.popper,r=t.popperRect,o=t.placement,a=t.variation,i=t.offsets,s=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,p=i.x,h=p===void 0?0:p,v=i.y,f=v===void 0?0:v,y=typeof u=="function"?u({x:h,y:f}):{x:h,y:f};h=y.x,f=y.y;var m=i.hasOwnProperty("x"),w=i.hasOwnProperty("y"),_=Ze,x=Ve,E=window;if(c){var I=qn(n),k="clientHeight",R="clientWidth";if(I===Je(n)&&(I=Nt(n),wt(I).position!=="static"&&s==="absolute"&&(k="scrollHeight",R="scrollWidth")),I=I,o===Ve||(o===Ze||o===tt)&&a===An){x=et;var D=d&&I===E&&E.visualViewport?E.visualViewport.height:I[k];f-=D-r.height,f*=l?1:-1}if(o===Ze||(o===Ve||o===et)&&a===An){_=tt;var T=d&&I===E&&E.visualViewport?E.visualViewport.width:I[R];h-=T-r.width,h*=l?1:-1}}var H=Object.assign({position:s},c&&Cu),j=u===!0?Iu({x:h,y:f},Je(n)):{x:h,y:f};if(h=j.x,f=j.y,l){var L;return Object.assign({},H,(L={},L[x]=w?"0":"",L[_]=m?"0":"",L.transform=(E.devicePixelRatio||1)<=1?"translate("+h+"px, "+f+"px)":"translate3d("+h+"px, "+f+"px, 0)",L))}return Object.assign({},H,(e={},e[x]=w?f+"px":"",e[_]=m?h+"px":"",e.transform="",e))}function Ou(t){var e=t.state,n=t.options,r=n.gpuAcceleration,o=r===void 0?!0:r,a=n.adaptive,i=a===void 0?!0:a,s=n.roundOffsets,l=s===void 0?!0:s,c={placement:lt(e.placement),variation:dn(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,is(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:i,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,is(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Du={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ou,data:{}};var Qn={passive:!0};function ju(t){var e=t.state,n=t.instance,r=t.options,o=r.scroll,a=o===void 0?!0:o,i=r.resize,s=i===void 0?!0:i,l=Je(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&c.forEach(function(u){u.addEventListener("scroll",n.update,Qn)}),s&&l.addEventListener("resize",n.update,Qn),function(){a&&c.forEach(function(u){u.removeEventListener("scroll",n.update,Qn)}),s&&l.removeEventListener("resize",n.update,Qn)}}const Pu={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:ju,data:{}};var Au={left:"right",right:"left",bottom:"top",top:"bottom"};function ur(t){return t.replace(/left|right|bottom|top/g,function(e){return Au[e]})}var Nu={start:"end",end:"start"};function ls(t){return t.replace(/start|end/g,function(e){return Nu[e]})}function Ia(t){var e=Je(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Oa(t){return un(Nt(t)).left+Ia(t).scrollLeft}function Fu(t,e){var n=Je(t),r=Nt(t),o=n.visualViewport,a=r.clientWidth,i=r.clientHeight,s=0,l=0;if(o){a=o.width,i=o.height;var c=oi();(c||!c&&e==="fixed")&&(s=o.offsetLeft,l=o.offsetTop)}return{width:a,height:i,x:s+Oa(t),y:l}}function Ru(t){var e,n=Nt(t),r=Ia(t),o=(e=t.ownerDocument)==null?void 0:e.body,a=Lt(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),i=Lt(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-r.scrollLeft+Oa(t),l=-r.scrollTop;return wt(o||n).direction==="rtl"&&(s+=Lt(n.clientWidth,o?o.clientWidth:0)-a),{width:a,height:i,x:s,y:l}}function Da(t){var e=wt(t),n=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function ci(t){return["html","body","#document"].indexOf(ct(t))>=0?t.ownerDocument.body:Qe(t)&&Da(t)?t:ci(Jr(t))}function Sn(t,e){var n;e===void 0&&(e=[]);var r=ci(t),o=r===((n=t.ownerDocument)==null?void 0:n.body),a=Je(r),i=o?[a].concat(a.visualViewport||[],Da(r)?r:[]):r,s=e.concat(i);return o?s:s.concat(Sn(Jr(i)))}function Co(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Tu(t,e){var n=un(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function cs(t,e,n){return e===ni?Co(Fu(t,n)):Ht(e)?Tu(e,n):Co(Ru(Nt(t)))}function Bu(t){var e=Sn(Jr(t)),n=["absolute","fixed"].indexOf(wt(t).position)>=0,r=n&&Qe(t)?qn(t):t;return Ht(r)?e.filter(function(o){return Ht(o)&&ai(o,r)&&ct(o)!=="body"}):[]}function Mu(t,e,n,r){var o=e==="clippingParents"?Bu(t):[].concat(e),a=[].concat(o,[n]),i=a[0],s=a.reduce(function(l,c){var u=cs(t,c,r);return l.top=Lt(u.top,l.top),l.right=Er(u.right,l.right),l.bottom=Er(u.bottom,l.bottom),l.left=Lt(u.left,l.left),l},cs(t,i,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function ui(t){var e=t.reference,n=t.element,r=t.placement,o=r?lt(r):null,a=r?dn(r):null,i=e.x+e.width/2-n.width/2,s=e.y+e.height/2-n.height/2,l;switch(o){case Ve:l={x:i,y:e.y-n.height};break;case et:l={x:i,y:e.y+e.height};break;case tt:l={x:e.x+e.width,y:s};break;case Ze:l={x:e.x-n.width,y:s};break;default:l={x:e.x,y:e.y}}var c=o?Ca(o):null;if(c!=null){var u=c==="y"?"height":"width";switch(a){case ln:l[c]=l[c]-(e[u]/2-n[u]/2);break;case An:l[c]=l[c]+(e[u]/2-n[u]/2);break}}return l}function Nn(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=r===void 0?t.placement:r,a=n.strategy,i=a===void 0?t.strategy:a,s=n.boundary,l=s===void 0?ou:s,c=n.rootBoundary,u=c===void 0?ni:c,d=n.elementContext,p=d===void 0?gn:d,h=n.altBoundary,v=h===void 0?!1:h,f=n.padding,y=f===void 0?0:f,m=ii(typeof y!="number"?y:li(y,$n)),w=p===gn?au:gn,_=t.rects.popper,x=t.elements[v?w:p],E=Mu(Ht(x)?x:x.contextElement||Nt(t.elements.popper),l,u,i),I=un(t.elements.reference),k=ui({reference:I,element:_,strategy:"absolute",placement:o}),R=Co(Object.assign({},_,k)),D=p===gn?R:I,T={top:E.top-D.top+m.top,bottom:D.bottom-E.bottom+m.bottom,left:E.left-D.left+m.left,right:D.right-E.right+m.right},H=t.modifiersData.offset;if(p===gn&&H){var j=H[o];Object.keys(T).forEach(function(L){var b=[tt,et].indexOf(L)>=0?1:-1,q=[Ve,et].indexOf(L)>=0?"y":"x";T[L]+=j[q]*b})}return T}function zu(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=n.boundary,a=n.rootBoundary,i=n.padding,s=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?ri:l,u=dn(r),d=u?s?as:as.filter(function(v){return dn(v)===u}):$n,p=d.filter(function(v){return c.indexOf(v)>=0});p.length===0&&(p=d);var h=p.reduce(function(v,f){return v[f]=Nn(t,{placement:f,boundary:o,rootBoundary:a,padding:i})[lt(f)],v},{});return Object.keys(h).sort(function(v,f){return h[v]-h[f]})}function Lu(t){if(lt(t)===ka)return[];var e=ur(t);return[ls(t),e,ls(e)]}function Wu(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var o=n.mainAxis,a=o===void 0?!0:o,i=n.altAxis,s=i===void 0?!0:i,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,v=h===void 0?!0:h,f=n.allowedAutoPlacements,y=e.options.placement,m=lt(y),w=m===y,_=l||(w||!v?[ur(y)]:Lu(y)),x=[y].concat(_).reduce(function(M,A){return M.concat(lt(A)===ka?zu(e,{placement:A,boundary:u,rootBoundary:d,padding:c,flipVariations:v,allowedAutoPlacements:f}):A)},[]),E=e.rects.reference,I=e.rects.popper,k=new Map,R=!0,D=x[0],T=0;T<x.length;T++){var H=x[T],j=lt(H),L=dn(H)===ln,b=[Ve,et].indexOf(j)>=0,q=b?"width":"height",te=Nn(e,{placement:H,boundary:u,rootBoundary:d,altBoundary:p,padding:c}),N=b?L?tt:Ze:L?et:Ve;E[q]>I[q]&&(N=ur(N));var ae=ur(N),Z=[];if(a&&Z.push(te[j]<=0),s&&Z.push(te[N]<=0,te[ae]<=0),Z.every(function(M){return M})){D=H,R=!1;break}k.set(H,Z)}if(R)for(var le=v?3:1,K=function(A){var J=x.find(function(oe){var ne=k.get(oe);if(ne)return ne.slice(0,A).every(function(ie){return ie})});if(J)return D=J,"break"},U=le;U>0;U--){var re=K(U);if(re==="break")break}e.placement!==D&&(e.modifiersData[r]._skip=!0,e.placement=D,e.reset=!0)}}const Uu={name:"flip",enabled:!0,phase:"main",fn:Wu,requiresIfExists:["offset"],data:{_skip:!1}};function us(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function ds(t){return[Ve,tt,et,Ze].some(function(e){return t[e]>=0})}function Ku(t){var e=t.state,n=t.name,r=e.rects.reference,o=e.rects.popper,a=e.modifiersData.preventOverflow,i=Nn(e,{elementContext:"reference"}),s=Nn(e,{altBoundary:!0}),l=us(i,r),c=us(s,o,a),u=ds(l),d=ds(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const $u={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Ku};function qu(t,e,n){var r=lt(t),o=[Ze,Ve].indexOf(r)>=0?-1:1,a=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,i=a[0],s=a[1];return i=i||0,s=(s||0)*o,[Ze,tt].indexOf(r)>=0?{x:s,y:i}:{x:i,y:s}}function Hu(t){var e=t.state,n=t.options,r=t.name,o=n.offset,a=o===void 0?[0,0]:o,i=ri.reduce(function(u,d){return u[d]=qu(d,e.rects,a),u},{}),s=i[e.placement],l=s.x,c=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=i}const Vu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Hu};function Zu(t){var e=t.state,n=t.name;e.modifiersData[n]=ui({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Gu={name:"popperOffsets",enabled:!0,phase:"read",fn:Zu,data:{}};function Ju(t){return t==="x"?"y":"x"}function Yu(t){var e=t.state,n=t.options,r=t.name,o=n.mainAxis,a=o===void 0?!0:o,i=n.altAxis,s=i===void 0?!1:i,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,p=n.tether,h=p===void 0?!0:p,v=n.tetherOffset,f=v===void 0?0:v,y=Nn(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),m=lt(e.placement),w=dn(e.placement),_=!w,x=Ca(m),E=Ju(x),I=e.modifiersData.popperOffsets,k=e.rects.reference,R=e.rects.popper,D=typeof f=="function"?f(Object.assign({},e.rects,{placement:e.placement})):f,T=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),H=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,j={x:0,y:0};if(I){if(a){var L,b=x==="y"?Ve:Ze,q=x==="y"?et:tt,te=x==="y"?"height":"width",N=I[x],ae=N+y[b],Z=N-y[q],le=h?-R[te]/2:0,K=w===ln?k[te]:R[te],U=w===ln?-R[te]:-k[te],re=e.elements.arrow,M=h&&re?Sa(re):{width:0,height:0},A=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:si(),J=A[b],oe=A[q],ne=En(0,k[te],M[te]),ie=_?k[te]/2-le-ne-J-T.mainAxis:K-ne-J-T.mainAxis,ve=_?-k[te]/2+le+ne+oe+T.mainAxis:U+ne+oe+T.mainAxis,fe=e.elements.arrow&&qn(e.elements.arrow),he=fe?x==="y"?fe.clientTop||0:fe.clientLeft||0:0,ue=(L=H==null?void 0:H[x])!=null?L:0,g=N+ie-ue-he,B=N+ve-ue,W=En(h?Er(ae,g):ae,N,h?Lt(Z,B):Z);I[x]=W,j[x]=W-N}if(s){var C,S=x==="x"?Ve:Ze,F=x==="x"?et:tt,$=I[E],V=E==="y"?"height":"width",z=$+y[S],Q=$-y[F],ee=[Ve,Ze].indexOf(m)!==-1,Y=(C=H==null?void 0:H[E])!=null?C:0,se=ee?z:$-k[V]-R[V]-Y+T.altAxis,be=ee?$+k[V]+R[V]-Y-T.altAxis:Q,ye=h&&ee?_u(se,$,be):En(h?se:z,$,h?be:Q);I[E]=ye,j[E]=ye-$}e.modifiersData[r]=j}}const Xu={name:"preventOverflow",enabled:!0,phase:"main",fn:Yu,requiresIfExists:["offset"]};function Qu(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function ed(t){return t===Je(t)||!Qe(t)?Ia(t):Qu(t)}function td(t){var e=t.getBoundingClientRect(),n=cn(e.width)/t.offsetWidth||1,r=cn(e.height)/t.offsetHeight||1;return n!==1||r!==1}function nd(t,e,n){n===void 0&&(n=!1);var r=Qe(e),o=Qe(e)&&td(e),a=Nt(e),i=un(t,o,n),s={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((ct(e)!=="body"||Da(a))&&(s=ed(e)),Qe(e)?(l=un(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=Oa(a))),{x:i.left+s.scrollLeft-l.x,y:i.top+s.scrollTop-l.y,width:i.width,height:i.height}}function rd(t){var e=new Map,n=new Set,r=[];t.forEach(function(a){e.set(a.name,a)});function o(a){n.add(a.name);var i=[].concat(a.requires||[],a.requiresIfExists||[]);i.forEach(function(s){if(!n.has(s)){var l=e.get(s);l&&o(l)}}),r.push(a)}return t.forEach(function(a){n.has(a.name)||o(a)}),r}function od(t){var e=rd(t);return mu.reduce(function(n,r){return n.concat(e.filter(function(o){return o.phase===r}))},[])}function ad(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function sd(t){var e=t.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var fs={placement:"bottom",modifiers:[],strategy:"absolute"};function hs(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function id(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,o=e.defaultOptions,a=o===void 0?fs:o;return function(s,l,c){c===void 0&&(c=a);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},fs,a),modifiersData:{},elements:{reference:s,popper:l},attributes:{},styles:{}},d=[],p=!1,h={state:u,setOptions:function(m){var w=typeof m=="function"?m(u.options):m;f(),u.options=Object.assign({},a,u.options,w),u.scrollParents={reference:Ht(s)?Sn(s):s.contextElement?Sn(s.contextElement):[],popper:Sn(l)};var _=od(sd([].concat(r,u.options.modifiers)));return u.orderedModifiers=_.filter(function(x){return x.enabled}),v(),h.update()},forceUpdate:function(){if(!p){var m=u.elements,w=m.reference,_=m.popper;if(hs(w,_)){u.rects={reference:nd(w,qn(_),u.options.strategy==="fixed"),popper:Sa(_)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(T){return u.modifiersData[T.name]=Object.assign({},T.data)});for(var x=0;x<u.orderedModifiers.length;x++){if(u.reset===!0){u.reset=!1,x=-1;continue}var E=u.orderedModifiers[x],I=E.fn,k=E.options,R=k===void 0?{}:k,D=E.name;typeof I=="function"&&(u=I({state:u,options:R,name:D,instance:h})||u)}}}},update:ad(function(){return new Promise(function(y){h.forceUpdate(),y(u)})}),destroy:function(){f(),p=!0}};if(!hs(s,l))return h;h.setOptions(c).then(function(y){!p&&c.onFirstUpdate&&c.onFirstUpdate(y)});function v(){u.orderedModifiers.forEach(function(y){var m=y.name,w=y.options,_=w===void 0?{}:w,x=y.effect;if(typeof x=="function"){var E=x({state:u,name:m,instance:h,options:_}),I=function(){};d.push(E||I)}})}function f(){d.forEach(function(y){return y()}),d=[]}return h}}var ld=[Pu,Gu,Du,gu,Vu,Uu,Xu,Su,$u],cd=id({defaultModifiers:ld});function ja(t={}){const{enabled:e=!0,modifiers:n,placement:r="bottom",strategy:o="absolute",arrowPadding:a=8,eventListeners:i=!0,offset:s,gutter:l=8,flip:c=!0,boundary:u="clippingParents",preventOverflow:d=!0,matchWidth:p,direction:h="ltr"}=t,v=P.useRef(null),f=P.useRef(null),y=P.useRef(null),m=ru(r,h),w=P.useRef(()=>{}),_=P.useCallback(()=>{var T;!e||!v.current||!f.current||((T=w.current)==null||T.call(w),y.current=cd(v.current,f.current,{placement:m,modifiers:[eu,Yc,Jc,{...Gc,enabled:!!p},{name:"eventListeners",...Zc(i)},{name:"arrow",options:{padding:a}},{name:"offset",options:{offset:s??[0,l]}},{name:"flip",enabled:!!c,options:{padding:8}},{name:"preventOverflow",enabled:!!d,options:{boundary:u}},...n??[]],strategy:o}),y.current.forceUpdate(),w.current=y.current.destroy)},[m,e,n,p,i,a,s,l,c,d,u,o]);P.useEffect(()=>()=>{var T;!v.current&&!f.current&&((T=y.current)==null||T.destroy(),y.current=null)},[]);const x=P.useCallback(T=>{v.current=T,_()},[_]),E=P.useCallback((T={},H=null)=>({...T,ref:Le(x,H)}),[x]),I=P.useCallback(T=>{f.current=T,_()},[_]),k=P.useCallback((T={},H=null)=>({...T,ref:Le(I,H),style:{...T.style,position:o,minWidth:p?void 0:"max-content",inset:"0 auto auto 0"}}),[o,I,p]),R=P.useCallback((T={},H=null)=>{const{size:j,shadowColor:L,bg:b,style:q,...te}=T;return{...te,ref:H,"data-popper-arrow":"",style:ud(T)}},[]),D=P.useCallback((T={},H=null)=>({...T,ref:H,"data-popper-arrow-inner":""}),[]);return{update(){var T;(T=y.current)==null||T.update()},forceUpdate(){var T;(T=y.current)==null||T.forceUpdate()},transformOrigin:Fe.transformOrigin.varRef,referenceRef:x,popperRef:I,getPopperProps:k,getArrowProps:R,getArrowInnerProps:D,getReferenceProps:E}}function ud(t){const{size:e,shadowColor:n,bg:r,style:o}=t,a={...o,position:"absolute"};return e&&(a["--popper-arrow-size"]=e),n&&(a["--popper-arrow-shadow-color"]=n),r&&(a["--popper-arrow-bg"]=r),a}function Pa(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,a=Mt(n),i=Mt(e),[s,l]=P.useState(t.defaultIsOpen||!1),c=r!==void 0?r:s,u=r!==void 0,d=P.useId(),p=o??`disclosure-${d}`,h=P.useCallback(()=>{u||l(!1),i==null||i()},[u,i]),v=P.useCallback(()=>{u||l(!0),a==null||a()},[u,a]),f=P.useCallback(()=>{c?h():v()},[c,v,h]);function y(w={}){return{...w,"aria-expanded":c,"aria-controls":p,onClick(_){var x;(x=w.onClick)==null||x.call(w,_),f()}}}function m(w={}){return{...w,hidden:!c,id:p}}return{isOpen:c,onOpen:v,onClose:h,onToggle:f,isControlled:u,getButtonProps:y,getDisclosureProps:m}}function dd(t){const{ref:e,handler:n,enabled:r=!0}=t,o=Mt(n),i=P.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;P.useEffect(()=>{if(!r)return;const s=d=>{io(d,e)&&(i.isPointerDown=!0)},l=d=>{if(i.ignoreEmulatedMouseEvents){i.ignoreEmulatedMouseEvents=!1;return}i.isPointerDown&&n&&io(d,e)&&(i.isPointerDown=!1,o(d))},c=d=>{i.ignoreEmulatedMouseEvents=!0,n&&i.isPointerDown&&io(d,e)&&(i.isPointerDown=!1,o(d))},u=di(e.current);return u.addEventListener("mousedown",s,!0),u.addEventListener("mouseup",l,!0),u.addEventListener("touchstart",s,!0),u.addEventListener("touchend",c,!0),()=>{u.removeEventListener("mousedown",s,!0),u.removeEventListener("mouseup",l,!0),u.removeEventListener("touchstart",s,!0),u.removeEventListener("touchend",c,!0)}},[n,e,o,i,r])}function io(t,e){var n;const r=t.target;return r&&!di(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function di(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function fi(t){const{isOpen:e,ref:n}=t,[r,o]=P.useState(e),[a,i]=P.useState(!1);return P.useEffect(()=>{a||(o(e),i(!0))},[e,a,r]),nn(()=>n.current,"animationend",()=>{o(e)}),{present:!(e?!1:!r),onComplete(){var l;const c=Ml(n.current),u=new c.CustomEvent("animationend",{bubbles:!0});(l=n.current)==null||l.dispatchEvent(u)}}}function Aa(t){const{wasSelected:e,enabled:n,isSelected:r,mode:o="unmount"}=t;return!!(!n||r||o==="keepMounted"&&e)}var[fd,hd,pd,md]=Ws(),[yd,Hn]=nt({strict:!1,name:"MenuContext"});function vd(t,...e){const n=P.useId(),r=t||n;return P.useMemo(()=>e.map(o=>`${o}-${r}`),[r,e])}function hi(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function ps(t){return hi(t).activeElement===t}function gd(t={}){const{id:e,closeOnSelect:n=!0,closeOnBlur:r=!0,initialFocusRef:o,autoSelect:a=!0,isLazy:i,isOpen:s,defaultIsOpen:l,onClose:c,onOpen:u,placement:d="bottom-start",lazyBehavior:p="unmount",direction:h,computePositionOnMount:v=!1,...f}=t,y=P.useRef(null),m=P.useRef(null),w=pd(),_=P.useCallback(()=>{requestAnimationFrame(()=>{var re;(re=y.current)==null||re.focus({preventScroll:!1})})},[]),x=P.useCallback(()=>{const re=setTimeout(()=>{var M;if(o)(M=o.current)==null||M.focus();else{const A=w.firstEnabled();A&&L(A.index)}});ae.current.add(re)},[w,o]),E=P.useCallback(()=>{const re=setTimeout(()=>{const M=w.lastEnabled();M&&L(M.index)});ae.current.add(re)},[w]),I=P.useCallback(()=>{u==null||u(),a?x():_()},[a,x,_,u]),{isOpen:k,onOpen:R,onClose:D,onToggle:T}=Pa({isOpen:s,defaultIsOpen:l,onClose:c,onOpen:I});dd({enabled:k&&r,ref:y,handler:re=>{var M;(M=m.current)!=null&&M.contains(re.target)||D()}});const H=ja({...f,enabled:k||v,placement:d,direction:h}),[j,L]=P.useState(-1);Kr(()=>{k||L(-1)},[k]),ti(y,{focusRef:m,visible:k,shouldFocus:!0});const b=fi({isOpen:k,ref:y}),[q,te]=vd(e,"menu-button","menu-list"),N=P.useCallback(()=>{R(),_()},[R,_]),ae=P.useRef(new Set([]));P.useEffect(()=>{const re=ae.current;return()=>{re.forEach(M=>clearTimeout(M)),re.clear()}},[]);const Z=P.useCallback(()=>{R(),x()},[x,R]),le=P.useCallback(()=>{R(),E()},[R,E]),K=P.useCallback(()=>{var re,M;const A=hi(y.current),J=(re=y.current)==null?void 0:re.contains(A.activeElement);if(!(k&&!J))return;const ne=(M=w.item(j))==null?void 0:M.node;ne==null||ne.focus({preventScroll:!0})},[k,j,w]),U=P.useRef(null);return{openAndFocusMenu:N,openAndFocusFirstItem:Z,openAndFocusLastItem:le,onTransitionEnd:K,unstable__animationState:b,descendants:w,popper:H,buttonId:q,menuId:te,forceUpdate:H.forceUpdate,orientation:"vertical",isOpen:k,onToggle:T,onOpen:R,onClose:D,menuRef:y,buttonRef:m,focusedIndex:j,closeOnSelect:n,closeOnBlur:r,autoSelect:a,setFocusedIndex:L,isLazy:i,lazyBehavior:p,initialFocusRef:o,rafId:U}}function Ip(t={},e=null){const n=Hn(),{onToggle:r,popper:o,openAndFocusFirstItem:a,openAndFocusLastItem:i}=n,s=P.useCallback(l=>{const c=l.key,d={Enter:a,ArrowDown:a,ArrowUp:i}[c];d&&(l.preventDefault(),l.stopPropagation(),d(l))},[a,i]);return{...t,ref:Le(n.buttonRef,e,o.referenceRef),id:n.buttonId,"data-active":st(n.isOpen),"aria-expanded":n.isOpen,"aria-haspopup":"menu","aria-controls":n.menuId,onClick:Oe(t.onClick,r),onKeyDown:Oe(t.onKeyDown,s)}}function Io(t){var e;return _d(t)&&!!((e=t==null?void 0:t.getAttribute("role"))!=null&&e.startsWith("menuitem"))}function wd(t={},e=null){const n=Hn();if(!n)throw new Error("useMenuContext: context is undefined. Seems you forgot to wrap component within <Menu>");const{focusedIndex:r,setFocusedIndex:o,menuRef:a,isOpen:i,onClose:s,menuId:l,isLazy:c,lazyBehavior:u,unstable__animationState:d}=n,p=hd(),h=Mc({preventDefault:m=>m.key!==" "&&Io(m.target)}),v=P.useCallback(m=>{if(!m.currentTarget.contains(m.target))return;const w=m.key,x={Tab:I=>I.preventDefault(),Escape:s,ArrowDown:()=>{const I=p.nextEnabled(r);I&&o(I.index)},ArrowUp:()=>{const I=p.prevEnabled(r);I&&o(I.index)}}[w];if(x){m.preventDefault(),x(m);return}const E=h(I=>{const k=zc(p.values(),I,R=>{var D,T;return(T=(D=R==null?void 0:R.node)==null?void 0:D.textContent)!=null?T:""},p.item(r));if(k){const R=p.indexOf(k.node);o(R)}});Io(m.target)&&E(m)},[p,r,h,s,o]),f=P.useRef(!1);i&&(f.current=!0);const y=Aa({wasSelected:f.current,enabled:c,mode:u,isSelected:d.present});return{...t,ref:Le(a,e),children:y?t.children:null,tabIndex:-1,role:"menu",id:l,style:{...t.style,transformOrigin:"var(--popper-transform-origin)"},"aria-orientation":"vertical",onKeyDown:Oe(t.onKeyDown,v)}}function bd(t={}){const{popper:e,isOpen:n}=Hn();return e.getPopperProps({...t,style:{visibility:n?"visible":"hidden",...t.style}})}function pi(t={},e=null){const{onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onClick:a,onFocus:i,isDisabled:s,isFocusable:l,closeOnSelect:c,type:u,...d}=t,p=Hn(),{setFocusedIndex:h,focusedIndex:v,closeOnSelect:f,onClose:y,menuRef:m,isOpen:w,menuId:_,rafId:x}=p,E=P.useRef(null),I=`${_}-menuitem-${P.useId()}`,{index:k,register:R}=md({disabled:s&&!l}),D=P.useCallback(N=>{n==null||n(N),!s&&h(k)},[h,k,s,n]),T=P.useCallback(N=>{r==null||r(N),E.current&&!ps(E.current)&&D(N)},[D,r]),H=P.useCallback(N=>{o==null||o(N),!s&&h(-1)},[h,s,o]),j=P.useCallback(N=>{a==null||a(N),Io(N.currentTarget)&&(c??f)&&y()},[y,a,f,c]),L=P.useCallback(N=>{i==null||i(N),h(k)},[h,i,k]),b=k===v,q=s&&!l;Kr(()=>{if(w)return b&&!q&&E.current?(x.current&&cancelAnimationFrame(x.current),x.current=requestAnimationFrame(()=>{var N;(N=E.current)==null||N.focus({preventScroll:!0}),x.current=null})):m.current&&!ps(m.current)&&m.current.focus({preventScroll:!0}),()=>{x.current&&cancelAnimationFrame(x.current)}},[b,q,m,w]);const te=ei({onClick:j,onFocus:L,onMouseEnter:D,onMouseMove:T,onMouseLeave:H,ref:Le(R,E,e),isDisabled:s,isFocusable:l});return{...d,...te,type:u??te.type,id:I,role:"menuitem",tabIndex:b?0:-1}}function Op(t={},e=null){const{type:n="radio",isChecked:r,...o}=t;return{...pi(o,e),role:`menuitem${n}`,"aria-checked":r}}function Dp(t={}){const{children:e,type:n="radio",value:r,defaultValue:o,onChange:a,...i}=t,l=n==="radio"?"":[],[c,u]=Us({defaultValue:o??l,value:r,onChange:a}),d=P.useCallback(v=>{if(n==="radio"&&typeof c=="string"&&u(v),n==="checkbox"&&Array.isArray(c)){const f=c.includes(v)?c.filter(y=>y!==v):c.concat(v);u(f)}},[c,u,n]),h=_a(e).map(v=>{if(v.type.id!=="MenuItemOption")return v;const f=m=>{var w,_;d(v.props.value),(_=(w=v.props).onClick)==null||_.call(w,m)},y=n==="radio"?v.props.value===c:c.includes(v.props.value);return P.cloneElement(v,{type:n,onClick:f,isChecked:y})});return{...i,children:h}}function _d(t){var e;if(!xd(t))return!1;const n=(e=t.ownerDocument.defaultView)!=null?e:window;return t instanceof n.HTMLElement}function xd(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}var[kd,Yr]=nt({name:"MenuStylesContext",errorMessage:`useMenuStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Menu />" `}),Na=t=>{const{children:e}=t,n=At("Menu",t),r=rt(t),{direction:o}=ha(),{descendants:a,...i}=gd({...r,direction:o}),s=P.useMemo(()=>i,[i]),{isOpen:l,onClose:c,forceUpdate:u}=s;return O.jsx(fd,{value:a,children:O.jsx(yd,{value:s,children:O.jsx(kd,{value:n,children:Ns(e,{isOpen:l,onClose:c,forceUpdate:u})})})})};Na.displayName="Menu";var mi=_e((t,e)=>{const n=Yr();return O.jsx(we.span,{ref:e,...t,__css:n.command,className:"chakra-menu__command"})});mi.displayName="MenuCommand";var Ed=_e((t,e)=>{const{type:n,...r}=t,o=Yr(),a=r.as||n?n??void 0:"button",i=P.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...o.item}),[o.item]);return O.jsx(we.button,{ref:e,type:a,...r,__css:i})}),yi=t=>{const{className:e,children:n,...r}=t,o=Yr(),a=P.Children.only(n),i=P.isValidElement(a)?P.cloneElement(a,{focusable:"false","aria-hidden":!0,className:Ee("chakra-menu__icon",a.props.className)}):null,s=Ee("chakra-menu__icon-wrapper",e);return O.jsx(we.span,{className:s,...r,__css:o.icon,children:i})};yi.displayName="MenuIcon";var xt=_e((t,e)=>{const{icon:n,iconSpacing:r="0.75rem",command:o,commandSpacing:a="0.75rem",children:i,...s}=t,l=pi(s,e),u=n||o?O.jsx("span",{style:{pointerEvents:"none",flex:1},children:i}):i;return O.jsxs(Ed,{...l,className:Ee("chakra-menu__menuitem",l.className),children:[n&&O.jsx(yi,{fontSize:"0.8em",marginEnd:r,children:n}),u,o&&O.jsx(mi,{marginStart:a,children:o})]})});xt.displayName="MenuItem";var Sd={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},Cd=we(pa.div),Fa=_e(function(e,n){var r,o;const{rootProps:a,motionProps:i,...s}=e,{isOpen:l,onTransitionEnd:c,unstable__animationState:u}=Hn(),d=wd(s,n),p=bd(a),h=Yr();return O.jsx(we.div,{...p,__css:{zIndex:(o=e.zIndex)!=null?o:(r=h.list)==null?void 0:r.zIndex},children:O.jsx(Cd,{variants:Sd,initial:!1,animate:l?"enter":"exit",__css:{outline:0,...h.list},...i,className:Ee("chakra-menu__menu-list",d.className),...d,onUpdate:c,onAnimationComplete:Fs(u.onComplete,d.onAnimationComplete)})})});Fa.displayName="MenuList";var[Id,pn]=nt({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[Od,Xr]=nt({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `});function vi(t){const e=P.Children.only(t.children),{getTriggerProps:n}=pn();return P.cloneElement(e,n(e.props,e.ref))}vi.displayName="PopoverTrigger";var Xt={click:"click",hover:"hover"};function Dd(t={}){const{closeOnBlur:e=!0,closeOnEsc:n=!0,initialFocusRef:r,id:o,returnFocusOnClose:a=!0,autoFocus:i=!0,arrowSize:s,arrowShadowColor:l,trigger:c=Xt.click,openDelay:u=200,closeDelay:d=200,isLazy:p,lazyBehavior:h="unmount",computePositionOnMount:v,...f}=t,{isOpen:y,onClose:m,onOpen:w,onToggle:_}=Pa(t),x=P.useRef(null),E=P.useRef(null),I=P.useRef(null),k=P.useRef(!1),R=P.useRef(!1);y&&(R.current=!0);const[D,T]=P.useState(!1),[H,j]=P.useState(!1),L=P.useId(),b=o??L,[q,te,N,ae]=["popover-trigger","popover-content","popover-header","popover-body"].map(B=>`${B}-${b}`),{referenceRef:Z,getArrowProps:le,getPopperProps:K,getArrowInnerProps:U,forceUpdate:re}=ja({...f,enabled:y||!!v}),M=fi({isOpen:y,ref:I});bc({enabled:y,ref:E}),ti(I,{focusRef:E,visible:y,shouldFocus:a&&c===Xt.click}),Kc(I,{focusRef:r,visible:y,shouldFocus:i&&c===Xt.click});const A=Aa({wasSelected:R.current,enabled:p,mode:h,isSelected:M.present}),J=P.useCallback((B={},W=null)=>{const C={...B,style:{...B.style,transformOrigin:Fe.transformOrigin.varRef,[Fe.arrowSize.var]:s?`${s}px`:void 0,[Fe.arrowShadowColor.var]:l},ref:Le(I,W),children:A?B.children:null,id:te,tabIndex:-1,role:"dialog",onKeyDown:Oe(B.onKeyDown,S=>{n&&S.key==="Escape"&&m()}),onBlur:Oe(B.onBlur,S=>{const F=ms(S),$=lo(I.current,F),V=lo(E.current,F);y&&e&&(!$&&!V)&&m()}),"aria-labelledby":D?N:void 0,"aria-describedby":H?ae:void 0};return c===Xt.hover&&(C.role="tooltip",C.onMouseEnter=Oe(B.onMouseEnter,()=>{k.current=!0}),C.onMouseLeave=Oe(B.onMouseLeave,S=>{S.nativeEvent.relatedTarget!==null&&(k.current=!1,setTimeout(()=>m(),d))})),C},[A,te,D,N,H,ae,c,n,m,y,e,d,l,s]),oe=P.useCallback((B={},W=null)=>K({...B,style:{visibility:y?"visible":"hidden",...B.style}},W),[y,K]),ne=P.useCallback((B,W=null)=>({...B,ref:Le(W,x,Z)}),[x,Z]),ie=P.useRef(),ve=P.useRef(),fe=P.useCallback(B=>{x.current==null&&Z(B)},[Z]),he=P.useCallback((B={},W=null)=>{const C={...B,ref:Le(E,W,fe),id:q,"aria-haspopup":"dialog","aria-expanded":y,"aria-controls":te};return c===Xt.click&&(C.onClick=Oe(B.onClick,_)),c===Xt.hover&&(C.onFocus=Oe(B.onFocus,()=>{ie.current===void 0&&w()}),C.onBlur=Oe(B.onBlur,S=>{const F=ms(S),$=!lo(I.current,F);y&&e&&$&&m()}),C.onKeyDown=Oe(B.onKeyDown,S=>{S.key==="Escape"&&m()}),C.onMouseEnter=Oe(B.onMouseEnter,()=>{k.current=!0,ie.current=window.setTimeout(()=>w(),u)}),C.onMouseLeave=Oe(B.onMouseLeave,()=>{k.current=!1,ie.current&&(clearTimeout(ie.current),ie.current=void 0),ve.current=window.setTimeout(()=>{k.current===!1&&m()},d)})),C},[q,y,te,c,fe,_,w,e,m,u,d]);P.useEffect(()=>()=>{ie.current&&clearTimeout(ie.current),ve.current&&clearTimeout(ve.current)},[]);const ue=P.useCallback((B={},W=null)=>({...B,id:N,ref:Le(W,C=>{T(!!C)})}),[N]),g=P.useCallback((B={},W=null)=>({...B,id:ae,ref:Le(W,C=>{j(!!C)})}),[ae]);return{forceUpdate:re,isOpen:y,onAnimationComplete:M.onComplete,onClose:m,getAnchorProps:ne,getArrowProps:le,getArrowInnerProps:U,getPopoverPositionerProps:oe,getPopoverProps:J,getTriggerProps:he,getHeaderProps:ue,getBodyProps:g}}function lo(t,e){return t===e||(t==null?void 0:t.contains(e))}function ms(t){var e;const n=t.currentTarget.ownerDocument.activeElement;return(e=t.relatedTarget)!=null?e:n}function gi(t){const e=At("Popover",t),{children:n,...r}=rt(t),o=ha(),a=Dd({...r,direction:o.direction});return O.jsx(Id,{value:a,children:O.jsx(Od,{value:e,children:Ns(n,{isOpen:a.isOpen,onClose:a.onClose,forceUpdate:a.forceUpdate})})})}gi.displayName="Popover";var co=(t,e)=>e?`${t}.${e}, ${e}`:void 0;function wi(t){var e;const{bg:n,bgColor:r,backgroundColor:o,shadow:a,boxShadow:i,shadowColor:s}=t,{getArrowProps:l,getArrowInnerProps:c}=pn(),u=Xr(),d=(e=n??r)!=null?e:o,p=a??i;return O.jsx(we.div,{...l(),className:"chakra-popover__arrow-positioner",children:O.jsx(we.div,{className:Ee("chakra-popover__arrow",t.className),...c(t),__css:{"--popper-arrow-shadow-color":co("colors",s),"--popper-arrow-bg":co("colors",d),"--popper-arrow-shadow":co("shadows",p),...u.arrow}})})}wi.displayName="PopoverArrow";var bi=_e(function(e,n){const{getBodyProps:r}=pn(),o=Xr();return O.jsx(we.div,{...r(e,n),className:Ee("chakra-popover__body",e.className),__css:o.body})});bi.displayName="PopoverBody";var _i=_e(function(e,n){const{onClose:r}=pn(),o=Xr();return O.jsx(zl,{size:"sm",onClick:r,className:Ee("chakra-popover__close-btn",e.className),__css:o.closeButton,ref:n,...e})});_i.displayName="PopoverCloseButton";function jd(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}var Pd={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},Ad=we(pa.section),xi=_e(function(e,n){const{variants:r=Pd,...o}=e,{isOpen:a}=pn();return O.jsx(Ad,{ref:n,variants:jd(r),initial:!1,animate:a?"enter":"exit",...o})});xi.displayName="PopoverTransition";var ki=_e(function(e,n){const{rootProps:r,motionProps:o,...a}=e,{getPopoverProps:i,getPopoverPositionerProps:s,onAnimationComplete:l}=pn(),c=Xr(),u={position:"relative",display:"flex",flexDirection:"column",...c.content};return O.jsx(we.div,{...s(r),__css:c.popper,className:"chakra-popover__popper",children:O.jsx(xi,{...o,...i(a,n),onAnimationComplete:Fs(l,a.onAnimationComplete),className:Ee("chakra-popover__content",e.className),__css:u})})});ki.displayName="PopoverContent";var[Nd,Fd,Rd,Td]=Ws();function Bd(t){var e;const{defaultIndex:n,onChange:r,index:o,isManual:a,isLazy:i,lazyBehavior:s="unmount",orientation:l="horizontal",direction:c="ltr",...u}=t,[d,p]=P.useState(n??0),[h,v]=Us({defaultValue:n??0,value:o,onChange:r});P.useEffect(()=>{o!=null&&p(o)},[o]);const f=Rd(),y=P.useId();return{id:`tabs-${(e=t.id)!=null?e:y}`,selectedIndex:h,focusedIndex:d,setSelectedIndex:v,setFocusedIndex:p,isManual:a,isLazy:i,lazyBehavior:s,orientation:l,descendants:f,direction:c,htmlProps:u}}var[Md,Qr]=nt({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function zd(t){const{focusedIndex:e,orientation:n,direction:r}=Qr(),o=Fd(),a=P.useCallback(i=>{const s=()=>{var w;const _=o.nextEnabled(e);_&&((w=_.node)==null||w.focus())},l=()=>{var w;const _=o.prevEnabled(e);_&&((w=_.node)==null||w.focus())},c=()=>{var w;const _=o.firstEnabled();_&&((w=_.node)==null||w.focus())},u=()=>{var w;const _=o.lastEnabled();_&&((w=_.node)==null||w.focus())},d=n==="horizontal",p=n==="vertical",h=i.key,v=r==="ltr"?"ArrowLeft":"ArrowRight",f=r==="ltr"?"ArrowRight":"ArrowLeft",m={[v]:()=>d&&l(),[f]:()=>d&&s(),ArrowDown:()=>p&&s(),ArrowUp:()=>p&&l(),Home:c,End:u}[h];m&&(i.preventDefault(),m(i))},[o,e,n,r]);return{...t,role:"tablist","aria-orientation":n,onKeyDown:Oe(t.onKeyDown,a)}}function Ld(t){const{isDisabled:e=!1,isFocusable:n=!1,...r}=t,{setSelectedIndex:o,isManual:a,id:i,setFocusedIndex:s,selectedIndex:l}=Qr(),{index:c,register:u}=Td({disabled:e&&!n}),d=c===l,p=()=>{o(c)},h=()=>{s(c),!a&&!(e&&n)&&o(c)},v=ei({...r,ref:Le(u,t.ref),isDisabled:e,isFocusable:n,onClick:Oe(t.onClick,p)}),f="button";return{...v,id:Ei(i,c),role:"tab",tabIndex:d?0:-1,type:f,"aria-selected":d,"aria-controls":Si(i,c),onFocus:e?void 0:Oe(t.onFocus,h)}}var[Wd,Ud]=nt({});function Kd(t){const e=Qr(),{id:n,selectedIndex:r}=e,a=_a(t.children).map((i,s)=>P.createElement(Wd,{key:s,value:{isSelected:s===r,id:Si(n,s),tabId:Ei(n,s),selectedIndex:r}},i));return{...t,children:a}}function $d(t){const{children:e,...n}=t,{isLazy:r,lazyBehavior:o}=Qr(),{isSelected:a,id:i,tabId:s}=Ud(),l=P.useRef(!1);a&&(l.current=!0);const c=Aa({wasSelected:l.current,isSelected:a,enabled:r,mode:o});return{tabIndex:0,...n,children:c?e:null,role:"tabpanel","aria-labelledby":s,hidden:!a,id:i}}function Ei(t,e){return`${t}--tab-${e}`}function Si(t,e){return`${t}--tabpanel-${e}`}var[qd,eo]=nt({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),Ci=_e(function(e,n){const r=At("Tabs",e),{children:o,className:a,...i}=rt(e),{htmlProps:s,descendants:l,...c}=Bd(i),u=P.useMemo(()=>c,[c]),{isFitted:d,...p}=s,h={position:"relative",...r.root};return O.jsx(Nd,{value:l,children:O.jsx(Md,{value:u,children:O.jsx(qd,{value:r,children:O.jsx(we.div,{className:Ee("chakra-tabs",a),ref:n,...p,__css:h,children:o})})})})});Ci.displayName="Tabs";var Ii=_e(function(e,n){const r=zd({...e,ref:n}),a={display:"flex",...eo().tablist};return O.jsx(we.div,{...r,className:Ee("chakra-tabs__tablist",e.className),__css:a})});Ii.displayName="TabList";var Oo=_e(function(e,n){const r=$d({...e,ref:n}),o=eo();return O.jsx(we.div,{outline:"0",...r,className:Ee("chakra-tabs__tab-panel",e.className),__css:o.tabpanel})});Oo.displayName="TabPanel";var Oi=_e(function(e,n){const r=Kd(e),o=eo();return O.jsx(we.div,{...r,width:"100%",ref:n,className:Ee("chakra-tabs__tab-panels",e.className),__css:o.tabpanels})});Oi.displayName="TabPanels";var Do=_e(function(e,n){const r=eo(),o=Ld({...e,ref:n}),a={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...r.tab};return O.jsx(we.button,{...o,className:Ee("chakra-tabs__tab",e.className),__css:a})});Do.displayName="Tab";var[Hd,Di]=nt({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),Ra=_e((t,e)=>{const n=At("Tag",t),r=rt(t),o={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...n.container};return O.jsx(Hd,{value:n,children:O.jsx(we.span,{ref:e,...r,__css:o})})});Ra.displayName="Tag";var Vd=_e((t,e)=>{const n=Di();return O.jsx(we.span,{ref:e,noOfLines:1,...t,__css:n.label})});Vd.displayName="TagLabel";var Zd=_e((t,e)=>O.jsx(Wr,{ref:e,verticalAlign:"top",marginEnd:"0.5rem",...t}));Zd.displayName="TagLeftIcon";var Gd=_e((t,e)=>O.jsx(Wr,{ref:e,verticalAlign:"top",marginStart:"0.5rem",...t}));Gd.displayName="TagRightIcon";var ji=t=>O.jsx(Wr,{verticalAlign:"inherit",viewBox:"0 0 512 512",...t,children:O.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});ji.displayName="TagCloseIcon";var Jd=_e((t,e)=>{const{isDisabled:n,children:r,...o}=t,i={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...Di().closeButton};return O.jsx(we.button,{ref:e,"aria-label":"close",...o,type:"button",disabled:n,__css:i,children:r||O.jsx(ji,{})})});Jd.displayName="TagCloseButton";var Yd={exit:{scale:.85,opacity:0,transition:{opacity:{duration:.15,easings:"easeInOut"},scale:{duration:.2,easings:"easeInOut"}}},enter:{scale:1,opacity:1,transition:{opacity:{easings:"easeOut",duration:.2},scale:{duration:.2,ease:[.175,.885,.4,1.1]}}}},jo=t=>{var e;return((e=t.current)==null?void 0:e.ownerDocument)||document},dr=t=>{var e,n;return((n=(e=t.current)==null?void 0:e.ownerDocument)==null?void 0:n.defaultView)||window};function Xd(t={}){const{openDelay:e=0,closeDelay:n=0,closeOnClick:r=!0,closeOnMouseDown:o,closeOnScroll:a,closeOnPointerDown:i=o,closeOnEsc:s=!0,onOpen:l,onClose:c,placement:u,id:d,isOpen:p,defaultIsOpen:h,arrowSize:v=10,arrowShadowColor:f,arrowPadding:y,modifiers:m,isDisabled:w,gutter:_,offset:x,direction:E,...I}=t,{isOpen:k,onOpen:R,onClose:D}=Pa({isOpen:p,defaultIsOpen:h,onOpen:l,onClose:c}),{referenceRef:T,getPopperProps:H,getArrowInnerProps:j,getArrowProps:L}=ja({enabled:k,placement:u,arrowPadding:y,modifiers:m,gutter:_,offset:x,direction:E}),b=P.useId(),te=`tooltip-${d??b}`,N=P.useRef(null),ae=P.useRef(),Z=P.useCallback(()=>{ae.current&&(clearTimeout(ae.current),ae.current=void 0)},[]),le=P.useRef(),K=P.useCallback(()=>{le.current&&(clearTimeout(le.current),le.current=void 0)},[]),U=P.useCallback(()=>{K(),D()},[D,K]),re=Qd(N,U),M=P.useCallback(()=>{if(!w&&!ae.current){k&&re();const he=dr(N);ae.current=he.setTimeout(R,e)}},[re,w,k,R,e]),A=P.useCallback(()=>{Z();const he=dr(N);le.current=he.setTimeout(U,n)},[n,U,Z]),J=P.useCallback(()=>{k&&r&&A()},[r,A,k]),oe=P.useCallback(()=>{k&&i&&A()},[i,A,k]),ne=P.useCallback(he=>{k&&he.key==="Escape"&&A()},[k,A]);nn(()=>jo(N),"keydown",s?ne:void 0),nn(()=>{if(!a)return null;const he=N.current;if(!he)return null;const ue=Ys(he);return ue.localName==="body"?dr(N):ue},"scroll",()=>{k&&a&&U()},{passive:!0,capture:!0}),P.useEffect(()=>{w&&(Z(),k&&D())},[w,k,D,Z]),P.useEffect(()=>()=>{Z(),K()},[Z,K]),nn(()=>N.current,"pointerleave",A);const ie=P.useCallback((he={},ue=null)=>({...he,ref:Le(N,ue,T),onPointerEnter:Oe(he.onPointerEnter,B=>{B.pointerType!=="touch"&&M()}),onClick:Oe(he.onClick,J),onPointerDown:Oe(he.onPointerDown,oe),onFocus:Oe(he.onFocus,M),onBlur:Oe(he.onBlur,A),"aria-describedby":k?te:void 0}),[M,A,oe,k,te,J,T]),ve=P.useCallback((he={},ue=null)=>H({...he,style:{...he.style,[Fe.arrowSize.var]:v?`${v}px`:void 0,[Fe.arrowShadowColor.var]:f}},ue),[H,v,f]),fe=P.useCallback((he={},ue=null)=>{const g={...he.style,position:"relative",transformOrigin:Fe.transformOrigin.varRef};return{ref:ue,...I,...he,id:te,role:"tooltip",style:g}},[I,te]);return{isOpen:k,show:M,hide:A,getTriggerProps:ie,getTooltipProps:fe,getTooltipPositionerProps:ve,getArrowProps:L,getArrowInnerProps:j}}var uo="chakra-ui:close-tooltip";function Qd(t,e){return P.useEffect(()=>{const n=jo(t);return n.addEventListener(uo,e),()=>n.removeEventListener(uo,e)},[e,t]),()=>{const n=jo(t),r=dr(t);n.dispatchEvent(new r.CustomEvent(uo))}}function ef(t,e=[]){const n=Object.assign({},t);for(const r of e)r in n&&delete n[r];return n}function tf(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}var nf=we(pa.div),Wt=_e((t,e)=>{var n,r;const o=Ur("Tooltip",t),a=rt(t),i=ha(),{children:s,label:l,shouldWrapChildren:c,"aria-label":u,hasArrow:d,bg:p,portalProps:h,background:v,backgroundColor:f,bgColor:y,motionProps:m,...w}=a,_=(r=(n=v??f)!=null?n:p)!=null?r:y;if(_){o.bg=_;const H=Ll(i,"colors",_);o[Fe.arrowBg.var]=H}const x=Xd({...w,direction:i.direction}),E=typeof s=="string"||c;let I;if(E)I=O.jsx(we.span,{display:"inline-block",tabIndex:0,...x.getTriggerProps(),children:s});else{const H=P.Children.only(s);I=P.cloneElement(H,x.getTriggerProps(H.props,H.ref))}const k=!!u,R=x.getTooltipProps({},e),D=k?ef(R,["role","id"]):R,T=tf(R,["role","id"]);return l?O.jsxs(O.Fragment,{children:[I,O.jsx(Wl,{children:x.isOpen&&O.jsx(Rs,{...h,children:O.jsx(we.div,{...x.getTooltipPositionerProps(),__css:{zIndex:o.zIndex,pointerEvents:"none"},children:O.jsxs(nf,{variants:Yd,initial:"exit",animate:"enter",exit:"exit",...m,...D,__css:o,children:[l,k&&O.jsx(we.span,{srOnly:!0,...T,children:u}),d&&O.jsx(we.div,{"data-popper-arrow":!0,className:"chakra-tooltip__arrow-wrapper",children:O.jsx(we.div,{"data-popper-arrow-inner":!0,className:"chakra-tooltip__arrow",__css:{bg:o.bg}})})]})})})})]}):O.jsx(O.Fragment,{children:s})});Wt.displayName="Tooltip";let er;const rf=new Uint8Array(16);function of(){if(!er&&(er=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!er))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return er(rf)}const Me=[];for(let t=0;t<256;++t)Me.push((t+256).toString(16).slice(1));function af(t,e=0){return Me[t[e+0]]+Me[t[e+1]]+Me[t[e+2]]+Me[t[e+3]]+"-"+Me[t[e+4]]+Me[t[e+5]]+"-"+Me[t[e+6]]+Me[t[e+7]]+"-"+Me[t[e+8]]+Me[t[e+9]]+"-"+Me[t[e+10]]+Me[t[e+11]]+Me[t[e+12]]+Me[t[e+13]]+Me[t[e+14]]+Me[t[e+15]]}const sf=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ys={randomUUID:sf};function Fn(t,e,n){if(ys.randomUUID&&!e&&!t)return ys.randomUUID();t=t||{};const r=t.random||(t.rng||of)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let o=0;o<16;++o)e[n+o]=r[o];return e}return af(r)}async function lf(t){console.warn("[workspace deprecated] getDB is deprecated",t);try{const e=await fetch(`/workspace/get_db?table=${t}`);return e.ok?await e.json():void 0}catch(e){console.error("Error fetching workspace:",e);return}}async function cf(t,e){try{return await(await fetch("/workspace/save_db",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table:t,json:e})})).text()}catch(n){console.error("Error saving workspace:",n)}}async function Pi(t,e){try{return await(await fetch("/workspace/update_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,json_str:e})})).text()}catch(n){alert("Error saving workflow .json file: "+n),console.error("Error saving workspace:",n)}}async function Ai(t,e=!1){try{return await(await fetch("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,deleteEmptyFolder:e})})).text()}catch(n){console.error("Error deleting file:",n)}}async function jp(t){try{return await(await fetch("/workspace/get_system_dir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absolute_dir:t??""})})).json()}catch(e){console.error("Error getting workflows dir:",e)}}async function Pp(){try{return await(await fetch("/workspace/open_workflow_file_browser",{method:"POST",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error open workflows folder:",t)}}async function uf(){const e=await(await fetch("/workspace/get_my_workflows_dir")).json();return e.error&&alert(`Failed to fetch my workflows path: ${e.error}`),e.path}async function Ap(){try{return await(await fetch("/model_manager/get_model_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function Np(){try{return await(await fetch("/model_manager/get_folder_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}const df="backup",Sr="workspace";let tr=null;function ff(){return new Promise((t,e)=>{const n=indexedDB.open("WorkspaceDB",3);n.onupgradeneeded=r=>{const o=r.target.result;o.objectStoreNames.contains(Sr)||o.createObjectStore(Sr,{keyPath:"id"})},n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{e(r.target.error)}})}async function hf(){try{return tr==null&&(tr=await ff()),new Promise((t,e)=>{if(tr==null)return e("indexDB is null");const o=tr.transaction([Sr],"readonly").objectStore(Sr).get(df);o.onsuccess=()=>{o.result?t(o.result.value):t(void 0)},o.onerror=()=>e(o.error)})}catch(t){console.error("Error while reading from database:",t)}}async function pf(){try{return await hf()}catch(t){console.error("Error retrieving data from IndexedDB:",t)}}const Ce=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Re=Object.keys,Ue=Array.isArray;function He(t,e){return typeof e!="object"||Re(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||Ce.Promise||(Ce.Promise=Promise);const Rn=Object.getPrototypeOf,mf={}.hasOwnProperty;function Ye(t,e){return mf.call(t,e)}function fn(t,e){typeof e=="function"&&(e=e(Rn(t))),(typeof Reflect>"u"?Re:Reflect.ownKeys)(e).forEach(n=>{vt(t,n,e[n])})}const Ni=Object.defineProperty;function vt(t,e,n,r){Ni(t,e,He(n&&Ye(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function on(t){return{from:function(e){return t.prototype=Object.create(e.prototype),vt(t.prototype,"constructor",t),{extend:fn.bind(null,t.prototype)}}}}const yf=Object.getOwnPropertyDescriptor;function Ta(t,e){let n;return yf(t,e)||(n=Rn(t))&&Ta(n,e)}const vf=[].slice;function Cr(t,e,n){return vf.call(t,e,n)}function Fi(t,e){return e(t)}function bn(t){if(!t)throw new Error("Assertion Failed")}function Ri(t){Ce.setImmediate?setImmediate(t):setTimeout(t,0)}function Ti(t,e){return t.reduce((n,r,o)=>{var a=e(r,o);return a&&(n[a[0]]=a[1]),n},{})}function gt(t,e){if(Ye(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,o=e.length;r<o;++r){var a=gt(t,e[r]);n.push(a)}return n}var i=e.indexOf(".");if(i!==-1){var s=t[e.substr(0,i)];return s===void 0?void 0:gt(s,e.substr(i+1))}}function at(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){bn(typeof n!="string"&&"length"in n);for(var r=0,o=e.length;r<o;++r)at(t,e[r],n[r])}else{var a=e.indexOf(".");if(a!==-1){var i=e.substr(0,a),s=e.substr(a+1);if(s==="")n===void 0?Ue(t)&&!isNaN(parseInt(i))?t.splice(i,1):delete t[i]:t[i]=n;else{var l=t[i];l&&Ye(t,i)||(l=t[i]={}),at(l,s,n)}}else n===void 0?Ue(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Bi(t){var e={};for(var n in t)Ye(t,n)&&(e[n]=t[n]);return e}const gf=[].concat;function Mi(t){return gf.apply([],t)}const zi="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Mi([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>Ce[t]),wf=zi.map(t=>Ce[t]);Ti(zi,t=>[t,!0]);let Et=null;function Vn(t){Et=typeof WeakMap<"u"&&new WeakMap;const e=Po(t);return Et=null,e}function Po(t){if(!t||typeof t!="object")return t;let e=Et&&Et.get(t);if(e)return e;if(Ue(t)){e=[],Et&&Et.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Po(t[n]))}else if(wf.indexOf(t.constructor)>=0)e=t;else{const a=Rn(t);for(var o in e=a===Object.prototype?{}:Object.create(a),Et&&Et.set(t,e),t)Ye(t,o)&&(e[o]=Po(t[o]))}return e}const{toString:bf}={};function Ao(t){return bf.call(t).slice(8,-1)}const No=typeof Symbol<"u"?Symbol.iterator:"@@iterator",_f=typeof No=="symbol"?function(t){var e;return t!=null&&(e=t[No])&&e.apply(t)}:function(){return null},tn={};function pt(t){var e,n,r,o;if(arguments.length===1){if(Ue(t))return t.slice();if(this===tn&&typeof t=="string")return[t];if(o=_f(t)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const Ba=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var ut=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Li(t,e){ut=t,Wi=e}var Wi=()=>!0;const xf=!new Error("").stack;function Gt(){if(xf)try{throw Gt.arguments,new Error}catch(t){return t}return new Error}function Fo(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(Wi).map(r=>`
`+r).join("")):""}var Ui=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ma=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ui),kf={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function an(t,e){this._e=Gt(),this.name=t,this.message=e}function Ki(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,o)=>o.indexOf(n)===r).join(`
`)}function Ir(t,e,n,r){this._e=Gt(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Ki(t,e)}function Cn(t,e){this._e=Gt(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Ki(t,e)}on(an).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Fo(this._e,2))}},toString:function(){return this.name+": "+this.message}}),on(Ir).from(an),on(Cn).from(an);var za=Ma.reduce((t,e)=>(t[e]=e+"Error",t),{});const Ef=an;var me=Ma.reduce((t,e)=>{var n=e+"Error";function r(o,a){this._e=Gt(),this.name=n,o?typeof o=="string"?(this.message=`${o}${a?`
 `+a:""}`,this.inner=a||null):typeof o=="object"&&(this.message=`${o.name} ${o.message}`,this.inner=o):(this.message=kf[e]||n,this.inner=null)}return on(r).from(Ef),t[e]=r,t},{});me.Syntax=SyntaxError,me.Type=TypeError,me.Range=RangeError;var vs=Ui.reduce((t,e)=>(t[e+"Error"]=me[e],t),{}),fr=Ma.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=me[e]),t),{});function ke(){}function Tn(t){return t}function Sf(t,e){return t==null||t===Tn?e:function(n){return e(t(n))}}function Vt(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Cf(t,e){return t===ke?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Vt(r,this.onsuccess):r),o&&(this.onerror=this.onerror?Vt(o,this.onerror):o),a!==void 0?a:n}}function If(t,e){return t===ke?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Vt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Vt(r,this.onerror):r)}}function Of(t,e){return t===ke?e:function(n){var r=t.apply(this,arguments);He(n,r);var o=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var i=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?Vt(o,this.onsuccess):o),a&&(this.onerror=this.onerror?Vt(a,this.onerror):a),r===void 0?i===void 0?void 0:i:He(r,i)}}function Df(t,e){return t===ke?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function La(t,e){return t===ke?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,o=arguments.length,a=new Array(o);o--;)a[o]=arguments[o];return n.then(function(){return e.apply(r,a)})}return e.apply(this,arguments)}}fr.ModifyError=Ir,fr.DexieError=an,fr.BulkError=Cn;var Bn={};const $i=100,[Ro,Or,To]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,Rn(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Rn(e),t]})(),qi=Or&&Or.then,hr=Ro&&Ro.constructor,Wa=!!To;var Bo=!1,jf=To?()=>{To.then(nr)}:Ce.setImmediate?setImmediate.bind(null,nr):Ce.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{nr(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(nr,0)},In=function(t,e){_n.push([t,e]),Dr&&(jf(),Dr=!1)},Mo=!0,Dr=!0,Ut=[],pr=[],zo=null,Lo=Tn,sn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:bs,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{bs(t[0],t[1])}catch{}})}},de=sn,_n=[],Kt=0,mr=[];function ce(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ke,this._lib=!1;var e=this._PSD=de;if(ut&&(this._stackHolder=Gt(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Bn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Uo(this,this._value))}this._state=null,this._value=null,++e.ref,Vi(this,t)}const Wo={get:function(){var t=de,e=jr;function n(r,o){var a=!t.global&&(t!==de||e!==jr);const i=a&&!bt();var s=new ce((l,c)=>{Ua(this,new Hi(Pr(r,t,a,i),Pr(o,t,a,i),l,c,t))});return ut&&Ji(s,this),s}return n.prototype=Bn,n},set:function(t){vt(this,"then",t&&t.prototype===Bn?Wo:{get:function(){return t},set:Wo.set})}};function Hi(t,e,n,r,o){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=o}function Vi(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Zn();n&&typeof n.then=="function"?Vi(t,(o,a)=>{n instanceof ce?n._then(o,a):n.then(o,a)}):(t._state=!0,t._value=n,Zi(t)),r&&Gn()}},Uo.bind(null,t))}catch(n){Uo(t,n)}}function Uo(t,e){if(pr.push(e),t._state===null){var n=t._lib&&Zn();e=Lo(e),t._state=!1,t._value=e,ut&&e!==null&&typeof e=="object"&&!e._promise&&function(r,o,a){try{r.apply(null,a)}catch(i){o&&o(i)}}(()=>{var r=Ta(e,"stack");e._promise=t,vt(e,"stack",{get:()=>Bo?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){Ut.some(o=>o._value===r._value)||Ut.push(r)}(t),Zi(t),n&&Gn()}}function Zi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Ua(t,e[n]);var o=t._PSD;--o.ref||o.finalize(),Kt===0&&(++Kt,In(()=>{--Kt==0&&Ka()},[]))}function Ua(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Kt,In(Pf,[n,t,e])}else t._listeners.push(e)}function Pf(t,e,n){try{zo=e;var r,o=e._value;e._state?r=t(o):(pr.length&&(pr=[]),r=t(o),pr.indexOf(o)===-1&&function(a){for(var i=Ut.length;i;)if(Ut[--i]._value===a._value)return void Ut.splice(i,1)}(e)),n.resolve(r)}catch(a){n.reject(a)}finally{zo=null,--Kt==0&&Ka(),--n.psd.ref||n.psd.finalize()}}function Gi(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var o,a,i=t._value;i!=null?(o=i.name||"Error",a=i.message||i,r=Fo(i,0)):(o=i,a=""),e.push(o+(a?": "+a:"")+r)}return ut&&((r=Fo(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&Gi(t._prev,e,n)),e}function Ji(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function nr(){Zn()&&Gn()}function Zn(){var t=Mo;return Mo=!1,Dr=!1,t}function Gn(){var t,e,n;do for(;_n.length>0;)for(t=_n,_n=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(_n.length>0);Mo=!0,Dr=!0}function Ka(){var t=Ut;Ut=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=mr.slice(0),n=e.length;n;)e[--n]()}function rr(t){return new ce(Bn,!1,t)}function Ie(t,e){var n=de;return function(){var r=Zn(),o=de;try{return Dt(n,!0),t.apply(this,arguments)}catch(a){e&&e(a)}finally{Dt(o,!1),r&&Gn()}}}fn(ce.prototype,{then:Wo,_then:function(t,e){Ua(this,new Hi(null,null,t,e,de))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):rr(r)):this.then(null,r=>r&&r.name===e?n(r):rr(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),rr(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Bo=!0;var t=Gi(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Bo=!1}}},timeout:function(t,e){return t<1/0?new ce((n,r)=>{var o=setTimeout(()=>r(new me.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&vt(ce.prototype,Symbol.toStringTag,"Dexie.Promise"),sn.env=Yi(),fn(ce,{all:function(){var t=pt.apply(null,arguments).map(or);return new ce(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((o,a)=>ce.resolve(o).then(i=>{t[a]=i,--r||e(t)},n))})},resolve:t=>{if(t instanceof ce)return t;if(t&&typeof t.then=="function")return new ce((n,r)=>{t.then(n,r)});var e=new ce(Bn,!0,t);return Ji(e,zo),e},reject:rr,race:function(){var t=pt.apply(null,arguments).map(or);return new ce((e,n)=>{t.map(r=>ce.resolve(r).then(e,n))})},PSD:{get:()=>de,set:t=>de=t},totalEchoes:{get:()=>jr},newPSD:Ot,usePSD:yn,scheduler:{get:()=>In,set:t=>{In=t}},rejectionMapper:{get:()=>Lo,set:t=>{Lo=t}},follow:(t,e)=>new ce((n,r)=>Ot((o,a)=>{var i=de;i.unhandleds=[],i.onunhandled=a,i.finalize=Vt(function(){(function(s){function l(){s(),mr.splice(mr.indexOf(l),1)}mr.push(l),++Kt,In(()=>{--Kt==0&&Ka()},[])})(()=>{this.unhandleds.length===0?o():a(this.unhandleds[0])})},i.finalize),t()},e,n,r))}),hr&&(hr.allSettled&&vt(ce,"allSettled",function(){const t=pt.apply(null,arguments).map(or);return new ce(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((o,a)=>ce.resolve(o).then(i=>r[a]={status:"fulfilled",value:i},i=>r[a]={status:"rejected",reason:i}).then(()=>--n||e(r)))})}),hr.any&&typeof AggregateError<"u"&&vt(ce,"any",function(){const t=pt.apply(null,arguments).map(or);return new ce((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const o=new Array(r);t.forEach((a,i)=>ce.resolve(a).then(s=>e(s),s=>{o[i]=s,--r||n(new AggregateError(o))}))})}));const We={awaits:0,echoes:0,id:0};var Af=0,yr=[],fo=0,jr=0,Nf=0;function Ot(t,e,n,r){var o=de,a=Object.create(o);a.parent=o,a.ref=0,a.global=!1,a.id=++Nf;var i=sn.env;a.env=Wa?{Promise:ce,PromiseProp:{value:ce,configurable:!0,writable:!0},all:ce.all,race:ce.race,allSettled:ce.allSettled,any:ce.any,resolve:ce.resolve,reject:ce.reject,nthen:gs(i.nthen,a),gthen:gs(i.gthen,a)}:{},e&&He(a,e),++o.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=yn(a,t,n,r);return a.ref===0&&a.finalize(),s}function mn(){return We.id||(We.id=++Af),++We.awaits,We.echoes+=$i,We.id}function bt(){return!!We.awaits&&(--We.awaits==0&&(We.id=0),We.echoes=We.awaits*$i,!0)}function or(t){return We.echoes&&t&&t.constructor===hr?(mn(),t.then(e=>(bt(),e),e=>(bt(),Te(e)))):t}function Ff(t){++jr,We.echoes&&--We.echoes!=0||(We.echoes=We.id=0),yr.push(de),Dt(t,!0)}function Rf(){var t=yr[yr.length-1];yr.pop(),Dt(t,!1)}function Dt(t,e){var n=de;if((e?!We.echoes||fo++&&t===de:!fo||--fo&&t===de)||Xi(e?Ff.bind(null,t):Rf),t!==de&&(de=t,n===sn&&(sn.env=Yi()),Wa)){var r=sn.env.Promise,o=t.env;Or.then=o.nthen,r.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(Ce,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function Yi(){var t=Ce.Promise;return Wa?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(Ce,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Or.then,gthen:t.prototype.then}:{}}function yn(t,e,n,r,o){var a=de;try{return Dt(t,!0),e(n,r,o)}finally{Dt(a,!1)}}function Xi(t){qi.call(Ro,t)}function Pr(t,e,n,r){return typeof t!="function"?t:function(){var o=de;n&&mn(),Dt(e,!0);try{return t.apply(this,arguments)}finally{Dt(o,!1),r&&Xi(bt)}}}function gs(t,e){return function(n,r){return t.call(this,Pr(n,e),Pr(r,e))}}(""+qi).indexOf("[native code]")===-1&&(mn=bt=ke);const ws="unhandledrejection";function bs(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,o={promise:e,reason:t};if(Ce.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(ws,!0,!0),He(r,o)):Ce.CustomEvent&&He(r=new CustomEvent(ws,{detail:o}),o),r&&Ce.dispatchEvent&&(dispatchEvent(r),!Ce.PromiseRejectionEvent&&Ce.onunhandledrejection))try{Ce.onunhandledrejection(r)}catch{}ut&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var Te=ce.reject;function Ko(t,e,n,r){if(t.idbdb&&(t._state.openComplete||de.letThrough||t._vip)){var o=t._createTransaction(e,n,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(a){return a.name===za.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Ko(t,e,n,r))):Te(a)}return o._promise(e,(a,i)=>Ot(()=>(de.trans=o,r(a,i,o)))).then(a=>o._completion.then(()=>a))}if(t._state.openComplete)return Te(new me.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Te(new me.DatabaseClosed);t.open().catch(ke)}return t._state.dbReadyPromise.then(()=>Ko(t,e,n,r))}const _s="3.2.4",Bt="",$o=-1/0,ft="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Qi="String expected.",On=[],to=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Tf=to,Bf=to,el=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),no="__dbnames",ho="readonly",po="readwrite";function Zt(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const tl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ar(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=Vn(e))[t],e)}class Mf{_trans(e,n,r){const o=this._tx||de.trans,a=this.name;function i(l,c,u){if(!u.schema[a])throw new me.NotFound("Table "+a+" not part of transaction");return n(u.idbtrans,u)}const s=Zn();try{return o&&o.db===this.db?o===de.trans?o._promise(e,i,r):Ot(()=>o._promise(e,i,r),{trans:o,transless:de.transless||de}):Ko(this.db,e,[this.name],i)}finally{s&&Gn()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(o=>this.hook.reading.fire(o))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(Ue(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=Re(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(c=>c.compound&&n.every(u=>c.keyPath.indexOf(u)>=0)&&c.keyPath.every(u=>n.indexOf(u)>=0))[0];if(r&&this.db._maxKey!==Bt)return this.where(r.name).equals(r.keyPath.map(c=>e[c]));!r&&ut&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:o}=this.schema,a=this.db._deps.indexedDB;function i(c,u){try{return a.cmp(c,u)===0}catch{return!1}}const[s,l]=n.reduce(([c,u],d)=>{const p=o[d],h=e[d];return[c||p,c||!p?Zt(u,p&&p.multi?v=>{const f=gt(v,d);return Ue(f)&&f.some(y=>i(h,y))}:v=>i(h,gt(v,d))):u]},[null,null]);return s?this.where(s.name).equals(e[s.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,Ue(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=r=>{if(!r)return r;const o=Object.create(e.prototype);for(var a in r)if(Ye(r,a))try{o[a]=r[a]}catch{}return o};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){He(this,e)})}add(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let a=e;return o&&r&&(a=ar(o)(e)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"add",keys:n!=null?[n]:null,values:[a]})).then(i=>i.numFailures?ce.reject(i.failures[0]):i.lastResult).then(i=>{if(o)try{at(e,o,i)}catch{}return i})}update(e,n){if(typeof e!="object"||Ue(e))return this.where(":id").equals(e).modify(n);{const r=gt(e,this.schema.primKey.keyPath);if(r===void 0)return Te(new me.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?Re(n).forEach(o=>{at(e,o,n[o])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let a=e;return o&&r&&(a=ar(o)(e)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"put",values:[a],keys:n!=null?[n]:null})).then(i=>i.numFailures?ce.reject(i.failures[0]):i.lastResult).then(i=>{if(o)try{at(e,o,i)}catch{}return i})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?ce.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:tl})).then(e=>e.numFailures?ce.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(o=>this.hook.reading.fire(o))))}bulkAdd(e,n,r){const o=Array.isArray(n)?n:void 0,a=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:s,keyPath:l}=this.schema.primKey;if(l&&o)throw new me.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new me.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=l&&s?e.map(ar(l)):e;return this.core.mutate({trans:i,type:"add",keys:o,values:u,wantResults:a}).then(({numFailures:d,results:p,lastResult:h,failures:v})=>{if(d===0)return a?p:h;throw new Cn(`${this.name}.bulkAdd(): ${d} of ${c} operations failed`,v)})})}bulkPut(e,n,r){const o=Array.isArray(n)?n:void 0,a=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:s,keyPath:l}=this.schema.primKey;if(l&&o)throw new me.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new me.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=l&&s?e.map(ar(l)):e;return this.core.mutate({trans:i,type:"put",keys:o,values:u,wantResults:a}).then(({numFailures:d,results:p,lastResult:h,failures:v})=>{if(d===0)return a?p:h;throw new Cn(`${this.name}.bulkPut(): ${d} of ${c} operations failed`,v)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:o,failures:a})=>{if(r===0)return o;throw new Cn(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,a)})}}function Dn(t){var e={},n=function(i,s){if(s){for(var l=arguments.length,c=new Array(l-1);--l;)c[l-1]=arguments[l];return e[i].subscribe.apply(null,c),t}if(typeof i=="string")return e[i]};n.addEventType=a;for(var r=1,o=arguments.length;r<o;++r)a(arguments[r]);return n;function a(i,s,l){if(typeof i!="object"){var c;s||(s=Df),l||(l=ke);var u={subscribers:[],fire:l,subscribe:function(d){u.subscribers.indexOf(d)===-1&&(u.subscribers.push(d),u.fire=s(u.fire,d))},unsubscribe:function(d){u.subscribers=u.subscribers.filter(function(p){return p!==d}),u.fire=u.subscribers.reduce(s,l)}};return e[i]=n[i]=u,u}Re(c=i).forEach(function(d){var p=c[d];if(Ue(p))a(d,c[d][0],c[d][1]);else{if(p!=="asap")throw new me.InvalidArgument("Invalid event config");var h=a(d,Tn,function(){for(var v=arguments.length,f=new Array(v);v--;)f[v]=arguments[v];h.subscribers.forEach(function(y){Ri(function(){y.apply(null,f)})})})}})}}function wn(t,e){return on(e).from({prototype:t}),e}function Qt(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function mo(t,e){t.filter=Zt(t.filter,e)}function yo(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>Zt(r(),e()):e,t.justLimit=n&&!r}function vr(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new me.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function xs(t,e,n){const r=vr(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function sr(t,e,n,r){const o=t.replayFilter?Zt(t.filter,t.replayFilter()):t.filter;if(t.or){const a={},i=(s,l,c)=>{if(!o||o(l,c,p=>l.stop(p),p=>l.fail(p))){var u=l.primaryKey,d=""+u;d==="[object ArrayBuffer]"&&(d=""+new Uint8Array(u)),Ye(a,d)||(a[d]=!0,e(s,l,c))}};return Promise.all([t.or._iterate(i,n),ks(xs(t,r,n),t.algorithm,i,!t.keysOnly&&t.valueMapper)])}return ks(xs(t,r,n),Zt(t.algorithm,o),e,!t.keysOnly&&t.valueMapper)}function ks(t,e,n,r){var o=Ie(r?(a,i,s)=>n(r(a),i,s):n);return t.then(a=>{if(a)return a.start(()=>{var i=()=>a.continue();e&&!e(a,s=>i=s,s=>{a.stop(s),i=ke},s=>{a.fail(s),i=ke})||o(a.value,a,s=>i=s),i()})})}function $e(t,e){try{const n=Es(t),r=Es(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(o,a){const i=o.length,s=a.length,l=i<s?i:s;for(let c=0;c<l;++c)if(o[c]!==a[c])return o[c]<a[c]?-1:1;return i===s?0:i<s?-1:1}(Ss(t),Ss(e));case"Array":return function(o,a){const i=o.length,s=a.length,l=i<s?i:s;for(let c=0;c<l;++c){const u=$e(o[c],a[c]);if(u!==0)return u}return i===s?0:i<s?-1:1}(t,e)}}catch{}return NaN}function Es(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=Ao(t);return n==="ArrayBuffer"?"binary":n}function Ss(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class zf{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,Te.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,Te.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=Zt(n.algorithm,e)}_iterate(e,n){return sr(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&He(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>sr(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,o=r.table.core;if(Qt(r,!0))return o.count({trans:n,query:{index:vr(r,o.schema),range:r.range}}).then(i=>Math.min(i,r.limit));var a=0;return sr(r,()=>(++a,!1),n,o).then(()=>a)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),o=r[0],a=r.length-1;function i(c,u){return u?i(c[r[u]],u-1):c[o]}var s=this._ctx.dir==="next"?1:-1;function l(c,u){var d=i(c,a),p=i(u,a);return d<p?-s:d>p?s:0}return this.toArray(function(c){return c.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&Qt(r,!0)&&r.limit>0){const{valueMapper:o}=r,a=vr(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:a,range:r.range}}).then(({result:i})=>o?i.map(o):i)}{const o=[];return sr(r,a=>o.push(a),n,r.table.core).then(()=>o)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,Qt(n)?yo(n,()=>{var r=e;return(o,a)=>r===0||(r===1?(--r,!1):(a(()=>{o.advance(r),r=0}),!1))}):yo(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),yo(this._ctx,()=>{var n=e;return function(r,o,a){return--n<=0&&o(a),n>=0}},!0),this}until(e,n){return mo(this._ctx,function(r,o,a){return!e(r.value)||(o(a),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return mo(this._ctx,function(o){return e(o.value)}),n=this._ctx,r=e,n.isMatch=Zt(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.key,o)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.primaryKey,o)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,a){r.push(a.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&Qt(n,!0)&&n.limit>0)return this._read(o=>{var a=vr(n,n.table.core.schema);return n.table.core.query({trans:o,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(({result:o})=>o).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,a){r.push(a.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return mo(this._ctx,function(o){var a=o.primaryKey.toString(),i=Ye(r,a);return r[a]=!0,!i}),this}modify(e){var n=this._ctx;return this._write(r=>{var o;if(typeof e=="function")o=e;else{var a=Re(e),i=a.length;o=function(f){for(var y=!1,m=0;m<i;++m){var w=a[m],_=e[w];gt(f,w)!==_&&(at(f,w,_),y=!0)}return y}}const s=n.table.core,{outbound:l,extractKey:c}=s.schema.primaryKey,u=this.db._options.modifyChunkSize||200,d=[];let p=0;const h=[],v=(f,y)=>{const{failures:m,numFailures:w}=y;p+=f-w;for(let _ of Re(m))d.push(m[_])};return this.clone().primaryKeys().then(f=>{const y=m=>{const w=Math.min(u,f.length-m);return s.getMany({trans:r,keys:f.slice(m,m+w),cache:"immutable"}).then(_=>{const x=[],E=[],I=l?[]:null,k=[];for(let D=0;D<w;++D){const T=_[D],H={value:Vn(T),primKey:f[m+D]};o.call(H,H.value,H)!==!1&&(H.value==null?k.push(f[m+D]):l||$e(c(T),c(H.value))===0?(E.push(H.value),l&&I.push(f[m+D])):(k.push(f[m+D]),x.push(H.value)))}const R=Qt(n)&&n.limit===1/0&&(typeof e!="function"||e===vo)&&{index:n.index,range:n.range};return Promise.resolve(x.length>0&&s.mutate({trans:r,type:"add",values:x}).then(D=>{for(let T in D.failures)k.splice(parseInt(T),1);v(x.length,D)})).then(()=>(E.length>0||R&&typeof e=="object")&&s.mutate({trans:r,type:"put",keys:I,values:E,criteria:R,changeSpec:typeof e!="function"&&e}).then(D=>v(E.length,D))).then(()=>(k.length>0||R&&e===vo)&&s.mutate({trans:r,type:"delete",keys:k,criteria:R}).then(D=>v(k.length,D))).then(()=>f.length>m+w&&y(m+u))})};return y(0).then(()=>{if(d.length>0)throw new Ir("Error modifying one or more objects",d,p,h);return f.length})})})}delete(){var e=this._ctx,n=e.range;return Qt(e)&&(e.isPrimKey&&!Bf||n.type===3)?this._write(r=>{const{primaryKey:o}=e.table.core.schema,a=n;return e.table.core.count({trans:r,query:{index:o,range:a}}).then(i=>e.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(({failures:s,lastResult:l,results:c,numFailures:u})=>{if(u)throw new Ir("Could not delete some values",Object.keys(s).map(d=>s[d]),i-u);return i-u}))}):this.modify(vo)}}const vo=(t,e)=>e.value=null;function Lf(t,e){return t<e?-1:t===e?0:1}function Wf(t,e){return t>e?-1:t===e?0:1}function Ge(t,e,n){var r=t instanceof rl?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function en(t){return new t.Collection(t,()=>nl("")).limit(0)}function Uf(t,e,n,r,o,a){for(var i=Math.min(t.length,r.length),s=-1,l=0;l<i;++l){var c=e[l];if(c!==r[l])return o(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):o(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):s>=0?t.substr(0,s)+e[s]+n.substr(s+1):null;o(t[l],c)<0&&(s=l)}return i<r.length&&a==="next"?t+n.substr(t.length):i<t.length&&a==="prev"?t.substr(0,n.length):s<0?null:t.substr(0,s)+r[s]+n.substr(s+1)}function ir(t,e,n,r){var o,a,i,s,l,c,u,d=n.length;if(!n.every(f=>typeof f=="string"))return Ge(t,Qi);function p(f){o=function(m){return m==="next"?w=>w.toUpperCase():w=>w.toLowerCase()}(f),a=function(m){return m==="next"?w=>w.toLowerCase():w=>w.toUpperCase()}(f),i=f==="next"?Lf:Wf;var y=n.map(function(m){return{lower:a(m),upper:o(m)}}).sort(function(m,w){return i(m.lower,w.lower)});s=y.map(function(m){return m.upper}),l=y.map(function(m){return m.lower}),c=f,u=f==="next"?"":r}p("next");var h=new t.Collection(t,()=>kt(s[0],l[d-1]+r));h._ondirectionchange=function(f){p(f)};var v=0;return h._addAlgorithm(function(f,y,m){var w=f.key;if(typeof w!="string")return!1;var _=a(w);if(e(_,l,v))return!0;for(var x=null,E=v;E<d;++E){var I=Uf(w,_,s[E],l[E],i,c);I===null&&x===null?v=E+1:(x===null||i(x,I)>0)&&(x=I)}return y(x!==null?function(){f.continue(x+u)}:m),!1}),h}function kt(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function nl(t){return{type:1,lower:t,upper:t}}class rl{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,o){r=r!==!1,o=o===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||o)&&(!r||!o)?en(this):new this.Collection(this,()=>kt(e,n,!r,!o))}catch{return Ge(this,ft)}}equals(e){return e==null?Ge(this,ft):new this.Collection(this,()=>nl(e))}above(e){return e==null?Ge(this,ft):new this.Collection(this,()=>kt(e,void 0,!0))}aboveOrEqual(e){return e==null?Ge(this,ft):new this.Collection(this,()=>kt(e,void 0,!1))}below(e){return e==null?Ge(this,ft):new this.Collection(this,()=>kt(void 0,e,!1,!0))}belowOrEqual(e){return e==null?Ge(this,ft):new this.Collection(this,()=>kt(void 0,e))}startsWith(e){return typeof e!="string"?Ge(this,Qi):this.between(e,e+Bt,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):ir(this,(n,r)=>n.indexOf(r[0])===0,[e],Bt)}equalsIgnoreCase(e){return ir(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=pt.apply(tn,arguments);return e.length===0?en(this):ir(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=pt.apply(tn,arguments);return e.length===0?en(this):ir(this,(n,r)=>r.some(o=>n.indexOf(o)===0),e,Bt)}anyOf(){const e=pt.apply(tn,arguments);let n=this._cmp;try{e.sort(n)}catch{return Ge(this,ft)}if(e.length===0)return en(this);const r=new this.Collection(this,()=>kt(e[0],e[e.length-1]));r._ondirectionchange=a=>{n=a==="next"?this._ascending:this._descending,e.sort(n)};let o=0;return r._addAlgorithm((a,i,s)=>{const l=a.key;for(;n(l,e[o])>0;)if(++o,o===e.length)return i(s),!1;return n(l,e[o])===0||(i(()=>{a.continue(e[o])}),!1)}),r}notEqual(e){return this.inAnyRange([[$o,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=pt.apply(tn,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Ge(this,ft)}const n=e.reduce((r,o)=>r?r.concat([[r[r.length-1][1],o]]):[[$o,o]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,o=this._ascending,a=this._descending,i=this._min,s=this._max;if(e.length===0)return en(this);if(!e.every(w=>w[0]!==void 0&&w[1]!==void 0&&o(w[0],w[1])<=0))return Ge(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",me.InvalidArgument);const l=!n||n.includeLowers!==!1,c=n&&n.includeUppers===!0;let u,d=o;function p(w,_){return d(w[0],_[0])}try{u=e.reduce(function(w,_){let x=0,E=w.length;for(;x<E;++x){const I=w[x];if(r(_[0],I[1])<0&&r(_[1],I[0])>0){I[0]=i(I[0],_[0]),I[1]=s(I[1],_[1]);break}}return x===E&&w.push(_),w},[]),u.sort(p)}catch{return Ge(this,ft)}let h=0;const v=c?w=>o(w,u[h][1])>0:w=>o(w,u[h][1])>=0,f=l?w=>a(w,u[h][0])>0:w=>a(w,u[h][0])>=0;let y=v;const m=new this.Collection(this,()=>kt(u[0][0],u[u.length-1][1],!l,!c));return m._ondirectionchange=w=>{w==="next"?(y=v,d=o):(y=f,d=a),u.sort(p)},m._addAlgorithm((w,_,x)=>{for(var E=w.key;y(E);)if(++h,h===u.length)return _(x),!1;return!!function(I){return!v(I)&&!f(I)}(E)||(this._cmp(E,u[h][1])===0||this._cmp(E,u[h][0])===0||_(()=>{d===o?w.continue(u[h][0]):w.continue(u[h][1])}),!1)}),m}startsWithAnyOf(){const e=pt.apply(tn,arguments);return e.every(n=>typeof n=="string")?e.length===0?en(this):this.inAnyRange(e.map(n=>[n,n+Bt])):Ge(this,"startsWithAnyOf() only works with strings")}}function it(t){return Ie(function(e){return Mn(e),t(e.target.error),!1})}function Mn(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const zn="storagemutated",St="x-storagemutated-1",jt=Dn(null,zn);class Kf{_lock(){return bn(!de.global),++this._reculock,this._reculock!==1||de.global||(de.lockOwnerFor=this),this}_unlock(){if(bn(!de.global),--this._reculock==0)for(de.global||(de.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{yn(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&de.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(bn(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new me.DatabaseClosed(r);case"MissingAPIError":throw new me.MissingAPI(r.message,r);default:throw new me.OpenFailed(r)}if(!this.active)throw new me.TransactionInactive;return bn(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ie(o=>{Mn(o),this._reject(e.error)}),e.onabort=Ie(o=>{Mn(o),this.active&&this._reject(new me.Abort(e.error)),this.active=!1,this.on("abort").fire(o)}),e.oncomplete=Ie(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&jt.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return Te(new me.ReadOnly("Transaction is readonly"));if(!this.active)return Te(new me.TransactionInactive);if(this._locked())return new ce((a,i)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(a,i)},de])});if(r)return Ot(()=>{var a=new ce((i,s)=>{this._lock();const l=n(i,s,this);l&&l.then&&l.then(i,s)});return a.finally(()=>this._unlock()),a._lib=!0,a});var o=new ce((a,i)=>{var s=n(a,i,this);s&&s.then&&s.then(a,i)});return o._lib=!0,o}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=ce.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var o=n.idbtrans.objectStore(n.storeNames[0]);(function i(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(o.get(-1/0).onsuccess=i)})()}var a=n._waitingFor;return new ce((i,s)=>{r.then(l=>n._waitingQueue.push(Ie(i.bind(null,l))),l=>n._waitingQueue.push(Ie(s.bind(null,l)))).finally(()=>{n._waitingFor===a&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new me.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(Ye(n,e))return n[e];const r=this.schema[e];if(!r)throw new me.NotFound("Table "+e+" not part of transaction");const o=new this.db.Table(e,r,this);return o.core=this.db.core.table(e),n[e]=o,o}}function qo(t,e,n,r,o,a,i){return{name:t,keyPath:e,unique:n,multi:r,auto:o,compound:a,src:(n&&!i?"&":"")+(r?"*":"")+(o?"++":"")+ol(e)}}function ol(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function al(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Ti(n,r=>[r.name,r])}}let Ln=t=>{try{return t.only([[]]),Ln=()=>[[]],[[]]}catch{return Ln=()=>Bt,Bt}};function Ho(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?r=>r[e]:r=>gt(r,e)}(t):e=>gt(e,t)}function Cs(t){return[].slice.call(t)}let $f=0;function jn(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function qf(t,e,n){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:c,upper:u,lowerOpen:d,upperOpen:p}=l;return c===void 0?u===void 0?null:e.upperBound(u,!!p):u===void 0?e.lowerBound(c,!!d):e.bound(c,u,!!d,!!p)}const{schema:o,hasGetAll:a}=function(l,c){const u=Cs(l.objectStoreNames);return{schema:{name:l.name,tables:u.map(d=>c.objectStore(d)).map(d=>{const{keyPath:p,autoIncrement:h}=d,v=Ue(p),f=p==null,y={},m={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:f,compound:v,keyPath:p,autoIncrement:h,unique:!0,extractKey:Ho(p)},indexes:Cs(d.indexNames).map(w=>d.index(w)).map(w=>{const{name:_,unique:x,multiEntry:E,keyPath:I}=w,k={name:_,compound:Ue(I),keyPath:I,unique:x,multiEntry:E,extractKey:Ho(I)};return y[jn(I)]=k,k}),getIndexByKeyPath:w=>y[jn(w)]};return y[":id"]=m.primaryKey,p!=null&&(y[jn(p)]=m.primaryKey),m})},hasGetAll:u.length>0&&"getAll"in c.objectStore(u[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),i=o.tables.map(l=>function(c){const u=c.name;return{name:u,schema:c,mutate:function({trans:d,type:p,keys:h,values:v,range:f}){return new Promise((y,m)=>{y=Ie(y);const w=d.objectStore(u),_=w.keyPath==null,x=p==="put"||p==="add";if(!x&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:E}=h||v||{length:1};if(h&&v&&h.length!==v.length)throw new Error("Given keys array must have same length as given values array.");if(E===0)return y({numFailures:0,failures:{},results:[],lastResult:void 0});let I;const k=[],R=[];let D=0;const T=j=>{++D,Mn(j)};if(p==="deleteRange"){if(f.type===4)return y({numFailures:D,failures:R,results:[],lastResult:void 0});f.type===3?k.push(I=w.clear()):k.push(I=w.delete(r(f)))}else{const[j,L]=x?_?[v,h]:[v,null]:[h,null];if(x)for(let b=0;b<E;++b)k.push(I=L&&L[b]!==void 0?w[p](j[b],L[b]):w[p](j[b])),I.onerror=T;else for(let b=0;b<E;++b)k.push(I=w[p](j[b])),I.onerror=T}const H=j=>{const L=j.target.result;k.forEach((b,q)=>b.error!=null&&(R[q]=b.error)),y({numFailures:D,failures:R,results:p==="delete"?h:k.map(b=>b.result),lastResult:L})};I.onerror=j=>{T(j),H(j)},I.onsuccess=H})},getMany:({trans:d,keys:p})=>new Promise((h,v)=>{h=Ie(h);const f=d.objectStore(u),y=p.length,m=new Array(y);let w,_=0,x=0;const E=k=>{const R=k.target;m[R._pos]=R.result,++x===_&&h(m)},I=it(v);for(let k=0;k<y;++k)p[k]!=null&&(w=f.get(p[k]),w._pos=k,w.onsuccess=E,w.onerror=I,++_);_===0&&h(m)}),get:({trans:d,key:p})=>new Promise((h,v)=>{h=Ie(h);const f=d.objectStore(u).get(p);f.onsuccess=y=>h(y.target.result),f.onerror=it(v)}),query:function(d){return p=>new Promise((h,v)=>{h=Ie(h);const{trans:f,values:y,limit:m,query:w}=p,_=m===1/0?void 0:m,{index:x,range:E}=w,I=f.objectStore(u),k=x.isPrimaryKey?I:I.index(x.name),R=r(E);if(m===0)return h({result:[]});if(d){const D=y?k.getAll(R,_):k.getAllKeys(R,_);D.onsuccess=T=>h({result:T.target.result}),D.onerror=it(v)}else{let D=0;const T=y||!("openKeyCursor"in k)?k.openCursor(R):k.openKeyCursor(R),H=[];T.onsuccess=j=>{const L=T.result;return L?(H.push(y?L.value:L.primaryKey),++D===m?h({result:H}):void L.continue()):h({result:H})},T.onerror=it(v)}})}(a),openCursor:function({trans:d,values:p,query:h,reverse:v,unique:f}){return new Promise((y,m)=>{y=Ie(y);const{index:w,range:_}=h,x=d.objectStore(u),E=w.isPrimaryKey?x:x.index(w.name),I=v?f?"prevunique":"prev":f?"nextunique":"next",k=p||!("openKeyCursor"in E)?E.openCursor(r(_),I):E.openKeyCursor(r(_),I);k.onerror=it(m),k.onsuccess=Ie(R=>{const D=k.result;if(!D)return void y(null);D.___id=++$f,D.done=!1;const T=D.continue.bind(D);let H=D.continuePrimaryKey;H&&(H=H.bind(D));const j=D.advance.bind(D),L=()=>{throw new Error("Cursor not stopped")};D.trans=d,D.stop=D.continue=D.continuePrimaryKey=D.advance=()=>{throw new Error("Cursor not started")},D.fail=Ie(m),D.next=function(){let b=1;return this.start(()=>b--?this.continue():this.stop()).then(()=>this)},D.start=b=>{const q=new Promise((N,ae)=>{N=Ie(N),k.onerror=it(ae),D.fail=ae,D.stop=Z=>{D.stop=D.continue=D.continuePrimaryKey=D.advance=L,N(Z)}}),te=()=>{if(k.result)try{b()}catch(N){D.fail(N)}else D.done=!0,D.start=()=>{throw new Error("Cursor behind last entry")},D.stop()};return k.onsuccess=Ie(N=>{k.onsuccess=te,te()}),D.continue=T,D.continuePrimaryKey=H,D.advance=j,te(),q},y(D)},m)})},count({query:d,trans:p}){const{index:h,range:v}=d;return new Promise((f,y)=>{const m=p.objectStore(u),w=h.isPrimaryKey?m:m.index(h.name),_=r(v),x=_?w.count(_):w.count();x.onsuccess=Ie(E=>f(E.target.result)),x.onerror=it(y)})}}}(l)),s={};return i.forEach(l=>s[l.name]=l),{stack:"dbcore",transaction:t.transaction.bind(t),table(l){if(!s[l])throw new Error(`Table '${l}' not found`);return s[l]},MIN_KEY:-1/0,MAX_KEY:Ln(e),schema:o}}function Vo({_novip:t},e){const n=e.db,r=function(o,a,{IDBKeyRange:i,indexedDB:s},l){return{dbcore:function(u,d){return d.reduce((p,{create:h})=>({...p,...h(p)}),u)}(qf(a,i,l),o.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(o=>{const a=o.name;t.core.schema.tables.some(i=>i.name===a)&&(o.core=t.core.table(a),t[a]instanceof t.Table&&(t[a].core=o.core))})}function Ar({_novip:t},e,n,r){n.forEach(o=>{const a=r[o];e.forEach(i=>{const s=Ta(i,o);(!s||"value"in s&&s.value===void 0)&&(i===t.Transaction.prototype||i instanceof t.Transaction?vt(i,o,{get(){return this.table(o)},set(l){Ni(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):i[o]=new t.Table(o,a))})})}function Zo({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function Hf(t,e){return t._cfg.version-e._cfg.version}function Vf(t,e,n,r){const o=t._dbSchema,a=t._createTransaction("readwrite",t._storeNames,o);a.create(n),a._completion.catch(r);const i=a._reject.bind(a),s=de.transless||de;Ot(()=>{de.trans=a,de.transless=s,e===0?(Re(o).forEach(l=>{go(n,l,o[l].primKey,o[l].indexes)}),Vo(t,n),ce.follow(()=>t.on.populate.fire(a)).catch(i)):function({_novip:l},c,u,d){const p=[],h=l._versions;let v=l._dbSchema=Jo(l,l.idbdb,d),f=!1;const y=h.filter(w=>w._cfg.version>=c);function m(){return p.length?ce.resolve(p.shift()(u.idbtrans)).then(m):ce.resolve()}return y.forEach(w=>{p.push(()=>{const _=v,x=w._cfg.dbschema;Yo(l,_,d),Yo(l,x,d),v=l._dbSchema=x;const E=sl(_,x);E.add.forEach(k=>{go(d,k[0],k[1].primKey,k[1].indexes)}),E.change.forEach(k=>{if(k.recreate)throw new me.Upgrade("Not yet support for changing primary key");{const R=d.objectStore(k.name);k.add.forEach(D=>Go(R,D)),k.change.forEach(D=>{R.deleteIndex(D.name),Go(R,D)}),k.del.forEach(D=>R.deleteIndex(D))}});const I=w._cfg.contentUpgrade;if(I&&w._cfg.version>c){Vo(l,d),u._memoizedTables={},f=!0;let k=Bi(x);E.del.forEach(H=>{k[H]=_[H]}),Zo(l,[l.Transaction.prototype]),Ar(l,[l.Transaction.prototype],Re(k),k),u.schema=k;const R=Ba(I);let D;R&&mn();const T=ce.follow(()=>{if(D=I(u),D&&R){var H=bt.bind(null,null);D.then(H,H)}});return D&&typeof D.then=="function"?ce.resolve(D):T.then(()=>D)}}),p.push(_=>{(!f||!Tf)&&function(x,E){[].slice.call(E.db.objectStoreNames).forEach(I=>x[I]==null&&E.db.deleteObjectStore(I))}(w._cfg.dbschema,_),Zo(l,[l.Transaction.prototype]),Ar(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),u.schema=l._dbSchema})}),m().then(()=>{var w,_;_=d,Re(w=v).forEach(x=>{_.db.objectStoreNames.contains(x)||go(_,x,w[x].primKey,w[x].indexes)})})}(t,e,a,n).catch(i)})}function sl(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const o=t[r],a=e[r];if(o){const i={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||o.primKey.auto!==a.primKey.auto&&!to)i.recreate=!0,n.change.push(i);else{const s=o.idxByName,l=a.idxByName;let c;for(c in s)l[c]||i.del.push(c);for(c in l){const u=s[c],d=l[c];u?u.src!==d.src&&i.change.push(d):i.add.push(d)}(i.del.length>0||i.add.length>0||i.change.length>0)&&n.change.push(i)}}else n.add.push([r,a])}return n}function go(t,e,n,r){const o=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(a=>Go(o,a)),o}function Go(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Jo(t,e,n){const r={};return Cr(e.objectStoreNames,0).forEach(o=>{const a=n.objectStore(o);let i=a.keyPath;const s=qo(ol(i),i||"",!1,!1,!!a.autoIncrement,i&&typeof i!="string",!0),l=[];for(let u=0;u<a.indexNames.length;++u){const d=a.index(a.indexNames[u]);i=d.keyPath;var c=qo(d.name,i,!!d.unique,!!d.multiEntry,!1,i&&typeof i!="string",!1);l.push(c)}r[o]=al(o,s,l)}),r}function Yo({_novip:t},e,n){const r=n.db.objectStoreNames;for(let o=0;o<r.length;++o){const a=r[o],i=n.objectStore(a);t._hasGetAll="getAll"in i;for(let s=0;s<i.indexNames.length;++s){const l=i.indexNames[s],c=i.index(l).keyPath,u=typeof c=="string"?c:"["+Cr(c).join("+")+"]";if(e[a]){const d=e[a].idxByName[u];d&&(d.name=l,delete e[a].idxByName[u],e[a].idxByName[l]=d)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Ce.WorkerGlobalScope&&Ce instanceof Ce.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class Zf{_parseStoresSpec(e,n){Re(e).forEach(r=>{if(e[r]!==null){var o=e[r].split(",").map((i,s)=>{const l=(i=i.trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return qo(l,c||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),Ue(c),s===0)}),a=o.shift();if(a.multi)throw new me.Schema("Primary key cannot be multi-valued");o.forEach(i=>{if(i.auto)throw new me.Schema("Only primary key can be marked as autoIncrement (++)");if(!i.keyPath)throw new me.Schema("Index must have a name and cannot be an empty string")}),n[r]=al(r,a,o)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?He(this._cfg.storesSource,e):e;const r=n._versions,o={};let a={};return r.forEach(i=>{He(o,i._cfg.storesSource),a=i._cfg.dbschema={},i._parseStoresSpec(o,a)}),n._dbSchema=a,Zo(n,[n._allTables,n,n.Transaction.prototype]),Ar(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],Re(a),a),n._storeNames=Re(a),this}upgrade(e){return this._cfg.contentUpgrade=La(this._cfg.contentUpgrade||ke,e),this}}function $a(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new $t(no,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function qa(t){return t&&typeof t.databases=="function"}function Xo(t){return Ot(function(){return de.letThrough=!0,t()})}function Gf(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function Jf(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?Te(e.dbOpenError):t);ut&&(e.openCanceller._stackHolder=Gt()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function o(){if(e.openCanceller!==r)throw new me.DatabaseClosed("db.open() was cancelled")}let a=e.dbReadyResolve,i=null,s=!1;return ce.race([r,(typeof navigator>"u"?ce.resolve():Gf()).then(()=>new ce((l,c)=>{if(o(),!n)throw new me.MissingAPI;const u=t.name,d=e.autoSchema?n.open(u):n.open(u,Math.round(10*t.verno));if(!d)throw new me.MissingAPI;d.onerror=it(c),d.onblocked=Ie(t._fireOnBlocked),d.onupgradeneeded=Ie(p=>{if(i=d.transaction,e.autoSchema&&!t._options.allowEmptyDB){d.onerror=Mn,i.abort(),d.result.close();const v=n.deleteDatabase(u);v.onsuccess=v.onerror=Ie(()=>{c(new me.NoSuchDatabase(`Database ${u} doesnt exist`))})}else{i.onerror=it(c);var h=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;s=h<1,t._novip.idbdb=d.result,Vf(t,h/10,i,c)}},c),d.onsuccess=Ie(()=>{i=null;const p=t._novip.idbdb=d.result,h=Cr(p.objectStoreNames);if(h.length>0)try{const f=p.transaction((v=h).length===1?v[0]:v,"readonly");e.autoSchema?function({_novip:y},m,w){y.verno=m.version/10;const _=y._dbSchema=Jo(0,m,w);y._storeNames=Cr(m.objectStoreNames,0),Ar(y,[y._allTables],Re(_),_)}(t,p,f):(Yo(t,t._dbSchema,f),function(y,m){const w=sl(Jo(0,y.idbdb,m),y._dbSchema);return!(w.add.length||w.change.some(_=>_.add.length||_.change.length))}(t,f)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Vo(t,f)}catch{}var v;On.push(t),p.onversionchange=Ie(f=>{e.vcFired=!0,t.on("versionchange").fire(f)}),p.onclose=Ie(f=>{t.on("close").fire(f)}),s&&function({indexedDB:f,IDBKeyRange:y},m){!qa(f)&&m!==no&&$a(f,y).put({name:m}).catch(ke)}(t._deps,u),l()},c)}))]).then(()=>(o(),e.onReadyBeingFired=[],ce.resolve(Xo(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let c=e.onReadyBeingFired.reduce(La,ke);return e.onReadyBeingFired=[],ce.resolve(Xo(()=>c(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{i&&i.abort()}catch{}return r===e.openCanceller&&t._close(),Te(l)}).finally(()=>{e.openComplete=!0,a()})}function Qo(t){var e=a=>t.next(a),n=o(e),r=o(a=>t.throw(a));function o(a){return i=>{var s=a(i),l=s.value;return s.done?l:l&&typeof l.then=="function"?l.then(n,r):Ue(l)?Promise.all(l).then(n,r):n(l)}}return o(e)()}function Yf(t,e,n){var r=arguments.length;if(r<2)throw new me.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return n=o.pop(),[t,Mi(o),n]}function il(t,e,n,r,o){return ce.resolve().then(()=>{const a=de.transless||de,i=t._createTransaction(e,n,t._dbSchema,r),s={trans:i,transless:a};if(r)i.idbtrans=r.idbtrans;else try{i.create(),t._state.PR1398_maxLoop=3}catch(d){return d.name===za.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>il(t,e,n,null,o))):Te(d)}const l=Ba(o);let c;l&&mn();const u=ce.follow(()=>{if(c=o.call(i,i),c)if(l){var d=bt.bind(null,null);c.then(d,d)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=Qo(c))},s);return(c&&typeof c.then=="function"?ce.resolve(c).then(d=>i.active?d:Te(new me.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):u.then(()=>c)).then(d=>(r&&i._resolve(),i._completion.then(()=>d))).catch(d=>(i._reject(d),Te(d)))})}function lr(t,e,n){const r=Ue(t)?t.slice():[t];for(let o=0;o<n;++o)r.push(e);return r}const Xf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,o={},a=[];function i(u,d,p){const h=jn(u),v=o[h]=o[h]||[],f=u==null?0:typeof u=="string"?1:u.length,y=d>0,m={...p,isVirtual:y,keyTail:d,keyLength:f,extractKey:Ho(u),unique:!y&&p.unique};return v.push(m),m.isPrimaryKey||a.push(m),f>1&&i(f===2?u[0]:u.slice(0,f-1),d+1,p),v.sort((w,_)=>w.keyTail-_.keyTail),m}const s=i(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[s];for(const u of r.indexes)i(u.keyPath,0,u);function l(u){const d=u.query.index;return d.isVirtual?{...u,query:{index:d,range:(p=u.query.range,h=d.keyTail,{type:p.type===1?2:p.type,lower:lr(p.lower,p.lowerOpen?t.MAX_KEY:t.MIN_KEY,h),lowerOpen:!0,upper:lr(p.upper,p.upperOpen?t.MIN_KEY:t.MAX_KEY,h),upperOpen:!0})}}:u;var p,h}return{...n,schema:{...r,primaryKey:s,indexes:a,getIndexByKeyPath:function(u){const d=o[jn(u)];return d&&d[0]}},count:u=>n.count(l(u)),query:u=>n.query(l(u)),openCursor(u){const{keyTail:d,isVirtual:p,keyLength:h}=u.query.index;return p?n.openCursor(l(u)).then(v=>v&&function(f){return Object.create(f,{continue:{value:function(m){m!=null?f.continue(lr(m,u.reverse?t.MAX_KEY:t.MIN_KEY,d)):u.unique?f.continue(f.key.slice(0,h).concat(u.reverse?t.MIN_KEY:t.MAX_KEY,d)):f.continue()}},continuePrimaryKey:{value(m,w){f.continuePrimaryKey(lr(m,t.MAX_KEY,d),w)}},primaryKey:{get:()=>f.primaryKey},key:{get(){const m=f.key;return h===1?m[0]:m.slice(0,h)}},value:{get:()=>f.value}})}(v)):n.openCursor(u)}}}}}};function Ha(t,e,n,r){return n=n||{},r=r||"",Re(t).forEach(o=>{if(Ye(e,o)){var a=t[o],i=e[o];if(typeof a=="object"&&typeof i=="object"&&a&&i){const s=Ao(a);s!==Ao(i)?n[r+o]=e[o]:s==="Object"?Ha(a,i,n,r+o+"."):a!==i&&(n[r+o]=e[o])}else a!==i&&(n[r+o]=e[o])}else n[r+o]=void 0}),Re(e).forEach(o=>{Ye(t,o)||(n[r+o]=e[o])}),n}const Qf={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(a){const i=de.trans,{deleting:s,creating:l,updating:c}=i.table(e).hook;switch(a.type){case"add":if(l.fire===ke)break;return i._promise("readwrite",()=>u(a),!0);case"put":if(l.fire===ke&&c.fire===ke)break;return i._promise("readwrite",()=>u(a),!0);case"delete":if(s.fire===ke)break;return i._promise("readwrite",()=>u(a),!0);case"deleteRange":if(s.fire===ke)break;return i._promise("readwrite",()=>function(p){return d(p.trans,p.range,1e4)}(a),!0)}return n.mutate(a);function u(p){const h=de.trans,v=p.keys||function(f,y){return y.type==="delete"?y.keys:y.keys||y.values.map(f.extractKey)}(r,p);if(!v)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:v}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(f,y,m){return y.type==="add"?Promise.resolve([]):f.getMany({trans:y.trans,keys:m,cache:"immutable"})}(n,p,v).then(f=>{const y=v.map((m,w)=>{const _=f[w],x={onerror:null,onsuccess:null};if(p.type==="delete")s.fire.call(x,m,_,h);else if(p.type==="add"||_===void 0){const E=l.fire.call(x,m,p.values[w],h);m==null&&E!=null&&(m=E,p.keys[w]=m,r.outbound||at(p.values[w],r.keyPath,m))}else{const E=Ha(_,p.values[w]),I=c.fire.call(x,E,m,_,h);if(I){const k=p.values[w];Object.keys(I).forEach(R=>{Ye(k,R)?k[R]=I[R]:at(k,R,I[R])})}}return x});return n.mutate(p).then(({failures:m,results:w,numFailures:_,lastResult:x})=>{for(let E=0;E<v.length;++E){const I=w?w[E]:v[E],k=y[E];I==null?k.onerror&&k.onerror(m[E]):k.onsuccess&&k.onsuccess(p.type==="put"&&f[E]?p.values[E]:I)}return{failures:m,results:w,numFailures:_,lastResult:x}}).catch(m=>(y.forEach(w=>w.onerror&&w.onerror(m)),Promise.reject(m)))})}function d(p,h,v){return n.query({trans:p,values:!1,query:{index:r,range:h},limit:v}).then(({result:f})=>u({type:"delete",keys:f,trans:p}).then(y=>y.numFailures>0?Promise.reject(y.failures[0]):f.length<v?{failures:[],numFailures:0,lastResult:void 0}:d(p,{...h,lower:f[f.length-1],lowerOpen:!0},v)))}}}}})};function ll(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let o=0,a=0;o<e.keys.length&&a<t.length;++o)$e(e.keys[o],t[a])===0&&(r.push(n?Vn(e.values[o]):e.values[o]),++a);return r.length===t.length?r:null}catch{return null}}const eh={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const o=ll(r.keys,r.trans._cache,r.cache==="clone");return o?ce.resolve(o):n.getMany(r).then(a=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?Vn(a):a},a))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function Va(t){return!("from"in t)}const ht=function(t,e){if(!this){const n=new ht;return t&&"d"in t&&He(n,t),n}He(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function Wn(t,e,n){const r=$e(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(Va(t))return He(t,{from:e,to:n,d:1});const o=t.l,a=t.r;if($e(n,t.from)<0)return o?Wn(o,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Is(t);if($e(e,t.to)>0)return a?Wn(a,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Is(t);$e(e,t.from)<0&&(t.from=e,t.l=null,t.d=a?a.d+1:1),$e(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const i=!t.r;o&&!t.l&&Nr(t,o),a&&i&&Nr(t,a)}function Nr(t,e){Va(e)||function n(r,{from:o,to:a,l:i,r:s}){Wn(r,o,a),i&&n(r,i),s&&n(r,s)}(t,e)}function th(t,e){const n=ea(e);let r=n.next();if(r.done)return!1;let o=r.value;const a=ea(t);let i=a.next(o.from),s=i.value;for(;!r.done&&!i.done;){if($e(s.from,o.to)<=0&&$e(s.to,o.from)>=0)return!0;$e(o.from,s.from)<0?o=(r=n.next(s.from)).value:s=(i=a.next(o.from)).value}return!1}function ea(t){let e=Va(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&$e(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||$e(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Is(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){const a=o==="r"?"l":"r",i={...t},s=t[o];t.from=s.from,t.to=s.to,t[o]=s[o],i[o]=s[a],t[a]=i,i.d=Os(i)}t.d=Os(t)}function Os({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}fn(ht.prototype,{add(t){return Nr(this,t),this},addKey(t){return Wn(this,t,t),this},addKeys(t){return t.forEach(e=>Wn(this,e,e)),this},[No](){return ea(this)}});const nh={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new ht(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const o=t.table(r),{schema:a}=o,{primaryKey:i}=a,{extractKey:s,outbound:l}=i,c={...o,mutate:p=>{const h=p.trans,v=h.mutatedParts||(h.mutatedParts={}),f=I=>{const k=`idb://${e}/${r}/${I}`;return v[k]||(v[k]=new ht)},y=f(""),m=f(":dels"),{type:w}=p;let[_,x]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const E=p.trans._cache;return o.mutate(p).then(I=>{if(Ue(_)){w!=="delete"&&(_=I.results),y.addKeys(_);const k=ll(_,E);k||w==="add"||m.addKeys(_),(k||x)&&function(R,D,T,H){function j(L){const b=R(L.name||"");function q(N){return N!=null?L.extractKey(N):null}const te=N=>L.multiEntry&&Ue(N)?N.forEach(ae=>b.addKey(ae)):b.addKey(N);(T||H).forEach((N,ae)=>{const Z=T&&q(T[ae]),le=H&&q(H[ae]);$e(Z,le)!==0&&(Z!=null&&te(Z),le!=null&&te(le))})}D.indexes.forEach(j)}(f,a,k,x)}else if(_){const k={from:_.lower,to:_.upper};m.add(k),y.add(k)}else y.add(n),m.add(n),a.indexes.forEach(k=>f(k.name).add(n));return I})}},u=({query:{index:p,range:h}})=>{var v,f;return[p,new ht((v=h.lower)!==null&&v!==void 0?v:t.MIN_KEY,(f=h.upper)!==null&&f!==void 0?f:t.MAX_KEY)]},d={get:p=>[i,new ht(p.key)],getMany:p=>[i,new ht().addKeys(p.keys)],count:u,query:u,openCursor:u};return Re(d).forEach(p=>{c[p]=function(h){const{subscr:v}=de;if(v){const f=x=>{const E=`idb://${e}/${r}/${x}`;return v[E]||(v[E]=new ht)},y=f(""),m=f(":dels"),[w,_]=d[p](h);if(f(w.name||"").add(_),!w.isPrimaryKey){if(p!=="count"){const x=p==="query"&&l&&h.values&&o.query({...h,values:!1});return o[p].apply(this,arguments).then(E=>{if(p==="query"){if(l&&h.values)return x.then(({result:k})=>(y.addKeys(k),E));const I=h.values?E.result.map(s):E.result;h.values?y.addKeys(I):m.addKeys(I)}else if(p==="openCursor"){const I=E,k=h.values;return I&&Object.create(I,{key:{get:()=>(m.addKey(I.primaryKey),I.key)},primaryKey:{get(){const R=I.primaryKey;return m.addKey(R),R}},value:{get:()=>(k&&y.addKey(I.primaryKey),I.value)}})}return E})}m.add(n)}}return o[p].apply(this,arguments)}}),c}}}};class $t{constructor(e,n){this._middlewares={},this.verno=0;const r=$t.dependencies;this._options=n={addons:$t.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:o}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var i;a.dbReadyPromise=new ce(s=>{a.dbReadyResolve=s}),a.openCanceller=new ce((s,l)=>{a.cancelOpen=l}),this._state=a,this.name=e,this.on=Dn(this,"populate","blocked","versionchange","close",{ready:[La,ke]}),this.on.ready.subscribe=Fi(this.on.ready.subscribe,s=>(l,c)=>{$t.vip(()=>{const u=this._state;if(u.openComplete)u.dbOpenError||ce.resolve().then(l),c&&s(l);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(l),c&&s(l);else{s(l);const d=this;c||s(function p(){d.on.ready.unsubscribe(l),d.on.ready.unsubscribe(p)})}})}),this.Collection=(i=this,wn(zf.prototype,function(s,l){this.db=i;let c=tl,u=null;if(l)try{c=l()}catch(v){u=v}const d=s._ctx,p=d.table,h=p.hook.reading.fire;this._ctx={table:p,index:d.index,isPrimKey:!d.index||p.schema.primKey.keyPath&&d.index===p.schema.primKey.name,range:c,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:u,or:d.or,valueMapper:h!==Tn?h:null}})),this.Table=function(s){return wn(Mf.prototype,function(l,c,u){this.db=s,this._tx=u,this.name=l,this.schema=c,this.hook=s._allTables[l]?s._allTables[l].hook:Dn(null,{creating:[Cf,ke],reading:[Sf,Tn],updating:[Of,ke],deleting:[If,ke]})})}(this),this.Transaction=function(s){return wn(Kf.prototype,function(l,c,u,d,p){this.db=s,this.mode=l,this.storeNames=c,this.schema=u,this.chromeTransactionDurability=d,this.idbtrans=null,this.on=Dn(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ce((h,v)=>{this._resolve=h,this._reject=v}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},h=>{var v=this.active;return this.active=!1,this.on.error.fire(h),this.parent?this.parent._reject(h):v&&this.idbtrans&&this.idbtrans.abort(),Te(h)})})}(this),this.Version=function(s){return wn(Zf.prototype,function(l){this.db=s,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(s){return wn(rl.prototype,function(l,c,u){this.db=s,this._ctx={table:l,index:c===":id"?null:c,or:u};const d=s._deps.indexedDB;if(!d)throw new me.MissingAPI;this._cmp=this._ascending=d.cmp.bind(d),this._descending=(p,h)=>d.cmp(h,p),this._max=(p,h)=>d.cmp(p,h)>0?p:h,this._min=(p,h)=>d.cmp(p,h)<0?p:h,this._IDBKeyRange=s._deps.IDBKeyRange})}(this),this.on("versionchange",s=>{s.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",s=>{!s.newVersion||s.newVersion<s.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${s.oldVersion/10}`)}),this._maxKey=Ln(n.IDBKeyRange),this._createTransaction=(s,l,c,u)=>new this.Transaction(s,l,c,this._options.chromeTransactionDurability,u),this._fireOnBlocked=s=>{this.on("blocked").fire(s),On.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(s))},this.use(Xf),this.use(Qf),this.use(nh),this.use(eh),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(s=>s(this))}version(e){if(isNaN(e)||e<.1)throw new me.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new me.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(o=>o._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(Hf),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||de.letThrough||this._vip)?e():new ce((n,r)=>{if(this._state.openComplete)return r(new me.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new me.DatabaseClosed);this.open().catch(ke)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:o}){o&&this.unuse({stack:e,name:o});const a=this._middlewares[e]||(this._middlewares[e]=[]);return a.push({stack:e,create:n,level:r??10,name:o}),a.sort((i,s)=>i.level-s.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(o=>r?o.create!==r:!!n&&o.name!==n)),this}open(){return Jf(this)}_close(){const e=this._state,n=On.indexOf(this);if(n>=0&&On.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new ce(r=>{e.dbReadyResolve=r}),e.openCanceller=new ce((r,o)=>{e.cancelOpen=o})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new me.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new ce((r,o)=>{const a=()=>{this.close();var i=this._deps.indexedDB.deleteDatabase(this.name);i.onsuccess=Ie(()=>{(function({indexedDB:s,IDBKeyRange:l},c){!qa(s)&&c!==no&&$a(s,l).delete(c).catch(ke)})(this._deps,this.name),r()}),i.onerror=it(o),i.onblocked=this._fireOnBlocked};if(e)throw new me.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(a):a()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Re(this._allTables).map(e=>this._allTables[e])}transaction(){const e=Yf.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let o=de.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);const a=e.indexOf("?")!==-1;let i,s;e=e.replace("!","").replace("?","");try{if(s=n.map(c=>{var u=c instanceof this.Table?c.name:c;if(typeof u!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return u}),e=="r"||e===ho)i=ho;else{if(e!="rw"&&e!=po)throw new me.InvalidArgument("Invalid transaction mode: "+e);i=po}if(o){if(o.mode===ho&&i===po){if(!a)throw new me.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&s.forEach(c=>{if(o&&o.storeNames.indexOf(c)===-1){if(!a)throw new me.SubTransaction("Table "+c+" not included in parent transaction.");o=null}}),a&&o&&!o.active&&(o=null)}}catch(c){return o?o._promise(null,(u,d)=>{d(c)}):Te(c)}const l=il.bind(null,this,i,s,o,r);return o?o._promise(i,l,"lock"):de.trans?yn(de.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!Ye(this._allTables,e))throw new me.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const rh=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class oh{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[rh](){return this}}function cl(t,e){return Re(e).forEach(n=>{Nr(t[n]||(t[n]=new ht),e[n])}),t}function ah(t){let e,n=!1;const r=new oh(o=>{const a=Ba(t);let i=!1,s={},l={};const c={get closed(){return i},unsubscribe:()=>{i=!0,jt.storagemutated.unsubscribe(h)}};o.start&&o.start(c);let u=!1,d=!1;function p(){return Re(l).some(f=>s[f]&&th(s[f],l[f]))}const h=f=>{cl(s,f),p()&&v()},v=()=>{if(u||i)return;s={};const f={},y=function(m){a&&mn();const w=()=>Ot(t,{subscr:m,trans:null}),_=de.trans?yn(de.transless,w):w();return a&&_.then(bt,bt),_}(f);d||(jt(zn,h),d=!0),u=!0,Promise.resolve(y).then(m=>{n=!0,e=m,u=!1,i||(p()?v():(s={},l=f,o.next&&o.next(m)))},m=>{u=!1,n=!1,o.error&&o.error(m),c.unsubscribe()})};return v(),c});return r.hasValue=()=>n,r.getValue=()=>e,r}let ta;try{ta={indexedDB:Ce.indexedDB||Ce.mozIndexedDB||Ce.webkitIndexedDB||Ce.msIndexedDB,IDBKeyRange:Ce.IDBKeyRange||Ce.webkitIDBKeyRange}}catch{ta={indexedDB:null,IDBKeyRange:null}}const Rt=$t;function gr(t){let e=mt;try{mt=!0,jt.storagemutated.fire(t)}finally{mt=e}}fn(Rt,{...fr,delete:t=>new Rt(t,{addons:[]}).delete(),exists:t=>new Rt(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return qa(e)?Promise.resolve(e.databases()).then(r=>r.map(o=>o.name).filter(o=>o!==no)):$a(e,n).toCollection().primaryKeys()}(Rt.dependencies).then(t)}catch{return Te(new me.MissingAPI)}},defineClass:()=>function(t){He(this,t)},ignoreTransaction:t=>de.trans?yn(de.transless,t):t(),vip:Xo,async:function(t){return function(){try{var e=Qo(t.apply(this,arguments));return e&&typeof e.then=="function"?e:ce.resolve(e)}catch(n){return Te(n)}}},spawn:function(t,e,n){try{var r=Qo(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:ce.resolve(r)}catch(o){return Te(o)}},currentTransaction:{get:()=>de.trans||null},waitFor:function(t,e){const n=ce.resolve(typeof t=="function"?Rt.ignoreTransaction(t):t).timeout(e||6e4);return de.trans?de.trans.waitFor(n):n},Promise:ce,debug:{get:()=>ut,set:t=>{Li(t,t==="dexie"?()=>!0:el)}},derive:on,extend:He,props:fn,override:Fi,Events:Dn,on:jt,liveQuery:ah,extendObservabilitySet:cl,getByKeyPath:gt,setByKeyPath:at,delByKeyPath:function(t,e){typeof e=="string"?at(t,e,void 0):"length"in e&&[].map.call(e,function(n){at(t,n,void 0)})},shallowClone:Bi,deepClone:Vn,getObjectDiff:Ha,cmp:$e,asap:Ri,minKey:$o,addons:[],connections:On,errnames:za,dependencies:ta,semVer:_s,version:_s.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),Rt.maxKey=Ln(Rt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(jt(zn,t=>{if(!mt){let e;to?(e=document.createEvent("CustomEvent"),e.initCustomEvent(St,!0,!0,t)):e=new CustomEvent(St,{detail:t}),mt=!0,dispatchEvent(e),mt=!1}}),addEventListener(St,({detail:t})=>{mt||gr(t)}));let mt=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(St);typeof t.unref=="function"&&t.unref(),jt(zn,e=>{mt||t.postMessage(e)}),t.onmessage=e=>{e.data&&gr(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){jt(zn,e=>{try{mt||(typeof localStorage<"u"&&localStorage.setItem(St,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:St,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===St){const n=JSON.parse(e.newValue);n&&gr(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===St&&gr(e.changedParts)})}ce.rejectionMapper=function(t,e){if(!t||t instanceof an||t instanceof TypeError||t instanceof SyntaxError||!t.name||!vs[t.name])return t;var n=new vs[t.name](e||t.message,t);return"stack"in t&&vt(n,"stack",{get:function(){return this.inner.stack}}),n},Li(ut,el);var na=(t=>(t.SAVE="save",t.SAVE_AS="saveAs",t))(na||{}),wr=(t=>(t.MOVE_TO_ROOT_FOLDER="moveToRootFolder",t.DELETE="delete",t))(wr||{});const sh="comfyui_workspace_db";class ih extends $t{constructor(){super(sh);je(this,"workflows");je(this,"changelogs");je(this,"media");je(this,"folders");je(this,"tags");je(this,"userSettings");je(this,"models");je(this,"cache");je(this,"workflowVersions");this.version(1).stores({workflows:"&id, name, parentFolderID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id"}).upgrade(n=>{}),this.version(2).stores({workflows:"&id, name, parentFolderID,cloudID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id",workflowVersions:"&id, name, workflowID,cloudID"}).upgrade(n=>{})}}const ge=new ih,lh="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let ra=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=lh[n[t]&63];return e};class Jt{constructor(e){je(this,"tableName");this.tableName=e}async saveDiskDB(){const e=await ge[this.tableName].toArray(),n={};e.forEach(r=>{r.id?n[r.id]=r:r.name?n[r.name]=r:console.error("TableBaseModel should have id or name")}),cf(this.tableName,JSON.stringify(n))}async add(e){return e.id||(e.id=ra()),e.createTime||(e.createTime=Date.now()),await ge[this.tableName].add(e),await this.saveDiskDB(),e}async put(e){return await ge[this.tableName].put(e),await this.saveDiskDB(),e}async bulkPut(e){await ge[this.tableName].bulkPut(e),this.saveDiskDB()}async update(e,n){return await ge[this.tableName].update(e,n),await this.saveDiskDB(),await this.get(e)??null}async listAll(){return await ge[this.tableName].toArray()}async batchQuery(e){return await ge[this.tableName].bulkGet(e)}async getRecords(){console.warn("[DEPRECATED] getRecords() call, should only be used for one-time backfill for indexdb",this.tableName);const e=await lf(this.tableName);let n;try{n=e!=null?JSON.parse(e):null}catch{}if(n==null){const r=await pf()??"{}";n=JSON.parse(r)[this.tableName]}return n??{}}async get(e){return await ge[this.tableName].get(e)}async delete(e){await ge[this.tableName].delete(e),await this.saveDiskDB()}async listByIndex(e,n){return await ge[this.tableName].where(e).equals(n).toArray()}}const ch=150,Rr=class Rr extends Jt{constructor(){super("changelogs")}static async load(){return new Rr}async listByWorkflowID(e){return await ge.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime")}async getLastestByWorkflowID(e){return(await this.listByWorkflowID(e))[0]}async create(e){const n=await this.getLastestByWorkflowID(e.workflowID);if(n!=null&&n.json===e.json)return null;const r={id:Fn(),json:e.json,workflowID:e.workflowID,createTime:Date.now()};return await ge.changelogs.add(r),await this.saveDiskDB(),r}async deleteLogsExceedLimit(e,n=ch){const r=await ge.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime"),o=r.filter(i=>i.isAutoSave===!0),a=r.filter(i=>i.isAutoSave==null||i.isAutoSave==!1);if(o.length>n){const i=o.slice(n);await ge.changelogs.bulkDelete(i.map(s=>s.id)),await this.saveDiskDB()}if(a.length>n){const i=a.slice(n);await ge.changelogs.bulkDelete(i.map(s=>s.id)),await this.saveDiskDB()}}};je(Rr,"TABLE_NAME","changelogs");let oa=Rr;const Fp="CWM_WORKFLOWS_SORT_TYPE";var Ct=(t=>(t.RECENTLY_MODIFIED="newest",t.OLDEST_MODIFIED="oldest",t.AZ="name A-Z",t.ZA="name Z-A",t))(Ct||{});const Rp=[{title:"Import Workflows",type:"file"},{title:"Import Folder",type:"folder"}],ul="comfyspace_tracking",Un="workspace_info",uh=9999999,Ds="upgrade_to_2way_sync";function br(...t){const e=t.filter(n=>n!=="").join("/");return Pt(e)}function Pt(t){let n=t.split("/").filter(r=>r!=="").join("/").replace(/\\/g,"/");return n=n.replace(/^\/+/,""),n}function wo(t){return br(t.parentFolderID??"",t.name+".json")}var It;(t=>{async function e({parentFolderID:s,name:l}){return Pt(`${s??""}/${l}`)}t.genFolderRelPath=e;async function n(s){await fetch("/workspace/folder/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Pt(s.id)})})}t.createFolder=n;async function r(s,l){const u=await(await fetch("/workspace/folder/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folder:s,newParentPath:l})})).json();u.error&&alert("Failed to move folder: "+u.error)}t.moveFolder=r;async function o(s){try{return await(await fetch("/workspace/folder/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:s})})).text()}catch(l){console.error("Error deleting file:",l)}}t.deleteFolder=o;async function a(s){try{const c=await(await fetch("/workspace/file/count_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:s})})).json();return c.error&&console.error("Error counting files:",c.error),c.count}catch(l){console.error("Error renaming file:",l)}return null}t.genFilesCountInFolder=a;async function i(s,l){try{const u=await(await fetch("/workspace/folder/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absPath:s,newName:l})})).json();u.error&&alert("Failed to rename folder: "+u.error)}catch(c){console.error("Error renaming file:",c)}}t.renameFolder=i})(It||(It={}));async function xn(t){const e=await Za(t);if(e==null)return;const n=await Ga(t);await(G==null?void 0:G.updateMetaInfo(t.id,{filePath:n??void 0}));const r=t.json,o=JSON.parse(r);o.extra[Un]={id:t.id,name:t.name},delete o.extra[ul],await Pi(e,JSON.stringify(o))}async function bo(t){if(t.name==null)return;const e=await Za(t);e!=null&&Ai(e)}async function Za(t){let e=fh(t.name)+".json",n=t.parentFolderID;for(;n!=null;){const r=await(Ke==null?void 0:Ke.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??void 0}return e??null}async function dh(t){let e="",n=t;for(;n!=null;){const r=await(Ke==null?void 0:Ke.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??null}return e}async function Ga(t){const e=await Za(t);let n=await(X==null?void 0:X.getSetting("myWorkflowsDir"));return n?(n.endsWith("/")||(n=n+"/"),n+e):(console.error("myWorkflowsDir is not set"),null)}async function Tp(t){if(await(X==null?void 0:X.getSetting("twoWaySync")))return await It.genFilesCountInFolder(t)??0;const n=await(G==null?void 0:G.listAll())??[],r=await(Ke==null?void 0:Ke.listAll())??[],o=[t];let a=0;for(;o.length>0;){const i=o.shift();if(i){for(const l of n)l.parentFolderID===i&&a++;const s=r.filter(l=>l.parentFolderID===i).map(l=>l.id);s.length&&o.push(...s)}}return a}function fh(t){return t=t.replace(/[\\/:*?"<>|]/g,"_"),t.trim()}function aa(t,e=!0,n=!1){const r=new Date(t),o=String(r.getDate()).padStart(2,"0"),a=String(r.getMonth()+1).padStart(2,"0"),i=r.getFullYear(),s=String(r.getHours()).padStart(2,"0"),l=String(r.getMinutes()).padStart(2,"0"),c=String(r.getSeconds()).padStart(2,"0"),u=`${a}-${o}-${i}`;return e?u+` ${s}:${l}`:n?u+`:${c}`:u}async function dl(t=!1){if(await(X==null?void 0:X.getSetting("twoWaySync")))return;const n=await(G==null?void 0:G.listAll())??[];for(const r of n){const o=await Ga(r);r.filePath!=o&&(r.filePath!=null&&await Ai(r.filePath,t),await xn(r))}}const fl=(t,e=Ct.RECENTLY_MODIFIED)=>{const n=[...t];switch(e){case Ct.AZ:n.sort((r,o)=>r.name.localeCompare(o.name));break;case Ct.ZA:n.sort((r,o)=>o.name.localeCompare(r.name));break;case Ct.RECENTLY_MODIFIED:n.sort((r,o)=>o.updateTime-r.updateTime);break;case Ct.OLDEST_MODIFIED:n.sort((r,o)=>r.updateTime-o.updateTime);break}return n};function Bp(t,e){let n=JSON.parse(t);typeof structuredClone>"u"?n=JSON.parse(JSON.stringify(n)):n=structuredClone(n);let r=new LGraph;r.configure(n);const o=localStorage.getItem("litegrapheditor_clipboard"),a=document.createElement("canvas");let i=new LGraphCanvas(a,r);i.selectNodes(r._nodes),i.copyToClipboard(r._nodes);const s=Se.canvas.graph_mouse;e&&(e[0]-=15,e[1]-=15,Se.canvas.graph_mouse=e),Se.canvas.pasteFromClipboard(),Se.canvas.graph_mouse=s,o&&localStorage.setItem("litegrapheditor_clipboard",o),r=null,i=null}const hh=async t=>{const e=await(X==null?void 0:X.getSetting("shortcuts"))??(X==null?void 0:X.defaultSettings.shortcuts);if(!e)return!1;for(const n in e){const o=e[n].split("+"),a={Control:t.ctrlKey,Shift:t.shiftKey,Alt:t.altKey,Command:t.metaKey,[t.key.toUpperCase()]:!0};for(const i in a)a[i]||delete a[i];if(o.length===Object.keys(a).length&&o.every(i=>a[i]))return n}};function Mp(t){const e=["png","jpg","jpeg","gif","bmp","webp"],n=t.split(".").pop();return n!=null&&e.includes(n)}function ph(t){return`/workspace/view_media?filename=${t}`}function js(){const e=window.location.hash.slice(1).split("/").find(n=>n.includes("workspaceId@"));return e?e.split("@")[1]:null}function hl(t){const e=window.location.hash.slice(1).split("/"),n=e.findIndex(o=>o.includes("workspaceId@")),r=`workspaceId@${t}`;return n>=0?e[n]=r:e.push(r),`${e.join("/")}`}const mh=t=>{const e=hl(t);window.open(`${window.location.origin}/#${e}`)};async function yh(){const t=await(G==null?void 0:G.listAll())??[];for(const e of t)try{const n=await Ga(e),r=JSON.parse(e.json);r.extra[Un]={id:e.id,name:e.name},delete r.extra[ul],n&&await Pi(n,JSON.stringify(r))}catch(n){console.error(n)}}const _r={last_node_id:9,last_link_id:9,nodes:[{id:7,type:"CLIPTextEncode",pos:[413,389],size:{0:425.27801513671875,1:180.6060791015625},flags:{},order:3,mode:0,inputs:[{name:"clip",type:"CLIP",link:5}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[6],slot_index:0}],properties:{},widgets_values:["text, watermark"]},{id:6,type:"CLIPTextEncode",pos:[415,186],size:{0:422.84503173828125,1:164.31304931640625},flags:{},order:2,mode:0,inputs:[{name:"clip",type:"CLIP",link:3}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[4],slot_index:0}],properties:{},widgets_values:["beautiful scenery nature glass bottle landscape, , purple galaxy bottle,"]},{id:5,type:"EmptyLatentImage",pos:[473,609],size:{0:315,1:106},flags:{},order:1,mode:0,outputs:[{name:"LATENT",type:"LATENT",links:[2],slot_index:0}],properties:{},widgets_values:[512,512,1]},{id:3,type:"KSampler",pos:[863,186],size:{0:315,1:262},flags:{},order:4,mode:0,inputs:[{name:"model",type:"MODEL",link:1},{name:"positive",type:"CONDITIONING",link:4},{name:"negative",type:"CONDITIONING",link:6},{name:"latent_image",type:"LATENT",link:2}],outputs:[{name:"LATENT",type:"LATENT",links:[7],slot_index:0}],properties:{},widgets_values:[0x8e7ff42ed37e,!0,20,8,"euler","normal",1]},{id:8,type:"VAEDecode",pos:[1209,188],size:{0:210,1:46},flags:{},order:5,mode:0,inputs:[{name:"samples",type:"LATENT",link:7},{name:"vae",type:"VAE",link:8}],outputs:[{name:"IMAGE",type:"IMAGE",links:[9],slot_index:0}],properties:{}},{id:9,type:"SaveImage",pos:[1451,189],size:{0:210,1:26},flags:{},order:6,mode:0,inputs:[{name:"images",type:"IMAGE",link:9}],properties:{}},{id:4,type:"CheckpointLoaderSimple",pos:[26,474],size:{0:315,1:98},flags:{},order:0,mode:0,outputs:[{name:"MODEL",type:"MODEL",links:[1],slot_index:0},{name:"CLIP",type:"CLIP",links:[3,5],slot_index:1},{name:"VAE",type:"VAE",links:[8],slot_index:2}],properties:{},widgets_values:["v1-5-pruned-emaonly.ckpt"]}],links:[[1,4,0,3,0,"MODEL"],[2,5,0,3,3,"LATENT"],[3,4,1,6,0,"CLIP"],[4,6,0,3,1,"CONDITIONING"],[5,4,1,7,0,"CLIP"],[6,7,0,3,2,"CONDITIONING"],[7,3,0,8,0,"LATENT"],[8,4,2,8,1,"VAE"],[9,8,0,9,0,"IMAGE"]],groups:[],config:{},extra:{},version:.4};var Xe;(t=>{async function e(l,c){try{const d=await(await fetch("/workspace/file/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:wo(l),newParentPath:c})})).json();return d.error?(alert("Error moving file: "+d.error),!1):!0}catch(u){console.error("Error deleting file:",u)}}t.moveWorkflow=e;async function n(l,c){try{const d=await(await fetch("/workspace/file/gen_unique_name",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:br(c??"",l)})})).json();return d.error?(console.error("Error getting unique name:",d.error),null):d.uniqueName}catch(u){console.error("Error deleting file:",u)}return null}t.genFileUniqueName=n;async function r({parentFolderID:l,name:c},u){try{const p=await(await fetch("/workspace/file/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:br(l??"",c+".json"),newName:u})})).json();return p.error?(alert("Error rename file: "+p.error),!1):!0}catch(d){console.error("Error deleting file:",d)}}t.renameWorkflow=r;async function o(l){const c=l.json,u=JSON.parse(c);u.extra[Un]={id:l.id};const p=await(await fetch("/workspace/file/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:wo(l),json:JSON.stringify(u)})})).json();if(p.error)throw console.error("Error saving file:",p.error),alert(`"Error saving file: ${p.error}
      
      Please try "Save as" from "Files" dropdown menu
      `),new Error(p.error);return p}t.saveWorkflow=o;async function a(l){try{return await(await fetch("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:wo(l),deleteEmptyFolder:!1})})).text()}catch(c){alert("Error deleting workflow .json file: "+c),console.error("Error deleting file:",c)}}t.deleteWorkflow=a;async function i({parentFolderID:l,name:c,json:u,id:d}){var v;let p=JSON.parse(u);p={...p,extra:{[Un]:{id:d}}};const h={parentFolderPath:Pt(l??""),name:c,json:JSON.stringify(p)};console.log("createWorkflow",h);try{const y=await(await fetch("/workspace/create_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).json();return y.name&&await((v=ge.workflows)==null?void 0:v.update(d,{name:y.name})),y}catch(f){return console.error(`Error creating file <${d}> at "${l}"`,f),alert(`Error creating file <${d}> at "${l}"`),{}}}t.createWorkflow=i;async function s({parentFolderID:l,name:c,id:u}){const d=br(l??"",c+".json");try{const h=await(await fetch("/workspace/get_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:d,id:u})})).json();return h.error&&(console.error(`Error getting file <${u}> at "${d}"`,h.error),alert({message:`Error getting file <${u}> at "${d}"`,level:"error"})),h}catch(p){return console.error(`Erro finding file <${u}> at "${d}"`,p),{}}}t.getFile=s})(Xe||(Xe={}));async function pl(t,e=!1,n=!1){try{return await(await fetch("/workspace/file/scan_my_workflows_folder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Pt(t),recursive:e,metaInfoOnly:n})})).json()}catch(r){return console.error("Error scan local new files:",r),[]}}async function vh(t,e){const n=Pt(t??""),o=(await pl(n)).map(async s=>{var u;const l=s.name,c=[n,l].join("/");return gh(s)?{id:Pt(c),name:s.name,parentFolderID:n,type:"folder",createTime:Date.now(),updateTime:Date.now()}:{...await((u=ge.workflows)==null?void 0:u.get(s.id))??{createTime:Date.now(),updateTime:Date.now()},id:s.id,lastSavedJson:s.json??"{}",json:s.json??"{}",name:l.replace(/\.json$/,""),parentFolderID:n,createTime:s.createTime}}),a=await Promise.all(o);ge.workflows.bulkPut(a.filter(s=>!_h(s)));const i=a.filter(s=>s!=null);return fl(i,e??Ct.RECENTLY_MODIFIED)}function gh(t){return"type"in t&&t.type==="folder"}const Tr=class Tr extends Jt{constructor(){super("workflows");je(this,"_curWorkflow",null)}get curWorkflow(){return this._curWorkflow}static async load(){return new Tr}updateCurWorkflowID(n){if(n==null){this._curWorkflow=null;return}this.get(n).then(r=>{this._curWorkflow=r??null})}updateCurWorkflow(n){this._curWorkflow=n}async latestVersionCheck(){if(this._curWorkflow){const n=await ge.workflows.get(this._curWorkflow.id);return n?(n==null?void 0:n.updateTime)===this._curWorkflow.updateTime:!0}return!0}async listByIndex(n,r){const o=await super.listByIndex(n,r);return await(X==null?void 0:X.getSetting("twoWaySync"))?(await Promise.all(o.map(async s=>await this.get(s.id)))).filter(s=>s!=null):o}async generateUniqueName(n,r){if(await(X==null?void 0:X.getSetting("twoWaySync"))){const l=await Xe.genFileUniqueName((n??"Untitled Flow")+".json",r??"");return(l==null?void 0:l.replace(/\.json$/,""))??"Untitled Flow"}let a=n??"Untitled Flow";const s=(await this.listAll()??[]).filter(l=>l.parentFolderID==r).map(l=>l.name);if(s.includes(a)){let l=2,c=!0;for(;c;)s.includes(`${a} ${l}`)?l++:(a=`${a} ${l}`,c=!1)}return a}async createFlow(n){const{id:r,json:o,name:a}=n,i=await this.generateUniqueName(a,n.parentFolderID??void 0),s=r??ra(),l=Date.now(),c={...n,id:s,json:o??JSON.stringify(_r),name:i,updateTime:l,createTime:l};return await ge.workflows.add(c),this.saveDiskDB(),await(X==null?void 0:X.getSetting("twoWaySync"))?(await Xe.createWorkflow(c),await this.get(c.id)):(xn(c),c)}async update(n,r){throw new Error("Method not allowed.")}async updateMetaInfo(n,r){return this._update(n,r)}async _update(n,r){await ge.workflows.update(n,r);const o=await ge.workflows.get(n)??null;return this._curWorkflow&&this._curWorkflow.id===n&&(this._curWorkflow=o),this.saveDiskDB(),o}async updateFolder(n,r){var s;const o=await(X==null?void 0:X.getSetting("twoWaySync")),a=await this.get(n),i=await this.updateMetaInfo(n,r);!i||!a||(o?await Xe.moveWorkflow(a,r.parentFolderID):(await xn(i),await bo(a),(i==null?void 0:i.parentFolderID)!=null&&await((s=ge.folders)==null?void 0:s.update(i.parentFolderID,{updateTime:Date.now()}))))}async genLastManualSavedJson(n){const r=await(ze==null?void 0:ze.getLastestByWorkflowID(n));return r==null?void 0:r.json}async updateName(n,r){const o=await this.get(n);return await(X==null?void 0:X.getSetting("twoWaySync"))&&o&&await Xe.renameWorkflow(o,r.name+".json"),await this.updateMetaInfo(n,r)}async updateFlow(n,r){const o=await this.get(n,!1);if(o==null)return;const a=JSON.stringify(o.json),i=JSON.stringify(r.json);if(a===i)return;const s=await this._update(n,{updateTime:Date.now(),json:r.json});await(X==null?void 0:X.getSetting("twoWaySync"))?s&&await Xe.saveWorkflow(s):s&&await xn(s)}async batchCreateFlows(n=[],r=!1,o){var i,s;const a=[];for(const l of n){const c=l.name&&r?l.name:await this.generateUniqueName(l.name,o),u=ra(),d=Date.now(),p={id:u,name:c,json:l.json,parentFolderID:o,updateTime:d,createTime:d,tags:[]};if(a.push(p),await(X==null?void 0:X.getSetting("twoWaySync")))try{const v=JSON.parse(l.json),f=(s=(i=v==null?void 0:v.extra)==null?void 0:i[Un])==null?void 0:s.id;f&&(await this.get(f)||(p.id=f)),Xe.createWorkflow(p)}catch(v){console.error("batchCreateFlows error",v)}else await xn(p)}try{await ge.workflows.bulkAdd(a),this.saveDiskDB()}catch(l){console.error("batchCreateFlows error",l)}}async deleteFlow(n){const r=await this.get(n);r&&(await(X==null?void 0:X.getSetting("twoWaySync"))?await Xe.deleteWorkflow(r):bo({...r})),await ge.workflows.delete(n),this.saveDiskDB()}async batchDeleteFlow(n){const r=await ge.workflows.bulkGet(n);for(const o of r){if(!o)return;await(X==null?void 0:X.getSetting("twoWaySync"))?await Xe.deleteWorkflow(o):bo({...o})}await ge.workflows.bulkDelete(n),this.saveDiskDB()}async listFolderContent(n,r){if(await(X==null?void 0:X.getSetting("twoWaySync")))return await vh(n??null);const a=await this.listAll().then(l=>l.filter(c=>c.parentFolderID==n))??[],i=await(Ke==null?void 0:Ke.listAll().then(l=>l.filter(c=>c.parentFolderID==n)))??[],s=[...a,...i];return fl(s,r??Ct.RECENTLY_MODIFIED)}async get(n,r=!0){const o=await(X==null?void 0:X.getSetting("twoWaySync")),a=await ge.workflows.get(n);if(!o||!r)return a;if(a==null)return;const i=await Xe.getFile({parentFolderID:a.parentFolderID??null,name:a.name,id:a.id});if(i.json)return{...a,json:JSON.stringify(i.json)}}};je(Tr,"TABLE_NAME","workflows");let sa=Tr;const Br=class Br extends Jt{constructor(){super("folders")}static async load(){return new Br}async create(e){const n=await this.generateUniqueName(e.name,e.parentFolderID),r=await(X==null?void 0:X.getSetting("twoWaySync")),o=await It.genFolderRelPath({name:n,parentFolderID:e.parentFolderID??""}),a={id:r?o:Fn(),name:n,parentFolderID:e.parentFolderID??null,updateTime:Date.now(),createTime:Date.now(),type:"folder"};return r?await It.createFolder(a):(await ge.folders.add(a),this.saveDiskDB()),a}async update(e,n){if(await(X==null?void 0:X.getSetting("twoWaySync")))return"parentFolderID"in n&&await It.moveFolder(e,n.parentFolderID??""),"name"in n&&await It.renameFolder(e,n.name??""),null;const o=await this.get(e);if(o==null)return null;const a="name"in n&&n.name!=o.name,i="parentFolderID"in n&&n.parentFolderID!=o.parentFolderID,s={...o,...n};return n.name!=null&&(s.updateTime=Date.now()),i&&(n.name=await this.generateUniqueName(s.name,s.parentFolderID??void 0)),await ge.folders.update(e,n),this.saveDiskDB(),(a||i)&&dl(!0),s}async deleteFolder(e,n=wr.DELETE){if(await(X==null?void 0:X.getSetting("twoWaySync"))){await pl(e,!0,!0).then(s=>{s.forEach(l=>{l.type==="workflow"&&(console.log("delete workflow",l),G==null||G.deleteFlow(l.id))})}),await It.deleteFolder(e);return}const o=await(G==null?void 0:G.listAll())??[],a=await this.listAll(),i=[e];for(;i.length>0;){const s=i.shift();if(s){for(const c of o)if(c.parentFolderID===s)switch(n){case wr.DELETE:await(G==null?void 0:G.deleteFlow(c.id));break;case wr.MOVE_TO_ROOT_FOLDER:await(G==null?void 0:G.updateFolder(c.id,{parentFolderID:void 0}));break}await ge.folders.delete(s);const l=a.filter(c=>c.parentFolderID===s).map(c=>c.id);l.length&&i.push(...l)}}this.saveDiskDB()}async generateUniqueName(e,n){if(await(X==null?void 0:X.getSetting("twoWaySync")))return await Xe.genFileUniqueName(e??"New folder",n??"")??"New folder";let o=e??"New folder";const a=await this.listAll().then(i=>i.filter(s=>s.parentFolderID==n).map(s=>s.name));if(a.includes(o)){let i=2,s=!0;for(;s;)a.includes(`${o} ${i}`)?i++:(o=`${o} ${i}`,s=!1)}return o}};je(Br,"TABLE_NAME","folders");let ia=Br;class ml extends Jt{constructor(){super("media")}async listByWorkflowID(e){return await ge.media.where("workflowID").equals(e).reverse().sortBy("createTime")}async create(e){const n=e.localPath.split(".").pop();if(n==null)return null;const r={id:Fn(),localPath:e.localPath,workflowID:e.workflowID,createTime:Date.now(),format:n},o=await(G==null?void 0:G.get(e.workflowID)),a=new Set((o==null?void 0:o.mediaIDs)??[]).add(r.id);return await(G==null?void 0:G.updateMetaInfo(e.workflowID,{mediaIDs:Array.from(a),coverMediaPath:r.localPath})),ge.media.add(r),this.saveDiskDB(),r}}je(ml,"TABLE_NAME","media");const zp=["Checkpoint","TextualInversion","Hypernetwork","LORA","Controlnet","Upscaler","VAE"],wh={Checkpoint:"checkpoints",TextualInversion:"embeddings",Hypernetwork:"hypernetworks",LORA:"loras",Controlnet:"controlnet",Upscaler:"upscale_models",VAE:"vae"};function Lp(t){return t.modelVersions!==void 0}function bh(t){var e;return((e=t.files)==null?void 0:e[0])!==void 0}function Wp(t,e){var r,o,a,i,s,l;if(!t)return;let n;return bh(t)?n={id:t.id,SHA256:(o=(r=t.files)==null?void 0:r[0].hashes)==null?void 0:o.SHA256,name:(a=t.files)==null?void 0:a[0].name,sizeKB:(s=(i=t.files)==null?void 0:i[0])==null?void 0:s.sizeKB}:n={id:t.id,SHA256:(l=t.hashes)==null?void 0:l[2],name:`${e} ${t.name}`},n}const Mr=class Mr extends Jt{constructor(){super("userSettings");je(this,"defaultSettings");je(this,"DEFAULT_USER","guest");je(this,"_autoSave",!1);this.defaultSettings={id:this.DEFAULT_USER,topBarStyle:{top:0,left:0},modelManagerTopBarStyle:{top:0,right:0},myWorkflowsDir:"",shortcuts:{save:"Shift+S",saveAs:"Control+Alt+S"},defaultFolders:wh,autoSave:!0,twoWaySync:!1,foldersOnTop:!1,cloudHost:"https://www.comfyspace.art",overwriteCurWorkflowWhenDroppingFileToCanvas:!1}}get autoSave(){return this._autoSave}__TEMP_OVERRIDE_ONLY_disableAutoSave(){this._autoSave&&(this._autoSave=!1,setTimeout(async()=>{this._autoSave=await this.getSetting("autoSave")??this.defaultSettings.autoSave??!0},3e3))}async getSetting(n){const r=await this.get(this.DEFAULT_USER);return(r==null?void 0:r[n])??this.defaultSettings[n]}async upsert(n){const o={...await this.get(this.DEFAULT_USER)??this.defaultSettings,...n};await this.put(o),Object.hasOwn(n,"autoSave")&&n.autoSave!==void 0&&(this._autoSave=n.autoSave)}static async load(){const n=new Mr,r=await uf();return n.defaultSettings.myWorkflowsDir=r,await n.getSetting("autoSave").then(o=>{n._autoSave=o??!0}),n}};je(Mr,"TABLE_NAME","userSettings");let la=Mr;const zr=class zr extends Jt{constructor(){super("tags")}static async load(){return new zr}};je(zr,"TABLE_NAME","tags");let ca=zr;const Lr=class Lr extends Jt{constructor(){super("workflowVersions")}static async load(){return new Lr}async listByWorkflowID(e){return await ge[this.tableName].where("workflowID").equals(e).reverse().sortBy("createTime")??[]}async getLatestByWorkflowID(e){const n=await this.listByWorkflowID(e);return n!=null&&n.length?n[0]:null}};je(Lr,"TABLE_NAME","workflowVersions");let ua=Lr;function _h(t){return"type"in t&&t.type==="folder"}let G=null,xr=null,X=null,Ke=null,ze=null,qt=null,xe=null;async function xh(){const t=async()=>{G=await sa.load()},e=async()=>{xr=await ca.load()},n=async()=>{X=await la.load()},r=async()=>{Ke=await ia.load()},o=async()=>{ze=await oa.load()},a=async()=>{qt=new ml},i=async()=>{xe=await ua.load()};await Promise.all([t(),e(),n(),r(),o(),a(),i()]),localStorage.getItem("WORKSPACE_INDEXDB_BACKFILL")!=="true"&&(await kh(),localStorage.setItem("WORKSPACE_INDEXDB_BACKFILL","true"))}async function kh(){const t=async()=>{try{const s=await(G==null?void 0:G.getRecords());s&&await ge.workflows.bulkAdd(Object.values(s))}catch(s){console.error(s)}},e=async()=>{try{const s=await(Ke==null?void 0:Ke.getRecords());s&&await ge.folders.bulkAdd(Object.values(s))}catch(s){console.error(s)}},n=async()=>{try{const s=await(qt==null?void 0:qt.getRecords());s&&await ge.media.bulkAdd(Object.values(s))}catch(s){console.error(s)}},r=async()=>{try{const s=await(ze==null?void 0:ze.getRecords());s&&await ge.changelogs.bulkAdd(Object.values(s))}catch(s){console.error(s)}},o=async()=>{try{const s=await(xr==null?void 0:xr.getRecords());s&&await ge.tags.bulkAdd(Object.values(s))}catch(s){console.error(s)}},a=async()=>{try{const s=X,l=await s.getRecords().then(c=>c[s.DEFAULT_USER]?c[s.DEFAULT_USER]:c);await ge.userSettings.put({...s.defaultSettings,...l})}catch(s){console.error(s)}},i=async()=>{try{const s=await(xe==null?void 0:xe.getRecords());s&&await ge.workflowVersions.bulkAdd(Object.values(s))}catch(s){console.error(s)}};await Promise.all([t(),e(),n(),r(),o(),a(),i()])}const _t=P.createContext({curFlowID:null,loadWorkflowID:()=>{},saveCurWorkflow:()=>{},discardUnsavedChanges:async()=>{},isDirty:!1,loadNewWorkflow:()=>{},loadFilePath:()=>{},setRoute:()=>{},route:"root",jsonDiff:null,compareJson:()=>{},curVersion:null}),Up=P.createContext({refreshFolderStamp:0,setRefreshFolderStamp:()=>{}}),_o={x:0,y:0};function Eh({children:t,onDragEnd:e,dragIconId:n}){const r=P.useRef(_o),o=P.useRef(!1),[a,i]=P.useState(_o),s=d=>{var p,h,v;if(!(!(d.target instanceof Element)||!(d.target.parentNode instanceof Element))&&[(p=d.target)==null?void 0:p.id,(v=(h=d.target)==null?void 0:h.parentNode)==null?void 0:v.id].includes(n)){r.current={x:d.clientX,y:d.clientY},o.current=!0,window.addEventListener("mousemove",l),window.addEventListener("mouseup",c);const f=document.getElementsByTagName("body")[0];f.style.userSelect="none"}},l=P.useCallback(d=>{const p={x:d.clientX-r.current.x,y:d.clientY-r.current.y};i(p)},[]),c=P.useCallback(()=>{i(p=>(setTimeout(()=>{e(p)},0),_o)),o.current=!1;const d=document.getElementsByTagName("body")[0];d.style.userSelect="auto",window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",c)},[e,l]),u={transform:`translate(${a.x}px, ${a.y}px)`,zIndex:o.current?1e3:1};return O.jsx("div",{style:u,onMouseDown:s,children:t})}var Sh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},Ch=Object.defineProperty,Ih=Object.defineProperties,Oh=Object.getOwnPropertyDescriptors,Fr=Object.getOwnPropertySymbols,yl=Object.prototype.hasOwnProperty,vl=Object.prototype.propertyIsEnumerable,Ps=(t,e,n)=>e in t?Ch(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,As=(t,e)=>{for(var n in e||(e={}))yl.call(e,n)&&Ps(t,n,e[n]);if(Fr)for(var n of Fr(e))vl.call(e,n)&&Ps(t,n,e[n]);return t},Dh=(t,e)=>Ih(t,Oh(e)),jh=(t,e)=>{var n={};for(var r in t)yl.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Fr)for(var r of Fr(t))e.indexOf(r)<0&&vl.call(t,r)&&(n[r]=t[r]);return n},Be=(t,e,n)=>{const r=P.forwardRef((o,a)=>{var i=o,{color:s="currentColor",size:l=24,stroke:c=2,children:u}=i,d=jh(i,["color","size","stroke","children"]);return P.createElement("svg",As(Dh(As({ref:a},Sh),{width:l,height:l,stroke:s,strokeWidth:c,className:`tabler-icon tabler-icon-${t}`}),d),[...n.map(([p,h])=>P.createElement(p,h)),...u||[]])});return r.propTypes={color:Ft.string,size:Ft.oneOfType([Ft.string,Ft.number]),stroke:Ft.oneOfType([Ft.string,Ft.number])},r.displayName=`${e}`,r},Ph=Be("arrow-back-up-double","IconArrowBackUpDouble",[["path",{d:"M13 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M8 14l-4 -4l4 -4",key:"svg-1"}],["path",{d:"M9 10h7a4 4 0 1 1 0 8h-1",key:"svg-2"}]]),Ah=Be("chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),da=Be("device-floppy","IconDeviceFloppy",[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]]),Nh=Be("download","IconDownload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 11l5 5l5 -5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]),Fh=Be("external-link","IconExternalLink",[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]]),Rh=Be("folder","IconFolder",[["path",{d:"M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2",key:"svg-0"}]]),Th=Be("grip-vertical","IconGripVertical",[["path",{d:"M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}],["path",{d:"M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-4"}],["path",{d:"M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-5"}]]),Bh=Be("history","IconHistory",[["path",{d:"M12 8l0 4l2 2",key:"svg-0"}],["path",{d:"M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5",key:"svg-1"}]]),Mh=Be("link","IconLink",[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]]),zh=Be("lock","IconLock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]),Lh=Be("photo","IconPhoto",[["path",{d:"M15 8h.01",key:"svg-0"}],["path",{d:"M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z",key:"svg-1"}],["path",{d:"M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5",key:"svg-2"}],["path",{d:"M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3",key:"svg-3"}]]),Wh=Be("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),Uh=Be("share-2","IconShare2",[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]]),Kh=Be("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]),gl=Be("triangle-inverted-filled","IconTriangleInvertedFilled",[["path",{d:"M20.118 3h-16.225a2.914 2.914 0 0 0 -2.503 4.371l8.116 13.549a2.917 2.917 0 0 0 4.987 .005l8.11 -13.539a2.914 2.914 0 0 0 -2.486 -4.386z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}]]),$h=Be("versions","IconVersions",[["path",{d:"M10 5m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 7l0 10",key:"svg-1"}],["path",{d:"M4 8l0 8",key:"svg-2"}]]),qh=Be("world","IconWorld",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]]),Hh=Be("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);function Vh(t){const{promptMessage:e="Are you sure you want to delete this?",variant:n="ghost",onDelete:r,isDisabled:o=!1,tooltipText:a}=t;return O.jsx(gi,{isLazy:!0,placement:"auto",children:({onClose:i})=>O.jsxs(O.Fragment,{children:[O.jsx(vi,{children:O.jsx(yt,{children:O.jsx(Wt,{hasArrow:!0,label:a,placement:"bottom",children:O.jsx(Pn,{"aria-label":"Delete confirm",size:"sm",icon:O.jsx(Kh,{color:"#F56565"}),isDisabled:o,variant:n})})})}),O.jsxs(ki,{children:[O.jsx(wi,{}),O.jsx(_i,{onClick:i}),O.jsxs(bi,{children:[O.jsx(zt,{mb:4,pr:4,fontWeight:600,children:e}),O.jsx(qe,{colorScheme:"red",size:"sm",onClick:()=>{r(),i()},children:"Yes, delete"})]})]})]})})}function Zh({onClose:t}){zs();const{curFlowID:e,isDirty:n,loadWorkflowID:r}=P.useContext(_t),[o,a]=P.useState(0),[i,s]=P.useState(null),[l,c]=P.useState([]),[u,d]=P.useState([]),p=async f=>{var x;const y=await(G==null?void 0:G.get(f)),m=await(ze==null?void 0:ze.listByWorkflowID(f));c(m??[]);const w=m==null?void 0:m.filter(E=>E.json===(y==null?void 0:y.json)),_=(x=w==null?void 0:w[0])==null?void 0:x.id;_&&s(_)},h=async()=>{var _;const f=await(xe==null?void 0:xe.listByWorkflowID(e))??[];d(f);const y=JSON.stringify(Se.graph.serialize()),m=f==null?void 0:f.filter(x=>x.json===y),w=(_=m==null?void 0:m[0])==null?void 0:_.id;w&&s(w)},v=f=>{xe==null||xe.delete(f).then(()=>{h()})};return P.useEffect(()=>{switch(o){case 0:h();break;case 1:p(e);break}},[o]),P.useEffect(()=>(Se.canvasEl.addEventListener("click",t),()=>{Se.canvasEl.removeEventListener("click",t)}),[o]),O.jsxs(oc,{width:400,height:"100vh",gap:0,position:"fixed",top:0,left:0,zIndex:1e3,children:[O.jsx(rc,{pb:1,mb:0,children:O.jsxs(kn,{justifyContent:"space-between",alignItems:"center",children:[O.jsx(xa,{size:"md",children:"Version History"}),O.jsx(Pn,{size:"sm",icon:O.jsx(Hh,{}),onClick:t,variant:"ghost","aria-label":"close version history"})]})}),O.jsx(nc,{overflowY:"auto",gap:0,children:O.jsxs(Ci,{isFitted:!0,variant:"enclosed",onChange:a,colorScheme:"teal",children:[O.jsxs(Ii,{mb:"1em",children:[O.jsx(Do,{children:"Versions"}),O.jsx(Do,{children:"Change History"})]}),O.jsxs(Oi,{children:[O.jsx(Oo,{children:O.jsx(rn,{divider:O.jsx(Eo,{}),spacing:2,children:u==null?void 0:u.map(f=>O.jsxs(kn,{w:"100%",mb:1,justify:"space-between",backgroundColor:f.id===i?"teal.300":void 0,borderRadius:4,children:[O.jsxs(rn,{textAlign:"left",gap:0,children:[O.jsx(zt,{fontWeight:"500",children:f.name??"untitled"}),O.jsxs(zt,{color:"GrayText",fontSize:"sm",children:["Created: ",aa(f.createTime)]})]}),O.jsxs(kn,{alignItems:"center",gap:2,children:[O.jsx(qe,{size:"sm",onClick:()=>{if(n){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}Se.loadGraphData(JSON.parse(f.json)),r(e,f.id),t()},children:"Load"}),O.jsx(Vh,{promptMessage:"Are you sure you want to delete this version?",onDelete:()=>{v(f.id)}})]})]},f.id))})}),O.jsxs(Oo,{children:[O.jsx(zt,{mb:4,children:"All the saved changes of this workflow"}),O.jsx(rn,{divider:O.jsx(Eo,{}),spacing:2,children:l==null?void 0:l.map(f=>O.jsxs(qe,{size:"sm",variant:"ghost",onClick:()=>{if(n){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}Se.loadGraphData(JSON.parse(f.json)),G==null||G.updateFlow(e,{json:f.json}),t()},isActive:f.id===i,children:["Saved at ",aa(f.createTime,!0)]},f.id))})]})]})]})})]})}function Gh({workflowId:t,onClose:e}){const[n,r]=P.useState(""),[o,a]=P.useState(""),i=l=>{r(l.target.value),o&&a("")},s=async()=>{const l=n.trim();if(r(l),(await(xe==null?void 0:xe.listByWorkflowID(t))??[]).some(u=>u.name===l))a("The name is duplicated, please modify it and submit again.");else{const u=JSON.stringify(Se.graph.serialize());await(xe==null?void 0:xe.add({name:n,workflowID:t,createTime:Date.now(),json:u})),e()}};return O.jsxs($r,{isOpen:!0,onClose:e,children:[O.jsx(ma,{}),O.jsxs(qr,{children:[O.jsx(ya,{children:"Create Version"}),O.jsx(va,{}),O.jsx(ga,{children:O.jsxs(Vr,{isInvalid:!!o,children:[O.jsx(Gr,{children:"Name"}),O.jsx(Kn,{value:n,onChange:i,autoFocus:!0,onKeyUp:l=>{l.code==="Enter"&&!o&&n&&s()}}),o&&O.jsx(Zr,{children:o})]})}),O.jsxs(wa,{children:[O.jsx(qe,{colorScheme:"teal",mr:3,onClick:s,isDisabled:!n||!!o,children:"Create"}),O.jsx(qe,{onClick:e,children:"Cancel"})]})]})]})}function Jh({options:t,menuButton:e,isOpen:n,onClose:r}){const o=P.useRef(null);return Dc({ref:o,handler:()=>r()}),O.jsxs(yt,{position:"relative",children:[O.jsx(yt,{children:e}),n&&O.jsx(yt,{ref:o,mt:"8px",shadow:"md",p:"2",position:"absolute",zIndex:"dropdown",children:t})]})}function Yh({menuButton:t,menuContent:e,onClose:n}){const r=P.useRef(),[o,a]=P.useState(!1),i=()=>{r.current=setTimeout(()=>a(!1),400)},s=()=>{a(!0),clearTimeout(r.current),r.current=void 0};return O.jsx(Jh,{isOpen:o,onClose:i,menuButton:O.jsx(yt,{"aria-label":"menu",onClick:s,onMouseEnter:s,onMouseLeave:i,children:t}),options:O.jsx(Na,{isOpen:!0,children:O.jsx(Fa,{minWidth:150,zIndex:1e3,onMouseEnter:s,onMouseLeave:i,children:e})})})}var wl={exports:{}};(function(t,e){(function(n,r){t.exports=r(P)})(self,function(n){return(()=>{var r={579:(s,l,c)=>{var u=c(84);s.exports=u},84:(s,l,c)=>{c.r(l),c.d(l,{default:()=>M});var u=c(250),d=c.n(u),p=function(A){return A==="array"||Object.prototype.toString.call(A)==="[object Array]"},h=function(A){return Object.prototype.toString.call(A)==="[object Object]"},v=function(A){return A===1?{textIndent:"20px"}:{textIndent:"".concat(20*A,"px")}},f=function(A){var J=Object.prototype.toString.call(A);return(J=J.match(/(?!\[).+(?=\])/g)[0].split(" ")[1]).toLowerCase()},y=function(A){return h(A)||p(A)},m=function(A,J){return Object.prototype.toString.call(A)===Object.prototype.toString.call(J)};function w(A,J,oe){return J in A?Object.defineProperty(A,J,{value:oe,enumerable:!0,configurable:!0,writable:!0}):A[J]=oe,A}function _(){return _=Object.assign||function(A){for(var J=1;J<arguments.length;J++){var oe=arguments[J];for(var ne in oe)Object.prototype.hasOwnProperty.call(oe,ne)&&(A[ne]=oe[ne])}return A},_.apply(this,arguments)}function x(A,J){(J==null||J>A.length)&&(J=A.length);for(var oe=0,ne=new Array(J);oe<J;oe++)ne[oe]=A[oe];return ne}function E(A){var J,oe,ne,ie=A.name,ve=A.value,fe=A.type,he=A.line,ue=A.showIndex,g=A.needComma,B=A.level,W=B===void 0?1:B,C=A.lineType,S=A.lastLineType,F=A.lastLine,$=F===void 0?null:F,V=(oe=(0,u.useState)(!0),ne=2,function(ee){if(Array.isArray(ee))return ee}(oe)||function(ee,Y){var se=ee==null?null:typeof Symbol<"u"&&ee[Symbol.iterator]||ee["@@iterator"];if(se!=null){var be,ye,pe=[],Ae=!0,De=!1;try{for(se=se.call(ee);!(Ae=(be=se.next()).done)&&(pe.push(be.value),!Y||pe.length!==Y);Ae=!0);}catch(ot){De=!0,ye=ot}finally{try{Ae||se.return==null||se.return()}finally{if(De)throw ye}}return pe}}(oe,ne)||function(ee,Y){if(ee){if(typeof ee=="string")return x(ee,Y);var se=Object.prototype.toString.call(ee).slice(8,-1);return se==="Object"&&ee.constructor&&(se=ee.constructor.name),se==="Map"||se==="Set"?Array.from(ee):se==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(se)?x(ee,Y):void 0}}(oe,ne)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),z=V[0],Q=V[1];return d().createElement("div",{className:"c-json-line"},d().createElement("p",{className:"c-json-p c-line-".concat(C),onClick:function(){return Q(!z)},style:v(W)},d().createElement("span",{className:"c-json-mark"},he),d().createElement("span",{className:"c-of-".concat(C)}),d().createElement("span",{className:"c-json-content"},ue&&d().createElement("span",{className:"c-json-key"},ie,": "),d().createElement("span",{className:"c-json-pt"},p(fe)?"[":"{")),!z&&d().createElement("span",{className:"c-json-pt"},p(fe)?"...]":"...}",g?",":"")),d().createElement("div",{style:{display:z?"block":"none"}},ve.map(function(ee,Y){return d().createElement(k,_({key:Y,level:W+1},ee))}),d().createElement("p",(w(J={className:"c-json-feet"},"className","c-json-p c-line-".concat(C)),w(J,"style",v(W)),J),$&&d().createElement("span",{className:"c-json-mark"},$),S&&d().createElement("span",{className:"c-of-".concat(S)}),d().createElement("span",{className:"c-json-pt"},p(fe)?"]":"}",g?",":""))))}function I(A){var J=A.name,oe=A.value,ne=A.line,ie=A.showIndex,ve=A.type,fe=A.lineType,he=A.needComma,ue=A.level,g=ue===void 0?1:ue;return d().createElement("p",{className:"c-json-p c-line-".concat(fe),style:v(g)},d().createElement("span",{className:"c-json-mark"},ne),d().createElement("span",{className:"c-of-".concat(fe)}),d().createElement("span",{className:"c-json-content"},ie&&d().createElement("span",{className:"c-json-key"},J,": "),d().createElement("span",{className:"c-json-".concat(ve)},oe),d().createElement("span",{className:"c-json-comma"},he?",":"")))}function k(A){return(J=A.type)==="array"||J==="object"?d().createElement(E,A):d().createElement(I,A);var J}var R=c(379),D=c.n(R),T=c(795),H=c.n(T),j=c(569),L=c.n(j),b=c(565),q=c.n(b),te=c(216),N=c.n(te),ae=c(589),Z=c.n(ae),le=c(725),K={};function U(){return U=Object.assign||function(A){for(var J=1;J<arguments.length;J++){var oe=arguments[J];for(var ne in oe)Object.prototype.hasOwnProperty.call(oe,ne)&&(A[ne]=oe[ne])}return A},U.apply(this,arguments)}function re(A,J){(J==null||J>A.length)&&(J=A.length);for(var oe=0,ne=new Array(J);oe<J;oe++)ne[oe]=A[oe];return ne}K.styleTagTransform=Z(),K.setAttributes=q(),K.insert=L().bind(null,"head"),K.domAPI=H(),K.insertStyleElement=N(),D()(le.Z,K),le.Z&&le.Z.locals&&le.Z.locals;const M=function(A){var J,oe,ne=A.oldData,ie=A.newData,ve=(J=(0,u.useState)([]),oe=2,function(ue){if(Array.isArray(ue))return ue}(J)||function(ue,g){var B=ue==null?null:typeof Symbol<"u"&&ue[Symbol.iterator]||ue["@@iterator"];if(B!=null){var W,C,S=[],F=!0,$=!1;try{for(B=B.call(ue);!(F=(W=B.next()).done)&&(S.push(W.value),!g||S.length!==g);F=!0);}catch(V){$=!0,C=V}finally{try{F||B.return==null||B.return()}finally{if($)throw C}}return S}}(J,oe)||function(ue,g){if(ue){if(typeof ue=="string")return re(ue,g);var B=Object.prototype.toString.call(ue).slice(8,-1);return B==="Object"&&ue.constructor&&(B=ue.constructor.name),B==="Map"||B==="Set"?Array.from(ue):B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B)?re(ue,g):void 0}}(J,oe)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),fe=ve[0],he=ve[1];return(0,u.useEffect)(function(){var ue,g,B,W,C,S;he((B=[],W=1,C=function F($,V){var z=[];if(y($)){var Q=f($)==="object",ee=Object.keys($),Y=ee.length;return ee.forEach(function(se,be){var ye=f($[se]);z.push({name:se,line:W++,value:F($[se],V),type:ye,showIndex:Q,needComma:Y!==be+1,lineType:V,lastLineType:V,lastLine:y($[se])?W++:null})}),z}switch(f($)){case"number":case"boolean":case"regexp":return $.toString();case"null":return"null";case"undefined":return"undefined";case"function":return" () {...}";default:return'"'.concat($.toString(),'"')}},S=function(F,$,V,z,Q){return{name:F,line:W++,value:C($,Q),type:f($),showIndex:V,needComma:z,lineType:Q,lastLineType:Q,lastLine:y($)?W++:null}},m(ue=ne,g=ie)&&y(g)?function F($,V,z){var Q=Object.keys($),ee=Object.keys(V),Y=h(V),se=Q.filter(function(pe){return!ee.some(function(Ae){return Ae===pe})}),be=Q.filter(function(pe){return ee.some(function(Ae){return Ae===pe})}),ye=ee.filter(function(pe){return!Q.some(function(Ae){return Ae===pe})});se.forEach(function(pe,Ae){var De=!0;be.length===0&&ye.length===0&&Ae===se.length-1&&(De=!1),z.push(S(pe,$[pe],Y,De,"del"))}),be.forEach(function(pe,Ae){var De=!0;if(ye.length===0&&Ae===be.length-1&&(De=!1),$[pe]===V[pe])z.push(S(pe,V[pe],Y,De,"none"));else if(m($[pe],V[pe]))if(y(V[pe])){var ot=S(pe,p($[pe])?[]:{},Y,De,"none");z.push(ot),W-=1,F($[pe],V[pe],ot.value),ot.lastLine=W++}else z.push(S(pe,$[pe],Y,!0,"del")),z.push(S(pe,V[pe],Y,De,"add"));else z.push(S(pe,$[pe],Y,!0,"del")),z.push(S(pe,V[pe],Y,De,"add"))}),ye.forEach(function(pe,Ae){z.push(S(pe,V[pe],Y,ye.length!==Ae+1,"add"))})}(ue,g,B):ue===g?B.push(S(0,g,!1,!1,"none")):(B.push(S(0,ue,!1,!0,"del")),B.push(S(1,g,!1,!1,"add"))),B))},[ne,ie]),d().createElement("pre",{className:"c-json-view"},d().createElement("p",{className:"c-json-outter"},p(ie)?"[":"{"),fe.map(function(ue,g){return d().createElement(k,U({key:g},ue))}),d().createElement("p",{className:"c-json-outter"},p(ie)?"]":"}"))}},725:(s,l,c)=>{c.d(l,{Z:()=>v});var u=c(81),d=c.n(u),p=c(645),h=c.n(p)()(d());h.push([s.id,`.c-json-view {
  display: block;
  width: 100%;
  padding: 10px 10px 10px 40px;
  background-color: #fbfbfb;
  box-sizing: border-box;
  white-space: pre-wrap;
  word-wrap: break-word;
  overflow: hidden;
}

.c-json-line,
.c-json-p,
.c-json-feet {
  position: relative;
  text-align: left;
  padding: 0;
  margin: 0;
  padding: 2px 0;
}

.c-json-line {
  padding: 0;
}

.c-line-del {
  background-color: #ffeef0;
}

.c-line-add {
  background-color: #e6ffed;
}

.c-line-none {}

.c-of-del:after {
  content: '-';
  position: absolute;
  left: 5px;
  top: 3px;
  width: 10px;
  height: 15px;
  z-index: 5;
  text-indent: 0;
  color: #ff6f6f;
}

.c-of-add:after {
  content: '+';
  position: absolute;
  left: 5px;
  top: 3px;
  width: 10px;
  height: 15px;
  z-index: 5;
  color: #3eb93e;
  text-indent: 0;
}

.c-json-p {
  cursor: pointer;
}

.c-json-outter {
  transform: translateX(-35px);
}

.c-json-mark {
  position: absolute;
  left: -30px;
  top: 2px;
  text-indent: 0;
  font-size: 12px;
  color: #545454;
  z-index: 5;
  user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.c-json-content {
  font-size: 14px;
}

.c-json-content .c-json-key {
  font-size: 15px;
  color: #5cadff;
}

.c-json-items {
  color: #b1b1b1;
}

.c-json-comma {
  color: #5cadff;
}

.c-json-pt {
  color: #5cadff;
}

.c-json-number {
  color: #ae81ff;
}

.c-json-string {
  color: #a6e22e;
}

.c-json-null,
.c-json-boolean,
.c-json-undefined,
.c-json-regexp,
.c-json-date,
.c-json-set,
.c-json-map,
.c-json-error,
.c-json-symbol,
.c-json-function {
  background-color: #f7f7f7;
  border-radius: 3px;
  padding: 0px 2px;
  border: 1px solid #dedede;
}

.c-json-boolean {
  color: #6f73ff;
}

.c-json-null {
  color: #66d9ef;
}

.c-json-undefined {
  color: #f92672;
}

.c-json-date {
  color: #09d3ac;
}

.c-json-regexp {
  color: #2ea021;
}

.c-json-function {
  color: #a2af3d;
}

.c-json-symbol {
  color: #fd3db8;
}

.c-json-error {
  color: #afafaf;
}

.c-json-set,
.c-json-map {
  color: #f56847;
}`,""]);const v=h},645:s=>{s.exports=function(l){var c=[];return c.toString=function(){return this.map(function(u){var d="",p=u[5]!==void 0;return u[4]&&(d+="@supports (".concat(u[4],") {")),u[2]&&(d+="@media ".concat(u[2]," {")),p&&(d+="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {")),d+=l(u),p&&(d+="}"),u[2]&&(d+="}"),u[4]&&(d+="}"),d}).join("")},c.i=function(u,d,p,h,v){typeof u=="string"&&(u=[[null,u,void 0]]);var f={};if(p)for(var y=0;y<this.length;y++){var m=this[y][0];m!=null&&(f[m]=!0)}for(var w=0;w<u.length;w++){var _=[].concat(u[w]);p&&f[_[0]]||(v!==void 0&&(_[5]===void 0||(_[1]="@layer".concat(_[5].length>0?" ".concat(_[5]):""," {").concat(_[1],"}")),_[5]=v),d&&(_[2]&&(_[1]="@media ".concat(_[2]," {").concat(_[1],"}")),_[2]=d),h&&(_[4]?(_[1]="@supports (".concat(_[4],") {").concat(_[1],"}"),_[4]=h):_[4]="".concat(h)),c.push(_))}},c}},81:s=>{s.exports=function(l){return l[1]}},379:s=>{var l=[];function c(p){for(var h=-1,v=0;v<l.length;v++)if(l[v].identifier===p){h=v;break}return h}function u(p,h){for(var v={},f=[],y=0;y<p.length;y++){var m=p[y],w=h.base?m[0]+h.base:m[0],_=v[w]||0,x="".concat(w," ").concat(_);v[w]=_+1;var E=c(x),I={css:m[1],media:m[2],sourceMap:m[3],supports:m[4],layer:m[5]};if(E!==-1)l[E].references++,l[E].updater(I);else{var k=d(I,h);h.byIndex=y,l.splice(y,0,{identifier:x,updater:k,references:1})}f.push(x)}return f}function d(p,h){var v=h.domAPI(h);return v.update(p),function(f){if(f){if(f.css===p.css&&f.media===p.media&&f.sourceMap===p.sourceMap&&f.supports===p.supports&&f.layer===p.layer)return;v.update(p=f)}else v.remove()}}s.exports=function(p,h){var v=u(p=p||[],h=h||{});return function(f){f=f||[];for(var y=0;y<v.length;y++){var m=c(v[y]);l[m].references--}for(var w=u(f,h),_=0;_<v.length;_++){var x=c(v[_]);l[x].references===0&&(l[x].updater(),l.splice(x,1))}v=w}}},569:s=>{var l={};s.exports=function(c,u){var d=function(p){if(l[p]===void 0){var h=document.querySelector(p);if(window.HTMLIFrameElement&&h instanceof window.HTMLIFrameElement)try{h=h.contentDocument.head}catch{h=null}l[p]=h}return l[p]}(c);if(!d)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");d.appendChild(u)}},216:s=>{s.exports=function(l){var c=document.createElement("style");return l.setAttributes(c,l.attributes),l.insert(c,l.options),c}},565:(s,l,c)=>{s.exports=function(u){var d=c.nc;d&&u.setAttribute("nonce",d)}},795:s=>{s.exports=function(l){var c=l.insertStyleElement(l);return{update:function(u){(function(d,p,h){var v="";h.supports&&(v+="@supports (".concat(h.supports,") {")),h.media&&(v+="@media ".concat(h.media," {"));var f=h.layer!==void 0;f&&(v+="@layer".concat(h.layer.length>0?" ".concat(h.layer):""," {")),v+=h.css,f&&(v+="}"),h.media&&(v+="}"),h.supports&&(v+="}");var y=h.sourceMap;y&&typeof btoa<"u"&&(v+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(y))))," */")),p.styleTagTransform(v,d,p.options)})(c,l,u)},remove:function(){(function(u){if(u.parentNode===null)return!1;u.parentNode.removeChild(u)})(c)}}}},589:s=>{s.exports=function(l,c){if(c.styleSheet)c.styleSheet.cssText=l;else{for(;c.firstChild;)c.removeChild(c.firstChild);c.appendChild(document.createTextNode(l))}}},250:s=>{s.exports=n}},o={};function a(s){var l=o[s];if(l!==void 0)return l.exports;var c=o[s]={id:s,exports:{}};return r[s](c,c.exports,a),c.exports}a.n=s=>{var l=s&&s.__esModule?()=>s.default:()=>s;return a.d(l,{a:l}),l},a.d=(s,l)=>{for(var c in l)a.o(l,c)&&!a.o(s,c)&&Object.defineProperty(s,c,{enumerable:!0,get:l[c]})},a.o=(s,l)=>Object.prototype.hasOwnProperty.call(s,l),a.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})};var i=a(579);return i.default})()})})(wl);var Xh=wl.exports;const Qh=fa(Xh);function ep(){const{jsonDiff:t,compareJson:e}=P.useContext(_t);return t==null?null:O.jsx($r,{isOpen:!0,onClose:()=>{e(null)},children:O.jsx(qr,{children:O.jsx(yt,{height:"80vh",width:"90%",overflow:"scroll",children:O.jsx(Qh,{oldData:t==null?void 0:t.old,newData:t==null?void 0:t.new})})})})}const tp=P.lazy(()=>Hr(()=>import("./ShareDialog-Q3AC6yal.js"),__vite__mapDeps([0,1,2,3])));function np(){const{curFlowID:t,loadWorkflowID:e,discardUnsavedChanges:n,saveCurWorkflow:r,setRoute:o,route:a}=P.useContext(_t),[i,s]=P.useState(!1),[l,c]=P.useState(""),[u,d]=P.useState(""),[p,h]=P.useState(),[v,f]=P.useState({save:"",saveAs:""}),[y,m]=P.useState(!1);P.useEffect(()=>{t&&(G==null||G.get(t).then(I=>{c((I==null?void 0:I.name)??""),h(I)})),X==null||X.getSetting("shortcuts").then(I=>{f(I)})},[t]);const w=I=>{c(I.target.value),u&&d("")},_=async()=>{if(!t){alert("Flow ID is required");return}const I=JSON.stringify(Se.graph.serialize()),k=await(G==null?void 0:G.createFlow({json:I,lastSavedJson:I,name:l,parentFolderID:p==null?void 0:p.parentFolderID}));k&&await e(k.id,null,!0),x()},x=()=>{o("root")},E=P.useCallback(async()=>{const I=t?await(G==null?void 0:G.get(t)):null;if(!I){alert("Workspace does not exist");return}const k=new Blob([I.json],{type:"application/json"}),R=URL.createObjectURL(k),D=document.createElement("a");D.href=R,D.download=`${I.name}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(R)},[t]);return O.jsxs(O.Fragment,{children:[O.jsx(Yh,{menuButton:O.jsx(Ts,{children:O.jsxs(qe,{px:1,height:"29px","aria-label":"menu",size:"sm",backgroundColor:"teal.600",children:["File",O.jsx(Ah,{size:20})]})}),menuContent:O.jsx(Na,{isOpen:!0,children:O.jsxs(Fa,{minWidth:150,zIndex:1e3,children:[O.jsx(xt,{onClick:r,icon:O.jsx(da,{size:20}),iconSpacing:1,command:v.save,children:"Save"}),O.jsx(Wt,{label:"Revert workflow to your last saved version. You will lose all changes made since your last save.",children:O.jsx(xt,{onClick:n,icon:O.jsx(Ph,{size:20}),iconSpacing:1,children:"Discard unsaved changes"})}),O.jsx(xt,{onClick:E,icon:O.jsx(Nh,{size:20}),iconSpacing:1,children:"Download"}),O.jsx(xt,{onClick:()=>o("saveAsModal"),icon:O.jsx(da,{size:20}),iconSpacing:1,command:v.saveAs,children:"Save As"}),O.jsx(xt,{onClick:()=>s(!0),icon:O.jsx($h,{size:20}),iconSpacing:1,children:"Create Version"}),O.jsx(xt,{onClick:()=>o("versionHistory"),icon:O.jsx(Bh,{size:20}),iconSpacing:1,children:"Versions History"}),O.jsx(xt,{onClick:()=>m(!0),icon:O.jsx(Uh,{size:20}),iconSpacing:1,alignItems:"center",children:O.jsxs(Tt,{children:[O.jsx("p",{children:"Share"})," ",O.jsx(Ra,{size:"sm",children:"beta"})]})})]})})}),y&&O.jsx(tp,{onClose:()=>m(!1)}),a=="versionHistory"&&O.jsx(Zh,{onClose:()=>o("root")}),O.jsx(ep,{}),a==="saveAsModal"&&O.jsxs($r,{isOpen:!0,onClose:x,children:[O.jsx(ma,{}),O.jsxs(qr,{children:[O.jsx(ya,{children:"Save As"}),O.jsx(va,{}),O.jsx(ga,{children:O.jsxs(Vr,{isInvalid:!!u,children:[O.jsx(Gr,{children:"Workflow name"}),O.jsx(Kn,{value:l,onChange:w,autoFocus:!0,onKeyUp:I=>{I.code==="Enter"&&!u&&l&&_()}}),u&&O.jsx(Zr,{children:u})]})}),O.jsxs(wa,{children:[O.jsx(qe,{colorScheme:"teal",mr:3,onClick:_,isDisabled:!l||!!u,children:"Save"}),O.jsx(qe,{onClick:x,children:"Cancel"})]})]})]}),i&&O.jsx(Gh,{workflowId:t,onClose:()=>s(!1)})]})}function rp({displayName:t,updateFlowName:e,isDirty:n}){const{isOpen:r,onOpen:o,onClose:a}=Ac(),{curFlowID:i}=P.useContext(_t),[s,l]=P.useState(t),[c,u]=P.useState(""),d=()=>{l(t),o()},p=f=>{l(f.target.value),c&&u("")},h=async()=>{var f;if(i){const y=s.trim();if(l(y),t===y)return v();await(G==null?void 0:G.generateUniqueName(y,((f=G.curWorkflow)==null?void 0:f.parentFolderID)??""))!==y?u("The name is duplicated, please modify it and submit again."):(await(G==null?void 0:G.updateName(i,{name:y})),e(y),v())}},v=()=>{u(""),a()};return i==null?null:O.jsxs(Tt,{children:[O.jsx(Wt,{label:t,placement:"bottom",children:O.jsxs(zt,{as:"div",color:"white",onClick:d,maxW:200,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:[O.jsx("div",{style:{width:8,display:"inline-block"},children:O.jsx(zt,{as:"span",children:n&&"* "})}),t]})}),O.jsxs($r,{isOpen:r,onClose:v,children:[O.jsx(ma,{}),O.jsxs(qr,{children:[O.jsx(ya,{children:"Edit workflow name"}),O.jsx(va,{}),O.jsx(ga,{children:O.jsxs(Vr,{isInvalid:!!c,children:[O.jsx(Gr,{children:"Workflow name"}),O.jsx(Kn,{value:s,onChange:p,autoFocus:!0,onKeyUp:f=>{f.code==="Enter"&&!c&&s&&h()}}),c&&O.jsx(Zr,{children:c})]})}),O.jsxs(wa,{children:[O.jsx(qe,{colorScheme:"teal",mr:3,onClick:h,isDisabled:!s||!!c,children:"Save"}),O.jsx(qe,{onClick:v,children:"Cancel"})]})]})]})]})}function Kp(t){const e=new Uint8Array(t);return window.crypto.getRandomValues(e),Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}const $p=[{label:"Private",value:"PRIVATE",icon:O.jsx(zh,{})},{label:"Unlisted, anyone with the link can view",value:"UNLISTED",icon:O.jsx(Mh,{})},{label:"Public",value:"PUBLIC",icon:O.jsx(qh,{})}],qp=()=>{const t=Se.graph._nodes,e={};for(let n of t)if(n.type in LiteGraph.registered_node_types){const r=structuredClone(LiteGraph.registered_node_types[n.type].nodeData);if(r==null)continue;for(let o in r.input){const a=r.input[o];for(let i in a){const s=a[i];Array.isArray(s[0])&&(s[0]=["value_1","value_2"])}}e[n.type]=r}return e};async function op(t){const e=t.cloudOrigin;if(!e)throw Error("cloudURL is required");return fetch(e+`/api/getWorkflow?id=${t.cloudID}`).then(n=>n.json()).then(n=>{var o;return((o=n.data)==null?void 0:o.privacy)??"PRIVATE"})}function ap({privacy:t,showEmoji:e=!1}){let n;return t==="PRIVATE"?(n="Private",e&&(n=" Private")):t==="UNLISTED"?(n="Unlisted",e&&(n=" Unlisted")):t==="PUBLIC"&&(n="Public",e&&(n=" Public")),O.jsx("span",{children:n})}function sp({}){const[t,e]=P.useState(),[n,r]=P.useState(),{curFlowID:o}=P.useContext(_t);return P.useEffect(()=>{o&&(G==null||G.get(o).then(a=>{a!=null&&a.cloudID?(e(a.cloudOrigin+"/workflow/"+a.cloudID),op(a).then(i=>{r(i)})):e(void 0)}))},[o]),t?O.jsx("a",{href:t,style:{textDecoration:"none"},target:"_blank",children:O.jsx(Ts,{children:O.jsx(Ra,{children:n?O.jsx(ap,{privacy:n,showEmoji:!0}):"Shared"})})}):null}function ip({}){const{route:t,setRoute:e,curVersion:n}=P.useContext(_t);return n?O.jsx(kn,{alignItems:"center",children:O.jsx(Ks,{size:"sm",isAttached:!0,variant:"outline",children:O.jsx(qe,{rightIcon:O.jsx(gl,{size:10}),onClick:()=>e("versionHistory"),children:(n==null?void 0:n.name)??"latest*"})})}):null}function lp({curFlowName:t,setCurFlowName:e}){const{isDirty:n,loadNewWorkflow:r,saveCurWorkflow:o,setRoute:a,curFlowID:i}=P.useContext(_t),[s,l]=P.useState(),c=P.useCallback((u,d=!1)=>{const{top:p=0,left:h=0}=s||{};let{top:v=0,left:f=0}=u??{};v+=p,f+=h;const y=document.documentElement.clientWidth,m=document.documentElement.clientHeight,w=document.getElementById("workspaceManagerPanel"),_=(w==null?void 0:w.offsetWidth)||392;v+36>m&&(v=m-36),f+_>=y&&(f=y-_),l({top:Math.max(0,v),left:Math.max(0,f)}),d&&(X==null||X.upsert({topBarStyle:{top:v,left:f}}))},[s]);return P.useEffect(()=>{X==null||X.getSetting("topBarStyle").then(u=>{c(u,!1)})},[]),s?O.jsx(Eh,{onDragEnd:u=>{c({top:u.y,left:u.x},!0)},dragIconId:"dragPanelIcon",children:O.jsxs(Tt,{style:{padding:2,position:"fixed",...s},justifyContent:"space-between",alignItems:"center",gap:2,draggable:!1,id:"workspaceManagerPanel",className:"workspaceManagerPanel",children:[O.jsx(qe,{size:"sm","aria-label":"workspace folder",onClick:()=>a("recentFlows"),px:2,children:O.jsxs(Tt,{gap:1,children:[O.jsx(Rh,{size:21}),O.jsx(gl,{size:8})]})}),O.jsx(Wt,{label:"New workflow",children:O.jsx(qe,{size:"sm",variant:"outline",colorScheme:"teal","aria-label":"new workflow",onClick:()=>r(),px:2,py:2,children:O.jsx(Tt,{gap:0,children:O.jsx(Wh,{size:16,color:"white"})})})}),O.jsx(rp,{isDirty:n,displayName:t??"",updateFlowName:u=>{e(u),requestAnimationFrame(()=>{c()})}}),i&&O.jsxs(Tt,{gap:"4px",children:[O.jsx(Wt,{label:"Open gallery",children:O.jsx(Pn,{onClick:()=>a("gallery"),icon:O.jsx(Lh,{size:22,color:"white"}),size:"sm","aria-label":"open gallery",variant:"ghost"})}),O.jsx(np,{})]}),i&&n?O.jsx(Wt,{label:"Save workflow",children:O.jsx(Pn,{onClick:o,icon:O.jsx(da,{size:23,color:"white"}),size:"xs",paddingY:4,"aria-label":"save workspace",variant:"ghost"})}):O.jsx("div",{style:{width:1}}),O.jsx(sp,{}),O.jsx(ip,{}),O.jsx(Th,{id:"dragPanelIcon",className:"dragPanelIcon",cursor:"move",size:15,color:"#FFF"})]})}):null}function cp(){const{showDialog:t}=Bs(),{loadWorkflowID:e}=P.useContext(_t),n=async(o,a)=>{var c,u;const{workflow:i,version:s}=o.detail;if(!i.id||!s.id)return;const l=(c=await(G==null?void 0:G.listByIndex("cloudID",i.id)))==null?void 0:c.at(0);if(l){const d=(u=await(xe==null?void 0:xe.listByIndex("cloudID",s.id)))==null?void 0:u.at(0);if(d)await e(l.id,d.id);else{const p=await(xe==null?void 0:xe.add({id:s.id,cloudID:s.id,workflowID:l.id,cloudOrigin:a,name:s.name,authorID:s.authorID,json:s.json}));p&&e(l.id,p.id)}}else{const d=await(G==null?void 0:G.createFlow({cloudID:i.id,cloudOrigin:a,name:i.name,json:s.json,updateTime:Date.now()}));if(!d){alert("Failed to add workflow to local db");return}const p=await(xe==null?void 0:xe.put({id:s.id,cloudID:s.id,workflowID:d.id,cloudOrigin:a,name:s.name,json:s.json,authorID:s.authorID,createTime:Date.now()}));await e(d.id,p==null?void 0:p.id)}},r=async o=>{const a=o.data;if(up(a)){const i=o.origin;t(`Open workflow "${a.detail.workflow.name}", version "${a.detail.version.name}" from ${i}`,[{label:"Open",colorScheme:"teal",onClick:()=>{n(a,i)}}])}};return P.useEffect(()=>{window.opener&&window.opener.postMessage("comfyui_workspace_manager_connected","*"),window.addEventListener("message",r)},[]),null}function up(t){return t.type==="workspace_open_workflow"}const dp=t=>typeof t=="function",fp=t=>{const[e,n]=P.useState(t),r=P.useRef(e),o=P.useCallback(a=>{r.current=dp(a)?a(r.current):a,n(r.current)},[]);return[e,o,r]};function cr(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var bl={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,o,a){function i(c,u){if(!o[c]){if(!r[c]){var d=typeof cr=="function"&&cr;if(!u&&d)return d(c,!0);if(s)return s(c,!0);var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}var h=o[c]={exports:{}};r[c][0].call(h.exports,function(v){var f=r[c][1][v];return i(f||v)},h,h.exports,n,r,o,a)}return o[c].exports}for(var s=typeof cr=="function"&&cr,l=0;l<a.length;l++)i(a[l]);return i}({1:[function(n,r,o){var a=n("./utils"),i=n("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var c,u,d,p,h,v,f,y=[],m=0,w=l.length,_=w,x=a.getTypeOf(l)!=="string";m<l.length;)_=w-m,d=x?(c=l[m++],u=m<w?l[m++]:0,m<w?l[m++]:0):(c=l.charCodeAt(m++),u=m<w?l.charCodeAt(m++):0,m<w?l.charCodeAt(m++):0),p=c>>2,h=(3&c)<<4|u>>4,v=1<_?(15&u)<<2|d>>6:64,f=2<_?63&d:64,y.push(s.charAt(p)+s.charAt(h)+s.charAt(v)+s.charAt(f));return y.join("")},o.decode=function(l){var c,u,d,p,h,v,f=0,y=0,m="data:";if(l.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var w,_=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&_--,l.charAt(l.length-2)===s.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=i.uint8array?new Uint8Array(0|_):new Array(0|_);f<l.length;)c=s.indexOf(l.charAt(f++))<<2|(p=s.indexOf(l.charAt(f++)))>>4,u=(15&p)<<4|(h=s.indexOf(l.charAt(f++)))>>2,d=(3&h)<<6|(v=s.indexOf(l.charAt(f++))),w[y++]=c,h!==64&&(w[y++]=u),v!==64&&(w[y++]=d);return w}},{"./support":30,"./utils":32}],2:[function(n,r,o){var a=n("./external"),i=n("./stream/DataWorker"),s=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,p,h,v){this.compressedSize=u,this.uncompressedSize=d,this.crc32=p,this.compression=h,this.compressedContent=v}c.prototype={getContentWorker:function(){var u=new i(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new i(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,p){return u.pipe(new s).pipe(new l("uncompressedSize")).pipe(d.compressWorker(p)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,o){var a=n("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},o.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,o){var a=n("./utils"),i=function(){for(var s,l=[],c=0;c<256;c++){s=c;for(var u=0;u<8;u++)s=1&s?3988292384^s>>>1:s>>>1;l[c]=s}return l}();r.exports=function(s,l){return s!==void 0&&s.length?a.getTypeOf(s)!=="string"?function(c,u,d,p){var h=i,v=p+d;c^=-1;for(var f=p;f<v;f++)c=c>>>8^h[255&(c^u[f])];return-1^c}(0|l,s,s.length,0):function(c,u,d,p){var h=i,v=p+d;c^=-1;for(var f=p;f<v;f++)c=c>>>8^h[255&(c^u.charCodeAt(f))];return-1^c}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(n,r,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(n,r,o){var a=null;a=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:a}},{lie:37}],7:[function(n,r,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=n("pako"),s=n("./utils"),l=n("./stream/GenericWorker"),c=a?"uint8array":"array";function u(d,p){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=p,this.meta={}}o.magic="\b\0",s.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(p){d.push({data:p,meta:d.meta})}},o.compressWorker=function(d){return new u("Deflate",d)},o.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,o){function a(h,v){var f,y="";for(f=0;f<v;f++)y+=String.fromCharCode(255&h),h>>>=8;return y}function i(h,v,f,y,m,w){var _,x,E=h.file,I=h.compression,k=w!==c.utf8encode,R=s.transformTo("string",w(E.name)),D=s.transformTo("string",c.utf8encode(E.name)),T=E.comment,H=s.transformTo("string",w(T)),j=s.transformTo("string",c.utf8encode(T)),L=D.length!==E.name.length,b=j.length!==T.length,q="",te="",N="",ae=E.dir,Z=E.date,le={crc32:0,compressedSize:0,uncompressedSize:0};v&&!f||(le.crc32=h.crc32,le.compressedSize=h.compressedSize,le.uncompressedSize=h.uncompressedSize);var K=0;v&&(K|=8),k||!L&&!b||(K|=2048);var U=0,re=0;ae&&(U|=16),m==="UNIX"?(re=798,U|=function(A,J){var oe=A;return A||(oe=J?16893:33204),(65535&oe)<<16}(E.unixPermissions,ae)):(re=20,U|=function(A){return 63&(A||0)}(E.dosPermissions)),_=Z.getUTCHours(),_<<=6,_|=Z.getUTCMinutes(),_<<=5,_|=Z.getUTCSeconds()/2,x=Z.getUTCFullYear()-1980,x<<=4,x|=Z.getUTCMonth()+1,x<<=5,x|=Z.getUTCDate(),L&&(te=a(1,1)+a(u(R),4)+D,q+="up"+a(te.length,2)+te),b&&(N=a(1,1)+a(u(H),4)+j,q+="uc"+a(N.length,2)+N);var M="";return M+=`
\0`,M+=a(K,2),M+=I.magic,M+=a(_,2),M+=a(x,2),M+=a(le.crc32,4),M+=a(le.compressedSize,4),M+=a(le.uncompressedSize,4),M+=a(R.length,2),M+=a(q.length,2),{fileRecord:d.LOCAL_FILE_HEADER+M+R+q,dirRecord:d.CENTRAL_FILE_HEADER+a(re,2)+M+a(H.length,2)+"\0\0\0\0"+a(U,4)+a(y,4)+R+q+H}}var s=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function p(h,v,f,y){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=f,this.encodeFileName=y,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(p,l),p.prototype.push=function(h){var v=h.meta.percent||0,f=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,l.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:f?(v+100*(f-y-1))/f:100}}))},p.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var v=this.streamFiles&&!h.file.dir;if(v){var f=i(h,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(h){this.accumulate=!1;var v=this.streamFiles&&!h.file.dir,f=i(h,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),v)this.push({data:function(y){return d.DATA_DESCRIPTOR+a(y.crc32,4)+a(y.compressedSize,4)+a(y.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var h=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var f=this.bytesWritten-h,y=function(m,w,_,x,E){var I=s.transformTo("string",E(x));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(m,2)+a(m,2)+a(w,4)+a(_,4)+a(I.length,2)+I}(this.dirRecords.length,f,h,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(h){this._sources.push(h);var v=this;return h.on("data",function(f){v.processChunk(f)}),h.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),h.on("error",function(f){v.error(f)}),this},p.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(h){var v=this._sources;if(!l.prototype.error.call(this,h))return!1;for(var f=0;f<v.length;f++)try{v[f].error(h)}catch{}return!0},p.prototype.lock=function(){l.prototype.lock.call(this);for(var h=this._sources,v=0;v<h.length;v++)h[v].lock()},r.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,o){var a=n("../compressions"),i=n("./ZipFileWorker");o.generateWorker=function(s,l,c){var u=new i(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{s.forEach(function(p,h){d++;var v=function(w,_){var x=w||_,E=a[x];if(!E)throw new Error(x+" is not a valid compression method !");return E}(h.options.compression,l.compression),f=h.options.compressionOptions||l.compressionOptions||{},y=h.dir,m=h.date;h._compressWorker(v,f).withStreamInfo("file",{name:p,dir:y,date:m,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(p){u.error(p)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,o){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new a;for(var s in this)typeof this[s]!="function"&&(i[s]=this[s]);return i}}(a.prototype=n("./object")).loadAsync=n("./load"),a.support=n("./support"),a.defaults=n("./defaults"),a.version="3.10.1",a.loadAsync=function(i,s){return new a().loadAsync(i,s)},a.external=n("./external"),r.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,o){var a=n("./utils"),i=n("./external"),s=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(p){return new i.Promise(function(h,v){var f=p.decompressed.getContentWorker().pipe(new c);f.on("error",function(y){v(y)}).on("end",function(){f.streamInfo.crc32!==p.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}r.exports=function(p,h){var v=this;return h=a.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),u.isNode&&u.isStream(p)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",p,!0,h.optimizedBinaryString,h.base64).then(function(f){var y=new l(h);return y.load(f),y}).then(function(f){var y=[i.Promise.resolve(f)],m=f.files;if(h.checkCRC32)for(var w=0;w<m.length;w++)y.push(d(m[w]));return i.Promise.all(y)}).then(function(f){for(var y=f.shift(),m=y.files,w=0;w<m.length;w++){var _=m[w],x=_.fileNameStr,E=a.resolve(_.fileNameStr);v.file(E,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:h.createFolders}),_.dir||(v.file(E).unsafeOriginalName=x)}return y.zipComment.length&&(v.comment=y.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,o){var a=n("../utils"),i=n("../stream/GenericWorker");function s(l,c){i.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}a.inherits(s,i),s.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},s.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,o){var a=n("readable-stream").Readable;function i(s,l,c){a.call(this,l),this._helper=s;var u=this;s.on("data",function(d,p){u.push(d)||u._helper.pause(),c&&c(p)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(i,a),i.prototype._read=function(){this._helper.resume()},r.exports=i},{"../utils":32,"readable-stream":16}],14:[function(n,r,o){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,i);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,i)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var i=new Buffer(a);return i.fill(0),i},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(n,r,o){function a(E,I,k){var R,D=s.getTypeOf(I),T=s.extend(k||{},u);T.date=T.date||new Date,T.compression!==null&&(T.compression=T.compression.toUpperCase()),typeof T.unixPermissions=="string"&&(T.unixPermissions=parseInt(T.unixPermissions,8)),T.unixPermissions&&16384&T.unixPermissions&&(T.dir=!0),T.dosPermissions&&16&T.dosPermissions&&(T.dir=!0),T.dir&&(E=m(E)),T.createFolders&&(R=y(E))&&w.call(this,R,!0);var H=D==="string"&&T.binary===!1&&T.base64===!1;k&&k.binary!==void 0||(T.binary=!H),(I instanceof d&&I.uncompressedSize===0||T.dir||!I||I.length===0)&&(T.base64=!1,T.binary=!0,I="",T.compression="STORE",D="string");var j=null;j=I instanceof d||I instanceof l?I:v.isNode&&v.isStream(I)?new f(E,I):s.prepareContent(E,I,T.binary,T.optimizedBinaryString,T.base64);var L=new p(E,j,T);this.files[E]=L}var i=n("./utf8"),s=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),p=n("./zipObject"),h=n("./generate"),v=n("./nodejsUtils"),f=n("./nodejs/NodejsStreamInputAdapter"),y=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var I=E.lastIndexOf("/");return 0<I?E.substring(0,I):""},m=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},w=function(E,I){return I=I!==void 0?I:u.createFolders,E=m(E),this.files[E]||a.call(this,E,null,{dir:!0,createFolders:I}),this.files[E]};function _(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var I,k,R;for(I in this.files)R=this.files[I],(k=I.slice(this.root.length,I.length))&&I.slice(0,this.root.length)===this.root&&E(k,R)},filter:function(E){var I=[];return this.forEach(function(k,R){E(k,R)&&I.push(R)}),I},file:function(E,I,k){if(arguments.length!==1)return E=this.root+E,a.call(this,E,I,k),this;if(_(E)){var R=E;return this.filter(function(T,H){return!H.dir&&R.test(T)})}var D=this.files[this.root+E];return D&&!D.dir?D:null},folder:function(E){if(!E)return this;if(_(E))return this.filter(function(D,T){return T.dir&&E.test(D)});var I=this.root+E,k=w.call(this,I),R=this.clone();return R.root=k.name,R},remove:function(E){E=this.root+E;var I=this.files[E];if(I||(E.slice(-1)!=="/"&&(E+="/"),I=this.files[E]),I&&!I.dir)delete this.files[E];else for(var k=this.filter(function(D,T){return T.name.slice(0,E.length)===E}),R=0;R<k.length;R++)delete this.files[k[R].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var I,k={};try{if((k=s.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),k.type==="binarystring"&&(k.type="string"),!k.type)throw new Error("No output type specified.");s.checkSupport(k.type),k.platform!=="darwin"&&k.platform!=="freebsd"&&k.platform!=="linux"&&k.platform!=="sunos"||(k.platform="UNIX"),k.platform==="win32"&&(k.platform="DOS");var R=k.comment||this.comment||"";I=h.generateWorker(this,k,R)}catch(D){(I=new l("error")).error(D)}return new c(I,k.type||"string",k.mimeType)},generateAsync:function(E,I){return this.generateInternalStream(E).accumulate(I)},generateNodeStream:function(E,I){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(I)}};r.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,o){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,o){var a=n("./DataReader");function i(s){a.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}n("../utils").inherits(i,a),i.prototype.byteAt=function(s){return this.data[this.zero+s]},i.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),c=s.charCodeAt(1),u=s.charCodeAt(2),d=s.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===l&&this.data[p+1]===c&&this.data[p+2]===u&&this.data[p+3]===d)return p-this.zero;return-1},i.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),c=s.charCodeAt(1),u=s.charCodeAt(2),d=s.charCodeAt(3),p=this.readData(4);return l===p[0]&&c===p[1]&&u===p[2]&&d===p[3]},i.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=i},{"../utils":32,"./DataReader":18}],18:[function(n,r,o){var a=n("../utils");function i(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var l,c=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=s,c},readString:function(s){return a.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},r.exports=i},{"../utils":32}],19:[function(n,r,o){var a=n("./Uint8ArrayReader");function i(s){a.call(this,s)}n("../utils").inherits(i,a),i.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,o){var a=n("./DataReader");function i(s){a.call(this,s)}n("../utils").inherits(i,a),i.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},i.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},i.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},i.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=i},{"../utils":32,"./DataReader":18}],21:[function(n,r,o){var a=n("./ArrayReader");function i(s){a.call(this,s)}n("../utils").inherits(i,a),i.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,o){var a=n("../utils"),i=n("../support"),s=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var p=a.getTypeOf(d);return a.checkSupport(p),p!=="string"||i.uint8array?p==="nodebuffer"?new c(d):i.uint8array?new u(a.transformTo("uint8array",d)):new s(a.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,o){var a=n("./GenericWorker"),i=n("../utils");function s(l){a.call(this,"ConvertWorker to "+l),this.destType=l}i.inherits(s,a),s.prototype.processChunk=function(l){this.push({data:i.transformTo(this.destType,l.data),meta:l.meta})},r.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,o){var a=n("./GenericWorker"),i=n("../crc32");function s(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(s,a),s.prototype.processChunk=function(l){this.streamInfo.crc32=i(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,o){var a=n("../utils"),i=n("./GenericWorker");function s(l){i.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}a.inherits(s,i),s.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}i.prototype.processChunk.call(this,l)},r.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,o){var a=n("../utils"),i=n("./GenericWorker");function s(l){i.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=a.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}a.inherits(s,i),s.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,o){function a(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,s){return this._listeners[i].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,s){if(this._listeners[i])for(var l=0;l<this._listeners[i].length;l++)this._listeners[i][l].call(this,s)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var s=this;return i.on("data",function(l){s.processChunk(l)}),i.on("end",function(){s.end()}),i.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,s){return this.extraStreamInfo[i]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},r.exports=a},{}],29:[function(n,r,o){var a=n("../utils"),i=n("./ConvertWorker"),s=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(v,f){return new u.Promise(function(y,m){var w=[],_=v._internalType,x=v._outputType,E=v._mimeType;v.on("data",function(I,k){w.push(I),f&&f(k)}).on("error",function(I){w=[],m(I)}).on("end",function(){try{var I=function(k,R,D){switch(k){case"blob":return a.newBlob(a.transformTo("arraybuffer",R),D);case"base64":return l.encode(R);default:return a.transformTo(k,R)}}(x,function(k,R){var D,T=0,H=null,j=0;for(D=0;D<R.length;D++)j+=R[D].length;switch(k){case"string":return R.join("");case"array":return Array.prototype.concat.apply([],R);case"uint8array":for(H=new Uint8Array(j),D=0;D<R.length;D++)H.set(R[D],T),T+=R[D].length;return H;case"nodebuffer":return Buffer.concat(R);default:throw new Error("concat : unsupported type '"+k+"'")}}(_,w),E);y(I)}catch(k){m(k)}w=[]}).resume()})}function h(v,f,y){var m=f;switch(f){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=f,this._mimeType=y,a.checkSupport(m),this._worker=v.pipe(new i(m)),v.lock()}catch(w){this._worker=new s("error"),this._worker.error(w)}}h.prototype={accumulate:function(v){return p(this,v)},on:function(v,f){var y=this;return v==="data"?this._worker.on(v,function(m){f.call(y,m.data,m.meta)}):this._worker.on(v,function(){a.delay(f,arguments,y)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},v)}},r.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var a=new ArrayBuffer(0);try{o.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(a),o.blob=i.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!n("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,o){for(var a=n("./utils"),i=n("./support"),s=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function p(){l.call(this,"utf-8 encode")}o.utf8encode=function(h){return i.nodebuffer?s.newBufferFrom(h,"utf-8"):function(v){var f,y,m,w,_,x=v.length,E=0;for(w=0;w<x;w++)(64512&(y=v.charCodeAt(w)))==55296&&w+1<x&&(64512&(m=v.charCodeAt(w+1)))==56320&&(y=65536+(y-55296<<10)+(m-56320),w++),E+=y<128?1:y<2048?2:y<65536?3:4;for(f=i.uint8array?new Uint8Array(E):new Array(E),w=_=0;_<E;w++)(64512&(y=v.charCodeAt(w)))==55296&&w+1<x&&(64512&(m=v.charCodeAt(w+1)))==56320&&(y=65536+(y-55296<<10)+(m-56320),w++),y<128?f[_++]=y:(y<2048?f[_++]=192|y>>>6:(y<65536?f[_++]=224|y>>>12:(f[_++]=240|y>>>18,f[_++]=128|y>>>12&63),f[_++]=128|y>>>6&63),f[_++]=128|63&y);return f}(h)},o.utf8decode=function(h){return i.nodebuffer?a.transformTo("nodebuffer",h).toString("utf-8"):function(v){var f,y,m,w,_=v.length,x=new Array(2*_);for(f=y=0;f<_;)if((m=v[f++])<128)x[y++]=m;else if(4<(w=c[m]))x[y++]=65533,f+=w-1;else{for(m&=w===2?31:w===3?15:7;1<w&&f<_;)m=m<<6|63&v[f++],w--;1<w?x[y++]=65533:m<65536?x[y++]=m:(m-=65536,x[y++]=55296|m>>10&1023,x[y++]=56320|1023&m)}return x.length!==y&&(x.subarray?x=x.subarray(0,y):x.length=y),a.applyFromCharCode(x)}(h=a.transformTo(i.uint8array?"uint8array":"array",h))},a.inherits(d,l),d.prototype.processChunk=function(h){var v=a.transformTo(i.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var f=v;(v=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),v.set(f,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var y=function(w,_){var x;for((_=_||w.length)>w.length&&(_=w.length),x=_-1;0<=x&&(192&w[x])==128;)x--;return x<0||x===0?_:x+c[w[x]]>_?x:_}(v),m=v;y!==v.length&&(i.uint8array?(m=v.subarray(0,y),this.leftOver=v.subarray(y,v.length)):(m=v.slice(0,y),this.leftOver=v.slice(y,v.length))),this.push({data:o.utf8decode(m),meta:h.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=d,a.inherits(p,l),p.prototype.processChunk=function(h){this.push({data:o.utf8encode(h.data),meta:h.meta})},o.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,o){var a=n("./support"),i=n("./base64"),s=n("./nodejsUtils"),l=n("./external");function c(f){return f}function u(f,y){for(var m=0;m<f.length;++m)y[m]=255&f.charCodeAt(m);return y}n("setimmediate"),o.newBlob=function(f,y){o.checkSupport("blob");try{return new Blob([f],{type:y})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(f),m.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(f,y,m){var w=[],_=0,x=f.length;if(x<=m)return String.fromCharCode.apply(null,f);for(;_<x;)y==="array"||y==="nodebuffer"?w.push(String.fromCharCode.apply(null,f.slice(_,Math.min(_+m,x)))):w.push(String.fromCharCode.apply(null,f.subarray(_,Math.min(_+m,x)))),_+=m;return w.join("")},stringifyByChar:function(f){for(var y="",m=0;m<f.length;m++)y+=String.fromCharCode(f[m]);return y},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function p(f){var y=65536,m=o.getTypeOf(f),w=!0;if(m==="uint8array"?w=d.applyCanBeUsed.uint8array:m==="nodebuffer"&&(w=d.applyCanBeUsed.nodebuffer),w)for(;1<y;)try{return d.stringifyByChunk(f,m,y)}catch{y=Math.floor(y/2)}return d.stringifyByChar(f)}function h(f,y){for(var m=0;m<f.length;m++)y[m]=f[m];return y}o.applyFromCharCode=p;var v={};v.string={string:c,array:function(f){return u(f,new Array(f.length))},arraybuffer:function(f){return v.string.uint8array(f).buffer},uint8array:function(f){return u(f,new Uint8Array(f.length))},nodebuffer:function(f){return u(f,s.allocBuffer(f.length))}},v.array={string:p,array:c,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(f)}},v.arraybuffer={string:function(f){return p(new Uint8Array(f))},array:function(f){return h(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:c,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(new Uint8Array(f))}},v.uint8array={string:p,array:function(f){return h(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:c,nodebuffer:function(f){return s.newBufferFrom(f)}},v.nodebuffer={string:p,array:function(f){return h(f,new Array(f.length))},arraybuffer:function(f){return v.nodebuffer.uint8array(f).buffer},uint8array:function(f){return h(f,new Uint8Array(f.length))},nodebuffer:c},o.transformTo=function(f,y){if(y=y||"",!f)return y;o.checkSupport(f);var m=o.getTypeOf(y);return v[m][f](y)},o.resolve=function(f){for(var y=f.split("/"),m=[],w=0;w<y.length;w++){var _=y[w];_==="."||_===""&&w!==0&&w!==y.length-1||(_===".."?m.pop():m.push(_))}return m.join("/")},o.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":a.nodebuffer&&s.isBuffer(f)?"nodebuffer":a.uint8array&&f instanceof Uint8Array?"uint8array":a.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(f){if(!a[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(f){var y,m,w="";for(m=0;m<(f||"").length;m++)w+="\\x"+((y=f.charCodeAt(m))<16?"0":"")+y.toString(16).toUpperCase();return w},o.delay=function(f,y,m){setImmediate(function(){f.apply(m||null,y||[])})},o.inherits=function(f,y){function m(){}m.prototype=y.prototype,f.prototype=new m},o.extend=function(){var f,y,m={};for(f=0;f<arguments.length;f++)for(y in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],y)&&m[y]===void 0&&(m[y]=arguments[f][y]);return m},o.prepareContent=function(f,y,m,w,_){return l.Promise.resolve(y).then(function(x){return a.blob&&(x instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x))!==-1)&&typeof FileReader<"u"?new l.Promise(function(E,I){var k=new FileReader;k.onload=function(R){E(R.target.result)},k.onerror=function(R){I(R.target.error)},k.readAsArrayBuffer(x)}):x}).then(function(x){var E=o.getTypeOf(x);return E?(E==="arraybuffer"?x=o.transformTo("uint8array",x):E==="string"&&(_?x=i.decode(x):m&&w!==!0&&(x=function(I){return u(I,a.uint8array?new Uint8Array(I.length):new Array(I.length))}(x))),x):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,o){var a=n("./reader/readerFor"),i=n("./utils"),s=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(p)+", expected "+i.pretty(d)+")")}},isSignature:function(d,p){var h=this.reader.index;this.reader.setIndex(d);var v=this.reader.readString(4)===p;return this.reader.setIndex(h),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),p=c.uint8array?"uint8array":"array",h=i.transformTo(p,d);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,p,h,v=this.zip64EndOfCentralSize-44;0<v;)d=this.reader.readInt(2),p=this.reader.readInt(4),h=this.reader.readData(p),this.zip64ExtensibleData[d]={id:d,length:p,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,p;for(d=0;d<this.files.length;d++)p=this.files[d],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var p=d;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var v=p-h;if(0<v)this.isSignature(p,s.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(d){this.reader=a(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,o){var a=n("./reader/readerFor"),i=n("./utils"),s=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function p(h,v){this.options=h,this.loadOptions=v}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var v,f;if(h.skip(22),this.fileNameLength=h.readInt(2),f=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(y){for(var m in u)if(Object.prototype.hasOwnProperty.call(u,m)&&u[m].magic===y)return u[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,v,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var v=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(v),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=a(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var v,f,y,m=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<m;)v=h.readInt(2),f=h.readInt(2),y=h.readData(f),this.extraFields[v]={id:v,length:f,value:y};h.setIndex(m)},handleUTF8:function(){var h=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var f=i.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var m=i.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var v=a(h.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:c.utf8decode(v.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var v=a(h.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:c.utf8decode(v.readData(h.length-5))}return null}},r.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,o){function a(v,f,y){this.name=v,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=f,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var i=n("./stream/StreamHelper"),s=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");a.prototype={internalStream:function(v){var f=null,y="string";try{if(!v)throw new Error("No output type specified.");var m=(y=v.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),f=this._decompressWorker();var w=!this._dataBinary;w&&!m&&(f=f.pipe(new l.Utf8EncodeWorker)),!w&&m&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(_){(f=new u("error")).error(_)}return new i(f,y,"")},async:function(v,f){return this.internalStream(v).accumulate(f)},nodeStream:function(v,f){return this.internalStream(v||"nodebuffer").toNodejsStream(f)},_compressWorker:function(v,f){if(this._data instanceof c&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(y,v,f)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new s(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<d.length;h++)a.prototype[d[h]]=p;r.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,o){(function(a){var i,s,l=a.MutationObserver||a.WebKitMutationObserver;if(l){var c=0,u=new l(v),d=a.document.createTextNode("");u.observe(d,{characterData:!0}),i=function(){d.data=c=++c%2}}else if(a.setImmediate||a.MessageChannel===void 0)i="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var f=a.document.createElement("script");f.onreadystatechange=function(){v(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},a.document.documentElement.appendChild(f)}:function(){setTimeout(v,0)};else{var p=new a.MessageChannel;p.port1.onmessage=v,i=function(){p.port2.postMessage(0)}}var h=[];function v(){var f,y;s=!0;for(var m=h.length;m;){for(y=h,h=[],f=-1;++f<m;)y[f]();m=h.length}s=!1}r.exports=function(f){h.push(f)!==1||s||i()}}).call(this,typeof Xn<"u"?Xn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,o){var a=n("immediate");function i(){}var s={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,m!==i&&f(this,m)}function p(m,w,_){this.promise=m,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function h(m,w,_){a(function(){var x;try{x=w(_)}catch(E){return s.reject(m,E)}x===m?s.reject(m,new TypeError("Cannot resolve promise with itself")):s.resolve(m,x)})}function v(m){var w=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof w=="function")return function(){w.apply(m,arguments)}}function f(m,w){var _=!1;function x(k){_||(_=!0,s.reject(m,k))}function E(k){_||(_=!0,s.resolve(m,k))}var I=y(function(){w(E,x)});I.status==="error"&&x(I.value)}function y(m,w){var _={};try{_.value=m(w),_.status="success"}catch(x){_.status="error",_.value=x}return _}(r.exports=d).prototype.finally=function(m){if(typeof m!="function")return this;var w=this.constructor;return this.then(function(_){return w.resolve(m()).then(function(){return _})},function(_){return w.resolve(m()).then(function(){throw _})})},d.prototype.catch=function(m){return this.then(null,m)},d.prototype.then=function(m,w){if(typeof m!="function"&&this.state===c||typeof w!="function"&&this.state===l)return this;var _=new this.constructor(i);return this.state!==u?h(_,this.state===c?m:w,this.outcome):this.queue.push(new p(_,m,w)),_},p.prototype.callFulfilled=function(m){s.resolve(this.promise,m)},p.prototype.otherCallFulfilled=function(m){h(this.promise,this.onFulfilled,m)},p.prototype.callRejected=function(m){s.reject(this.promise,m)},p.prototype.otherCallRejected=function(m){h(this.promise,this.onRejected,m)},s.resolve=function(m,w){var _=y(v,w);if(_.status==="error")return s.reject(m,_.value);var x=_.value;if(x)f(m,x);else{m.state=c,m.outcome=w;for(var E=-1,I=m.queue.length;++E<I;)m.queue[E].callFulfilled(w)}return m},s.reject=function(m,w){m.state=l,m.outcome=w;for(var _=-1,x=m.queue.length;++_<x;)m.queue[_].callRejected(w);return m},d.resolve=function(m){return m instanceof this?m:s.resolve(new this(i),m)},d.reject=function(m){var w=new this(i);return s.reject(w,m)},d.all=function(m){var w=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=m.length,x=!1;if(!_)return this.resolve([]);for(var E=new Array(_),I=0,k=-1,R=new this(i);++k<_;)D(m[k],k);return R;function D(T,H){w.resolve(T).then(function(j){E[H]=j,++I!==_||x||(x=!0,s.resolve(R,E))},function(j){x||(x=!0,s.reject(R,j))})}},d.race=function(m){var w=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=m.length,x=!1;if(!_)return this.resolve([]);for(var E=-1,I=new this(i);++E<_;)k=m[E],w.resolve(k).then(function(R){x||(x=!0,s.resolve(I,R))},function(R){x||(x=!0,s.reject(I,R))});var k;return I}},{immediate:36}],38:[function(n,r,o){var a={};(0,n("./lib/utils/common").assign)(a,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,o){var a=n("./zlib/deflate"),i=n("./utils/common"),s=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,p=-1,h=0,v=8;function f(m){if(!(this instanceof f))return new f(m);this.options=i.assign({level:p,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},m||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var _=a.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(_!==d)throw new Error(l[_]);if(w.header&&a.deflateSetHeader(this.strm,w.header),w.dictionary){var x;if(x=typeof w.dictionary=="string"?s.string2buf(w.dictionary):u.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(_=a.deflateSetDictionary(this.strm,x))!==d)throw new Error(l[_]);this._dict_set=!0}}function y(m,w){var _=new f(w);if(_.push(m,!0),_.err)throw _.msg||l[_.err];return _.result}f.prototype.push=function(m,w){var _,x,E=this.strm,I=this.options.chunkSize;if(this.ended)return!1;x=w===~~w?w:w===!0?4:0,typeof m=="string"?E.input=s.string2buf(m):u.call(m)==="[object ArrayBuffer]"?E.input=new Uint8Array(m):E.input=m,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new i.Buf8(I),E.next_out=0,E.avail_out=I),(_=a.deflate(E,x))!==1&&_!==d)return this.onEnd(_),!(this.ended=!0);E.avail_out!==0&&(E.avail_in!==0||x!==4&&x!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(i.shrinkBuf(E.output,E.next_out))):this.onData(i.shrinkBuf(E.output,E.next_out)))}while((0<E.avail_in||E.avail_out===0)&&_!==1);return x===4?(_=a.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===d):x!==2||(this.onEnd(d),!(E.avail_out=0))},f.prototype.onData=function(m){this.chunks.push(m)},f.prototype.onEnd=function(m){m===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},o.Deflate=f,o.deflate=y,o.deflateRaw=function(m,w){return(w=w||{}).raw=!0,y(m,w)},o.gzip=function(m,w){return(w=w||{}).gzip=!0,y(m,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,o){var a=n("./zlib/inflate"),i=n("./utils/common"),s=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),p=Object.prototype.toString;function h(f){if(!(this instanceof h))return new h(f);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},f||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||f&&f.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&!(15&y.windowBits)&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var m=a.inflateInit2(this.strm,y.windowBits);if(m!==l.Z_OK)throw new Error(c[m]);this.header=new d,a.inflateGetHeader(this.strm,this.header)}function v(f,y){var m=new h(y);if(m.push(f,!0),m.err)throw m.msg||c[m.err];return m.result}h.prototype.push=function(f,y){var m,w,_,x,E,I,k=this.strm,R=this.options.chunkSize,D=this.options.dictionary,T=!1;if(this.ended)return!1;w=y===~~y?y:y===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?k.input=s.binstring2buf(f):p.call(f)==="[object ArrayBuffer]"?k.input=new Uint8Array(f):k.input=f,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new i.Buf8(R),k.next_out=0,k.avail_out=R),(m=a.inflate(k,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&D&&(I=typeof D=="string"?s.string2buf(D):p.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,m=a.inflateSetDictionary(this.strm,I)),m===l.Z_BUF_ERROR&&T===!0&&(m=l.Z_OK,T=!1),m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),!(this.ended=!0);k.next_out&&(k.avail_out!==0&&m!==l.Z_STREAM_END&&(k.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=s.utf8border(k.output,k.next_out),x=k.next_out-_,E=s.buf2string(k.output,_),k.next_out=x,k.avail_out=R-x,x&&i.arraySet(k.output,k.output,_,x,0),this.onData(E)):this.onData(i.shrinkBuf(k.output,k.next_out)))),k.avail_in===0&&k.avail_out===0&&(T=!0)}while((0<k.avail_in||k.avail_out===0)&&m!==l.Z_STREAM_END);return m===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(m=a.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(k.avail_out=0))},h.prototype.onData=function(f){this.chunks.push(f)},h.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},o.Inflate=h,o.inflate=v,o.inflateRaw=function(f,y){return(y=y||{}).raw=!0,v(f,y)},o.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},o.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var i={arraySet:function(l,c,u,d,p){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),p);else for(var h=0;h<d;h++)l[p+h]=c[u+h]},flattenChunks:function(l){var c,u,d,p,h,v;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(v=new Uint8Array(d),c=p=0,u=l.length;c<u;c++)h=l[c],v.set(h,p),p+=h.length;return v}},s={arraySet:function(l,c,u,d,p){for(var h=0;h<d;h++)l[p+h]=c[u+h]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,i)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,s))},o.setTyped(a)},{}],42:[function(n,r,o){var a=n("./common"),i=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new a.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,p){if(p<65537&&(d.subarray&&s||!d.subarray&&i))return String.fromCharCode.apply(null,a.shrinkBuf(d,p));for(var h="",v=0;v<p;v++)h+=String.fromCharCode(d[v]);return h}l[254]=l[254]=1,o.string2buf=function(d){var p,h,v,f,y,m=d.length,w=0;for(f=0;f<m;f++)(64512&(h=d.charCodeAt(f)))==55296&&f+1<m&&(64512&(v=d.charCodeAt(f+1)))==56320&&(h=65536+(h-55296<<10)+(v-56320),f++),w+=h<128?1:h<2048?2:h<65536?3:4;for(p=new a.Buf8(w),f=y=0;y<w;f++)(64512&(h=d.charCodeAt(f)))==55296&&f+1<m&&(64512&(v=d.charCodeAt(f+1)))==56320&&(h=65536+(h-55296<<10)+(v-56320),f++),h<128?p[y++]=h:(h<2048?p[y++]=192|h>>>6:(h<65536?p[y++]=224|h>>>12:(p[y++]=240|h>>>18,p[y++]=128|h>>>12&63),p[y++]=128|h>>>6&63),p[y++]=128|63&h);return p},o.buf2binstring=function(d){return u(d,d.length)},o.binstring2buf=function(d){for(var p=new a.Buf8(d.length),h=0,v=p.length;h<v;h++)p[h]=d.charCodeAt(h);return p},o.buf2string=function(d,p){var h,v,f,y,m=p||d.length,w=new Array(2*m);for(h=v=0;h<m;)if((f=d[h++])<128)w[v++]=f;else if(4<(y=l[f]))w[v++]=65533,h+=y-1;else{for(f&=y===2?31:y===3?15:7;1<y&&h<m;)f=f<<6|63&d[h++],y--;1<y?w[v++]=65533:f<65536?w[v++]=f:(f-=65536,w[v++]=55296|f>>10&1023,w[v++]=56320|1023&f)}return u(w,v)},o.utf8border=function(d,p){var h;for((p=p||d.length)>d.length&&(p=d.length),h=p-1;0<=h&&(192&d[h])==128;)h--;return h<0||h===0?p:h+l[d[h]]>p?h:p}},{"./common":41}],43:[function(n,r,o){r.exports=function(a,i,s,l){for(var c=65535&a|0,u=a>>>16&65535|0,d=0;s!==0;){for(s-=d=2e3<s?2e3:s;u=u+(c=c+i[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,o){var a=function(){for(var i,s=[],l=0;l<256;l++){i=l;for(var c=0;c<8;c++)i=1&i?3988292384^i>>>1:i>>>1;s[l]=i}return s}();r.exports=function(i,s,l,c){var u=a,d=c+l;i^=-1;for(var p=c;p<d;p++)i=i>>>8^u[255&(i^s[p])];return-1^i}},{}],46:[function(n,r,o){var a,i=n("../utils/common"),s=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,p=4,h=0,v=-2,f=-1,y=4,m=2,w=8,_=9,x=286,E=30,I=19,k=2*x+1,R=15,D=3,T=258,H=T+D+1,j=42,L=113,b=1,q=2,te=3,N=4;function ae(g,B){return g.msg=u[B],B}function Z(g){return(g<<1)-(4<g?9:0)}function le(g){for(var B=g.length;0<=--B;)g[B]=0}function K(g){var B=g.state,W=B.pending;W>g.avail_out&&(W=g.avail_out),W!==0&&(i.arraySet(g.output,B.pending_buf,B.pending_out,W,g.next_out),g.next_out+=W,B.pending_out+=W,g.total_out+=W,g.avail_out-=W,B.pending-=W,B.pending===0&&(B.pending_out=0))}function U(g,B){s._tr_flush_block(g,0<=g.block_start?g.block_start:-1,g.strstart-g.block_start,B),g.block_start=g.strstart,K(g.strm)}function re(g,B){g.pending_buf[g.pending++]=B}function M(g,B){g.pending_buf[g.pending++]=B>>>8&255,g.pending_buf[g.pending++]=255&B}function A(g,B){var W,C,S=g.max_chain_length,F=g.strstart,$=g.prev_length,V=g.nice_match,z=g.strstart>g.w_size-H?g.strstart-(g.w_size-H):0,Q=g.window,ee=g.w_mask,Y=g.prev,se=g.strstart+T,be=Q[F+$-1],ye=Q[F+$];g.prev_length>=g.good_match&&(S>>=2),V>g.lookahead&&(V=g.lookahead);do if(Q[(W=B)+$]===ye&&Q[W+$-1]===be&&Q[W]===Q[F]&&Q[++W]===Q[F+1]){F+=2,W++;do;while(Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&F<se);if(C=T-(se-F),F=se-T,$<C){if(g.match_start=B,V<=($=C))break;be=Q[F+$-1],ye=Q[F+$]}}while((B=Y[B&ee])>z&&--S!=0);return $<=g.lookahead?$:g.lookahead}function J(g){var B,W,C,S,F,$,V,z,Q,ee,Y=g.w_size;do{if(S=g.window_size-g.lookahead-g.strstart,g.strstart>=Y+(Y-H)){for(i.arraySet(g.window,g.window,Y,Y,0),g.match_start-=Y,g.strstart-=Y,g.block_start-=Y,B=W=g.hash_size;C=g.head[--B],g.head[B]=Y<=C?C-Y:0,--W;);for(B=W=Y;C=g.prev[--B],g.prev[B]=Y<=C?C-Y:0,--W;);S+=Y}if(g.strm.avail_in===0)break;if($=g.strm,V=g.window,z=g.strstart+g.lookahead,Q=S,ee=void 0,ee=$.avail_in,Q<ee&&(ee=Q),W=ee===0?0:($.avail_in-=ee,i.arraySet(V,$.input,$.next_in,ee,z),$.state.wrap===1?$.adler=l($.adler,V,ee,z):$.state.wrap===2&&($.adler=c($.adler,V,ee,z)),$.next_in+=ee,$.total_in+=ee,ee),g.lookahead+=W,g.lookahead+g.insert>=D)for(F=g.strstart-g.insert,g.ins_h=g.window[F],g.ins_h=(g.ins_h<<g.hash_shift^g.window[F+1])&g.hash_mask;g.insert&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[F+D-1])&g.hash_mask,g.prev[F&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=F,F++,g.insert--,!(g.lookahead+g.insert<D)););}while(g.lookahead<H&&g.strm.avail_in!==0)}function oe(g,B){for(var W,C;;){if(g.lookahead<H){if(J(g),g.lookahead<H&&B===d)return b;if(g.lookahead===0)break}if(W=0,g.lookahead>=D&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+D-1])&g.hash_mask,W=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),W!==0&&g.strstart-W<=g.w_size-H&&(g.match_length=A(g,W)),g.match_length>=D)if(C=s._tr_tally(g,g.strstart-g.match_start,g.match_length-D),g.lookahead-=g.match_length,g.match_length<=g.max_lazy_match&&g.lookahead>=D){for(g.match_length--;g.strstart++,g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+D-1])&g.hash_mask,W=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart,--g.match_length!=0;);g.strstart++}else g.strstart+=g.match_length,g.match_length=0,g.ins_h=g.window[g.strstart],g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+1])&g.hash_mask;else C=s._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++;if(C&&(U(g,!1),g.strm.avail_out===0))return b}return g.insert=g.strstart<D-1?g.strstart:D-1,B===p?(U(g,!0),g.strm.avail_out===0?te:N):g.last_lit&&(U(g,!1),g.strm.avail_out===0)?b:q}function ne(g,B){for(var W,C,S;;){if(g.lookahead<H){if(J(g),g.lookahead<H&&B===d)return b;if(g.lookahead===0)break}if(W=0,g.lookahead>=D&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+D-1])&g.hash_mask,W=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),g.prev_length=g.match_length,g.prev_match=g.match_start,g.match_length=D-1,W!==0&&g.prev_length<g.max_lazy_match&&g.strstart-W<=g.w_size-H&&(g.match_length=A(g,W),g.match_length<=5&&(g.strategy===1||g.match_length===D&&4096<g.strstart-g.match_start)&&(g.match_length=D-1)),g.prev_length>=D&&g.match_length<=g.prev_length){for(S=g.strstart+g.lookahead-D,C=s._tr_tally(g,g.strstart-1-g.prev_match,g.prev_length-D),g.lookahead-=g.prev_length-1,g.prev_length-=2;++g.strstart<=S&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+D-1])&g.hash_mask,W=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),--g.prev_length!=0;);if(g.match_available=0,g.match_length=D-1,g.strstart++,C&&(U(g,!1),g.strm.avail_out===0))return b}else if(g.match_available){if((C=s._tr_tally(g,0,g.window[g.strstart-1]))&&U(g,!1),g.strstart++,g.lookahead--,g.strm.avail_out===0)return b}else g.match_available=1,g.strstart++,g.lookahead--}return g.match_available&&(C=s._tr_tally(g,0,g.window[g.strstart-1]),g.match_available=0),g.insert=g.strstart<D-1?g.strstart:D-1,B===p?(U(g,!0),g.strm.avail_out===0?te:N):g.last_lit&&(U(g,!1),g.strm.avail_out===0)?b:q}function ie(g,B,W,C,S){this.good_length=g,this.max_lazy=B,this.nice_length=W,this.max_chain=C,this.func=S}function ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*k),this.dyn_dtree=new i.Buf16(2*(2*E+1)),this.bl_tree=new i.Buf16(2*(2*I+1)),le(this.dyn_ltree),le(this.dyn_dtree),le(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(R+1),this.heap=new i.Buf16(2*x+1),le(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*x+1),le(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function fe(g){var B;return g&&g.state?(g.total_in=g.total_out=0,g.data_type=m,(B=g.state).pending=0,B.pending_out=0,B.wrap<0&&(B.wrap=-B.wrap),B.status=B.wrap?j:L,g.adler=B.wrap===2?0:1,B.last_flush=d,s._tr_init(B),h):ae(g,v)}function he(g){var B=fe(g);return B===h&&function(W){W.window_size=2*W.w_size,le(W.head),W.max_lazy_match=a[W.level].max_lazy,W.good_match=a[W.level].good_length,W.nice_match=a[W.level].nice_length,W.max_chain_length=a[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=D-1,W.match_available=0,W.ins_h=0}(g.state),B}function ue(g,B,W,C,S,F){if(!g)return v;var $=1;if(B===f&&(B=6),C<0?($=0,C=-C):15<C&&($=2,C-=16),S<1||_<S||W!==w||C<8||15<C||B<0||9<B||F<0||y<F)return ae(g,v);C===8&&(C=9);var V=new ve;return(g.state=V).strm=g,V.wrap=$,V.gzhead=null,V.w_bits=C,V.w_size=1<<V.w_bits,V.w_mask=V.w_size-1,V.hash_bits=S+7,V.hash_size=1<<V.hash_bits,V.hash_mask=V.hash_size-1,V.hash_shift=~~((V.hash_bits+D-1)/D),V.window=new i.Buf8(2*V.w_size),V.head=new i.Buf16(V.hash_size),V.prev=new i.Buf16(V.w_size),V.lit_bufsize=1<<S+6,V.pending_buf_size=4*V.lit_bufsize,V.pending_buf=new i.Buf8(V.pending_buf_size),V.d_buf=1*V.lit_bufsize,V.l_buf=3*V.lit_bufsize,V.level=B,V.strategy=F,V.method=W,he(g)}a=[new ie(0,0,0,0,function(g,B){var W=65535;for(W>g.pending_buf_size-5&&(W=g.pending_buf_size-5);;){if(g.lookahead<=1){if(J(g),g.lookahead===0&&B===d)return b;if(g.lookahead===0)break}g.strstart+=g.lookahead,g.lookahead=0;var C=g.block_start+W;if((g.strstart===0||g.strstart>=C)&&(g.lookahead=g.strstart-C,g.strstart=C,U(g,!1),g.strm.avail_out===0)||g.strstart-g.block_start>=g.w_size-H&&(U(g,!1),g.strm.avail_out===0))return b}return g.insert=0,B===p?(U(g,!0),g.strm.avail_out===0?te:N):(g.strstart>g.block_start&&(U(g,!1),g.strm.avail_out),b)}),new ie(4,4,8,4,oe),new ie(4,5,16,8,oe),new ie(4,6,32,32,oe),new ie(4,4,16,16,ne),new ie(8,16,32,32,ne),new ie(8,16,128,128,ne),new ie(8,32,128,256,ne),new ie(32,128,258,1024,ne),new ie(32,258,258,4096,ne)],o.deflateInit=function(g,B){return ue(g,B,w,15,8,0)},o.deflateInit2=ue,o.deflateReset=he,o.deflateResetKeep=fe,o.deflateSetHeader=function(g,B){return g&&g.state?g.state.wrap!==2?v:(g.state.gzhead=B,h):v},o.deflate=function(g,B){var W,C,S,F;if(!g||!g.state||5<B||B<0)return g?ae(g,v):v;if(C=g.state,!g.output||!g.input&&g.avail_in!==0||C.status===666&&B!==p)return ae(g,g.avail_out===0?-5:v);if(C.strm=g,W=C.last_flush,C.last_flush=B,C.status===j)if(C.wrap===2)g.adler=0,re(C,31),re(C,139),re(C,8),C.gzhead?(re(C,(C.gzhead.text?1:0)+(C.gzhead.hcrc?2:0)+(C.gzhead.extra?4:0)+(C.gzhead.name?8:0)+(C.gzhead.comment?16:0)),re(C,255&C.gzhead.time),re(C,C.gzhead.time>>8&255),re(C,C.gzhead.time>>16&255),re(C,C.gzhead.time>>24&255),re(C,C.level===9?2:2<=C.strategy||C.level<2?4:0),re(C,255&C.gzhead.os),C.gzhead.extra&&C.gzhead.extra.length&&(re(C,255&C.gzhead.extra.length),re(C,C.gzhead.extra.length>>8&255)),C.gzhead.hcrc&&(g.adler=c(g.adler,C.pending_buf,C.pending,0)),C.gzindex=0,C.status=69):(re(C,0),re(C,0),re(C,0),re(C,0),re(C,0),re(C,C.level===9?2:2<=C.strategy||C.level<2?4:0),re(C,3),C.status=L);else{var $=w+(C.w_bits-8<<4)<<8;$|=(2<=C.strategy||C.level<2?0:C.level<6?1:C.level===6?2:3)<<6,C.strstart!==0&&($|=32),$+=31-$%31,C.status=L,M(C,$),C.strstart!==0&&(M(C,g.adler>>>16),M(C,65535&g.adler)),g.adler=1}if(C.status===69)if(C.gzhead.extra){for(S=C.pending;C.gzindex<(65535&C.gzhead.extra.length)&&(C.pending!==C.pending_buf_size||(C.gzhead.hcrc&&C.pending>S&&(g.adler=c(g.adler,C.pending_buf,C.pending-S,S)),K(g),S=C.pending,C.pending!==C.pending_buf_size));)re(C,255&C.gzhead.extra[C.gzindex]),C.gzindex++;C.gzhead.hcrc&&C.pending>S&&(g.adler=c(g.adler,C.pending_buf,C.pending-S,S)),C.gzindex===C.gzhead.extra.length&&(C.gzindex=0,C.status=73)}else C.status=73;if(C.status===73)if(C.gzhead.name){S=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>S&&(g.adler=c(g.adler,C.pending_buf,C.pending-S,S)),K(g),S=C.pending,C.pending===C.pending_buf_size)){F=1;break}F=C.gzindex<C.gzhead.name.length?255&C.gzhead.name.charCodeAt(C.gzindex++):0,re(C,F)}while(F!==0);C.gzhead.hcrc&&C.pending>S&&(g.adler=c(g.adler,C.pending_buf,C.pending-S,S)),F===0&&(C.gzindex=0,C.status=91)}else C.status=91;if(C.status===91)if(C.gzhead.comment){S=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>S&&(g.adler=c(g.adler,C.pending_buf,C.pending-S,S)),K(g),S=C.pending,C.pending===C.pending_buf_size)){F=1;break}F=C.gzindex<C.gzhead.comment.length?255&C.gzhead.comment.charCodeAt(C.gzindex++):0,re(C,F)}while(F!==0);C.gzhead.hcrc&&C.pending>S&&(g.adler=c(g.adler,C.pending_buf,C.pending-S,S)),F===0&&(C.status=103)}else C.status=103;if(C.status===103&&(C.gzhead.hcrc?(C.pending+2>C.pending_buf_size&&K(g),C.pending+2<=C.pending_buf_size&&(re(C,255&g.adler),re(C,g.adler>>8&255),g.adler=0,C.status=L)):C.status=L),C.pending!==0){if(K(g),g.avail_out===0)return C.last_flush=-1,h}else if(g.avail_in===0&&Z(B)<=Z(W)&&B!==p)return ae(g,-5);if(C.status===666&&g.avail_in!==0)return ae(g,-5);if(g.avail_in!==0||C.lookahead!==0||B!==d&&C.status!==666){var V=C.strategy===2?function(z,Q){for(var ee;;){if(z.lookahead===0&&(J(z),z.lookahead===0)){if(Q===d)return b;break}if(z.match_length=0,ee=s._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,ee&&(U(z,!1),z.strm.avail_out===0))return b}return z.insert=0,Q===p?(U(z,!0),z.strm.avail_out===0?te:N):z.last_lit&&(U(z,!1),z.strm.avail_out===0)?b:q}(C,B):C.strategy===3?function(z,Q){for(var ee,Y,se,be,ye=z.window;;){if(z.lookahead<=T){if(J(z),z.lookahead<=T&&Q===d)return b;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=D&&0<z.strstart&&(Y=ye[se=z.strstart-1])===ye[++se]&&Y===ye[++se]&&Y===ye[++se]){be=z.strstart+T;do;while(Y===ye[++se]&&Y===ye[++se]&&Y===ye[++se]&&Y===ye[++se]&&Y===ye[++se]&&Y===ye[++se]&&Y===ye[++se]&&Y===ye[++se]&&se<be);z.match_length=T-(be-se),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=D?(ee=s._tr_tally(z,1,z.match_length-D),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(ee=s._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),ee&&(U(z,!1),z.strm.avail_out===0))return b}return z.insert=0,Q===p?(U(z,!0),z.strm.avail_out===0?te:N):z.last_lit&&(U(z,!1),z.strm.avail_out===0)?b:q}(C,B):a[C.level].func(C,B);if(V!==te&&V!==N||(C.status=666),V===b||V===te)return g.avail_out===0&&(C.last_flush=-1),h;if(V===q&&(B===1?s._tr_align(C):B!==5&&(s._tr_stored_block(C,0,0,!1),B===3&&(le(C.head),C.lookahead===0&&(C.strstart=0,C.block_start=0,C.insert=0))),K(g),g.avail_out===0))return C.last_flush=-1,h}return B!==p?h:C.wrap<=0?1:(C.wrap===2?(re(C,255&g.adler),re(C,g.adler>>8&255),re(C,g.adler>>16&255),re(C,g.adler>>24&255),re(C,255&g.total_in),re(C,g.total_in>>8&255),re(C,g.total_in>>16&255),re(C,g.total_in>>24&255)):(M(C,g.adler>>>16),M(C,65535&g.adler)),K(g),0<C.wrap&&(C.wrap=-C.wrap),C.pending!==0?h:1)},o.deflateEnd=function(g){var B;return g&&g.state?(B=g.state.status)!==j&&B!==69&&B!==73&&B!==91&&B!==103&&B!==L&&B!==666?ae(g,v):(g.state=null,B===L?ae(g,-3):h):v},o.deflateSetDictionary=function(g,B){var W,C,S,F,$,V,z,Q,ee=B.length;if(!g||!g.state||(F=(W=g.state).wrap)===2||F===1&&W.status!==j||W.lookahead)return v;for(F===1&&(g.adler=l(g.adler,B,ee,0)),W.wrap=0,ee>=W.w_size&&(F===0&&(le(W.head),W.strstart=0,W.block_start=0,W.insert=0),Q=new i.Buf8(W.w_size),i.arraySet(Q,B,ee-W.w_size,W.w_size,0),B=Q,ee=W.w_size),$=g.avail_in,V=g.next_in,z=g.input,g.avail_in=ee,g.next_in=0,g.input=B,J(W);W.lookahead>=D;){for(C=W.strstart,S=W.lookahead-(D-1);W.ins_h=(W.ins_h<<W.hash_shift^W.window[C+D-1])&W.hash_mask,W.prev[C&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=C,C++,--S;);W.strstart=C,W.lookahead=D-1,J(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=D-1,W.match_available=0,g.next_in=V,g.input=z,g.avail_in=$,W.wrap=F,h},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,o){r.exports=function(a,i){var s,l,c,u,d,p,h,v,f,y,m,w,_,x,E,I,k,R,D,T,H,j,L,b,q;s=a.state,l=a.next_in,b=a.input,c=l+(a.avail_in-5),u=a.next_out,q=a.output,d=u-(i-a.avail_out),p=u+(a.avail_out-257),h=s.dmax,v=s.wsize,f=s.whave,y=s.wnext,m=s.window,w=s.hold,_=s.bits,x=s.lencode,E=s.distcode,I=(1<<s.lenbits)-1,k=(1<<s.distbits)-1;e:do{_<15&&(w+=b[l++]<<_,_+=8,w+=b[l++]<<_,_+=8),R=x[w&I];t:for(;;){if(w>>>=D=R>>>24,_-=D,(D=R>>>16&255)===0)q[u++]=65535&R;else{if(!(16&D)){if(!(64&D)){R=x[(65535&R)+(w&(1<<D)-1)];continue t}if(32&D){s.mode=12;break e}a.msg="invalid literal/length code",s.mode=30;break e}T=65535&R,(D&=15)&&(_<D&&(w+=b[l++]<<_,_+=8),T+=w&(1<<D)-1,w>>>=D,_-=D),_<15&&(w+=b[l++]<<_,_+=8,w+=b[l++]<<_,_+=8),R=E[w&k];n:for(;;){if(w>>>=D=R>>>24,_-=D,!(16&(D=R>>>16&255))){if(!(64&D)){R=E[(65535&R)+(w&(1<<D)-1)];continue n}a.msg="invalid distance code",s.mode=30;break e}if(H=65535&R,_<(D&=15)&&(w+=b[l++]<<_,(_+=8)<D&&(w+=b[l++]<<_,_+=8)),h<(H+=w&(1<<D)-1)){a.msg="invalid distance too far back",s.mode=30;break e}if(w>>>=D,_-=D,(D=u-d)<H){if(f<(D=H-D)&&s.sane){a.msg="invalid distance too far back",s.mode=30;break e}if(L=m,(j=0)===y){if(j+=v-D,D<T){for(T-=D;q[u++]=m[j++],--D;);j=u-H,L=q}}else if(y<D){if(j+=v+y-D,(D-=y)<T){for(T-=D;q[u++]=m[j++],--D;);if(j=0,y<T){for(T-=D=y;q[u++]=m[j++],--D;);j=u-H,L=q}}}else if(j+=y-D,D<T){for(T-=D;q[u++]=m[j++],--D;);j=u-H,L=q}for(;2<T;)q[u++]=L[j++],q[u++]=L[j++],q[u++]=L[j++],T-=3;T&&(q[u++]=L[j++],1<T&&(q[u++]=L[j++]))}else{for(j=u-H;q[u++]=q[j++],q[u++]=q[j++],q[u++]=q[j++],2<(T-=3););T&&(q[u++]=q[j++],1<T&&(q[u++]=q[j++]))}break}}break}}while(l<c&&u<p);l-=T=_>>3,w&=(1<<(_-=T<<3))-1,a.next_in=l,a.next_out=u,a.avail_in=l<c?c-l+5:5-(l-c),a.avail_out=u<p?p-u+257:257-(u-p),s.hold=w,s.bits=_}},{}],49:[function(n,r,o){var a=n("../utils/common"),i=n("./adler32"),s=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,p=0,h=-2,v=1,f=852,y=592;function m(j){return(j>>>24&255)+(j>>>8&65280)+((65280&j)<<8)+((255&j)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(j){var L;return j&&j.state?(L=j.state,j.total_in=j.total_out=L.total=0,j.msg="",L.wrap&&(j.adler=1&L.wrap),L.mode=v,L.last=0,L.havedict=0,L.dmax=32768,L.head=null,L.hold=0,L.bits=0,L.lencode=L.lendyn=new a.Buf32(f),L.distcode=L.distdyn=new a.Buf32(y),L.sane=1,L.back=-1,p):h}function x(j){var L;return j&&j.state?((L=j.state).wsize=0,L.whave=0,L.wnext=0,_(j)):h}function E(j,L){var b,q;return j&&j.state?(q=j.state,L<0?(b=0,L=-L):(b=1+(L>>4),L<48&&(L&=15)),L&&(L<8||15<L)?h:(q.window!==null&&q.wbits!==L&&(q.window=null),q.wrap=b,q.wbits=L,x(j))):h}function I(j,L){var b,q;return j?(q=new w,(j.state=q).window=null,(b=E(j,L))!==p&&(j.state=null),b):h}var k,R,D=!0;function T(j){if(D){var L;for(k=new a.Buf32(512),R=new a.Buf32(32),L=0;L<144;)j.lens[L++]=8;for(;L<256;)j.lens[L++]=9;for(;L<280;)j.lens[L++]=7;for(;L<288;)j.lens[L++]=8;for(c(u,j.lens,0,288,k,0,j.work,{bits:9}),L=0;L<32;)j.lens[L++]=5;c(d,j.lens,0,32,R,0,j.work,{bits:5}),D=!1}j.lencode=k,j.lenbits=9,j.distcode=R,j.distbits=5}function H(j,L,b,q){var te,N=j.state;return N.window===null&&(N.wsize=1<<N.wbits,N.wnext=0,N.whave=0,N.window=new a.Buf8(N.wsize)),q>=N.wsize?(a.arraySet(N.window,L,b-N.wsize,N.wsize,0),N.wnext=0,N.whave=N.wsize):(q<(te=N.wsize-N.wnext)&&(te=q),a.arraySet(N.window,L,b-q,te,N.wnext),(q-=te)?(a.arraySet(N.window,L,b-q,q,0),N.wnext=q,N.whave=N.wsize):(N.wnext+=te,N.wnext===N.wsize&&(N.wnext=0),N.whave<N.wsize&&(N.whave+=te))),0}o.inflateReset=x,o.inflateReset2=E,o.inflateResetKeep=_,o.inflateInit=function(j){return I(j,15)},o.inflateInit2=I,o.inflate=function(j,L){var b,q,te,N,ae,Z,le,K,U,re,M,A,J,oe,ne,ie,ve,fe,he,ue,g,B,W,C,S=0,F=new a.Buf8(4),$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return h;(b=j.state).mode===12&&(b.mode=13),ae=j.next_out,te=j.output,le=j.avail_out,N=j.next_in,q=j.input,Z=j.avail_in,K=b.hold,U=b.bits,re=Z,M=le,B=p;e:for(;;)switch(b.mode){case v:if(b.wrap===0){b.mode=13;break}for(;U<16;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if(2&b.wrap&&K===35615){F[b.check=0]=255&K,F[1]=K>>>8&255,b.check=s(b.check,F,2,0),U=K=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&K)<<8)+(K>>8))%31){j.msg="incorrect header check",b.mode=30;break}if((15&K)!=8){j.msg="unknown compression method",b.mode=30;break}if(U-=4,g=8+(15&(K>>>=4)),b.wbits===0)b.wbits=g;else if(g>b.wbits){j.msg="invalid window size",b.mode=30;break}b.dmax=1<<g,j.adler=b.check=1,b.mode=512&K?10:12,U=K=0;break;case 2:for(;U<16;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if(b.flags=K,(255&b.flags)!=8){j.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){j.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=K>>8&1),512&b.flags&&(F[0]=255&K,F[1]=K>>>8&255,b.check=s(b.check,F,2,0)),U=K=0,b.mode=3;case 3:for(;U<32;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}b.head&&(b.head.time=K),512&b.flags&&(F[0]=255&K,F[1]=K>>>8&255,F[2]=K>>>16&255,F[3]=K>>>24&255,b.check=s(b.check,F,4,0)),U=K=0,b.mode=4;case 4:for(;U<16;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}b.head&&(b.head.xflags=255&K,b.head.os=K>>8),512&b.flags&&(F[0]=255&K,F[1]=K>>>8&255,b.check=s(b.check,F,2,0)),U=K=0,b.mode=5;case 5:if(1024&b.flags){for(;U<16;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}b.length=K,b.head&&(b.head.extra_len=K),512&b.flags&&(F[0]=255&K,F[1]=K>>>8&255,b.check=s(b.check,F,2,0)),U=K=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(Z<(A=b.length)&&(A=Z),A&&(b.head&&(g=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),a.arraySet(b.head.extra,q,N,A,g)),512&b.flags&&(b.check=s(b.check,q,A,N)),Z-=A,N+=A,b.length-=A),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(Z===0)break e;for(A=0;g=q[N+A++],b.head&&g&&b.length<65536&&(b.head.name+=String.fromCharCode(g)),g&&A<Z;);if(512&b.flags&&(b.check=s(b.check,q,A,N)),Z-=A,N+=A,g)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(Z===0)break e;for(A=0;g=q[N+A++],b.head&&g&&b.length<65536&&(b.head.comment+=String.fromCharCode(g)),g&&A<Z;);if(512&b.flags&&(b.check=s(b.check,q,A,N)),Z-=A,N+=A,g)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;U<16;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if(K!==(65535&b.check)){j.msg="header crc mismatch",b.mode=30;break}U=K=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),j.adler=b.check=0,b.mode=12;break;case 10:for(;U<32;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}j.adler=b.check=m(K),U=K=0,b.mode=11;case 11:if(b.havedict===0)return j.next_out=ae,j.avail_out=le,j.next_in=N,j.avail_in=Z,b.hold=K,b.bits=U,2;j.adler=b.check=1,b.mode=12;case 12:if(L===5||L===6)break e;case 13:if(b.last){K>>>=7&U,U-=7&U,b.mode=27;break}for(;U<3;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}switch(b.last=1&K,U-=1,3&(K>>>=1)){case 0:b.mode=14;break;case 1:if(T(b),b.mode=20,L!==6)break;K>>>=2,U-=2;break e;case 2:b.mode=17;break;case 3:j.msg="invalid block type",b.mode=30}K>>>=2,U-=2;break;case 14:for(K>>>=7&U,U-=7&U;U<32;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if((65535&K)!=(K>>>16^65535)){j.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&K,U=K=0,b.mode=15,L===6)break e;case 15:b.mode=16;case 16:if(A=b.length){if(Z<A&&(A=Z),le<A&&(A=le),A===0)break e;a.arraySet(te,q,N,A,ae),Z-=A,N+=A,le-=A,ae+=A,b.length-=A;break}b.mode=12;break;case 17:for(;U<14;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if(b.nlen=257+(31&K),K>>>=5,U-=5,b.ndist=1+(31&K),K>>>=5,U-=5,b.ncode=4+(15&K),K>>>=4,U-=4,286<b.nlen||30<b.ndist){j.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;U<3;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}b.lens[$[b.have++]]=7&K,K>>>=3,U-=3}for(;b.have<19;)b.lens[$[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,W={bits:b.lenbits},B=c(0,b.lens,0,19,b.lencode,0,b.work,W),b.lenbits=W.bits,B){j.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;ie=(S=b.lencode[K&(1<<b.lenbits)-1])>>>16&255,ve=65535&S,!((ne=S>>>24)<=U);){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if(ve<16)K>>>=ne,U-=ne,b.lens[b.have++]=ve;else{if(ve===16){for(C=ne+2;U<C;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if(K>>>=ne,U-=ne,b.have===0){j.msg="invalid bit length repeat",b.mode=30;break}g=b.lens[b.have-1],A=3+(3&K),K>>>=2,U-=2}else if(ve===17){for(C=ne+3;U<C;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}U-=ne,g=0,A=3+(7&(K>>>=ne)),K>>>=3,U-=3}else{for(C=ne+7;U<C;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}U-=ne,g=0,A=11+(127&(K>>>=ne)),K>>>=7,U-=7}if(b.have+A>b.nlen+b.ndist){j.msg="invalid bit length repeat",b.mode=30;break}for(;A--;)b.lens[b.have++]=g}}if(b.mode===30)break;if(b.lens[256]===0){j.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,W={bits:b.lenbits},B=c(u,b.lens,0,b.nlen,b.lencode,0,b.work,W),b.lenbits=W.bits,B){j.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,W={bits:b.distbits},B=c(d,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,W),b.distbits=W.bits,B){j.msg="invalid distances set",b.mode=30;break}if(b.mode=20,L===6)break e;case 20:b.mode=21;case 21:if(6<=Z&&258<=le){j.next_out=ae,j.avail_out=le,j.next_in=N,j.avail_in=Z,b.hold=K,b.bits=U,l(j,M),ae=j.next_out,te=j.output,le=j.avail_out,N=j.next_in,q=j.input,Z=j.avail_in,K=b.hold,U=b.bits,b.mode===12&&(b.back=-1);break}for(b.back=0;ie=(S=b.lencode[K&(1<<b.lenbits)-1])>>>16&255,ve=65535&S,!((ne=S>>>24)<=U);){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if(ie&&!(240&ie)){for(fe=ne,he=ie,ue=ve;ie=(S=b.lencode[ue+((K&(1<<fe+he)-1)>>fe)])>>>16&255,ve=65535&S,!(fe+(ne=S>>>24)<=U);){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}K>>>=fe,U-=fe,b.back+=fe}if(K>>>=ne,U-=ne,b.back+=ne,b.length=ve,ie===0){b.mode=26;break}if(32&ie){b.back=-1,b.mode=12;break}if(64&ie){j.msg="invalid literal/length code",b.mode=30;break}b.extra=15&ie,b.mode=22;case 22:if(b.extra){for(C=b.extra;U<C;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}b.length+=K&(1<<b.extra)-1,K>>>=b.extra,U-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;ie=(S=b.distcode[K&(1<<b.distbits)-1])>>>16&255,ve=65535&S,!((ne=S>>>24)<=U);){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if(!(240&ie)){for(fe=ne,he=ie,ue=ve;ie=(S=b.distcode[ue+((K&(1<<fe+he)-1)>>fe)])>>>16&255,ve=65535&S,!(fe+(ne=S>>>24)<=U);){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}K>>>=fe,U-=fe,b.back+=fe}if(K>>>=ne,U-=ne,b.back+=ne,64&ie){j.msg="invalid distance code",b.mode=30;break}b.offset=ve,b.extra=15&ie,b.mode=24;case 24:if(b.extra){for(C=b.extra;U<C;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}b.offset+=K&(1<<b.extra)-1,K>>>=b.extra,U-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){j.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(le===0)break e;if(A=M-le,b.offset>A){if((A=b.offset-A)>b.whave&&b.sane){j.msg="invalid distance too far back",b.mode=30;break}J=A>b.wnext?(A-=b.wnext,b.wsize-A):b.wnext-A,A>b.length&&(A=b.length),oe=b.window}else oe=te,J=ae-b.offset,A=b.length;for(le<A&&(A=le),le-=A,b.length-=A;te[ae++]=oe[J++],--A;);b.length===0&&(b.mode=21);break;case 26:if(le===0)break e;te[ae++]=b.length,le--,b.mode=21;break;case 27:if(b.wrap){for(;U<32;){if(Z===0)break e;Z--,K|=q[N++]<<U,U+=8}if(M-=le,j.total_out+=M,b.total+=M,M&&(j.adler=b.check=b.flags?s(b.check,te,M,ae-M):i(b.check,te,M,ae-M)),M=le,(b.flags?K:m(K))!==b.check){j.msg="incorrect data check",b.mode=30;break}U=K=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;U<32;){if(Z===0)break e;Z--,K+=q[N++]<<U,U+=8}if(K!==(4294967295&b.total)){j.msg="incorrect length check",b.mode=30;break}U=K=0}b.mode=29;case 29:B=1;break e;case 30:B=-3;break e;case 31:return-4;case 32:default:return h}return j.next_out=ae,j.avail_out=le,j.next_in=N,j.avail_in=Z,b.hold=K,b.bits=U,(b.wsize||M!==j.avail_out&&b.mode<30&&(b.mode<27||L!==4))&&H(j,j.output,j.next_out,M-j.avail_out)?(b.mode=31,-4):(re-=j.avail_in,M-=j.avail_out,j.total_in+=re,j.total_out+=M,b.total+=M,b.wrap&&M&&(j.adler=b.check=b.flags?s(b.check,te,M,j.next_out-M):i(b.check,te,M,j.next_out-M)),j.data_type=b.bits+(b.last?64:0)+(b.mode===12?128:0)+(b.mode===20||b.mode===15?256:0),(re==0&&M===0||L===4)&&B===p&&(B=-5),B)},o.inflateEnd=function(j){if(!j||!j.state)return h;var L=j.state;return L.window&&(L.window=null),j.state=null,p},o.inflateGetHeader=function(j,L){var b;return j&&j.state&&2&(b=j.state).wrap?((b.head=L).done=!1,p):h},o.inflateSetDictionary=function(j,L){var b,q=L.length;return j&&j.state?(b=j.state).wrap!==0&&b.mode!==11?h:b.mode===11&&i(1,L,q,0)!==b.check?-3:H(j,L,q,q)?(b.mode=31,-4):(b.havedict=1,p):h},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,o){var a=n("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,p,h,v,f,y,m){var w,_,x,E,I,k,R,D,T,H=m.bits,j=0,L=0,b=0,q=0,te=0,N=0,ae=0,Z=0,le=0,K=0,U=null,re=0,M=new a.Buf16(16),A=new a.Buf16(16),J=null,oe=0;for(j=0;j<=15;j++)M[j]=0;for(L=0;L<h;L++)M[d[p+L]]++;for(te=H,q=15;1<=q&&M[q]===0;q--);if(q<te&&(te=q),q===0)return v[f++]=20971520,v[f++]=20971520,m.bits=1,0;for(b=1;b<q&&M[b]===0;b++);for(te<b&&(te=b),j=Z=1;j<=15;j++)if(Z<<=1,(Z-=M[j])<0)return-1;if(0<Z&&(u===0||q!==1))return-1;for(A[1]=0,j=1;j<15;j++)A[j+1]=A[j]+M[j];for(L=0;L<h;L++)d[p+L]!==0&&(y[A[d[p+L]]++]=L);if(k=u===0?(U=J=y,19):u===1?(U=i,re-=257,J=s,oe-=257,256):(U=l,J=c,-1),j=b,I=f,ae=L=K=0,x=-1,E=(le=1<<(N=te))-1,u===1&&852<le||u===2&&592<le)return 1;for(;;){for(R=j-ae,T=y[L]<k?(D=0,y[L]):y[L]>k?(D=J[oe+y[L]],U[re+y[L]]):(D=96,0),w=1<<j-ae,b=_=1<<N;v[I+(K>>ae)+(_-=w)]=R<<24|D<<16|T|0,_!==0;);for(w=1<<j-1;K&w;)w>>=1;if(w!==0?(K&=w-1,K+=w):K=0,L++,--M[j]==0){if(j===q)break;j=d[p+y[L]]}if(te<j&&(K&E)!==x){for(ae===0&&(ae=te),I+=b,Z=1<<(N=j-ae);N+ae<q&&!((Z-=M[N+ae])<=0);)N++,Z<<=1;if(le+=1<<N,u===1&&852<le||u===2&&592<le)return 1;v[x=K&E]=te<<24|N<<16|I-f|0}}return K!==0&&(v[I+K]=j-ae<<24|64<<16|0),m.bits=te,0}},{"../utils/common":41}],51:[function(n,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,o){var a=n("../utils/common"),i=0,s=1;function l(S){for(var F=S.length;0<=--F;)S[F]=0}var c=0,u=29,d=256,p=d+1+u,h=30,v=19,f=2*p+1,y=15,m=16,w=7,_=256,x=16,E=17,I=18,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=new Array(2*(p+2));l(H);var j=new Array(2*h);l(j);var L=new Array(512);l(L);var b=new Array(256);l(b);var q=new Array(u);l(q);var te,N,ae,Z=new Array(h);function le(S,F,$,V,z){this.static_tree=S,this.extra_bits=F,this.extra_base=$,this.elems=V,this.max_length=z,this.has_stree=S&&S.length}function K(S,F){this.dyn_tree=S,this.max_code=0,this.stat_desc=F}function U(S){return S<256?L[S]:L[256+(S>>>7)]}function re(S,F){S.pending_buf[S.pending++]=255&F,S.pending_buf[S.pending++]=F>>>8&255}function M(S,F,$){S.bi_valid>m-$?(S.bi_buf|=F<<S.bi_valid&65535,re(S,S.bi_buf),S.bi_buf=F>>m-S.bi_valid,S.bi_valid+=$-m):(S.bi_buf|=F<<S.bi_valid&65535,S.bi_valid+=$)}function A(S,F,$){M(S,$[2*F],$[2*F+1])}function J(S,F){for(var $=0;$|=1&S,S>>>=1,$<<=1,0<--F;);return $>>>1}function oe(S,F,$){var V,z,Q=new Array(y+1),ee=0;for(V=1;V<=y;V++)Q[V]=ee=ee+$[V-1]<<1;for(z=0;z<=F;z++){var Y=S[2*z+1];Y!==0&&(S[2*z]=J(Q[Y]++,Y))}}function ne(S){var F;for(F=0;F<p;F++)S.dyn_ltree[2*F]=0;for(F=0;F<h;F++)S.dyn_dtree[2*F]=0;for(F=0;F<v;F++)S.bl_tree[2*F]=0;S.dyn_ltree[2*_]=1,S.opt_len=S.static_len=0,S.last_lit=S.matches=0}function ie(S){8<S.bi_valid?re(S,S.bi_buf):0<S.bi_valid&&(S.pending_buf[S.pending++]=S.bi_buf),S.bi_buf=0,S.bi_valid=0}function ve(S,F,$,V){var z=2*F,Q=2*$;return S[z]<S[Q]||S[z]===S[Q]&&V[F]<=V[$]}function fe(S,F,$){for(var V=S.heap[$],z=$<<1;z<=S.heap_len&&(z<S.heap_len&&ve(F,S.heap[z+1],S.heap[z],S.depth)&&z++,!ve(F,V,S.heap[z],S.depth));)S.heap[$]=S.heap[z],$=z,z<<=1;S.heap[$]=V}function he(S,F,$){var V,z,Q,ee,Y=0;if(S.last_lit!==0)for(;V=S.pending_buf[S.d_buf+2*Y]<<8|S.pending_buf[S.d_buf+2*Y+1],z=S.pending_buf[S.l_buf+Y],Y++,V===0?A(S,z,F):(A(S,(Q=b[z])+d+1,F),(ee=k[Q])!==0&&M(S,z-=q[Q],ee),A(S,Q=U(--V),$),(ee=R[Q])!==0&&M(S,V-=Z[Q],ee)),Y<S.last_lit;);A(S,_,F)}function ue(S,F){var $,V,z,Q=F.dyn_tree,ee=F.stat_desc.static_tree,Y=F.stat_desc.has_stree,se=F.stat_desc.elems,be=-1;for(S.heap_len=0,S.heap_max=f,$=0;$<se;$++)Q[2*$]!==0?(S.heap[++S.heap_len]=be=$,S.depth[$]=0):Q[2*$+1]=0;for(;S.heap_len<2;)Q[2*(z=S.heap[++S.heap_len]=be<2?++be:0)]=1,S.depth[z]=0,S.opt_len--,Y&&(S.static_len-=ee[2*z+1]);for(F.max_code=be,$=S.heap_len>>1;1<=$;$--)fe(S,Q,$);for(z=se;$=S.heap[1],S.heap[1]=S.heap[S.heap_len--],fe(S,Q,1),V=S.heap[1],S.heap[--S.heap_max]=$,S.heap[--S.heap_max]=V,Q[2*z]=Q[2*$]+Q[2*V],S.depth[z]=(S.depth[$]>=S.depth[V]?S.depth[$]:S.depth[V])+1,Q[2*$+1]=Q[2*V+1]=z,S.heap[1]=z++,fe(S,Q,1),2<=S.heap_len;);S.heap[--S.heap_max]=S.heap[1],function(ye,pe){var Ae,De,ot,Ne,Jn,ro,dt=pe.dyn_tree,Ja=pe.max_code,_l=pe.stat_desc.static_tree,xl=pe.stat_desc.has_stree,kl=pe.stat_desc.extra_bits,Ya=pe.stat_desc.extra_base,vn=pe.stat_desc.max_length,Yn=0;for(Ne=0;Ne<=y;Ne++)ye.bl_count[Ne]=0;for(dt[2*ye.heap[ye.heap_max]+1]=0,Ae=ye.heap_max+1;Ae<f;Ae++)vn<(Ne=dt[2*dt[2*(De=ye.heap[Ae])+1]+1]+1)&&(Ne=vn,Yn++),dt[2*De+1]=Ne,Ja<De||(ye.bl_count[Ne]++,Jn=0,Ya<=De&&(Jn=kl[De-Ya]),ro=dt[2*De],ye.opt_len+=ro*(Ne+Jn),xl&&(ye.static_len+=ro*(_l[2*De+1]+Jn)));if(Yn!==0){do{for(Ne=vn-1;ye.bl_count[Ne]===0;)Ne--;ye.bl_count[Ne]--,ye.bl_count[Ne+1]+=2,ye.bl_count[vn]--,Yn-=2}while(0<Yn);for(Ne=vn;Ne!==0;Ne--)for(De=ye.bl_count[Ne];De!==0;)Ja<(ot=ye.heap[--Ae])||(dt[2*ot+1]!==Ne&&(ye.opt_len+=(Ne-dt[2*ot+1])*dt[2*ot],dt[2*ot+1]=Ne),De--)}}(S,F),oe(Q,be,S.bl_count)}function g(S,F,$){var V,z,Q=-1,ee=F[1],Y=0,se=7,be=4;for(ee===0&&(se=138,be=3),F[2*($+1)+1]=65535,V=0;V<=$;V++)z=ee,ee=F[2*(V+1)+1],++Y<se&&z===ee||(Y<be?S.bl_tree[2*z]+=Y:z!==0?(z!==Q&&S.bl_tree[2*z]++,S.bl_tree[2*x]++):Y<=10?S.bl_tree[2*E]++:S.bl_tree[2*I]++,Q=z,be=(Y=0)===ee?(se=138,3):z===ee?(se=6,3):(se=7,4))}function B(S,F,$){var V,z,Q=-1,ee=F[1],Y=0,se=7,be=4;for(ee===0&&(se=138,be=3),V=0;V<=$;V++)if(z=ee,ee=F[2*(V+1)+1],!(++Y<se&&z===ee)){if(Y<be)for(;A(S,z,S.bl_tree),--Y!=0;);else z!==0?(z!==Q&&(A(S,z,S.bl_tree),Y--),A(S,x,S.bl_tree),M(S,Y-3,2)):Y<=10?(A(S,E,S.bl_tree),M(S,Y-3,3)):(A(S,I,S.bl_tree),M(S,Y-11,7));Q=z,be=(Y=0)===ee?(se=138,3):z===ee?(se=6,3):(se=7,4)}}l(Z);var W=!1;function C(S,F,$,V){M(S,(c<<1)+(V?1:0),3),function(z,Q,ee,Y){ie(z),Y&&(re(z,ee),re(z,~ee)),a.arraySet(z.pending_buf,z.window,Q,ee,z.pending),z.pending+=ee}(S,F,$,!0)}o._tr_init=function(S){W||(function(){var F,$,V,z,Q,ee=new Array(y+1);for(z=V=0;z<u-1;z++)for(q[z]=V,F=0;F<1<<k[z];F++)b[V++]=z;for(b[V-1]=z,z=Q=0;z<16;z++)for(Z[z]=Q,F=0;F<1<<R[z];F++)L[Q++]=z;for(Q>>=7;z<h;z++)for(Z[z]=Q<<7,F=0;F<1<<R[z]-7;F++)L[256+Q++]=z;for($=0;$<=y;$++)ee[$]=0;for(F=0;F<=143;)H[2*F+1]=8,F++,ee[8]++;for(;F<=255;)H[2*F+1]=9,F++,ee[9]++;for(;F<=279;)H[2*F+1]=7,F++,ee[7]++;for(;F<=287;)H[2*F+1]=8,F++,ee[8]++;for(oe(H,p+1,ee),F=0;F<h;F++)j[2*F+1]=5,j[2*F]=J(F,5);te=new le(H,k,d+1,p,y),N=new le(j,R,0,h,y),ae=new le(new Array(0),D,0,v,w)}(),W=!0),S.l_desc=new K(S.dyn_ltree,te),S.d_desc=new K(S.dyn_dtree,N),S.bl_desc=new K(S.bl_tree,ae),S.bi_buf=0,S.bi_valid=0,ne(S)},o._tr_stored_block=C,o._tr_flush_block=function(S,F,$,V){var z,Q,ee=0;0<S.level?(S.strm.data_type===2&&(S.strm.data_type=function(Y){var se,be=4093624447;for(se=0;se<=31;se++,be>>>=1)if(1&be&&Y.dyn_ltree[2*se]!==0)return i;if(Y.dyn_ltree[18]!==0||Y.dyn_ltree[20]!==0||Y.dyn_ltree[26]!==0)return s;for(se=32;se<d;se++)if(Y.dyn_ltree[2*se]!==0)return s;return i}(S)),ue(S,S.l_desc),ue(S,S.d_desc),ee=function(Y){var se;for(g(Y,Y.dyn_ltree,Y.l_desc.max_code),g(Y,Y.dyn_dtree,Y.d_desc.max_code),ue(Y,Y.bl_desc),se=v-1;3<=se&&Y.bl_tree[2*T[se]+1]===0;se--);return Y.opt_len+=3*(se+1)+5+5+4,se}(S),z=S.opt_len+3+7>>>3,(Q=S.static_len+3+7>>>3)<=z&&(z=Q)):z=Q=$+5,$+4<=z&&F!==-1?C(S,F,$,V):S.strategy===4||Q===z?(M(S,2+(V?1:0),3),he(S,H,j)):(M(S,4+(V?1:0),3),function(Y,se,be,ye){var pe;for(M(Y,se-257,5),M(Y,be-1,5),M(Y,ye-4,4),pe=0;pe<ye;pe++)M(Y,Y.bl_tree[2*T[pe]+1],3);B(Y,Y.dyn_ltree,se-1),B(Y,Y.dyn_dtree,be-1)}(S,S.l_desc.max_code+1,S.d_desc.max_code+1,ee+1),he(S,S.dyn_ltree,S.dyn_dtree)),ne(S),V&&ie(S)},o._tr_tally=function(S,F,$){return S.pending_buf[S.d_buf+2*S.last_lit]=F>>>8&255,S.pending_buf[S.d_buf+2*S.last_lit+1]=255&F,S.pending_buf[S.l_buf+S.last_lit]=255&$,S.last_lit++,F===0?S.dyn_ltree[2*$]++:(S.matches++,F--,S.dyn_ltree[2*(b[$]+d+1)]++,S.dyn_dtree[2*U(F)]++),S.last_lit===S.lit_bufsize-1},o._tr_align=function(S){M(S,2,3),A(S,_,H),function(F){F.bi_valid===16?(re(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):8<=F.bi_valid&&(F.pending_buf[F.pending++]=255&F.bi_buf,F.bi_buf>>=8,F.bi_valid-=8)}(S)}},{"../utils/common":41}],53:[function(n,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,o){(function(a){(function(i,s){if(!i.setImmediate){var l,c,u,d,p=1,h={},v=!1,f=i.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(i);y=y&&y.setTimeout?y:i,l={}.toString.call(i.process)==="[object process]"?function(x){process.nextTick(function(){w(x)})}:function(){if(i.postMessage&&!i.importScripts){var x=!0,E=i.onmessage;return i.onmessage=function(){x=!1},i.postMessage("","*"),i.onmessage=E,x}}()?(d="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",_,!1):i.attachEvent("onmessage",_),function(x){i.postMessage(d+x,"*")}):i.MessageChannel?((u=new MessageChannel).port1.onmessage=function(x){w(x.data)},function(x){u.port2.postMessage(x)}):f&&"onreadystatechange"in f.createElement("script")?(c=f.documentElement,function(x){var E=f.createElement("script");E.onreadystatechange=function(){w(x),E.onreadystatechange=null,c.removeChild(E),E=null},c.appendChild(E)}):function(x){setTimeout(w,0,x)},y.setImmediate=function(x){typeof x!="function"&&(x=new Function(""+x));for(var E=new Array(arguments.length-1),I=0;I<E.length;I++)E[I]=arguments[I+1];var k={callback:x,args:E};return h[p]=k,l(p),p++},y.clearImmediate=m}function m(x){delete h[x]}function w(x){if(v)setTimeout(w,0,x);else{var E=h[x];if(E){v=!0;try{(function(I){var k=I.callback,R=I.args;switch(R.length){case 0:k();break;case 1:k(R[0]);break;case 2:k(R[0],R[1]);break;case 3:k(R[0],R[1],R[2]);break;default:k.apply(s,R)}})(E)}finally{m(x),v=!1}}}}function _(x){x.source===i&&typeof x.data=="string"&&x.data.indexOf(d)===0&&w(+x.data.slice(d.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof Xn<"u"?Xn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(bl);var hp=bl.exports;const pp=fa(hp),mp=async t=>{const e=`ComfyUI workspace workflows ${aa(Date.now())}`,n=new pp,r=await(X==null?void 0:X.getSetting("twoWaySync"));for(const o of t){let a;r?a=o.parentFolderID??"":a=await dh(o.parentFolderID??null).then(async s=>Pt(s??""));const i=n.folder(a);i==null||i.file(`${o.name}.json`,o.json)}n.generateAsync({type:"blob"}).then(function(o){const a=document.createElement("a");a.href=window.URL.createObjectURL(o),a.download=`${e}.zip`,document.body.appendChild(a),a.click(),document.body.removeChild(a)})};function yp({myWorkflowsDir:t}){return O.jsxs(rn,{gap:3,children:[O.jsx(xa,{size:"md",children:" Upgrade to 2.0 - enable two way sync!"}),O.jsx("p",{children:"Your workflows will be synced to and from path:"}),O.jsx("p",{children:O.jsx("b",{children:t})}),O.jsxs("p",{children:["You can manually put workflow files into this folder using File Explorer to sync them with your workspace. You can change this path anytime in Settings ",">"," Workspace Save Directory"]}),O.jsxs("p",{children:[O.jsx("b",{children:"Please download all your workflows before enabling two way sync as a backup!"})," ","So you can manually import some workflows into your workspace in case something unexpected happens."]}),O.jsx(qe,{colorScheme:"teal",variant:"outline",width:"fit-content",onClick:async()=>{const e=await(G==null?void 0:G.listAll());mp(e??[])},children:" Download All My Workflows"})]})}const vp=ba.lazy(()=>Hr(()=>import("./RecentFilesDrawer-vciP1wo4.js"),__vite__mapDeps([4,1,5,2,6,7]))),gp=ba.lazy(()=>Hr(()=>import("./GalleryModal-OOtkZCVW.js"),__vite__mapDeps([8,1,7,5,2,3,6]))),wp=ba.lazy(()=>Hr(()=>import("./ModelManagerTopbar-aMEaROu7.js").then(t=>t.M),__vite__mapDeps([9,1,5,2,10]))),bp=["download_progress","download_error","model_list"];function _p(){const[t,e]=P.useState(null),[n,r]=P.useState("root"),[o,a]=P.useState(!0),[i,s]=P.useState(null),l=P.useRef(null),[c,u]=P.useState(!1),d=P.useRef(null),{showDialog:p}=Bs(),[h,v]=P.useState(!1);P.useRef(!1);const f=P.useRef(0),y=zs(),m=P.useRef("hide"),[w,_]=P.useState(null),[x,E,I]=fp(null),k=P.useCallback(async()=>{if(l.current){const M=JSON.stringify(Se.graph.serialize());await Promise.all([G==null?void 0:G.updateFlow(l.current,{json:M}),ze==null?void 0:ze.create({workflowID:l.current,json:M})]),X!=null&&X.autoSave&&y({title:"Saved",status:"success",duration:1e3,isClosable:!0})}},[]),R=async()=>{l.current&&confirm("Are you sure you want to delete this workflow?")&&(await(G==null?void 0:G.delete(l.current)),T(null))},D=async()=>{var A,J,oe;if(confirm("Are you sure you want to discard unsaved changes? This will revert current workflow to your last saved version. You will lose all changes made since your last save.")){const ne=(A=G==null?void 0:G.curWorkflow)==null?void 0:A.id;if(ne==null)return;let ie;X!=null&&X.autoSave?ie=(J=await(ze==null?void 0:ze.getLastestByWorkflowID(ne)))==null?void 0:J.json:ie=(oe=await(G==null?void 0:G.get(ne)))==null?void 0:oe.json,ie?(G==null||G.updateCurWorkflow({...G.curWorkflow,json:ie}),await Se.loadGraphData(JSON.parse(ie))):alert("Error: No last saved version found")}},T=M=>{const A=(M==null?void 0:M.id)??null;if(G==null||G.updateCurWorkflow(M),l.current=A,s(A),e((M==null?void 0:M.name)??""),A==null){document.title="ComfyUI",window.location.hash="",localStorage.removeItem("curFlowID");return}if(js()){const J=hl(A);window.location.hash=J,document.title=M.name+" - ComfyUI"}else localStorage.setItem("curFlowID",A),document.title="ComfyUI - "+M.name},H=async()=>{j(),localStorage.removeItem("workspace"),localStorage.removeItem("comfyspace");try{await xh()}catch(A){console.error("error loading db",A)}a(!1);let M=null;M=js(),M==null&&(M=localStorage.getItem("curFlowID")),M&&b(M),localStorage.getItem("REWRITTEN_ALL_LOCAL_DISK_FILE")==="true"?await dl():(await yh(),localStorage.setItem("REWRITTEN_ALL_LOCAL_DISK_FILE","true")),ge.cache.get(Ds).then(async A=>{if((A==null?void 0:A.value)!=="true"){const J=await(X==null?void 0:X.getSetting("myWorkflowsDir"));p(O.jsx(yp,{myWorkflowsDir:J??"undefined"}),[{label:"I have downloaded all my workflows and ready to enable",onClick:async()=>{await(X==null?void 0:X.upsert({twoWaySync:!0})),await(X==null?void 0:X.getSetting("twoWaySync"))&&(ge.cache.put({id:Ds,value:"true"}),location.reload())},colorScheme:"red"}])}})},j=()=>{bp.forEach(M=>{Xa.addEventListener(M,()=>null)})},L=()=>{if(l.current==null)return!1;const M=G==null?void 0:G.curWorkflow;if(M==null)return!1;if(M.json==null)return!0;const A=Se.graph.serialize()??{};let J={};try{J=M!=null&&M.json?JSON.parse(M==null?void 0:M.json):{}}catch(ne){console.error("error parsing json",ne)}return!(JSON.stringify(A)===JSON.stringify(J))},b=async(M,A)=>{if(Se.graph==null){console.error("app.graph is null cannot load workflow");return}const J=await(G==null?void 0:G.get(M));if(J==null){alert("Error: Workflow not found! id: "+M),T(null);return}const oe=A?await(xe==null?void 0:xe.get(A)):null;Se.ui.dialog.close(),oe?(E(oe),T({...J,json:oe.json}),Se.loadGraphData(JSON.parse(oe.json))):(T(J),E(null),Se.loadGraphData(JSON.parse(J.json))),r("root")},q=M=>{_(M)},te=async(M,A,J=!1)=>{if(M===null){T(null),Se.graph.clear();return}if(!c||J||await(X==null?void 0:X.getSetting("autoSave"))){b(M,A);return}N(M)},N=async M=>{var J,oe;const A=[M?{label:"Open in new tab",icon:O.jsx(Fh,{}),onClick:()=>{mh(M)}}:null,{label:"Save",colorScheme:"teal",onClick:async()=>{await k(),M&&b(M)}}];((J=G==null?void 0:G.curWorkflow)==null?void 0:J.lastSavedJson)!=null?A.push({label:"Discard",colorScheme:"red",onClick:async()=>{M&&b(M)}}):A.push({label:"Delete",colorScheme:"red",onClick:async()=>{await R(),M&&b(M)}}),p(`Please save or discard your changes to "${(oe=G==null?void 0:G.curWorkflow)==null?void 0:oe.name}" before leaving, or your changes will be lost.`,A)},ae=async M=>{const A=(M==null?void 0:M.json)??JSON.stringify(_r),J=await(G==null?void 0:G.createFlow({json:A,name:M==null?void 0:M.name}));J&&await te(J.id),r("root")},Z=async(M,A=!1)=>{const J=M.split("/").pop()??M;A?k():ae({name:J});const oe=await fetch(ph(M)),ne=await oe.blob(),ie=new File([ne],J,{type:oe.headers.get("Content-Type")||""});await Se.handleFile(ie),r("root")},le=async(M,A)=>{const J=await(G==null?void 0:G.get(M));if(J==null)return;const oe=await(G==null?void 0:G.createFlow({json:J.json,lastSavedJson:J.lastSavedJson,name:A||J.name,parentFolderID:J.parentFolderID,tags:J.tags}));oe&&await te(oe.id)},K=async M=>{if(document.visibilityState==="hidden")return;switch(await hh(M)){case na.SAVE:k();return;case na.SAVE_AS:r("saveAsModal");return}},U=P.useCallback(M=>{if(l.current==null)return;let A=M.filename;M.subfolder!=null&&M.subfolder!==""&&(A=M.subfolder+"/"+A),qt==null||qt.create({workflowID:l.current,localPath:A})},[]),re=P.useCallback(()=>{r("root")},[]);return P.useEffect(()=>{H(),v(!0),f.current=setInterval(async()=>{const ie=X==null?void 0:X.autoSave,ve=L();if(u(!!ve),!!ve&&(I.current!=null&&I.current.json!==JSON.stringify(Se.graph.serialize())&&E(null),l.current!=null&&ie)){const fe=await(G==null?void 0:G.latestVersionCheck());if(m.current!=="disabled"&&!fe)m.current="show",p(`This notification is to inform you that it appears you've opened the same workflow in multiple tabs. If all tabs are set to auto-save, this may lead to conflicts and potential data loss.

You might want to consider disabling auto-save to prevent this. We will remind you to save changes if you leave a page with unsaved work.`,[{label:"Do Not Remind Again",onClick:()=>{m.current="disabled"}},{label:"Disable Auto-Save",colorScheme:"teal",onClick:()=>{X==null||X.upsert({autoSave:!1})}}],!0);else{const he=JSON.stringify(Se.graph.serialize());he!=null&&await(G==null?void 0:G.updateFlow(l.current,{json:he}))}}},1e3),window.addEventListener("keydown",K);const M=document.getElementById("comfy-file-input"),A=async()=>{if(M&&M.files&&M.files.length>0){const ie={id:Fn(),name:M.files[0].name,json:JSON.stringify(_r),updateTime:Date.now(),createTime:Date.now()};T(ie),await(G==null?void 0:G.createFlow(ie))}};M==null||M.addEventListener("change",A);const J=ie=>{const ve=(X==null?void 0:X.autoSave)??!0,fe=L();!ve&&fe&&(ie.preventDefault(),ie.returnValue="You have unsaved changes!",N())};window.addEventListener("beforeunload",J);const oe=ie=>{var ve,fe,he,ue,g,B;(he=(fe=(ve=ie.detail)==null?void 0:ve.output)==null?void 0:fe.images)==null||he.forEach(W=>{W.type==="output"&&U(W)}),(B=(g=(ue=ie.detail)==null?void 0:ue.output)==null?void 0:g.gifs)==null||B.forEach(W=>{W.type==="output"&&U(W)})};Xa.addEventListener("executed",oe);const ne=async ie=>{var ue,g;const ve=(g=(ue=ie.dataTransfer)==null?void 0:ue.files[0])==null?void 0:g.name,fe=Se.dragOverNode;if(fe&&fe.onDragDrop)return;if(!(await(X==null?void 0:X.getSetting("overwriteCurWorkflowWhenDroppingFileToCanvas"))??!1)&&ve){const B={id:Fn(),name:ve,json:JSON.stringify(_r),updateTime:Date.now(),createTime:Date.now()};T(B),await(G==null?void 0:G.createFlow(B))}};return Se.canvasEl.addEventListener("drop",ne),()=>{window.removeEventListener("keydown",K),window.removeEventListener("change",A),window.removeEventListener("beforeunload",J),window.removeEventListener("executed",oe),Se.canvasEl.removeEventListener("drop",ne),clearInterval(f.current)}},[]),o?null:O.jsx(_t.Provider,{value:{curFlowID:i,onDuplicateWorkflow:le,loadWorkflowID:te,discardUnsavedChanges:D,saveCurWorkflow:k,isDirty:c,loadNewWorkflow:ae,loadFilePath:Z,setRoute:r,route:n,jsonDiff:w,compareJson:q,curVersion:x},children:O.jsx("div",{ref:d,className:"workspace_manager",children:O.jsxs(Rs,{containerRef:d,children:[O.jsxs(yt,{style:{position:"absolute",top:0,right:0,left:0},zIndex:uh,draggable:!1,children:[O.jsx(lp,{curFlowName:t,setCurFlowName:e}),h&&O.jsx(P.Suspense,{children:O.jsx(wp,{})}),h&&n==="recentFlows"&&O.jsx(P.Suspense,{children:O.jsx(vp,{onClose:re,onClickNewFlow:()=>{ae(),r("root")}})}),n==="gallery"&&O.jsx(gp,{onclose:()=>r("root")})]}),O.jsx(cp,{})]})})})}const Hp=Object.freeze(Object.defineProperty({__proto__:null,default:_p},Symbol.toStringTag,{value:"Module"}));export{gi as $,G as A,yt as B,Hh as C,Vh as D,na as E,kn as F,mp as G,Tt as H,Pn as I,Ah as J,Rp as K,Rh as L,yi as M,Ke as N,Vr as O,Gr as P,Zr as Q,Up as R,Ed as S,Ra as T,Wh as U,_r as V,Tp as W,wr as X,_h as Y,Fp as Z,fc as _,Cp as a,vi as a0,ki as a1,wi as a2,_i as a3,bi as a4,_t as a5,aa as a6,mh as a7,Fh as a8,Ct as a9,qp as aA,op as aB,ap as aC,rc as aD,Hp as aE,oc as aa,uh as ab,Pp as ac,fl as ad,Bp as ae,Mp as af,qt as ag,xa as ah,Fc as ai,ql as aj,ge as ak,Lp as al,Wp as am,Np as an,Ac as ao,fp as ap,wh as aq,zp as ar,Ap as as,Eh as at,Th as au,hc as av,hn as aw,$p as ax,xe as ay,Kp as az,Nc as b,Dp as c,Ip as d,Op as e,pn as f,Xr as g,Be as h,Kh as i,zs as j,rn as k,zt as l,Wt as m,Kn as n,X as o,yp as p,uf as q,jp as r,Eo as s,xr as t,Yr as u,dl as v,Na as w,Fa as x,xt as y,Nh as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["workspace_web/ShareDialog-Q3AC6yal.js","workspace_web/input.js","workspace_web/index-pz0vT7Or.js","workspace_web/IconCopy-D6uYPUbf.js","workspace_web/RecentFilesDrawer-vciP1wo4.js","workspace_web/chunk-JARCRF6W-we4xocqW.js","workspace_web/chunk-NTCQBYKE-qydYN07M.js","workspace_web/MediaPreview-1uswM5Au.js","workspace_web/GalleryModal-OOtkZCVW.js","workspace_web/ModelManagerTopbar-aMEaROu7.js","workspace_web/assets/ModelManagerTopbar--iv3sdjQ.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}