var $i=Object.defineProperty;var Ui=(t,e,n)=>e in t?$i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ce=(t,e,n)=>(Ui(t,typeof e!="symbol"?e+"":e,n),n);import{u as zi,a as qi,r as v,c as Vi,b as $e,m as _e,d as yt,f as J,j as p,B as Oe,e as Hi,g as V,h as re,o as Le,i as St,k as Ue,I as Ji,l as Cn,n as Nr,p as le,q as Gi,s as Yi,t as Xi,v as Zi,w as gr,x as Qi,y as el,z as tl,A as nl,C as rl,D as To,E as aa,F as Lo,G as ia,H as ol,J as sl,K as al,P as la,M as Bo,L as Wo,N as Ko,O as $o,Q as Uo,R as zo,S as qo,_ as wr,T as il,U as ll,V as Vo}from"./input.js";import{app as ye}from"/scripts/app.js";import{api as Es}from"/scripts/api.js";function cl(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}function ca(t){var e;return cl(t)&&(e=t.ownerDocument)!=null?e:document}function ul(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var dl=ul();function fl(t){const e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function hl(t){const{theme:e}=zi(),n=qi();return v.useMemo(()=>Vi(e.direction,{...n,...t}),[t,e.direction,n])}var pl=Object.defineProperty,ml=(t,e,n)=>e in t?pl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ue=(t,e,n)=>(ml(t,typeof e!="symbol"?e+"":e,n),n);function Ds(t){return t.sort((e,n)=>{const r=e.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var vl=t=>typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE;function Is(t,e,n){let r=t+1;return n&&r>=e&&(r=0),r}function Ss(t,e,n){let r=t-1;return n&&r<0&&(r=e),r}var Jr=typeof window<"u"?v.useLayoutEffect:v.useEffect,er=t=>t,yl=class{constructor(){ue(this,"descendants",new Map),ue(this,"register",t=>{if(t!=null)return vl(t)?this.registerNode(t):e=>{this.registerNode(e,t)}}),ue(this,"unregister",t=>{this.descendants.delete(t);const e=Ds(Array.from(this.descendants.keys()));this.assignIndex(e)}),ue(this,"destroy",()=>{this.descendants.clear()}),ue(this,"assignIndex",t=>{this.descendants.forEach(e=>{const n=t.indexOf(e.node);e.index=n,e.node.dataset.index=e.index.toString()})}),ue(this,"count",()=>this.descendants.size),ue(this,"enabledCount",()=>this.enabledValues().length),ue(this,"values",()=>Array.from(this.descendants.values()).sort((e,n)=>e.index-n.index)),ue(this,"enabledValues",()=>this.values().filter(t=>!t.disabled)),ue(this,"item",t=>{if(this.count()!==0)return this.values()[t]}),ue(this,"enabledItem",t=>{if(this.enabledCount()!==0)return this.enabledValues()[t]}),ue(this,"first",()=>this.item(0)),ue(this,"firstEnabled",()=>this.enabledItem(0)),ue(this,"last",()=>this.item(this.descendants.size-1)),ue(this,"lastEnabled",()=>{const t=this.enabledValues().length-1;return this.enabledItem(t)}),ue(this,"indexOf",t=>{var e,n;return t&&(n=(e=this.descendants.get(t))==null?void 0:e.index)!=null?n:-1}),ue(this,"enabledIndexOf",t=>t==null?-1:this.enabledValues().findIndex(e=>e.node.isSameNode(t))),ue(this,"next",(t,e=!0)=>{const n=Is(t,this.count(),e);return this.item(n)}),ue(this,"nextEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=Is(r,this.enabledCount(),e);return this.enabledItem(o)}),ue(this,"prev",(t,e=!0)=>{const n=Ss(t,this.count()-1,e);return this.item(n)}),ue(this,"prevEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=Ss(r,this.enabledCount()-1,e);return this.enabledItem(o)}),ue(this,"registerNode",(t,e)=>{if(!t||this.descendants.has(t))return;const n=Array.from(this.descendants.keys()).concat(t),r=Ds(n);e!=null&&e.disabled&&(e.disabled=!!e.disabled);const o={node:t,index:-1,...e};this.descendants.set(t,o),this.assignIndex(r)})}};function gl(){const t=v.useRef(new yl);return Jr(()=>()=>t.current.destroy()),t.current}var[wl,ua]=$e({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function bl(t){const e=ua(),[n,r]=v.useState(-1),o=v.useRef(null);Jr(()=>()=>{o.current&&e.unregister(o.current)},[]),Jr(()=>{if(!o.current)return;const a=Number(o.current.dataset.index);n!=a&&!Number.isNaN(a)&&r(a)});const s=er(t?e.register(t):e.register);return{descendants:e,index:n,enabledIndex:e.enabledIndexOf(o.current),register:_e(s,o)}}function da(){return[er(wl),()=>er(ua()),()=>gl(),o=>bl(o)]}function fa(t){const{value:e,defaultValue:n,onChange:r,shouldUpdate:o=(f,m)=>f!==m}=t,s=yt(r),a=yt(o),[i,l]=v.useState(n),u=e!==void 0,c=u?e:i,d=yt(f=>{const b=typeof f=="function"?f(c):f;a(c,b)&&(u||l(b),s(b))},[u,s,c,a]);return[c,d]}function Ho(t){return v.Children.toArray(t).filter(e=>v.isValidElement(e))}var Ut=J((t,e)=>{const{icon:n,children:r,isRound:o,"aria-label":s,...a}=t,i=n||r,l=v.isValidElement(i)?v.cloneElement(i,{"aria-hidden":!0,focusable:!1}):null;return p.jsx(Oe,{padding:"0",borderRadius:o?"full":void 0,ref:e,"aria-label":s,...a,children:l})});Ut.displayName="IconButton";var[xl,ha]=Hi("Card"),_l=J(function(e,n){const{className:r,...o}=e,s=ha();return p.jsx(V.div,{ref:n,className:re("chakra-card__body",r),__css:s.body,...o})}),kl=J(function(e,n){const{className:r,...o}=e,s=ha();return p.jsx(V.div,{ref:n,className:re("chakra-card__header",r),__css:s.header,...o})}),Cl=J(function(e,n){const{className:r,children:o,direction:s="column",justify:a,align:i,...l}=Le(e),u=St("Card",e);return p.jsx(V.div,{ref:n,className:re("chakra-card",r),__css:{display:"flex",flexDirection:s,justifyContent:a,alignItems:i,position:"relative",minWidth:0,wordWrap:"break-word",...u.container},...l,children:p.jsx(xl,{value:u,children:o})})}),[El,pa]=$e({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[Dl,Yt]=$e({strict:!1,name:"FormControlContext"});function Il(t){const{id:e,isRequired:n,isInvalid:r,isDisabled:o,isReadOnly:s,...a}=t,i=v.useId(),l=e||`field-${i}`,u=`${l}-label`,c=`${l}-feedback`,d=`${l}-helptext`,[f,m]=v.useState(!1),[b,h]=v.useState(!1),[w,g]=v.useState(!1),y=v.useCallback((x={},I=null)=>({id:d,...x,ref:_e(I,D=>{D&&h(!0)})}),[d]),_=v.useCallback((x={},I=null)=>({...x,ref:I,"data-focus":Ue(w),"data-disabled":Ue(o),"data-invalid":Ue(r),"data-readonly":Ue(s),id:x.id!==void 0?x.id:u,htmlFor:x.htmlFor!==void 0?x.htmlFor:l}),[l,o,w,r,s,u]),k=v.useCallback((x={},I=null)=>({id:c,...x,ref:_e(I,D=>{D&&m(!0)}),"aria-live":"polite"}),[c]),E=v.useCallback((x={},I=null)=>({...x,...a,ref:I,role:"group","data-focus":Ue(w),"data-disabled":Ue(o),"data-invalid":Ue(r),"data-readonly":Ue(s)}),[a,o,w,r,s]),C=v.useCallback((x={},I=null)=>({...x,ref:I,role:"presentation","aria-hidden":!0,children:x.children||"*"}),[]);return{isRequired:!!n,isInvalid:!!r,isReadOnly:!!s,isDisabled:!!o,isFocused:!!w,onFocus:()=>g(!0),onBlur:()=>g(!1),hasFeedbackText:f,setHasFeedbackText:m,hasHelpText:b,setHasHelpText:h,id:l,labelId:u,feedbackId:c,helpTextId:d,htmlProps:a,getHelpTextProps:y,getErrorMessageProps:k,getRootProps:E,getLabelProps:_,getRequiredIndicatorProps:C}}var br=J(function(e,n){const r=St("Form",e),o=Le(e),{getRootProps:s,htmlProps:a,...i}=Il(o),l=re("chakra-form-control",e.className);return p.jsx(Dl,{value:i,children:p.jsx(El,{value:r,children:p.jsx(V.div,{...s({},n),className:l,__css:r.container})})})});br.displayName="FormControl";var Sl=J(function(e,n){const r=Yt(),o=pa(),s=re("chakra-form__helper-text",e.className);return p.jsx(V.div,{...r==null?void 0:r.getHelpTextProps(e,n),__css:o.helperText,className:s})});Sl.displayName="FormHelperText";var[Ol,Pl]=$e({name:"FormErrorStylesContext",errorMessage:`useFormErrorStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormError />" `}),xr=J((t,e)=>{const n=St("FormError",t),r=Le(t),o=Yt();return o!=null&&o.isInvalid?p.jsx(Ol,{value:n,children:p.jsx(V.div,{...o==null?void 0:o.getErrorMessageProps(r,e),className:re("chakra-form__error-message",t.className),__css:{display:"flex",alignItems:"center",...n.text}})}):null});xr.displayName="FormErrorMessage";var jl=J((t,e)=>{const n=Pl(),r=Yt();if(!(r!=null&&r.isInvalid))return null;const o=re("chakra-form__error-icon",t.className);return p.jsx(Ji,{ref:e,"aria-hidden":!0,...t,__css:n.icon,className:o,children:p.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})});jl.displayName="FormErrorIcon";var _r=J(function(e,n){var r;const o=Cn("FormLabel",e),s=Le(e),{className:a,children:i,requiredIndicator:l=p.jsx(ma,{}),optionalIndicator:u=null,...c}=s,d=Yt(),f=(r=d==null?void 0:d.getLabelProps(c,n))!=null?r:{ref:n,...c};return p.jsxs(V.label,{...f,className:re("chakra-form__label",s.className),__css:{display:"block",textAlign:"start",...o},children:[i,d!=null&&d.isRequired?l:u]})});_r.displayName="FormLabel";var ma=J(function(e,n){const r=Yt(),o=pa();if(!(r!=null&&r.isRequired))return null;const s=re("chakra-form__required-indicator",e.className);return p.jsx(V.span,{...r==null?void 0:r.getRequiredIndicatorProps(e,n),__css:o.requiredIndicator,className:s})});ma.displayName="RequiredIndicator";function Nl(t){const{isDisabled:e,isInvalid:n,isReadOnly:r,isRequired:o,...s}=Al(t);return{...s,disabled:e,readOnly:r,required:o,"aria-invalid":Nr(n),"aria-required":Nr(o),"aria-readonly":Nr(r)}}function Al(t){var e,n,r;const o=Yt(),{id:s,disabled:a,readOnly:i,required:l,isRequired:u,isInvalid:c,isReadOnly:d,isDisabled:f,onFocus:m,onBlur:b,...h}=t,w=t["aria-describedby"]?[t["aria-describedby"]]:[];return o!=null&&o.hasFeedbackText&&(o!=null&&o.isInvalid)&&w.push(o.feedbackId),o!=null&&o.hasHelpText&&w.push(o.helpTextId),{...h,"aria-describedby":w.join(" ")||void 0,id:s??(o==null?void 0:o.id),isDisabled:(e=a??f)!=null?e:o==null?void 0:o.isDisabled,isReadOnly:(n=i??d)!=null?n:o==null?void 0:o.isReadOnly,isRequired:(r=l??u)!=null?r:o==null?void 0:o.isRequired,isInvalid:c??(o==null?void 0:o.isInvalid),onFocus:le(o==null?void 0:o.onFocus,m),onBlur:le(o==null?void 0:o.onBlur,b)}}function Bt(t,e,n,r){const o=yt(n);return v.useEffect(()=>{const s=typeof t=="function"?t():t??document;if(!(!n||!s))return s.addEventListener(e,o,r),()=>{s.removeEventListener(e,o,r)}},[e,t,r,o,n]),()=>{const s=typeof t=="function"?t():t??document;s==null||s.removeEventListener(e,o,r)}}function Fl(t){return"current"in t}var va=()=>typeof window<"u";function Ml(){var t;const e=navigator.userAgentData;return(t=e==null?void 0:e.platform)!=null?t:navigator.platform}var Rl=t=>va()&&t.test(navigator.vendor),Tl=t=>va()&&t.test(Ml()),Ll=()=>Tl(/mac|iphone|ipad|ipod/i),Bl=()=>Ll()&&Rl(/apple/i);function Wl(t){const{ref:e,elements:n,enabled:r}=t,o=()=>{var s,a;return(a=(s=e.current)==null?void 0:s.ownerDocument)!=null?a:document};Bt(o,"pointerdown",s=>{if(!Bl()||!r)return;const a=s.target,l=(n??[e]).some(u=>{const c=Fl(u)?u.current:u;return(c==null?void 0:c.contains(a))||c===a});o().activeElement!==a&&l&&(s.preventDefault(),a.focus())})}var ya={exports:{}},Kl="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",$l=Kl,Ul=$l;function ga(){}function wa(){}wa.resetWarningCache=ga;var zl=function(){function t(r,o,s,a,i,l){if(l!==Ul){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:wa,resetWarningCache:ga};return n.PropTypes=n,n};ya.exports=zl();var ql=ya.exports;const ft=Gi(ql);function Vl(t){const e=t.ownerDocument.defaultView||window,{overflow:n,overflowX:r,overflowY:o}=e.getComputedStyle(t);return/auto|scroll|overlay|hidden/.test(n+o+r)}function Hl(t){return t.localName==="html"?t:t.assignedSlot||t.parentElement||t.ownerDocument.documentElement}function ba(t){return["html","body","#document"].includes(t.localName)?t.ownerDocument.body:Yi(t)&&Vl(t)?t:ba(Hl(t))}var Jl=dl?v.useLayoutEffect:v.useEffect;function Gr(t,e=[]){const n=v.useRef(t);return Jl(()=>{n.current=t}),v.useCallback((...r)=>{var o;return(o=n.current)==null?void 0:o.call(n,...r)},e)}function Gl(t){const{ref:e,handler:n,enabled:r=!0}=t,o=Gr(n),a=v.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;v.useEffect(()=>{if(!r)return;const i=d=>{Ar(d,e)&&(a.isPointerDown=!0)},l=d=>{if(a.ignoreEmulatedMouseEvents){a.ignoreEmulatedMouseEvents=!1;return}a.isPointerDown&&n&&Ar(d,e)&&(a.isPointerDown=!1,o(d))},u=d=>{a.ignoreEmulatedMouseEvents=!0,n&&a.isPointerDown&&Ar(d,e)&&(a.isPointerDown=!1,o(d))},c=ca(e.current);return c.addEventListener("mousedown",i,!0),c.addEventListener("mouseup",l,!0),c.addEventListener("touchstart",i,!0),c.addEventListener("touchend",u,!0),()=>{c.removeEventListener("mousedown",i,!0),c.removeEventListener("mouseup",l,!0),c.removeEventListener("touchstart",i,!0),c.removeEventListener("touchend",u,!0)}},[n,e,o,a,r])}function Ar(t,e){var n;const r=t.target;return r&&!ca(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function Yl(t,e){const n=v.useId();return v.useMemo(()=>t||[e,n].filter(Boolean).join("-"),[t,e,n])}function Xl(t,e){const n=t!==void 0;return[n,n&&typeof t<"u"?t:e]}function Zl(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=Gr(n),a=Gr(e),[i,l]=v.useState(t.defaultIsOpen||!1),[u,c]=Xl(r,i),d=Yl(o,"disclosure"),f=v.useCallback(()=>{u||l(!1),a==null||a()},[u,a]),m=v.useCallback(()=>{u||l(!0),s==null||s()},[u,s]),b=v.useCallback(()=>{(c?f:m)()},[c,m,f]);return{isOpen:!!c,onOpen:m,onClose:f,onToggle:b,isControlled:u,getButtonProps:(h={})=>({...h,"aria-expanded":c,"aria-controls":d,onClick:Xi(h.onClick,b)}),getDisclosureProps:(h={})=>({...h,hidden:!c,id:d})}}var En=J(function(e,n){const{htmlSize:r,...o}=e,s=St("Input",o),a=Le(o),i=Nl(a),l=re("chakra-input",e.className);return p.jsx(V.input,{size:r,...i,__css:s.field,ref:n,className:l})});En.displayName="Input";En.id="Input";var xa=J(function(e,n){const r=Cn("Link",e),{className:o,isExternal:s,...a}=Le(e);return p.jsx(V.a,{target:s?"_blank":void 0,rel:s?"noopener":void 0,ref:n,className:re("chakra-link",o),...a,__css:r})});xa.displayName="Link";var Ql=Object.freeze(["base","sm","md","lg","xl","2xl"]);function ec(t,e){return Array.isArray(t)?t.map(n=>n===null?null:e(n)):Zi(t)?Object.keys(t).reduce((n,r)=>(n[r]=e(t[r]),n),{}):t!=null?e(t):null}function Sh(t,e=Ql){const n={};return t.forEach((r,o)=>{const s=e[o];r!=null&&(n[s]=r)}),n}var gt=J(function(e,n){const r=Cn("Text",e),{className:o,align:s,decoration:a,casing:i,...l}=Le(e),u=fl({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return p.jsx(V.p,{ref:n,className:re("chakra-text",e.className),...u,...l,__css:r})});gt.displayName="Text";var Yr=t=>p.jsx(V.div,{className:"chakra-stack__divider",...t,__css:{...t.__css,borderWidth:0,alignSelf:"stretch",borderColor:"inherit",width:"auto",height:"auto"}});Yr.displayName="StackDivider";var _a=t=>p.jsx(V.div,{className:"chakra-stack__item",...t,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...t.__css}});_a.displayName="StackItem";function tc(t){const{spacing:e,direction:n}=t,r={column:{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":ec(n,o=>r[o])}}var an=J((t,e)=>{const{isInline:n,direction:r,align:o,justify:s,spacing:a="0.5rem",wrap:i,children:l,divider:u,className:c,shouldWrapChildren:d,...f}=t,m=n?"row":r??"column",b=v.useMemo(()=>tc({spacing:a,direction:m}),[a,m]),h=!!u,w=!d&&!h,g=v.useMemo(()=>{const _=Ho(l);return w?_:_.map((k,E)=>{const C=typeof k.key<"u"?k.key:E,x=E+1===_.length,D=d?p.jsx(_a,{children:k},C):k;if(!h)return D;const P=v.cloneElement(u,{__css:b}),N=x?null:P;return p.jsxs(v.Fragment,{children:[D,N]},C)})},[u,b,h,w,d,l]),y=re("chakra-stack",c);return p.jsx(V.div,{ref:e,display:"flex",alignItems:o,justifyContent:s,flexDirection:m,flexWrap:i,gap:h?void 0:a,className:y,...f,children:g})});an.displayName="Stack";var mt=J((t,e)=>p.jsx(an,{align:"center",...t,direction:"row",ref:e}));mt.displayName="HStack";var ka=J(function(e,n){const r=Cn("Heading",e),{className:o,...s}=Le(e);return p.jsx(V.h2,{ref:n,className:re("chakra-heading",e.className),...s,__css:r})});ka.displayName="Heading";var it=V("div");it.displayName="Box";var Ca=J(function(e,n){const{size:r,centerContent:o=!0,...s}=e,a=o?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return p.jsx(it,{ref:n,boxSize:r,__css:{...a,flexShrink:0,flexGrow:0},...s})});Ca.displayName="Square";var nc=J(function(e,n){const{size:r,...o}=e;return p.jsx(Ca,{size:r,ref:n,borderRadius:"9999px",...o})});nc.displayName="Circle";var $n=J(function(e,n){const{direction:r,align:o,justify:s,wrap:a,basis:i,grow:l,shrink:u,...c}=e,d={display:"flex",flexDirection:r,alignItems:o,justifyContent:s,flexWrap:a,flexBasis:i,flexGrow:l,flexShrink:u};return p.jsx(V.div,{ref:n,__css:d,...c})});$n.displayName="Flex";function rc(t){const{key:e}=t;return e.length===1||e.length>1&&/[^a-zA-Z0-9]/.test(e)}function oc(t={}){const{timeout:e=300,preventDefault:n=()=>!0}=t,[r,o]=v.useState([]),s=v.useRef(),a=()=>{s.current&&(clearTimeout(s.current),s.current=null)},i=()=>{a(),s.current=setTimeout(()=>{o([]),s.current=null},e)};v.useEffect(()=>a,[]);function l(u){return c=>{if(c.key==="Backspace"){const d=[...r];d.pop(),o(d);return}if(rc(c)){const d=r.concat(c.key);n(c)&&(c.preventDefault(),c.stopPropagation()),o(d),u(d.join("")),i()}}}return l}function sc(t,e,n,r){if(e==null)return r;if(!r)return t.find(a=>n(a).toLowerCase().startsWith(e.toLowerCase()));const o=t.filter(s=>n(s).toLowerCase().startsWith(e.toLowerCase()));if(o.length>0){let s;return o.includes(r)?(s=o.indexOf(r)+1,s===o.length&&(s=0),o[s]):(s=t.indexOf(o[0]),t[s])}return r}function ac(){const t=v.useRef(new Map),e=t.current,n=v.useCallback((o,s,a,i)=>{t.current.set(a,{type:s,el:o,options:i}),o.addEventListener(s,a,i)},[]),r=v.useCallback((o,s,a,i)=>{o.removeEventListener(s,a,i),t.current.delete(a)},[]);return v.useEffect(()=>()=>{e.forEach((o,s)=>{r(o.el,o.type,s,o.options)})},[r,e]),{add:n,remove:r}}function Fr(t){const e=t.target,{tagName:n,isContentEditable:r}=e;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function Ea(t={}){const{ref:e,isDisabled:n,isFocusable:r,clickOnEnter:o=!0,clickOnSpace:s=!0,onMouseDown:a,onMouseUp:i,onClick:l,onKeyDown:u,onKeyUp:c,tabIndex:d,onMouseOver:f,onMouseLeave:m,...b}=t,[h,w]=v.useState(!0),[g,y]=v.useState(!1),_=ac(),k=O=>{O&&O.tagName!=="BUTTON"&&w(!1)},E=h?d:d||0,C=n&&!r,x=v.useCallback(O=>{if(n){O.stopPropagation(),O.preventDefault();return}O.currentTarget.focus(),l==null||l(O)},[n,l]),I=v.useCallback(O=>{g&&Fr(O)&&(O.preventDefault(),O.stopPropagation(),y(!1),_.remove(document,"keyup",I,!1))},[g,_]),D=v.useCallback(O=>{if(u==null||u(O),n||O.defaultPrevented||O.metaKey||!Fr(O.nativeEvent)||h)return;const H=o&&O.key==="Enter";s&&O.key===" "&&(O.preventDefault(),y(!0)),H&&(O.preventDefault(),O.currentTarget.click()),_.add(document,"keyup",I,!1)},[n,h,u,o,s,_,I]),P=v.useCallback(O=>{if(c==null||c(O),n||O.defaultPrevented||O.metaKey||!Fr(O.nativeEvent)||h)return;s&&O.key===" "&&(O.preventDefault(),y(!1),O.currentTarget.click())},[s,h,n,c]),N=v.useCallback(O=>{O.button===0&&(y(!1),_.remove(document,"mouseup",N,!1))},[_]),K=v.useCallback(O=>{if(O.button!==0)return;if(n){O.stopPropagation(),O.preventDefault();return}h||y(!0),O.currentTarget.focus({preventScroll:!0}),_.add(document,"mouseup",N,!1),a==null||a(O)},[n,h,a,_,N]),T=v.useCallback(O=>{O.button===0&&(h||y(!1),i==null||i(O))},[i,h]),B=v.useCallback(O=>{if(n){O.preventDefault();return}f==null||f(O)},[n,f]),Z=v.useCallback(O=>{g&&(O.preventDefault(),y(!1)),m==null||m(O)},[g,m]),$=_e(e,k);return h?{...b,ref:$,type:"button","aria-disabled":C?void 0:n,disabled:C,onClick:x,onMouseDown:a,onMouseUp:i,onKeyUp:c,onKeyDown:u,onMouseOver:f,onMouseLeave:m}:{...b,ref:$,role:"button","data-active":Ue(g),"aria-disabled":n?"true":void 0,tabIndex:C?void 0:E,onClick:x,onMouseDown:K,onMouseUp:T,onKeyUp:P,onKeyDown:D,onMouseOver:B,onMouseLeave:Z}}function ic(t){const e=t.current;if(!e)return!1;const n=tl(e);return!n||e.contains(n)?!1:!!nl(n)}function Da(t,e){const{shouldFocus:n,visible:r,focusRef:o}=e,s=n&&!r;gr(()=>{if(!s||ic(t))return;const a=(o==null?void 0:o.current)||t.current;let i;if(a)return i=requestAnimationFrame(()=>{a.focus({preventScroll:!0})}),()=>{cancelAnimationFrame(i)}},[s,t,o])}var lc={preventScroll:!0,shouldFocus:!1};function cc(t,e=lc){const{focusRef:n,preventScroll:r,shouldFocus:o,visible:s}=e,a=uc(t)?t.current:t,i=o&&s,l=v.useRef(i),u=v.useRef(s);Qi(()=>{!u.current&&s&&(l.current=i),u.current=s},[s,i]);const c=v.useCallback(()=>{if(!(!s||!a||!l.current)&&(l.current=!1,!a.contains(document.activeElement)))if(n!=null&&n.current)requestAnimationFrame(()=>{var d;(d=n.current)==null||d.focus({preventScroll:r})});else{const d=el(a);d.length>0&&requestAnimationFrame(()=>{d[0].focus({preventScroll:r})})}},[s,r,a,n]);gr(()=>{c()},[c]),Bt(a,"transitionend",c)}function uc(t){return"current"in t}var Ft=(t,e)=>({var:t,varRef:e?`var(${t}, ${e})`:`var(${t})`}),fe={arrowShadowColor:Ft("--popper-arrow-shadow-color"),arrowSize:Ft("--popper-arrow-size","8px"),arrowSizeHalf:Ft("--popper-arrow-size-half"),arrowBg:Ft("--popper-arrow-bg"),transformOrigin:Ft("--popper-transform-origin"),arrowOffset:Ft("--popper-arrow-offset")};function dc(t){if(t.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}var fc={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},hc=t=>fc[t],Os={scroll:!0,resize:!0};function pc(t){let e;return typeof t=="object"?e={enabled:!0,options:{...Os,...t}}:e={enabled:t,options:Os},e}var mc={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`},effect:({state:t})=>()=>{const e=t.elements.reference;t.elements.popper.style.width=`${e.offsetWidth}px`}},vc={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:t})=>{Ps(t)},effect:({state:t})=>()=>{Ps(t)}},Ps=t=>{t.elements.popper.style.setProperty(fe.transformOrigin.var,hc(t.placement))},yc={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:t})=>{gc(t)}},gc=t=>{var e;if(!t.placement)return;const n=wc(t.placement);if((e=t.elements)!=null&&e.arrow&&n){Object.assign(t.elements.arrow.style,{[n.property]:n.value,width:fe.arrowSize.varRef,height:fe.arrowSize.varRef,zIndex:-1});const r={[fe.arrowSizeHalf.var]:`calc(${fe.arrowSize.varRef} / 2 - 1px)`,[fe.arrowOffset.var]:`calc(${fe.arrowSizeHalf.varRef} * -1)`};for(const o in r)t.elements.arrow.style.setProperty(o,r[o])}},wc=t=>{if(t.startsWith("top"))return{property:"bottom",value:fe.arrowOffset.varRef};if(t.startsWith("bottom"))return{property:"top",value:fe.arrowOffset.varRef};if(t.startsWith("left"))return{property:"right",value:fe.arrowOffset.varRef};if(t.startsWith("right"))return{property:"left",value:fe.arrowOffset.varRef}},bc={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:t})=>{js(t)},effect:({state:t})=>()=>{js(t)}},js=t=>{if(!t.elements.arrow)return;const e=t.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!e)return;const n=dc(t.placement);n&&e.style.setProperty("--popper-arrow-default-shadow",n),Object.assign(e.style,{transform:"rotate(45deg)",background:fe.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},xc={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},_c={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function kc(t,e="ltr"){var n,r;const o=((n=xc[t])==null?void 0:n[e])||t;return e==="ltr"?o:(r=_c[t])!=null?r:o}var Pe="top",Re="bottom",Te="right",je="left",Jo="auto",Dn=[Pe,Re,Te,je],zt="start",mn="end",Cc="clippingParents",Ia="viewport",tn="popper",Ec="reference",Ns=Dn.reduce(function(t,e){return t.concat([e+"-"+zt,e+"-"+mn])},[]),Sa=[].concat(Dn,[Jo]).reduce(function(t,e){return t.concat([e,e+"-"+zt,e+"-"+mn])},[]),Dc="beforeRead",Ic="read",Sc="afterRead",Oc="beforeMain",Pc="main",jc="afterMain",Nc="beforeWrite",Ac="write",Fc="afterWrite",Mc=[Dc,Ic,Sc,Oc,Pc,jc,Nc,Ac,Fc];function He(t){return t?(t.nodeName||"").toLowerCase():null}function Ae(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Et(t){var e=Ae(t).Element;return t instanceof e||t instanceof Element}function Me(t){var e=Ae(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Go(t){if(typeof ShadowRoot>"u")return!1;var e=Ae(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Rc(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},o=e.attributes[n]||{},s=e.elements[n];!Me(s)||!He(s)||(Object.assign(s.style,r),Object.keys(o).forEach(function(a){var i=o[a];i===!1?s.removeAttribute(a):s.setAttribute(a,i===!0?"":i)}))})}function Tc(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var o=e.elements[r],s=e.attributes[r]||{},a=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),i=a.reduce(function(l,u){return l[u]="",l},{});!Me(o)||!He(o)||(Object.assign(o.style,i),Object.keys(s).forEach(function(l){o.removeAttribute(l)}))})}}const Lc={name:"applyStyles",enabled:!0,phase:"write",fn:Rc,effect:Tc,requires:["computeStyles"]};function qe(t){return t.split("-")[0]}var wt=Math.max,tr=Math.min,qt=Math.round;function Xr(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Oa(){return!/^((?!chrome|android).)*safari/i.test(Xr())}function Vt(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),o=1,s=1;e&&Me(t)&&(o=t.offsetWidth>0&&qt(r.width)/t.offsetWidth||1,s=t.offsetHeight>0&&qt(r.height)/t.offsetHeight||1);var a=Et(t)?Ae(t):window,i=a.visualViewport,l=!Oa()&&n,u=(r.left+(l&&i?i.offsetLeft:0))/o,c=(r.top+(l&&i?i.offsetTop:0))/s,d=r.width/o,f=r.height/s;return{width:d,height:f,top:c,right:u+d,bottom:c+f,left:u,x:u,y:c}}function Yo(t){var e=Vt(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function Pa(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Go(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function tt(t){return Ae(t).getComputedStyle(t)}function Bc(t){return["table","td","th"].indexOf(He(t))>=0}function dt(t){return((Et(t)?t.ownerDocument:t.document)||window.document).documentElement}function kr(t){return He(t)==="html"?t:t.assignedSlot||t.parentNode||(Go(t)?t.host:null)||dt(t)}function As(t){return!Me(t)||tt(t).position==="fixed"?null:t.offsetParent}function Wc(t){var e=/firefox/i.test(Xr()),n=/Trident/i.test(Xr());if(n&&Me(t)){var r=tt(t);if(r.position==="fixed")return null}var o=kr(t);for(Go(o)&&(o=o.host);Me(o)&&["html","body"].indexOf(He(o))<0;){var s=tt(o);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return o;o=o.parentNode}return null}function In(t){for(var e=Ae(t),n=As(t);n&&Bc(n)&&tt(n).position==="static";)n=As(n);return n&&(He(n)==="html"||He(n)==="body"&&tt(n).position==="static")?e:n||Wc(t)||e}function Xo(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function ln(t,e,n){return wt(t,tr(e,n))}function Kc(t,e,n){var r=ln(t,e,n);return r>n?n:r}function ja(){return{top:0,right:0,bottom:0,left:0}}function Na(t){return Object.assign({},ja(),t)}function Aa(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var $c=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,Na(typeof e!="number"?e:Aa(e,Dn))};function Uc(t){var e,n=t.state,r=t.name,o=t.options,s=n.elements.arrow,a=n.modifiersData.popperOffsets,i=qe(n.placement),l=Xo(i),u=[je,Te].indexOf(i)>=0,c=u?"height":"width";if(!(!s||!a)){var d=$c(o.padding,n),f=Yo(s),m=l==="y"?Pe:je,b=l==="y"?Re:Te,h=n.rects.reference[c]+n.rects.reference[l]-a[l]-n.rects.popper[c],w=a[l]-n.rects.reference[l],g=In(s),y=g?l==="y"?g.clientHeight||0:g.clientWidth||0:0,_=h/2-w/2,k=d[m],E=y-f[c]-d[b],C=y/2-f[c]/2+_,x=ln(k,C,E),I=l;n.modifiersData[r]=(e={},e[I]=x,e.centerOffset=x-C,e)}}function zc(t){var e=t.state,n=t.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||Pa(e.elements.popper,o)&&(e.elements.arrow=o))}const qc={name:"arrow",enabled:!0,phase:"main",fn:Uc,effect:zc,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ht(t){return t.split("-")[1]}var Vc={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Hc(t,e){var n=t.x,r=t.y,o=e.devicePixelRatio||1;return{x:qt(n*o)/o||0,y:qt(r*o)/o||0}}function Fs(t){var e,n=t.popper,r=t.popperRect,o=t.placement,s=t.variation,a=t.offsets,i=t.position,l=t.gpuAcceleration,u=t.adaptive,c=t.roundOffsets,d=t.isFixed,f=a.x,m=f===void 0?0:f,b=a.y,h=b===void 0?0:b,w=typeof c=="function"?c({x:m,y:h}):{x:m,y:h};m=w.x,h=w.y;var g=a.hasOwnProperty("x"),y=a.hasOwnProperty("y"),_=je,k=Pe,E=window;if(u){var C=In(n),x="clientHeight",I="clientWidth";if(C===Ae(n)&&(C=dt(n),tt(C).position!=="static"&&i==="absolute"&&(x="scrollHeight",I="scrollWidth")),C=C,o===Pe||(o===je||o===Te)&&s===mn){k=Re;var D=d&&C===E&&E.visualViewport?E.visualViewport.height:C[x];h-=D-r.height,h*=l?1:-1}if(o===je||(o===Pe||o===Re)&&s===mn){_=Te;var P=d&&C===E&&E.visualViewport?E.visualViewport.width:C[I];m-=P-r.width,m*=l?1:-1}}var N=Object.assign({position:i},u&&Vc),K=c===!0?Hc({x:m,y:h},Ae(n)):{x:m,y:h};if(m=K.x,h=K.y,l){var T;return Object.assign({},N,(T={},T[k]=y?"0":"",T[_]=g?"0":"",T.transform=(E.devicePixelRatio||1)<=1?"translate("+m+"px, "+h+"px)":"translate3d("+m+"px, "+h+"px, 0)",T))}return Object.assign({},N,(e={},e[k]=y?h+"px":"",e[_]=g?m+"px":"",e.transform="",e))}function Jc(t){var e=t.state,n=t.options,r=n.gpuAcceleration,o=r===void 0?!0:r,s=n.adaptive,a=s===void 0?!0:s,i=n.roundOffsets,l=i===void 0?!0:i,u={placement:qe(e.placement),variation:Ht(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Fs(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Fs(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Gc={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Jc,data:{}};var Nn={passive:!0};function Yc(t){var e=t.state,n=t.instance,r=t.options,o=r.scroll,s=o===void 0?!0:o,a=r.resize,i=a===void 0?!0:a,l=Ae(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&u.forEach(function(c){c.addEventListener("scroll",n.update,Nn)}),i&&l.addEventListener("resize",n.update,Nn),function(){s&&u.forEach(function(c){c.removeEventListener("scroll",n.update,Nn)}),i&&l.removeEventListener("resize",n.update,Nn)}}const Xc={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Yc,data:{}};var Zc={left:"right",right:"left",bottom:"top",top:"bottom"};function Un(t){return t.replace(/left|right|bottom|top/g,function(e){return Zc[e]})}var Qc={start:"end",end:"start"};function Ms(t){return t.replace(/start|end/g,function(e){return Qc[e]})}function Zo(t){var e=Ae(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Qo(t){return Vt(dt(t)).left+Zo(t).scrollLeft}function eu(t,e){var n=Ae(t),r=dt(t),o=n.visualViewport,s=r.clientWidth,a=r.clientHeight,i=0,l=0;if(o){s=o.width,a=o.height;var u=Oa();(u||!u&&e==="fixed")&&(i=o.offsetLeft,l=o.offsetTop)}return{width:s,height:a,x:i+Qo(t),y:l}}function tu(t){var e,n=dt(t),r=Zo(t),o=(e=t.ownerDocument)==null?void 0:e.body,s=wt(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=wt(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),i=-r.scrollLeft+Qo(t),l=-r.scrollTop;return tt(o||n).direction==="rtl"&&(i+=wt(n.clientWidth,o?o.clientWidth:0)-s),{width:s,height:a,x:i,y:l}}function es(t){var e=tt(t),n=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Fa(t){return["html","body","#document"].indexOf(He(t))>=0?t.ownerDocument.body:Me(t)&&es(t)?t:Fa(kr(t))}function cn(t,e){var n;e===void 0&&(e=[]);var r=Fa(t),o=r===((n=t.ownerDocument)==null?void 0:n.body),s=Ae(r),a=o?[s].concat(s.visualViewport||[],es(r)?r:[]):r,i=e.concat(a);return o?i:i.concat(cn(kr(a)))}function Zr(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function nu(t,e){var n=Vt(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function Rs(t,e,n){return e===Ia?Zr(eu(t,n)):Et(e)?nu(e,n):Zr(tu(dt(t)))}function ru(t){var e=cn(kr(t)),n=["absolute","fixed"].indexOf(tt(t).position)>=0,r=n&&Me(t)?In(t):t;return Et(r)?e.filter(function(o){return Et(o)&&Pa(o,r)&&He(o)!=="body"}):[]}function ou(t,e,n,r){var o=e==="clippingParents"?ru(t):[].concat(e),s=[].concat(o,[n]),a=s[0],i=s.reduce(function(l,u){var c=Rs(t,u,r);return l.top=wt(c.top,l.top),l.right=tr(c.right,l.right),l.bottom=tr(c.bottom,l.bottom),l.left=wt(c.left,l.left),l},Rs(t,a,r));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}function Ma(t){var e=t.reference,n=t.element,r=t.placement,o=r?qe(r):null,s=r?Ht(r):null,a=e.x+e.width/2-n.width/2,i=e.y+e.height/2-n.height/2,l;switch(o){case Pe:l={x:a,y:e.y-n.height};break;case Re:l={x:a,y:e.y+e.height};break;case Te:l={x:e.x+e.width,y:i};break;case je:l={x:e.x-n.width,y:i};break;default:l={x:e.x,y:e.y}}var u=o?Xo(o):null;if(u!=null){var c=u==="y"?"height":"width";switch(s){case zt:l[u]=l[u]-(e[c]/2-n[c]/2);break;case mn:l[u]=l[u]+(e[c]/2-n[c]/2);break}}return l}function vn(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=r===void 0?t.placement:r,s=n.strategy,a=s===void 0?t.strategy:s,i=n.boundary,l=i===void 0?Cc:i,u=n.rootBoundary,c=u===void 0?Ia:u,d=n.elementContext,f=d===void 0?tn:d,m=n.altBoundary,b=m===void 0?!1:m,h=n.padding,w=h===void 0?0:h,g=Na(typeof w!="number"?w:Aa(w,Dn)),y=f===tn?Ec:tn,_=t.rects.popper,k=t.elements[b?y:f],E=ou(Et(k)?k:k.contextElement||dt(t.elements.popper),l,c,a),C=Vt(t.elements.reference),x=Ma({reference:C,element:_,strategy:"absolute",placement:o}),I=Zr(Object.assign({},_,x)),D=f===tn?I:C,P={top:E.top-D.top+g.top,bottom:D.bottom-E.bottom+g.bottom,left:E.left-D.left+g.left,right:D.right-E.right+g.right},N=t.modifiersData.offset;if(f===tn&&N){var K=N[o];Object.keys(P).forEach(function(T){var B=[Te,Re].indexOf(T)>=0?1:-1,Z=[Pe,Re].indexOf(T)>=0?"y":"x";P[T]+=K[Z]*B})}return P}function su(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=n.boundary,s=n.rootBoundary,a=n.padding,i=n.flipVariations,l=n.allowedAutoPlacements,u=l===void 0?Sa:l,c=Ht(r),d=c?i?Ns:Ns.filter(function(b){return Ht(b)===c}):Dn,f=d.filter(function(b){return u.indexOf(b)>=0});f.length===0&&(f=d);var m=f.reduce(function(b,h){return b[h]=vn(t,{placement:h,boundary:o,rootBoundary:s,padding:a})[qe(h)],b},{});return Object.keys(m).sort(function(b,h){return m[b]-m[h]})}function au(t){if(qe(t)===Jo)return[];var e=Un(t);return[Ms(t),e,Ms(e)]}function iu(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var o=n.mainAxis,s=o===void 0?!0:o,a=n.altAxis,i=a===void 0?!0:a,l=n.fallbackPlacements,u=n.padding,c=n.boundary,d=n.rootBoundary,f=n.altBoundary,m=n.flipVariations,b=m===void 0?!0:m,h=n.allowedAutoPlacements,w=e.options.placement,g=qe(w),y=g===w,_=l||(y||!b?[Un(w)]:au(w)),k=[w].concat(_).reduce(function(W,U){return W.concat(qe(U)===Jo?su(e,{placement:U,boundary:c,rootBoundary:d,padding:u,flipVariations:b,allowedAutoPlacements:h}):U)},[]),E=e.rects.reference,C=e.rects.popper,x=new Map,I=!0,D=k[0],P=0;P<k.length;P++){var N=k[P],K=qe(N),T=Ht(N)===zt,B=[Pe,Re].indexOf(K)>=0,Z=B?"width":"height",$=vn(e,{placement:N,boundary:c,rootBoundary:d,altBoundary:f,padding:u}),O=B?T?Te:je:T?Re:Pe;E[Z]>C[Z]&&(O=Un(O));var H=Un(O),G=[];if(s&&G.push($[K]<=0),i&&G.push($[O]<=0,$[H]<=0),G.every(function(W){return W})){D=N,I=!1;break}x.set(N,G)}if(I)for(var de=b?3:1,j=function(U){var q=k.find(function(te){var oe=x.get(te);if(oe)return oe.slice(0,U).every(function(ie){return ie})});if(q)return D=q,"break"},R=de;R>0;R--){var F=j(R);if(F==="break")break}e.placement!==D&&(e.modifiersData[r]._skip=!0,e.placement=D,e.reset=!0)}}const lu={name:"flip",enabled:!0,phase:"main",fn:iu,requiresIfExists:["offset"],data:{_skip:!1}};function Ts(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function Ls(t){return[Pe,Te,Re,je].some(function(e){return t[e]>=0})}function cu(t){var e=t.state,n=t.name,r=e.rects.reference,o=e.rects.popper,s=e.modifiersData.preventOverflow,a=vn(e,{elementContext:"reference"}),i=vn(e,{altBoundary:!0}),l=Ts(a,r),u=Ts(i,o,s),c=Ls(l),d=Ls(u);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}const uu={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:cu};function du(t,e,n){var r=qe(t),o=[je,Pe].indexOf(r)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,a=s[0],i=s[1];return a=a||0,i=(i||0)*o,[je,Te].indexOf(r)>=0?{x:i,y:a}:{x:a,y:i}}function fu(t){var e=t.state,n=t.options,r=t.name,o=n.offset,s=o===void 0?[0,0]:o,a=Sa.reduce(function(c,d){return c[d]=du(d,e.rects,s),c},{}),i=a[e.placement],l=i.x,u=i.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[r]=a}const hu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:fu};function pu(t){var e=t.state,n=t.name;e.modifiersData[n]=Ma({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const mu={name:"popperOffsets",enabled:!0,phase:"read",fn:pu,data:{}};function vu(t){return t==="x"?"y":"x"}function yu(t){var e=t.state,n=t.options,r=t.name,o=n.mainAxis,s=o===void 0?!0:o,a=n.altAxis,i=a===void 0?!1:a,l=n.boundary,u=n.rootBoundary,c=n.altBoundary,d=n.padding,f=n.tether,m=f===void 0?!0:f,b=n.tetherOffset,h=b===void 0?0:b,w=vn(e,{boundary:l,rootBoundary:u,padding:d,altBoundary:c}),g=qe(e.placement),y=Ht(e.placement),_=!y,k=Xo(g),E=vu(k),C=e.modifiersData.popperOffsets,x=e.rects.reference,I=e.rects.popper,D=typeof h=="function"?h(Object.assign({},e.rects,{placement:e.placement})):h,P=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),N=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,K={x:0,y:0};if(C){if(s){var T,B=k==="y"?Pe:je,Z=k==="y"?Re:Te,$=k==="y"?"height":"width",O=C[k],H=O+w[B],G=O-w[Z],de=m?-I[$]/2:0,j=y===zt?x[$]:I[$],R=y===zt?-I[$]:-x[$],F=e.elements.arrow,W=m&&F?Yo(F):{width:0,height:0},U=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:ja(),q=U[B],te=U[Z],oe=ln(0,x[$],W[$]),ie=_?x[$]/2-de-oe-q-P.mainAxis:j-oe-q-P.mainAxis,be=_?-x[$]/2+de+oe+te+P.mainAxis:R+oe+te+P.mainAxis,Ee=e.elements.arrow&&In(e.elements.arrow),Q=Ee?k==="y"?Ee.clientTop||0:Ee.clientLeft||0:0,me=(T=N==null?void 0:N[k])!=null?T:0,jt=O+ie-me-Q,Y=O+be-me,Se=ln(m?tr(H,jt):H,O,m?wt(G,Y):G);C[k]=Se,K[k]=Se-O}if(i){var ve,Be=k==="x"?Pe:je,Nt=k==="x"?Re:Te,We=C[E],At=E==="y"?"height":"width",Pr=We+w[Be],bs=We-w[Nt],jr=[Pe,je].indexOf(g)!==-1,xs=(ve=N==null?void 0:N[E])!=null?ve:0,_s=jr?Pr:We-x[At]-I[At]-xs+P.altAxis,ks=jr?We+x[At]+I[At]-xs-P.altAxis:bs,Cs=m&&jr?Kc(_s,We,ks):ln(m?_s:Pr,We,m?ks:bs);C[E]=Cs,K[E]=Cs-We}e.modifiersData[r]=K}}const gu={name:"preventOverflow",enabled:!0,phase:"main",fn:yu,requiresIfExists:["offset"]};function wu(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function bu(t){return t===Ae(t)||!Me(t)?Zo(t):wu(t)}function xu(t){var e=t.getBoundingClientRect(),n=qt(e.width)/t.offsetWidth||1,r=qt(e.height)/t.offsetHeight||1;return n!==1||r!==1}function _u(t,e,n){n===void 0&&(n=!1);var r=Me(e),o=Me(e)&&xu(e),s=dt(e),a=Vt(t,o,n),i={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((He(e)!=="body"||es(s))&&(i=bu(e)),Me(e)?(l=Vt(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Qo(s))),{x:a.left+i.scrollLeft-l.x,y:a.top+i.scrollTop-l.y,width:a.width,height:a.height}}function ku(t){var e=new Map,n=new Set,r=[];t.forEach(function(s){e.set(s.name,s)});function o(s){n.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(i){if(!n.has(i)){var l=e.get(i);l&&o(l)}}),r.push(s)}return t.forEach(function(s){n.has(s.name)||o(s)}),r}function Cu(t){var e=ku(t);return Mc.reduce(function(n,r){return n.concat(e.filter(function(o){return o.phase===r}))},[])}function Eu(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function Du(t){var e=t.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var Bs={placement:"bottom",modifiers:[],strategy:"absolute"};function Ws(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Iu(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,o=e.defaultOptions,s=o===void 0?Bs:o;return function(i,l,u){u===void 0&&(u=s);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Bs,s),modifiersData:{},elements:{reference:i,popper:l},attributes:{},styles:{}},d=[],f=!1,m={state:c,setOptions:function(g){var y=typeof g=="function"?g(c.options):g;h(),c.options=Object.assign({},s,c.options,y),c.scrollParents={reference:Et(i)?cn(i):i.contextElement?cn(i.contextElement):[],popper:cn(l)};var _=Cu(Du([].concat(r,c.options.modifiers)));return c.orderedModifiers=_.filter(function(k){return k.enabled}),b(),m.update()},forceUpdate:function(){if(!f){var g=c.elements,y=g.reference,_=g.popper;if(Ws(y,_)){c.rects={reference:_u(y,In(_),c.options.strategy==="fixed"),popper:Yo(_)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(P){return c.modifiersData[P.name]=Object.assign({},P.data)});for(var k=0;k<c.orderedModifiers.length;k++){if(c.reset===!0){c.reset=!1,k=-1;continue}var E=c.orderedModifiers[k],C=E.fn,x=E.options,I=x===void 0?{}:x,D=E.name;typeof C=="function"&&(c=C({state:c,options:I,name:D,instance:m})||c)}}}},update:Eu(function(){return new Promise(function(w){m.forceUpdate(),w(c)})}),destroy:function(){h(),f=!0}};if(!Ws(i,l))return m;m.setOptions(u).then(function(w){!f&&u.onFirstUpdate&&u.onFirstUpdate(w)});function b(){c.orderedModifiers.forEach(function(w){var g=w.name,y=w.options,_=y===void 0?{}:y,k=w.effect;if(typeof k=="function"){var E=k({state:c,name:g,instance:m,options:_}),C=function(){};d.push(E||C)}})}function h(){d.forEach(function(w){return w()}),d=[]}return m}}var Su=[Xc,mu,Gc,Lc,hu,lu,gu,qc,uu],Ou=Iu({defaultModifiers:Su});function ts(t={}){const{enabled:e=!0,modifiers:n,placement:r="bottom",strategy:o="absolute",arrowPadding:s=8,eventListeners:a=!0,offset:i,gutter:l=8,flip:u=!0,boundary:c="clippingParents",preventOverflow:d=!0,matchWidth:f,direction:m="ltr"}=t,b=v.useRef(null),h=v.useRef(null),w=v.useRef(null),g=kc(r,m),y=v.useRef(()=>{}),_=v.useCallback(()=>{var P;!e||!b.current||!h.current||((P=y.current)==null||P.call(y),w.current=Ou(b.current,h.current,{placement:g,modifiers:[bc,yc,vc,{...mc,enabled:!!f},{name:"eventListeners",...pc(a)},{name:"arrow",options:{padding:s}},{name:"offset",options:{offset:i??[0,l]}},{name:"flip",enabled:!!u,options:{padding:8}},{name:"preventOverflow",enabled:!!d,options:{boundary:c}},...n??[]],strategy:o}),w.current.forceUpdate(),y.current=w.current.destroy)},[g,e,n,f,a,s,i,l,u,d,c,o]);v.useEffect(()=>()=>{var P;!b.current&&!h.current&&((P=w.current)==null||P.destroy(),w.current=null)},[]);const k=v.useCallback(P=>{b.current=P,_()},[_]),E=v.useCallback((P={},N=null)=>({...P,ref:_e(k,N)}),[k]),C=v.useCallback(P=>{h.current=P,_()},[_]),x=v.useCallback((P={},N=null)=>({...P,ref:_e(C,N),style:{...P.style,position:o,minWidth:f?void 0:"max-content",inset:"0 auto auto 0"}}),[o,C,f]),I=v.useCallback((P={},N=null)=>{const{size:K,shadowColor:T,bg:B,style:Z,...$}=P;return{...$,ref:N,"data-popper-arrow":"",style:Pu(P)}},[]),D=v.useCallback((P={},N=null)=>({...P,ref:N,"data-popper-arrow-inner":""}),[]);return{update(){var P;(P=w.current)==null||P.update()},forceUpdate(){var P;(P=w.current)==null||P.forceUpdate()},transformOrigin:fe.transformOrigin.varRef,referenceRef:k,popperRef:C,getPopperProps:x,getArrowProps:I,getArrowInnerProps:D,getReferenceProps:E}}function Pu(t){const{size:e,shadowColor:n,bg:r,style:o}=t,s={...o,position:"absolute"};return e&&(s["--popper-arrow-size"]=e),n&&(s["--popper-arrow-shadow-color"]=n),r&&(s["--popper-arrow-bg"]=r),s}function ns(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=yt(n),a=yt(e),[i,l]=v.useState(t.defaultIsOpen||!1),u=r!==void 0?r:i,c=r!==void 0,d=v.useId(),f=o??`disclosure-${d}`,m=v.useCallback(()=>{c||l(!1),a==null||a()},[c,a]),b=v.useCallback(()=>{c||l(!0),s==null||s()},[c,s]),h=v.useCallback(()=>{u?m():b()},[u,b,m]);function w(y={}){return{...y,"aria-expanded":u,"aria-controls":f,onClick(_){var k;(k=y.onClick)==null||k.call(y,_),h()}}}function g(y={}){return{...y,hidden:!u,id:f}}return{isOpen:u,onOpen:b,onClose:m,onToggle:h,isControlled:c,getButtonProps:w,getDisclosureProps:g}}function ju(t){const{ref:e,handler:n,enabled:r=!0}=t,o=yt(n),a=v.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;v.useEffect(()=>{if(!r)return;const i=d=>{Mr(d,e)&&(a.isPointerDown=!0)},l=d=>{if(a.ignoreEmulatedMouseEvents){a.ignoreEmulatedMouseEvents=!1;return}a.isPointerDown&&n&&Mr(d,e)&&(a.isPointerDown=!1,o(d))},u=d=>{a.ignoreEmulatedMouseEvents=!0,n&&a.isPointerDown&&Mr(d,e)&&(a.isPointerDown=!1,o(d))},c=Ra(e.current);return c.addEventListener("mousedown",i,!0),c.addEventListener("mouseup",l,!0),c.addEventListener("touchstart",i,!0),c.addEventListener("touchend",u,!0),()=>{c.removeEventListener("mousedown",i,!0),c.removeEventListener("mouseup",l,!0),c.removeEventListener("touchstart",i,!0),c.removeEventListener("touchend",u,!0)}},[n,e,o,a,r])}function Mr(t,e){var n;const r=t.target;return r&&!Ra(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function Ra(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function Ta(t){const{isOpen:e,ref:n}=t,[r,o]=v.useState(e),[s,a]=v.useState(!1);return v.useEffect(()=>{s||(o(e),a(!0))},[e,s,r]),Bt(()=>n.current,"animationend",()=>{o(e)}),{present:!(e?!1:!r),onComplete(){var l;const u=rl(n.current),c=new u.CustomEvent("animationend",{bubbles:!0});(l=n.current)==null||l.dispatchEvent(c)}}}function rs(t){const{wasSelected:e,enabled:n,isSelected:r,mode:o="unmount"}=t;return!!(!n||r||o==="keepMounted"&&e)}var[Nu,Au,Fu,Mu]=da(),[Ru,Sn]=$e({strict:!1,name:"MenuContext"});function Tu(t,...e){const n=v.useId(),r=t||n;return v.useMemo(()=>e.map(o=>`${o}-${r}`),[r,e])}function La(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function Ks(t){return La(t).activeElement===t}function Lu(t={}){const{id:e,closeOnSelect:n=!0,closeOnBlur:r=!0,initialFocusRef:o,autoSelect:s=!0,isLazy:a,isOpen:i,defaultIsOpen:l,onClose:u,onOpen:c,placement:d="bottom-start",lazyBehavior:f="unmount",direction:m,computePositionOnMount:b=!1,...h}=t,w=v.useRef(null),g=v.useRef(null),y=Fu(),_=v.useCallback(()=>{requestAnimationFrame(()=>{var F;(F=w.current)==null||F.focus({preventScroll:!1})})},[]),k=v.useCallback(()=>{const F=setTimeout(()=>{var W;if(o)(W=o.current)==null||W.focus();else{const U=y.firstEnabled();U&&T(U.index)}});H.current.add(F)},[y,o]),E=v.useCallback(()=>{const F=setTimeout(()=>{const W=y.lastEnabled();W&&T(W.index)});H.current.add(F)},[y]),C=v.useCallback(()=>{c==null||c(),s?k():_()},[s,k,_,c]),{isOpen:x,onOpen:I,onClose:D,onToggle:P}=ns({isOpen:i,defaultIsOpen:l,onClose:u,onOpen:C});ju({enabled:x&&r,ref:w,handler:F=>{var W;(W=g.current)!=null&&W.contains(F.target)||D()}});const N=ts({...h,enabled:x||b,placement:d,direction:m}),[K,T]=v.useState(-1);gr(()=>{x||T(-1)},[x]),Da(w,{focusRef:g,visible:x,shouldFocus:!0});const B=Ta({isOpen:x,ref:w}),[Z,$]=Tu(e,"menu-button","menu-list"),O=v.useCallback(()=>{I(),_()},[I,_]),H=v.useRef(new Set([]));v.useEffect(()=>{const F=H.current;return()=>{F.forEach(W=>clearTimeout(W)),F.clear()}},[]);const G=v.useCallback(()=>{I(),k()},[k,I]),de=v.useCallback(()=>{I(),E()},[I,E]),j=v.useCallback(()=>{var F,W;const U=La(w.current),q=(F=w.current)==null?void 0:F.contains(U.activeElement);if(!(x&&!q))return;const oe=(W=y.item(K))==null?void 0:W.node;oe==null||oe.focus({preventScroll:!0})},[x,K,y]),R=v.useRef(null);return{openAndFocusMenu:O,openAndFocusFirstItem:G,openAndFocusLastItem:de,onTransitionEnd:j,unstable__animationState:B,descendants:y,popper:N,buttonId:Z,menuId:$,forceUpdate:N.forceUpdate,orientation:"vertical",isOpen:x,onToggle:P,onOpen:I,onClose:D,menuRef:w,buttonRef:g,focusedIndex:K,closeOnSelect:n,closeOnBlur:r,autoSelect:s,setFocusedIndex:T,isLazy:a,lazyBehavior:f,initialFocusRef:o,rafId:R}}function Oh(t={},e=null){const n=Sn(),{onToggle:r,popper:o,openAndFocusFirstItem:s,openAndFocusLastItem:a}=n,i=v.useCallback(l=>{const u=l.key,d={Enter:s,ArrowDown:s,ArrowUp:a}[u];d&&(l.preventDefault(),l.stopPropagation(),d(l))},[s,a]);return{...t,ref:_e(n.buttonRef,e,o.referenceRef),id:n.buttonId,"data-active":Ue(n.isOpen),"aria-expanded":n.isOpen,"aria-haspopup":"menu","aria-controls":n.menuId,onClick:le(t.onClick,r),onKeyDown:le(t.onKeyDown,i)}}function Qr(t){var e;return Ku(t)&&!!((e=t==null?void 0:t.getAttribute("role"))!=null&&e.startsWith("menuitem"))}function Bu(t={},e=null){const n=Sn();if(!n)throw new Error("useMenuContext: context is undefined. Seems you forgot to wrap component within <Menu>");const{focusedIndex:r,setFocusedIndex:o,menuRef:s,isOpen:a,onClose:i,menuId:l,isLazy:u,lazyBehavior:c,unstable__animationState:d}=n,f=Au(),m=oc({preventDefault:g=>g.key!==" "&&Qr(g.target)}),b=v.useCallback(g=>{if(!g.currentTarget.contains(g.target))return;const y=g.key,k={Tab:C=>C.preventDefault(),Escape:i,ArrowDown:()=>{const C=f.nextEnabled(r);C&&o(C.index)},ArrowUp:()=>{const C=f.prevEnabled(r);C&&o(C.index)}}[y];if(k){g.preventDefault(),k(g);return}const E=m(C=>{const x=sc(f.values(),C,I=>{var D,P;return(P=(D=I==null?void 0:I.node)==null?void 0:D.textContent)!=null?P:""},f.item(r));if(x){const I=f.indexOf(x.node);o(I)}});Qr(g.target)&&E(g)},[f,r,m,i,o]),h=v.useRef(!1);a&&(h.current=!0);const w=rs({wasSelected:h.current,enabled:u,mode:c,isSelected:d.present});return{...t,ref:_e(s,e),children:w?t.children:null,tabIndex:-1,role:"menu",id:l,style:{...t.style,transformOrigin:"var(--popper-transform-origin)"},"aria-orientation":"vertical",onKeyDown:le(t.onKeyDown,b)}}function Wu(t={}){const{popper:e,isOpen:n}=Sn();return e.getPopperProps({...t,style:{visibility:n?"visible":"hidden",...t.style}})}function Ba(t={},e=null){const{onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onClick:s,onFocus:a,isDisabled:i,isFocusable:l,closeOnSelect:u,type:c,...d}=t,f=Sn(),{setFocusedIndex:m,focusedIndex:b,closeOnSelect:h,onClose:w,menuRef:g,isOpen:y,menuId:_,rafId:k}=f,E=v.useRef(null),C=`${_}-menuitem-${v.useId()}`,{index:x,register:I}=Mu({disabled:i&&!l}),D=v.useCallback(O=>{n==null||n(O),!i&&m(x)},[m,x,i,n]),P=v.useCallback(O=>{r==null||r(O),E.current&&!Ks(E.current)&&D(O)},[D,r]),N=v.useCallback(O=>{o==null||o(O),!i&&m(-1)},[m,i,o]),K=v.useCallback(O=>{s==null||s(O),Qr(O.currentTarget)&&(u??h)&&w()},[w,s,h,u]),T=v.useCallback(O=>{a==null||a(O),m(x)},[m,a,x]),B=x===b,Z=i&&!l;gr(()=>{if(y)return B&&!Z&&E.current?(k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(()=>{var O;(O=E.current)==null||O.focus({preventScroll:!0}),k.current=null})):g.current&&!Ks(g.current)&&g.current.focus({preventScroll:!0}),()=>{k.current&&cancelAnimationFrame(k.current)}},[B,Z,g,y]);const $=Ea({onClick:K,onFocus:T,onMouseEnter:D,onMouseMove:P,onMouseLeave:N,ref:_e(I,E,e),isDisabled:i,isFocusable:l});return{...d,...$,type:c??$.type,id:C,role:"menuitem",tabIndex:B?0:-1}}function Ph(t={},e=null){const{type:n="radio",isChecked:r,...o}=t;return{...Ba(o,e),role:`menuitem${n}`,"aria-checked":r}}function jh(t={}){const{children:e,type:n="radio",value:r,defaultValue:o,onChange:s,...a}=t,l=n==="radio"?"":[],[u,c]=fa({defaultValue:o??l,value:r,onChange:s}),d=v.useCallback(b=>{if(n==="radio"&&typeof u=="string"&&c(b),n==="checkbox"&&Array.isArray(u)){const h=u.includes(b)?u.filter(w=>w!==b):u.concat(b);c(h)}},[u,c,n]),m=Ho(e).map(b=>{if(b.type.id!=="MenuItemOption")return b;const h=g=>{var y,_;d(b.props.value),(_=(y=b.props).onClick)==null||_.call(y,g)},w=n==="radio"?b.props.value===u:u.includes(b.props.value);return v.cloneElement(b,{type:n,onClick:h,isChecked:w})});return{...a,children:m}}function Ku(t){var e;if(!$u(t))return!1;const n=(e=t.ownerDocument.defaultView)!=null?e:window;return t instanceof n.HTMLElement}function $u(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}var[Uu,Cr]=$e({name:"MenuStylesContext",errorMessage:`useMenuStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Menu />" `}),os=t=>{const{children:e}=t,n=St("Menu",t),r=Le(t),{direction:o}=To(),{descendants:s,...a}=Lu({...r,direction:o}),i=v.useMemo(()=>a,[a]),{isOpen:l,onClose:u,forceUpdate:c}=i;return p.jsx(Nu,{value:s,children:p.jsx(Ru,{value:i,children:p.jsx(Uu,{value:n,children:aa(e,{isOpen:l,onClose:u,forceUpdate:c})})})})};os.displayName="Menu";var Wa=J((t,e)=>{const n=Cr();return p.jsx(V.span,{ref:e,...t,__css:n.command,className:"chakra-menu__command"})});Wa.displayName="MenuCommand";var zu=J((t,e)=>{const{type:n,...r}=t,o=Cr(),s=r.as||n?n??void 0:"button",a=v.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...o.item}),[o.item]);return p.jsx(V.button,{ref:e,type:s,...r,__css:a})}),Ka=t=>{const{className:e,children:n,...r}=t,o=Cr(),s=v.Children.only(n),a=v.isValidElement(s)?v.cloneElement(s,{focusable:"false","aria-hidden":!0,className:re("chakra-menu__icon",s.props.className)}):null,i=re("chakra-menu__icon-wrapper",e);return p.jsx(V.span,{className:i,...r,__css:o.icon,children:a})};Ka.displayName="MenuIcon";var rt=J((t,e)=>{const{icon:n,iconSpacing:r="0.75rem",command:o,commandSpacing:s="0.75rem",children:a,...i}=t,l=Ba(i,e),c=n||o?p.jsx("span",{style:{pointerEvents:"none",flex:1},children:a}):a;return p.jsxs(zu,{...l,className:re("chakra-menu__menuitem",l.className),children:[n&&p.jsx(Ka,{fontSize:"0.8em",marginEnd:r,children:n}),c,o&&p.jsx(Wa,{marginStart:s,children:o})]})});rt.displayName="MenuItem";var qu={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},Vu=V(Lo.div),ss=J(function(e,n){var r,o;const{rootProps:s,motionProps:a,...i}=e,{isOpen:l,onTransitionEnd:u,unstable__animationState:c}=Sn(),d=Bu(i,n),f=Wu(s),m=Cr();return p.jsx(V.div,{...f,__css:{zIndex:(o=e.zIndex)!=null?o:(r=m.list)==null?void 0:r.zIndex},children:p.jsx(Vu,{variants:qu,initial:!1,animate:l?"enter":"exit",__css:{outline:0,...m.list},...a,className:re("chakra-menu__menu-list",d.className),...d,onUpdate:u,onAnimationComplete:ia(c.onComplete,d.onAnimationComplete)})})});ss.displayName="MenuList";var[Hu,Xt]=$e({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[Ju,Er]=$e({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `});function $a(t){const e=v.Children.only(t.children),{getTriggerProps:n}=Xt();return v.cloneElement(e,n(e.props,e.ref))}$a.displayName="PopoverTrigger";var Mt={click:"click",hover:"hover"};function Gu(t={}){const{closeOnBlur:e=!0,closeOnEsc:n=!0,initialFocusRef:r,id:o,returnFocusOnClose:s=!0,autoFocus:a=!0,arrowSize:i,arrowShadowColor:l,trigger:u=Mt.click,openDelay:c=200,closeDelay:d=200,isLazy:f,lazyBehavior:m="unmount",computePositionOnMount:b,...h}=t,{isOpen:w,onClose:g,onOpen:y,onToggle:_}=ns(t),k=v.useRef(null),E=v.useRef(null),C=v.useRef(null),x=v.useRef(!1),I=v.useRef(!1);w&&(I.current=!0);const[D,P]=v.useState(!1),[N,K]=v.useState(!1),T=v.useId(),B=o??T,[Z,$,O,H]=["popover-trigger","popover-content","popover-header","popover-body"].map(Y=>`${Y}-${B}`),{referenceRef:G,getArrowProps:de,getPopperProps:j,getArrowInnerProps:R,forceUpdate:F}=ts({...h,enabled:w||!!b}),W=Ta({isOpen:w,ref:C});Wl({enabled:w,ref:E}),Da(C,{focusRef:E,visible:w,shouldFocus:s&&u===Mt.click}),cc(C,{focusRef:r,visible:w,shouldFocus:a&&u===Mt.click});const U=rs({wasSelected:I.current,enabled:f,mode:m,isSelected:W.present}),q=v.useCallback((Y={},Se=null)=>{const ve={...Y,style:{...Y.style,transformOrigin:fe.transformOrigin.varRef,[fe.arrowSize.var]:i?`${i}px`:void 0,[fe.arrowShadowColor.var]:l},ref:_e(C,Se),children:U?Y.children:null,id:$,tabIndex:-1,role:"dialog",onKeyDown:le(Y.onKeyDown,Be=>{n&&Be.key==="Escape"&&g()}),onBlur:le(Y.onBlur,Be=>{const Nt=$s(Be),We=Rr(C.current,Nt),At=Rr(E.current,Nt);w&&e&&(!We&&!At)&&g()}),"aria-labelledby":D?O:void 0,"aria-describedby":N?H:void 0};return u===Mt.hover&&(ve.role="tooltip",ve.onMouseEnter=le(Y.onMouseEnter,()=>{x.current=!0}),ve.onMouseLeave=le(Y.onMouseLeave,Be=>{Be.nativeEvent.relatedTarget!==null&&(x.current=!1,setTimeout(()=>g(),d))})),ve},[U,$,D,O,N,H,u,n,g,w,e,d,l,i]),te=v.useCallback((Y={},Se=null)=>j({...Y,style:{visibility:w?"visible":"hidden",...Y.style}},Se),[w,j]),oe=v.useCallback((Y,Se=null)=>({...Y,ref:_e(Se,k,G)}),[k,G]),ie=v.useRef(),be=v.useRef(),Ee=v.useCallback(Y=>{k.current==null&&G(Y)},[G]),Q=v.useCallback((Y={},Se=null)=>{const ve={...Y,ref:_e(E,Se,Ee),id:Z,"aria-haspopup":"dialog","aria-expanded":w,"aria-controls":$};return u===Mt.click&&(ve.onClick=le(Y.onClick,_)),u===Mt.hover&&(ve.onFocus=le(Y.onFocus,()=>{ie.current===void 0&&y()}),ve.onBlur=le(Y.onBlur,Be=>{const Nt=$s(Be),We=!Rr(C.current,Nt);w&&e&&We&&g()}),ve.onKeyDown=le(Y.onKeyDown,Be=>{Be.key==="Escape"&&g()}),ve.onMouseEnter=le(Y.onMouseEnter,()=>{x.current=!0,ie.current=window.setTimeout(()=>y(),c)}),ve.onMouseLeave=le(Y.onMouseLeave,()=>{x.current=!1,ie.current&&(clearTimeout(ie.current),ie.current=void 0),be.current=window.setTimeout(()=>{x.current===!1&&g()},d)})),ve},[Z,w,$,u,Ee,_,y,e,g,c,d]);v.useEffect(()=>()=>{ie.current&&clearTimeout(ie.current),be.current&&clearTimeout(be.current)},[]);const me=v.useCallback((Y={},Se=null)=>({...Y,id:O,ref:_e(Se,ve=>{P(!!ve)})}),[O]),jt=v.useCallback((Y={},Se=null)=>({...Y,id:H,ref:_e(Se,ve=>{K(!!ve)})}),[H]);return{forceUpdate:F,isOpen:w,onAnimationComplete:W.onComplete,onClose:g,getAnchorProps:oe,getArrowProps:de,getArrowInnerProps:R,getPopoverPositionerProps:te,getPopoverProps:q,getTriggerProps:Q,getHeaderProps:me,getBodyProps:jt}}function Rr(t,e){return t===e||(t==null?void 0:t.contains(e))}function $s(t){var e;const n=t.currentTarget.ownerDocument.activeElement;return(e=t.relatedTarget)!=null?e:n}function Ua(t){const e=St("Popover",t),{children:n,...r}=Le(t),o=To(),s=Gu({...r,direction:o.direction});return p.jsx(Hu,{value:s,children:p.jsx(Ju,{value:e,children:aa(n,{isOpen:s.isOpen,onClose:s.onClose,forceUpdate:s.forceUpdate})})})}Ua.displayName="Popover";var Tr=(t,e)=>e?`${t}.${e}, ${e}`:void 0;function za(t){var e;const{bg:n,bgColor:r,backgroundColor:o,shadow:s,boxShadow:a,shadowColor:i}=t,{getArrowProps:l,getArrowInnerProps:u}=Xt(),c=Er(),d=(e=n??r)!=null?e:o,f=s??a;return p.jsx(V.div,{...l(),className:"chakra-popover__arrow-positioner",children:p.jsx(V.div,{className:re("chakra-popover__arrow",t.className),...u(t),__css:{"--popper-arrow-shadow-color":Tr("colors",i),"--popper-arrow-bg":Tr("colors",d),"--popper-arrow-shadow":Tr("shadows",f),...c.arrow}})})}za.displayName="PopoverArrow";var qa=J(function(e,n){const{getBodyProps:r}=Xt(),o=Er();return p.jsx(V.div,{...r(e,n),className:re("chakra-popover__body",e.className),__css:o.body})});qa.displayName="PopoverBody";var Va=J(function(e,n){const{onClose:r}=Xt(),o=Er();return p.jsx(ol,{size:"sm",onClick:r,className:re("chakra-popover__close-btn",e.className),__css:o.closeButton,ref:n,...e})});Va.displayName="PopoverCloseButton";function Yu(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}var Xu={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},Zu=V(Lo.section),Ha=J(function(e,n){const{variants:r=Xu,...o}=e,{isOpen:s}=Xt();return p.jsx(Zu,{ref:n,variants:Yu(r),initial:!1,animate:s?"enter":"exit",...o})});Ha.displayName="PopoverTransition";var Ja=J(function(e,n){const{rootProps:r,motionProps:o,...s}=e,{getPopoverProps:a,getPopoverPositionerProps:i,onAnimationComplete:l}=Xt(),u=Er(),c={position:"relative",display:"flex",flexDirection:"column",...u.content};return p.jsx(V.div,{...i(r),__css:u.popper,className:"chakra-popover__popper",children:p.jsx(Ha,{...o,...a(s,n),onAnimationComplete:ia(l,s.onAnimationComplete),className:re("chakra-popover__content",e.className),__css:c})})});Ja.displayName="PopoverContent";var[Qu,ed,td,nd]=da();function rd(t){var e;const{defaultIndex:n,onChange:r,index:o,isManual:s,isLazy:a,lazyBehavior:i="unmount",orientation:l="horizontal",direction:u="ltr",...c}=t,[d,f]=v.useState(n??0),[m,b]=fa({defaultValue:n??0,value:o,onChange:r});v.useEffect(()=>{o!=null&&f(o)},[o]);const h=td(),w=v.useId();return{id:`tabs-${(e=t.id)!=null?e:w}`,selectedIndex:m,focusedIndex:d,setSelectedIndex:b,setFocusedIndex:f,isManual:s,isLazy:a,lazyBehavior:i,orientation:l,descendants:h,direction:u,htmlProps:c}}var[od,Dr]=$e({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function sd(t){const{focusedIndex:e,orientation:n,direction:r}=Dr(),o=ed(),s=v.useCallback(a=>{const i=()=>{var y;const _=o.nextEnabled(e);_&&((y=_.node)==null||y.focus())},l=()=>{var y;const _=o.prevEnabled(e);_&&((y=_.node)==null||y.focus())},u=()=>{var y;const _=o.firstEnabled();_&&((y=_.node)==null||y.focus())},c=()=>{var y;const _=o.lastEnabled();_&&((y=_.node)==null||y.focus())},d=n==="horizontal",f=n==="vertical",m=a.key,b=r==="ltr"?"ArrowLeft":"ArrowRight",h=r==="ltr"?"ArrowRight":"ArrowLeft",g={[b]:()=>d&&l(),[h]:()=>d&&i(),ArrowDown:()=>f&&i(),ArrowUp:()=>f&&l(),Home:u,End:c}[m];g&&(a.preventDefault(),g(a))},[o,e,n,r]);return{...t,role:"tablist","aria-orientation":n,onKeyDown:le(t.onKeyDown,s)}}function ad(t){const{isDisabled:e=!1,isFocusable:n=!1,...r}=t,{setSelectedIndex:o,isManual:s,id:a,setFocusedIndex:i,selectedIndex:l}=Dr(),{index:u,register:c}=nd({disabled:e&&!n}),d=u===l,f=()=>{o(u)},m=()=>{i(u),!s&&!(e&&n)&&o(u)},b=Ea({...r,ref:_e(c,t.ref),isDisabled:e,isFocusable:n,onClick:le(t.onClick,f)}),h="button";return{...b,id:Ga(a,u),role:"tab",tabIndex:d?0:-1,type:h,"aria-selected":d,"aria-controls":Ya(a,u),onFocus:e?void 0:le(t.onFocus,m)}}var[id,ld]=$e({});function cd(t){const e=Dr(),{id:n,selectedIndex:r}=e,s=Ho(t.children).map((a,i)=>v.createElement(id,{key:i,value:{isSelected:i===r,id:Ya(n,i),tabId:Ga(n,i),selectedIndex:r}},a));return{...t,children:s}}function ud(t){const{children:e,...n}=t,{isLazy:r,lazyBehavior:o}=Dr(),{isSelected:s,id:a,tabId:i}=ld(),l=v.useRef(!1);s&&(l.current=!0);const u=rs({wasSelected:l.current,isSelected:s,enabled:r,mode:o});return{tabIndex:0,...n,children:u?e:null,role:"tabpanel","aria-labelledby":i,hidden:!s,id:a}}function Ga(t,e){return`${t}--tab-${e}`}function Ya(t,e){return`${t}--tabpanel-${e}`}var[dd,Ir]=$e({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),Xa=J(function(e,n){const r=St("Tabs",e),{children:o,className:s,...a}=Le(e),{htmlProps:i,descendants:l,...u}=rd(a),c=v.useMemo(()=>u,[u]),{isFitted:d,...f}=i,m={position:"relative",...r.root};return p.jsx(Qu,{value:l,children:p.jsx(od,{value:c,children:p.jsx(dd,{value:r,children:p.jsx(V.div,{className:re("chakra-tabs",s),ref:n,...f,__css:m,children:o})})})})});Xa.displayName="Tabs";var Za=J(function(e,n){const r=sd({...e,ref:n}),s={display:"flex",...Ir().tablist};return p.jsx(V.div,{...r,className:re("chakra-tabs__tablist",e.className),__css:s})});Za.displayName="TabList";var eo=J(function(e,n){const r=ud({...e,ref:n}),o=Ir();return p.jsx(V.div,{outline:"0",...r,className:re("chakra-tabs__tab-panel",e.className),__css:o.tabpanel})});eo.displayName="TabPanel";var Qa=J(function(e,n){const r=cd(e),o=Ir();return p.jsx(V.div,{...r,width:"100%",ref:n,className:re("chakra-tabs__tab-panels",e.className),__css:o.tabpanels})});Qa.displayName="TabPanels";var to=J(function(e,n){const r=Ir(),o=ad({...e,ref:n}),s={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...r.tab};return p.jsx(V.button,{...o,className:re("chakra-tabs__tab",e.className),__css:s})});to.displayName="Tab";var fd={exit:{scale:.85,opacity:0,transition:{opacity:{duration:.15,easings:"easeInOut"},scale:{duration:.2,easings:"easeInOut"}}},enter:{scale:1,opacity:1,transition:{opacity:{easings:"easeOut",duration:.2},scale:{duration:.2,ease:[.175,.885,.4,1.1]}}}},no=t=>{var e;return((e=t.current)==null?void 0:e.ownerDocument)||document},zn=t=>{var e,n;return((n=(e=t.current)==null?void 0:e.ownerDocument)==null?void 0:n.defaultView)||window};function hd(t={}){const{openDelay:e=0,closeDelay:n=0,closeOnClick:r=!0,closeOnMouseDown:o,closeOnScroll:s,closeOnPointerDown:a=o,closeOnEsc:i=!0,onOpen:l,onClose:u,placement:c,id:d,isOpen:f,defaultIsOpen:m,arrowSize:b=10,arrowShadowColor:h,arrowPadding:w,modifiers:g,isDisabled:y,gutter:_,offset:k,direction:E,...C}=t,{isOpen:x,onOpen:I,onClose:D}=ns({isOpen:f,defaultIsOpen:m,onOpen:l,onClose:u}),{referenceRef:P,getPopperProps:N,getArrowInnerProps:K,getArrowProps:T}=ts({enabled:x,placement:c,arrowPadding:w,modifiers:g,gutter:_,offset:k,direction:E}),B=v.useId(),$=`tooltip-${d??B}`,O=v.useRef(null),H=v.useRef(),G=v.useCallback(()=>{H.current&&(clearTimeout(H.current),H.current=void 0)},[]),de=v.useRef(),j=v.useCallback(()=>{de.current&&(clearTimeout(de.current),de.current=void 0)},[]),R=v.useCallback(()=>{j(),D()},[D,j]),F=pd(O,R),W=v.useCallback(()=>{if(!y&&!H.current){x&&F();const Q=zn(O);H.current=Q.setTimeout(I,e)}},[F,y,x,I,e]),U=v.useCallback(()=>{G();const Q=zn(O);de.current=Q.setTimeout(R,n)},[n,R,G]),q=v.useCallback(()=>{x&&r&&U()},[r,U,x]),te=v.useCallback(()=>{x&&a&&U()},[a,U,x]),oe=v.useCallback(Q=>{x&&Q.key==="Escape"&&U()},[x,U]);Bt(()=>no(O),"keydown",i?oe:void 0),Bt(()=>{if(!s)return null;const Q=O.current;if(!Q)return null;const me=ba(Q);return me.localName==="body"?zn(O):me},"scroll",()=>{x&&s&&R()},{passive:!0,capture:!0}),v.useEffect(()=>{y&&(G(),x&&D())},[y,x,D,G]),v.useEffect(()=>()=>{G(),j()},[G,j]),Bt(()=>O.current,"pointerleave",U);const ie=v.useCallback((Q={},me=null)=>({...Q,ref:_e(O,me,P),onPointerEnter:le(Q.onPointerEnter,Y=>{Y.pointerType!=="touch"&&W()}),onClick:le(Q.onClick,q),onPointerDown:le(Q.onPointerDown,te),onFocus:le(Q.onFocus,W),onBlur:le(Q.onBlur,U),"aria-describedby":x?$:void 0}),[W,U,te,x,$,q,P]),be=v.useCallback((Q={},me=null)=>N({...Q,style:{...Q.style,[fe.arrowSize.var]:b?`${b}px`:void 0,[fe.arrowShadowColor.var]:h}},me),[N,b,h]),Ee=v.useCallback((Q={},me=null)=>{const jt={...Q.style,position:"relative",transformOrigin:fe.transformOrigin.varRef};return{ref:me,...C,...Q,id:$,role:"tooltip",style:jt}},[C,$]);return{isOpen:x,show:W,hide:U,getTriggerProps:ie,getTooltipProps:Ee,getTooltipPositionerProps:be,getArrowProps:T,getArrowInnerProps:K}}var Lr="chakra-ui:close-tooltip";function pd(t,e){return v.useEffect(()=>{const n=no(t);return n.addEventListener(Lr,e),()=>n.removeEventListener(Lr,e)},[e,t]),()=>{const n=no(t),r=zn(t);n.dispatchEvent(new r.CustomEvent(Lr))}}function md(t,e=[]){const n=Object.assign({},t);for(const r of e)r in n&&delete n[r];return n}function vd(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}var yd=V(Lo.div),bt=J((t,e)=>{var n,r;const o=Cn("Tooltip",t),s=Le(t),a=To(),{children:i,label:l,shouldWrapChildren:u,"aria-label":c,hasArrow:d,bg:f,portalProps:m,background:b,backgroundColor:h,bgColor:w,motionProps:g,...y}=s,_=(r=(n=b??h)!=null?n:f)!=null?r:w;if(_){o.bg=_;const N=sl(a,"colors",_);o[fe.arrowBg.var]=N}const k=hd({...y,direction:a.direction}),E=typeof i=="string"||u;let C;if(E)C=p.jsx(V.span,{display:"inline-block",tabIndex:0,...k.getTriggerProps(),children:i});else{const N=v.Children.only(i);C=v.cloneElement(N,k.getTriggerProps(N.props,N.ref))}const x=!!c,I=k.getTooltipProps({},e),D=x?md(I,["role","id"]):I,P=vd(I,["role","id"]);return l?p.jsxs(p.Fragment,{children:[C,p.jsx(al,{children:k.isOpen&&p.jsx(la,{...m,children:p.jsx(V.div,{...k.getTooltipPositionerProps(),__css:{zIndex:o.zIndex,pointerEvents:"none"},children:p.jsxs(yd,{variants:fd,initial:"exit",animate:"enter",exit:"exit",...g,...D,__css:o,children:[l,x&&p.jsx(V.span,{srOnly:!0,...P,children:c}),d&&p.jsx(V.div,{"data-popper-arrow":!0,className:"chakra-tooltip__arrow-wrapper",children:p.jsx(V.div,{"data-popper-arrow-inner":!0,className:"chakra-tooltip__arrow",__css:{bg:o.bg}})})]})})})})]}):p.jsx(p.Fragment,{children:i})});bt.displayName="Tooltip";let An;const gd=new Uint8Array(16);function wd(){if(!An&&(An=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!An))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return An(gd)}const we=[];for(let t=0;t<256;++t)we.push((t+256).toString(16).slice(1));function bd(t,e=0){return we[t[e+0]]+we[t[e+1]]+we[t[e+2]]+we[t[e+3]]+"-"+we[t[e+4]]+we[t[e+5]]+"-"+we[t[e+6]]+we[t[e+7]]+"-"+we[t[e+8]]+we[t[e+9]]+"-"+we[t[e+10]]+we[t[e+11]]+we[t[e+12]]+we[t[e+13]]+we[t[e+14]]+we[t[e+15]]}const xd=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Us={randomUUID:xd};function Jt(t,e,n){if(Us.randomUUID&&!e&&!t)return Us.randomUUID();t=t||{};const r=t.random||(t.rng||wd)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let o=0;o<16;++o)e[n+o]=r[o];return e}return bd(r)}async function _d(t){console.warn("[workspace deprecated] getDB is deprecated",t);try{const e=await fetch(`/workspace/get_db?table=${t}`);return e.ok?await e.json():void 0}catch(e){console.error("Error fetching workspace:",e);return}}async function kd(t,e){try{return await(await fetch("/workspace/save_db",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table:t,json:e})})).text()}catch(n){console.error("Error saving workspace:",n)}}async function ei(t,e){try{return await(await fetch("/workspace/update_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,json_str:e})})).text()}catch(n){alert("Error saving workflow .json file: "+n),console.error("Error saving workspace:",n)}}async function ti(t,e=!1){try{return await(await fetch("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t,deleteEmptyFolder:e})})).text()}catch(n){console.error("Error deleting file:",n)}}async function Cd(t){try{return await(await fetch("/workspace/get_system_dir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absolute_dir:t??""})})).json()}catch(e){console.error("Error getting workflows dir:",e)}}async function Nh(){try{return await(await fetch("/workspace/open_workflow_file_browser",{method:"POST",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error open workflows folder:",t)}}async function Ed(t,e){try{return await(await fetch("/workspace/scan_local_new_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t,existFlowIds:e})})).json()}catch(n){console.error("Error scan local new files:",n)}}async function Ah(){try{return await(await fetch("/model_manager/get_model_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function Fh(){try{return await(await fetch("/model_manager/get_folder_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function Dd(t){try{return await(await fetch("/workspace/delete_folder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folder_path:t})})).text()}catch(e){console.error("Error move file:",e)}}const Id="backup",nr="workspace";let Fn=null;function Sd(){return new Promise((t,e)=>{const n=indexedDB.open("WorkspaceDB",3);n.onupgradeneeded=r=>{const o=r.target.result;o.objectStoreNames.contains(nr)||o.createObjectStore(nr,{keyPath:"id"})},n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{e(r.target.error)}})}async function Od(){try{return Fn==null&&(Fn=await Sd()),new Promise((t,e)=>{if(Fn==null)return e("indexDB is null");const o=Fn.transaction([nr],"readonly").objectStore(nr).get(Id);o.onsuccess=()=>{o.result?t(o.result.value):t(void 0)},o.onerror=()=>e(o.error)})}catch(t){console.error("Error while reading from database:",t)}}async function Pd(){try{return await Od()}catch(t){console.error("Error retrieving data from IndexedDB:",t)}}const se=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,he=Object.keys,Ce=Array.isArray;function Ie(t,e){return typeof e!="object"||he(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||se.Promise||(se.Promise=Promise);const yn=Object.getPrototypeOf,jd={}.hasOwnProperty;function Fe(t,e){return jd.call(t,e)}function Gt(t,e){typeof e=="function"&&(e=e(yn(t))),(typeof Reflect>"u"?he:Reflect.ownKeys)(e).forEach(n=>{Qe(t,n,e[n])})}const ni=Object.defineProperty;function Qe(t,e,n,r){ni(t,e,Ie(n&&Fe(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Wt(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Qe(t.prototype,"constructor",t),{extend:Gt.bind(null,t.prototype)}}}}const Nd=Object.getOwnPropertyDescriptor;function as(t,e){let n;return Nd(t,e)||(n=yn(t))&&as(n,e)}const Ad=[].slice;function rr(t,e,n){return Ad.call(t,e,n)}function ri(t,e){return e(t)}function rn(t){if(!t)throw new Error("Assertion Failed")}function oi(t){se.setImmediate?setImmediate(t):setTimeout(t,0)}function si(t,e){return t.reduce((n,r,o)=>{var s=e(r,o);return s&&(n[s[0]]=s[1]),n},{})}function et(t,e){if(Fe(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,o=e.length;r<o;++r){var s=et(t,e[r]);n.push(s)}return n}var a=e.indexOf(".");if(a!==-1){var i=t[e.substr(0,a)];return i===void 0?void 0:et(i,e.substr(a+1))}}function Ke(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){rn(typeof n!="string"&&"length"in n);for(var r=0,o=e.length;r<o;++r)Ke(t,e[r],n[r])}else{var s=e.indexOf(".");if(s!==-1){var a=e.substr(0,s),i=e.substr(s+1);if(i==="")n===void 0?Ce(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=n;else{var l=t[a];l&&Fe(t,a)||(l=t[a]={}),Ke(l,i,n)}}else n===void 0?Ce(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function ai(t){var e={};for(var n in t)Fe(t,n)&&(e[n]=t[n]);return e}const Fd=[].concat;function ii(t){return Fd.apply([],t)}const li="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ii([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>se[t]),Md=li.map(t=>se[t]);si(li,t=>[t,!0]);let st=null;function On(t){st=typeof WeakMap<"u"&&new WeakMap;const e=ro(t);return st=null,e}function ro(t){if(!t||typeof t!="object")return t;let e=st&&st.get(t);if(e)return e;if(Ce(t)){e=[],st&&st.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(ro(t[n]))}else if(Md.indexOf(t.constructor)>=0)e=t;else{const s=yn(t);for(var o in e=s===Object.prototype?{}:Object.create(s),st&&st.set(t,e),t)Fe(t,o)&&(e[o]=ro(t[o]))}return e}const{toString:Rd}={};function oo(t){return Rd.call(t).slice(8,-1)}const so=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Td=typeof so=="symbol"?function(t){var e;return t!=null&&(e=t[so])&&e.apply(t)}:function(){return null},Lt={};function Xe(t){var e,n,r,o;if(arguments.length===1){if(Ce(t))return t.slice();if(this===Lt&&typeof t=="string")return[t];if(o=Td(t)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const is=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Je=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ci(t,e){Je=t,ui=e}var ui=()=>!0;const Ld=!new Error("").stack;function Ot(){if(Ld)try{throw Ot.arguments,new Error}catch(t){return t}return new Error}function ao(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(ui).map(r=>`
`+r).join("")):""}var di=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ls=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(di),Bd={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Kt(t,e){this._e=Ot(),this.name=t,this.message=e}function fi(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,o)=>o.indexOf(n)===r).join(`
`)}function or(t,e,n,r){this._e=Ot(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=fi(t,e)}function un(t,e){this._e=Ot(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=fi(t,e)}Wt(Kt).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+ao(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Wt(or).from(Kt),Wt(un).from(Kt);var cs=ls.reduce((t,e)=>(t[e]=e+"Error",t),{});const Wd=Kt;var L=ls.reduce((t,e)=>{var n=e+"Error";function r(o,s){this._e=Ot(),this.name=n,o?typeof o=="string"?(this.message=`${o}${s?`
 `+s:""}`,this.inner=s||null):typeof o=="object"&&(this.message=`${o.name} ${o.message}`,this.inner=o):(this.message=Bd[e]||n,this.inner=null)}return Wt(r).from(Wd),t[e]=r,t},{});L.Syntax=SyntaxError,L.Type=TypeError,L.Range=RangeError;var zs=di.reduce((t,e)=>(t[e+"Error"]=L[e],t),{}),qn=ls.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=L[e]),t),{});function ne(){}function gn(t){return t}function Kd(t,e){return t==null||t===gn?e:function(n){return e(t(n))}}function Dt(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function $d(t,e){return t===ne?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Dt(r,this.onsuccess):r),o&&(this.onerror=this.onerror?Dt(o,this.onerror):o),s!==void 0?s:n}}function Ud(t,e){return t===ne?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Dt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Dt(r,this.onerror):r)}}function zd(t,e){return t===ne?e:function(n){var r=t.apply(this,arguments);Ie(n,r);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?Dt(o,this.onsuccess):o),s&&(this.onerror=this.onerror?Dt(s,this.onerror):s),r===void 0?a===void 0?void 0:a:Ie(r,a)}}function qd(t,e){return t===ne?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function us(t,e){return t===ne?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return n.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}qn.ModifyError=or,qn.DexieError=Kt,qn.BulkError=un;var wn={};const hi=100,[io,sr,lo]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,yn(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,yn(e),t]})(),pi=sr&&sr.then,Vn=io&&io.constructor,ds=!!lo;var co=!1,Vd=lo?()=>{lo.then(Mn)}:se.setImmediate?setImmediate.bind(null,Mn):se.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{Mn(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(Mn,0)},dn=function(t,e){on.push([t,e]),ar&&(Vd(),ar=!1)},uo=!0,ar=!0,xt=[],Hn=[],fo=null,ho=gn,$t={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Hs,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{Hs(t[0],t[1])}catch{}})}},M=$t,on=[],_t=0,Jn=[];function A(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ne,this._lib=!1;var e=this._PSD=M;if(Je&&(this._stackHolder=Ot(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==wn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&mo(this,this._value))}this._state=null,this._value=null,++e.ref,vi(this,t)}const po={get:function(){var t=M,e=ir;function n(r,o){var s=!t.global&&(t!==M||e!==ir);const a=s&&!nt();var i=new A((l,u)=>{fs(this,new mi(lr(r,t,s,a),lr(o,t,s,a),l,u,t))});return Je&&wi(i,this),i}return n.prototype=wn,n},set:function(t){Qe(this,"then",t&&t.prototype===wn?po:{get:function(){return t},set:po.set})}};function mi(t,e,n,r,o){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=o}function vi(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Pn();n&&typeof n.then=="function"?vi(t,(o,s)=>{n instanceof A?n._then(o,s):n.then(o,s)}):(t._state=!0,t._value=n,yi(t)),r&&jn()}},mo.bind(null,t))}catch(n){mo(t,n)}}function mo(t,e){if(Hn.push(e),t._state===null){var n=t._lib&&Pn();e=ho(e),t._state=!1,t._value=e,Je&&e!==null&&typeof e=="object"&&!e._promise&&function(r,o,s){try{r.apply(null,s)}catch(a){o&&o(a)}}(()=>{var r=as(e,"stack");e._promise=t,Qe(e,"stack",{get:()=>co?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){xt.some(o=>o._value===r._value)||xt.push(r)}(t),yi(t),n&&jn()}}function yi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)fs(t,e[n]);var o=t._PSD;--o.ref||o.finalize(),_t===0&&(++_t,dn(()=>{--_t==0&&hs()},[]))}function fs(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++_t,dn(Hd,[n,t,e])}else t._listeners.push(e)}function Hd(t,e,n){try{fo=e;var r,o=e._value;e._state?r=t(o):(Hn.length&&(Hn=[]),r=t(o),Hn.indexOf(o)===-1&&function(s){for(var a=xt.length;a;)if(xt[--a]._value===s._value)return void xt.splice(a,1)}(e)),n.resolve(r)}catch(s){n.reject(s)}finally{fo=null,--_t==0&&hs(),--n.psd.ref||n.psd.finalize()}}function gi(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var o,s,a=t._value;a!=null?(o=a.name||"Error",s=a.message||a,r=ao(a,0)):(o=a,s=""),e.push(o+(s?": "+s:"")+r)}return Je&&((r=ao(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&gi(t._prev,e,n)),e}function wi(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function Mn(){Pn()&&jn()}function Pn(){var t=uo;return uo=!1,ar=!1,t}function jn(){var t,e,n;do for(;on.length>0;)for(t=on,on=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(on.length>0);uo=!0,ar=!0}function hs(){var t=xt;xt=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=Jn.slice(0),n=e.length;n;)e[--n]()}function Rn(t){return new A(wn,!1,t)}function ae(t,e){var n=M;return function(){var r=Pn(),o=M;try{return ct(n,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{ct(o,!1),r&&jn()}}}Gt(A.prototype,{then:po,_then:function(t,e){fs(this,new mi(null,null,t,e,M))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):Rn(r)):this.then(null,r=>r&&r.name===e?n(r):Rn(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),Rn(e)))},stack:{get:function(){if(this._stack)return this._stack;try{co=!0;var t=gi(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{co=!1}}},timeout:function(t,e){return t<1/0?new A((n,r)=>{var o=setTimeout(()=>r(new L.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Qe(A.prototype,Symbol.toStringTag,"Dexie.Promise"),$t.env=bi(),Gt(A,{all:function(){var t=Xe.apply(null,arguments).map(Tn);return new A(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((o,s)=>A.resolve(o).then(a=>{t[s]=a,--r||e(t)},n))})},resolve:t=>{if(t instanceof A)return t;if(t&&typeof t.then=="function")return new A((n,r)=>{t.then(n,r)});var e=new A(wn,!0,t);return wi(e,fo),e},reject:Rn,race:function(){var t=Xe.apply(null,arguments).map(Tn);return new A((e,n)=>{t.map(r=>A.resolve(r).then(e,n))})},PSD:{get:()=>M,set:t=>M=t},totalEchoes:{get:()=>ir},newPSD:lt,usePSD:Qt,scheduler:{get:()=>dn,set:t=>{dn=t}},rejectionMapper:{get:()=>ho,set:t=>{ho=t}},follow:(t,e)=>new A((n,r)=>lt((o,s)=>{var a=M;a.unhandleds=[],a.onunhandled=s,a.finalize=Dt(function(){(function(i){function l(){i(),Jn.splice(Jn.indexOf(l),1)}Jn.push(l),++_t,dn(()=>{--_t==0&&hs()},[])})(()=>{this.unhandleds.length===0?o():s(this.unhandleds[0])})},a.finalize),t()},e,n,r))}),Vn&&(Vn.allSettled&&Qe(A,"allSettled",function(){const t=Xe.apply(null,arguments).map(Tn);return new A(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((o,s)=>A.resolve(o).then(a=>r[s]={status:"fulfilled",value:a},a=>r[s]={status:"rejected",reason:a}).then(()=>--n||e(r)))})}),Vn.any&&typeof AggregateError<"u"&&Qe(A,"any",function(){const t=Xe.apply(null,arguments).map(Tn);return new A((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const o=new Array(r);t.forEach((s,a)=>A.resolve(s).then(i=>e(i),i=>{o[a]=i,--r||n(new AggregateError(o))}))})}));const ke={awaits:0,echoes:0,id:0};var Jd=0,Gn=[],Br=0,ir=0,Gd=0;function lt(t,e,n,r){var o=M,s=Object.create(o);s.parent=o,s.ref=0,s.global=!1,s.id=++Gd;var a=$t.env;s.env=ds?{Promise:A,PromiseProp:{value:A,configurable:!0,writable:!0},all:A.all,race:A.race,allSettled:A.allSettled,any:A.any,resolve:A.resolve,reject:A.reject,nthen:qs(a.nthen,s),gthen:qs(a.gthen,s)}:{},e&&Ie(s,e),++o.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var i=Qt(s,t,n,r);return s.ref===0&&s.finalize(),i}function Zt(){return ke.id||(ke.id=++Jd),++ke.awaits,ke.echoes+=hi,ke.id}function nt(){return!!ke.awaits&&(--ke.awaits==0&&(ke.id=0),ke.echoes=ke.awaits*hi,!0)}function Tn(t){return ke.echoes&&t&&t.constructor===Vn?(Zt(),t.then(e=>(nt(),e),e=>(nt(),ge(e)))):t}function Yd(t){++ir,ke.echoes&&--ke.echoes!=0||(ke.echoes=ke.id=0),Gn.push(M),ct(t,!0)}function Xd(){var t=Gn[Gn.length-1];Gn.pop(),ct(t,!1)}function ct(t,e){var n=M;if((e?!ke.echoes||Br++&&t===M:!Br||--Br&&t===M)||xi(e?Yd.bind(null,t):Xd),t!==M&&(M=t,n===$t&&($t.env=bi()),ds)){var r=$t.env.Promise,o=t.env;sr.then=o.nthen,r.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(se,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function bi(){var t=se.Promise;return ds?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(se,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:sr.then,gthen:t.prototype.then}:{}}function Qt(t,e,n,r,o){var s=M;try{return ct(t,!0),e(n,r,o)}finally{ct(s,!1)}}function xi(t){pi.call(io,t)}function lr(t,e,n,r){return typeof t!="function"?t:function(){var o=M;n&&Zt(),ct(e,!0);try{return t.apply(this,arguments)}finally{ct(o,!1),r&&xi(nt)}}}function qs(t,e){return function(n,r){return t.call(this,lr(n,e),lr(r,e))}}(""+pi).indexOf("[native code]")===-1&&(Zt=nt=ne);const Vs="unhandledrejection";function Hs(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,o={promise:e,reason:t};if(se.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(Vs,!0,!0),Ie(r,o)):se.CustomEvent&&Ie(r=new CustomEvent(Vs,{detail:o}),o),r&&se.dispatchEvent&&(dispatchEvent(r),!se.PromiseRejectionEvent&&se.onunhandledrejection))try{se.onunhandledrejection(r)}catch{}Je&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var ge=A.reject;function vo(t,e,n,r){if(t.idbdb&&(t._state.openComplete||M.letThrough||t._vip)){var o=t._createTransaction(e,n,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===cs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>vo(t,e,n,r))):ge(s)}return o._promise(e,(s,a)=>lt(()=>(M.trans=o,r(s,a,o)))).then(s=>o._completion.then(()=>s))}if(t._state.openComplete)return ge(new L.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return ge(new L.DatabaseClosed);t.open().catch(ne)}return t._state.dbReadyPromise.then(()=>vo(t,e,n,r))}const Js="3.2.4",vt="",yo=-1/0,Ge="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",_i="String expected.",fn=[],Sr=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Zd=Sr,Qd=Sr,ki=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),Or="__dbnames",Wr="readonly",Kr="readwrite";function It(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const Ci={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ln(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=On(e))[t],e)}class ef{_trans(e,n,r){const o=this._tx||M.trans,s=this.name;function a(l,u,c){if(!c.schema[s])throw new L.NotFound("Table "+s+" not part of transaction");return n(c.idbtrans,c)}const i=Pn();try{return o&&o.db===this.db?o===M.trans?o._promise(e,a,r):lt(()=>o._promise(e,a,r),{trans:o,transless:M.transless||M}):vo(this.db,e,[this.name],a)}finally{i&&jn()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(o=>this.hook.reading.fire(o))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(Ce(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=he(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(u=>u.compound&&n.every(c=>u.keyPath.indexOf(c)>=0)&&u.keyPath.every(c=>n.indexOf(c)>=0))[0];if(r&&this.db._maxKey!==vt)return this.where(r.name).equals(r.keyPath.map(u=>e[u]));!r&&Je&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:o}=this.schema,s=this.db._deps.indexedDB;function a(u,c){try{return s.cmp(u,c)===0}catch{return!1}}const[i,l]=n.reduce(([u,c],d)=>{const f=o[d],m=e[d];return[u||f,u||!f?It(c,f&&f.multi?b=>{const h=et(b,d);return Ce(h)&&h.some(w=>a(m,w))}:b=>a(m,et(b,d))):c]},[null,null]);return i?this.where(i.name).equals(e[i.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,Ce(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=r=>{if(!r)return r;const o=Object.create(e.prototype);for(var s in r)if(Fe(r,s))try{o[s]=r[s]}catch{}return o};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){Ie(this,e)})}add(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=Ln(o)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"add",keys:n!=null?[n]:null,values:[s]})).then(a=>a.numFailures?A.reject(a.failures[0]):a.lastResult).then(a=>{if(o)try{Ke(e,o,a)}catch{}return a})}update(e,n){if(typeof e!="object"||Ce(e))return this.where(":id").equals(e).modify(n);{const r=et(e,this.schema.primKey.keyPath);if(r===void 0)return ge(new L.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?he(n).forEach(o=>{Ke(e,o,n[o])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=Ln(o)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"put",values:[s],keys:n!=null?[n]:null})).then(a=>a.numFailures?A.reject(a.failures[0]):a.lastResult).then(a=>{if(o)try{Ke(e,o,a)}catch{}return a})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?A.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Ci})).then(e=>e.numFailures?A.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(o=>this.hook.reading.fire(o))))}bulkAdd(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:i,keyPath:l}=this.schema.primKey;if(l&&o)throw new L.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new L.InvalidArgument("Arguments objects and keys must have the same length");const u=e.length;let c=l&&i?e.map(Ln(l)):e;return this.core.mutate({trans:a,type:"add",keys:o,values:c,wantResults:s}).then(({numFailures:d,results:f,lastResult:m,failures:b})=>{if(d===0)return s?f:m;throw new un(`${this.name}.bulkAdd(): ${d} of ${u} operations failed`,b)})})}bulkPut(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:i,keyPath:l}=this.schema.primKey;if(l&&o)throw new L.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new L.InvalidArgument("Arguments objects and keys must have the same length");const u=e.length;let c=l&&i?e.map(Ln(l)):e;return this.core.mutate({trans:a,type:"put",keys:o,values:c,wantResults:s}).then(({numFailures:d,results:f,lastResult:m,failures:b})=>{if(d===0)return s?f:m;throw new un(`${this.name}.bulkPut(): ${d} of ${u} operations failed`,b)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:o,failures:s})=>{if(r===0)return o;throw new un(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,s)})}}function hn(t){var e={},n=function(a,i){if(i){for(var l=arguments.length,u=new Array(l-1);--l;)u[l-1]=arguments[l];return e[a].subscribe.apply(null,u),t}if(typeof a=="string")return e[a]};n.addEventType=s;for(var r=1,o=arguments.length;r<o;++r)s(arguments[r]);return n;function s(a,i,l){if(typeof a!="object"){var u;i||(i=qd),l||(l=ne);var c={subscribers:[],fire:l,subscribe:function(d){c.subscribers.indexOf(d)===-1&&(c.subscribers.push(d),c.fire=i(c.fire,d))},unsubscribe:function(d){c.subscribers=c.subscribers.filter(function(f){return f!==d}),c.fire=c.subscribers.reduce(i,l)}};return e[a]=n[a]=c,c}he(u=a).forEach(function(d){var f=u[d];if(Ce(f))s(d,u[d][0],u[d][1]);else{if(f!=="asap")throw new L.InvalidArgument("Invalid event config");var m=s(d,gn,function(){for(var b=arguments.length,h=new Array(b);b--;)h[b]=arguments[b];m.subscribers.forEach(function(w){oi(function(){w.apply(null,h)})})})}})}}function nn(t,e){return Wt(e).from({prototype:t}),e}function Rt(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function $r(t,e){t.filter=It(t.filter,e)}function Ur(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>It(r(),e()):e,t.justLimit=n&&!r}function Yn(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new L.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Gs(t,e,n){const r=Yn(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function Bn(t,e,n,r){const o=t.replayFilter?It(t.filter,t.replayFilter()):t.filter;if(t.or){const s={},a=(i,l,u)=>{if(!o||o(l,u,f=>l.stop(f),f=>l.fail(f))){var c=l.primaryKey,d=""+c;d==="[object ArrayBuffer]"&&(d=""+new Uint8Array(c)),Fe(s,d)||(s[d]=!0,e(i,l,u))}};return Promise.all([t.or._iterate(a,n),Ys(Gs(t,r,n),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}return Ys(Gs(t,r,n),It(t.algorithm,o),e,!t.keysOnly&&t.valueMapper)}function Ys(t,e,n,r){var o=ae(r?(s,a,i)=>n(r(s),a,i):n);return t.then(s=>{if(s)return s.start(()=>{var a=()=>s.continue();e&&!e(s,i=>a=i,i=>{s.stop(i),a=ne},i=>{s.fail(i),a=ne})||o(s.value,s,i=>a=i),a()})})}function De(t,e){try{const n=Xs(t),r=Xs(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(o,s){const a=o.length,i=s.length,l=a<i?a:i;for(let u=0;u<l;++u)if(o[u]!==s[u])return o[u]<s[u]?-1:1;return a===i?0:a<i?-1:1}(Zs(t),Zs(e));case"Array":return function(o,s){const a=o.length,i=s.length,l=a<i?a:i;for(let u=0;u<l;++u){const c=De(o[u],s[u]);if(c!==0)return c}return a===i?0:a<i?-1:1}(t,e)}}catch{}return NaN}function Xs(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=oo(t);return n==="ArrayBuffer"?"binary":n}function Zs(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class tf{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,ge.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,ge.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=It(n.algorithm,e)}_iterate(e,n){return Bn(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Ie(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>Bn(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,o=r.table.core;if(Rt(r,!0))return o.count({trans:n,query:{index:Yn(r,o.schema),range:r.range}}).then(a=>Math.min(a,r.limit));var s=0;return Bn(r,()=>(++s,!1),n,o).then(()=>s)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),o=r[0],s=r.length-1;function a(u,c){return c?a(u[r[c]],c-1):u[o]}var i=this._ctx.dir==="next"?1:-1;function l(u,c){var d=a(u,s),f=a(c,s);return d<f?-i:d>f?i:0}return this.toArray(function(u){return u.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&Rt(r,!0)&&r.limit>0){const{valueMapper:o}=r,s=Yn(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:s,range:r.range}}).then(({result:a})=>o?a.map(o):a)}{const o=[];return Bn(r,s=>o.push(s),n,r.table.core).then(()=>o)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,Rt(n)?Ur(n,()=>{var r=e;return(o,s)=>r===0||(r===1?(--r,!1):(s(()=>{o.advance(r),r=0}),!1))}):Ur(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Ur(this._ctx,()=>{var n=e;return function(r,o,s){return--n<=0&&o(s),n>=0}},!0),this}until(e,n){return $r(this._ctx,function(r,o,s){return!e(r.value)||(o(s),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return $r(this._ctx,function(o){return e(o.value)}),n=this._ctx,r=e,n.isMatch=It(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.key,o)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.primaryKey,o)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&Rt(n,!0)&&n.limit>0)return this._read(o=>{var s=Yn(n,n.table.core.schema);return n.table.core.query({trans:o,values:!1,limit:n.limit,query:{index:s,range:n.range}})}).then(({result:o})=>o).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return $r(this._ctx,function(o){var s=o.primaryKey.toString(),a=Fe(r,s);return r[s]=!0,!a}),this}modify(e){var n=this._ctx;return this._write(r=>{var o;if(typeof e=="function")o=e;else{var s=he(e),a=s.length;o=function(h){for(var w=!1,g=0;g<a;++g){var y=s[g],_=e[y];et(h,y)!==_&&(Ke(h,y,_),w=!0)}return w}}const i=n.table.core,{outbound:l,extractKey:u}=i.schema.primaryKey,c=this.db._options.modifyChunkSize||200,d=[];let f=0;const m=[],b=(h,w)=>{const{failures:g,numFailures:y}=w;f+=h-y;for(let _ of he(g))d.push(g[_])};return this.clone().primaryKeys().then(h=>{const w=g=>{const y=Math.min(c,h.length-g);return i.getMany({trans:r,keys:h.slice(g,g+y),cache:"immutable"}).then(_=>{const k=[],E=[],C=l?[]:null,x=[];for(let D=0;D<y;++D){const P=_[D],N={value:On(P),primKey:h[g+D]};o.call(N,N.value,N)!==!1&&(N.value==null?x.push(h[g+D]):l||De(u(P),u(N.value))===0?(E.push(N.value),l&&C.push(h[g+D])):(x.push(h[g+D]),k.push(N.value)))}const I=Rt(n)&&n.limit===1/0&&(typeof e!="function"||e===zr)&&{index:n.index,range:n.range};return Promise.resolve(k.length>0&&i.mutate({trans:r,type:"add",values:k}).then(D=>{for(let P in D.failures)x.splice(parseInt(P),1);b(k.length,D)})).then(()=>(E.length>0||I&&typeof e=="object")&&i.mutate({trans:r,type:"put",keys:C,values:E,criteria:I,changeSpec:typeof e!="function"&&e}).then(D=>b(E.length,D))).then(()=>(x.length>0||I&&e===zr)&&i.mutate({trans:r,type:"delete",keys:x,criteria:I}).then(D=>b(x.length,D))).then(()=>h.length>g+y&&w(g+c))})};return w(0).then(()=>{if(d.length>0)throw new or("Error modifying one or more objects",d,f,m);return h.length})})})}delete(){var e=this._ctx,n=e.range;return Rt(e)&&(e.isPrimKey&&!Qd||n.type===3)?this._write(r=>{const{primaryKey:o}=e.table.core.schema,s=n;return e.table.core.count({trans:r,query:{index:o,range:s}}).then(a=>e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(({failures:i,lastResult:l,results:u,numFailures:c})=>{if(c)throw new or("Could not delete some values",Object.keys(i).map(d=>i[d]),a-c);return a-c}))}):this.modify(zr)}}const zr=(t,e)=>e.value=null;function nf(t,e){return t<e?-1:t===e?0:1}function rf(t,e){return t>e?-1:t===e?0:1}function Ne(t,e,n){var r=t instanceof Di?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function Tt(t){return new t.Collection(t,()=>Ei("")).limit(0)}function of(t,e,n,r,o,s){for(var a=Math.min(t.length,r.length),i=-1,l=0;l<a;++l){var u=e[l];if(u!==r[l])return o(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):o(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):i>=0?t.substr(0,i)+e[i]+n.substr(i+1):null;o(t[l],u)<0&&(i=l)}return a<r.length&&s==="next"?t+n.substr(t.length):a<t.length&&s==="prev"?t.substr(0,n.length):i<0?null:t.substr(0,i)+r[i]+n.substr(i+1)}function Wn(t,e,n,r){var o,s,a,i,l,u,c,d=n.length;if(!n.every(h=>typeof h=="string"))return Ne(t,_i);function f(h){o=function(g){return g==="next"?y=>y.toUpperCase():y=>y.toLowerCase()}(h),s=function(g){return g==="next"?y=>y.toLowerCase():y=>y.toUpperCase()}(h),a=h==="next"?nf:rf;var w=n.map(function(g){return{lower:s(g),upper:o(g)}}).sort(function(g,y){return a(g.lower,y.lower)});i=w.map(function(g){return g.upper}),l=w.map(function(g){return g.lower}),u=h,c=h==="next"?"":r}f("next");var m=new t.Collection(t,()=>ot(i[0],l[d-1]+r));m._ondirectionchange=function(h){f(h)};var b=0;return m._addAlgorithm(function(h,w,g){var y=h.key;if(typeof y!="string")return!1;var _=s(y);if(e(_,l,b))return!0;for(var k=null,E=b;E<d;++E){var C=of(y,_,i[E],l[E],a,u);C===null&&k===null?b=E+1:(k===null||a(k,C)>0)&&(k=C)}return w(k!==null?function(){h.continue(k+c)}:g),!1}),m}function ot(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function Ei(t){return{type:1,lower:t,upper:t}}class Di{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,o){r=r!==!1,o=o===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||o)&&(!r||!o)?Tt(this):new this.Collection(this,()=>ot(e,n,!r,!o))}catch{return Ne(this,Ge)}}equals(e){return e==null?Ne(this,Ge):new this.Collection(this,()=>Ei(e))}above(e){return e==null?Ne(this,Ge):new this.Collection(this,()=>ot(e,void 0,!0))}aboveOrEqual(e){return e==null?Ne(this,Ge):new this.Collection(this,()=>ot(e,void 0,!1))}below(e){return e==null?Ne(this,Ge):new this.Collection(this,()=>ot(void 0,e,!1,!0))}belowOrEqual(e){return e==null?Ne(this,Ge):new this.Collection(this,()=>ot(void 0,e))}startsWith(e){return typeof e!="string"?Ne(this,_i):this.between(e,e+vt,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):Wn(this,(n,r)=>n.indexOf(r[0])===0,[e],vt)}equalsIgnoreCase(e){return Wn(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=Xe.apply(Lt,arguments);return e.length===0?Tt(this):Wn(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=Xe.apply(Lt,arguments);return e.length===0?Tt(this):Wn(this,(n,r)=>r.some(o=>n.indexOf(o)===0),e,vt)}anyOf(){const e=Xe.apply(Lt,arguments);let n=this._cmp;try{e.sort(n)}catch{return Ne(this,Ge)}if(e.length===0)return Tt(this);const r=new this.Collection(this,()=>ot(e[0],e[e.length-1]));r._ondirectionchange=s=>{n=s==="next"?this._ascending:this._descending,e.sort(n)};let o=0;return r._addAlgorithm((s,a,i)=>{const l=s.key;for(;n(l,e[o])>0;)if(++o,o===e.length)return a(i),!1;return n(l,e[o])===0||(a(()=>{s.continue(e[o])}),!1)}),r}notEqual(e){return this.inAnyRange([[yo,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=Xe.apply(Lt,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Ne(this,Ge)}const n=e.reduce((r,o)=>r?r.concat([[r[r.length-1][1],o]]):[[yo,o]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,o=this._ascending,s=this._descending,a=this._min,i=this._max;if(e.length===0)return Tt(this);if(!e.every(y=>y[0]!==void 0&&y[1]!==void 0&&o(y[0],y[1])<=0))return Ne(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",L.InvalidArgument);const l=!n||n.includeLowers!==!1,u=n&&n.includeUppers===!0;let c,d=o;function f(y,_){return d(y[0],_[0])}try{c=e.reduce(function(y,_){let k=0,E=y.length;for(;k<E;++k){const C=y[k];if(r(_[0],C[1])<0&&r(_[1],C[0])>0){C[0]=a(C[0],_[0]),C[1]=i(C[1],_[1]);break}}return k===E&&y.push(_),y},[]),c.sort(f)}catch{return Ne(this,Ge)}let m=0;const b=u?y=>o(y,c[m][1])>0:y=>o(y,c[m][1])>=0,h=l?y=>s(y,c[m][0])>0:y=>s(y,c[m][0])>=0;let w=b;const g=new this.Collection(this,()=>ot(c[0][0],c[c.length-1][1],!l,!u));return g._ondirectionchange=y=>{y==="next"?(w=b,d=o):(w=h,d=s),c.sort(f)},g._addAlgorithm((y,_,k)=>{for(var E=y.key;w(E);)if(++m,m===c.length)return _(k),!1;return!!function(C){return!b(C)&&!h(C)}(E)||(this._cmp(E,c[m][1])===0||this._cmp(E,c[m][0])===0||_(()=>{d===o?y.continue(c[m][0]):y.continue(c[m][1])}),!1)}),g}startsWithAnyOf(){const e=Xe.apply(Lt,arguments);return e.every(n=>typeof n=="string")?e.length===0?Tt(this):this.inAnyRange(e.map(n=>[n,n+vt])):Ne(this,"startsWithAnyOf() only works with strings")}}function ze(t){return ae(function(e){return bn(e),t(e.target.error),!1})}function bn(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const xn="storagemutated",at="x-storagemutated-1",ut=hn(null,xn);class sf{_lock(){return rn(!M.global),++this._reculock,this._reculock!==1||M.global||(M.lockOwnerFor=this),this}_unlock(){if(rn(!M.global),--this._reculock==0)for(M.global||(M.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Qt(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&M.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(rn(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new L.DatabaseClosed(r);case"MissingAPIError":throw new L.MissingAPI(r.message,r);default:throw new L.OpenFailed(r)}if(!this.active)throw new L.TransactionInactive;return rn(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=ae(o=>{bn(o),this._reject(e.error)}),e.onabort=ae(o=>{bn(o),this.active&&this._reject(new L.Abort(e.error)),this.active=!1,this.on("abort").fire(o)}),e.oncomplete=ae(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&ut.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return ge(new L.ReadOnly("Transaction is readonly"));if(!this.active)return ge(new L.TransactionInactive);if(this._locked())return new A((s,a)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(s,a)},M])});if(r)return lt(()=>{var s=new A((a,i)=>{this._lock();const l=n(a,i,this);l&&l.then&&l.then(a,i)});return s.finally(()=>this._unlock()),s._lib=!0,s});var o=new A((s,a)=>{var i=n(s,a,this);i&&i.then&&i.then(s,a)});return o._lib=!0,o}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=A.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var o=n.idbtrans.objectStore(n.storeNames[0]);(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(o.get(-1/0).onsuccess=a)})()}var s=n._waitingFor;return new A((a,i)=>{r.then(l=>n._waitingQueue.push(ae(a.bind(null,l))),l=>n._waitingQueue.push(ae(i.bind(null,l)))).finally(()=>{n._waitingFor===s&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new L.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(Fe(n,e))return n[e];const r=this.schema[e];if(!r)throw new L.NotFound("Table "+e+" not part of transaction");const o=new this.db.Table(e,r,this);return o.core=this.db.core.table(e),n[e]=o,o}}function go(t,e,n,r,o,s,a){return{name:t,keyPath:e,unique:n,multi:r,auto:o,compound:s,src:(n&&!a?"&":"")+(r?"*":"")+(o?"++":"")+Ii(e)}}function Ii(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Si(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:si(n,r=>[r.name,r])}}let _n=t=>{try{return t.only([[]]),_n=()=>[[]],[[]]}catch{return _n=()=>vt,vt}};function wo(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?r=>r[e]:r=>et(r,e)}(t):e=>et(e,t)}function Qs(t){return[].slice.call(t)}let af=0;function pn(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function lf(t,e,n){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:c,lowerOpen:d,upperOpen:f}=l;return u===void 0?c===void 0?null:e.upperBound(c,!!f):c===void 0?e.lowerBound(u,!!d):e.bound(u,c,!!d,!!f)}const{schema:o,hasGetAll:s}=function(l,u){const c=Qs(l.objectStoreNames);return{schema:{name:l.name,tables:c.map(d=>u.objectStore(d)).map(d=>{const{keyPath:f,autoIncrement:m}=d,b=Ce(f),h=f==null,w={},g={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h,compound:b,keyPath:f,autoIncrement:m,unique:!0,extractKey:wo(f)},indexes:Qs(d.indexNames).map(y=>d.index(y)).map(y=>{const{name:_,unique:k,multiEntry:E,keyPath:C}=y,x={name:_,compound:Ce(C),keyPath:C,unique:k,multiEntry:E,extractKey:wo(C)};return w[pn(C)]=x,x}),getIndexByKeyPath:y=>w[pn(y)]};return w[":id"]=g.primaryKey,f!=null&&(w[pn(f)]=g.primaryKey),g})},hasGetAll:c.length>0&&"getAll"in u.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),a=o.tables.map(l=>function(u){const c=u.name;return{name:c,schema:u,mutate:function({trans:d,type:f,keys:m,values:b,range:h}){return new Promise((w,g)=>{w=ae(w);const y=d.objectStore(c),_=y.keyPath==null,k=f==="put"||f==="add";if(!k&&f!=="delete"&&f!=="deleteRange")throw new Error("Invalid operation type: "+f);const{length:E}=m||b||{length:1};if(m&&b&&m.length!==b.length)throw new Error("Given keys array must have same length as given values array.");if(E===0)return w({numFailures:0,failures:{},results:[],lastResult:void 0});let C;const x=[],I=[];let D=0;const P=K=>{++D,bn(K)};if(f==="deleteRange"){if(h.type===4)return w({numFailures:D,failures:I,results:[],lastResult:void 0});h.type===3?x.push(C=y.clear()):x.push(C=y.delete(r(h)))}else{const[K,T]=k?_?[b,m]:[b,null]:[m,null];if(k)for(let B=0;B<E;++B)x.push(C=T&&T[B]!==void 0?y[f](K[B],T[B]):y[f](K[B])),C.onerror=P;else for(let B=0;B<E;++B)x.push(C=y[f](K[B])),C.onerror=P}const N=K=>{const T=K.target.result;x.forEach((B,Z)=>B.error!=null&&(I[Z]=B.error)),w({numFailures:D,failures:I,results:f==="delete"?m:x.map(B=>B.result),lastResult:T})};C.onerror=K=>{P(K),N(K)},C.onsuccess=N})},getMany:({trans:d,keys:f})=>new Promise((m,b)=>{m=ae(m);const h=d.objectStore(c),w=f.length,g=new Array(w);let y,_=0,k=0;const E=x=>{const I=x.target;g[I._pos]=I.result,++k===_&&m(g)},C=ze(b);for(let x=0;x<w;++x)f[x]!=null&&(y=h.get(f[x]),y._pos=x,y.onsuccess=E,y.onerror=C,++_);_===0&&m(g)}),get:({trans:d,key:f})=>new Promise((m,b)=>{m=ae(m);const h=d.objectStore(c).get(f);h.onsuccess=w=>m(w.target.result),h.onerror=ze(b)}),query:function(d){return f=>new Promise((m,b)=>{m=ae(m);const{trans:h,values:w,limit:g,query:y}=f,_=g===1/0?void 0:g,{index:k,range:E}=y,C=h.objectStore(c),x=k.isPrimaryKey?C:C.index(k.name),I=r(E);if(g===0)return m({result:[]});if(d){const D=w?x.getAll(I,_):x.getAllKeys(I,_);D.onsuccess=P=>m({result:P.target.result}),D.onerror=ze(b)}else{let D=0;const P=w||!("openKeyCursor"in x)?x.openCursor(I):x.openKeyCursor(I),N=[];P.onsuccess=K=>{const T=P.result;return T?(N.push(w?T.value:T.primaryKey),++D===g?m({result:N}):void T.continue()):m({result:N})},P.onerror=ze(b)}})}(s),openCursor:function({trans:d,values:f,query:m,reverse:b,unique:h}){return new Promise((w,g)=>{w=ae(w);const{index:y,range:_}=m,k=d.objectStore(c),E=y.isPrimaryKey?k:k.index(y.name),C=b?h?"prevunique":"prev":h?"nextunique":"next",x=f||!("openKeyCursor"in E)?E.openCursor(r(_),C):E.openKeyCursor(r(_),C);x.onerror=ze(g),x.onsuccess=ae(I=>{const D=x.result;if(!D)return void w(null);D.___id=++af,D.done=!1;const P=D.continue.bind(D);let N=D.continuePrimaryKey;N&&(N=N.bind(D));const K=D.advance.bind(D),T=()=>{throw new Error("Cursor not stopped")};D.trans=d,D.stop=D.continue=D.continuePrimaryKey=D.advance=()=>{throw new Error("Cursor not started")},D.fail=ae(g),D.next=function(){let B=1;return this.start(()=>B--?this.continue():this.stop()).then(()=>this)},D.start=B=>{const Z=new Promise((O,H)=>{O=ae(O),x.onerror=ze(H),D.fail=H,D.stop=G=>{D.stop=D.continue=D.continuePrimaryKey=D.advance=T,O(G)}}),$=()=>{if(x.result)try{B()}catch(O){D.fail(O)}else D.done=!0,D.start=()=>{throw new Error("Cursor behind last entry")},D.stop()};return x.onsuccess=ae(O=>{x.onsuccess=$,$()}),D.continue=P,D.continuePrimaryKey=N,D.advance=K,$(),Z},w(D)},g)})},count({query:d,trans:f}){const{index:m,range:b}=d;return new Promise((h,w)=>{const g=f.objectStore(c),y=m.isPrimaryKey?g:g.index(m.name),_=r(b),k=_?y.count(_):y.count();k.onsuccess=ae(E=>h(E.target.result)),k.onerror=ze(w)})}}}(l)),i={};return a.forEach(l=>i[l.name]=l),{stack:"dbcore",transaction:t.transaction.bind(t),table(l){if(!i[l])throw new Error(`Table '${l}' not found`);return i[l]},MIN_KEY:-1/0,MAX_KEY:_n(e),schema:o}}function bo({_novip:t},e){const n=e.db,r=function(o,s,{IDBKeyRange:a,indexedDB:i},l){return{dbcore:function(c,d){return d.reduce((f,{create:m})=>({...f,...m(f)}),c)}(lf(s,a,l),o.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(o=>{const s=o.name;t.core.schema.tables.some(a=>a.name===s)&&(o.core=t.core.table(s),t[s]instanceof t.Table&&(t[s].core=o.core))})}function cr({_novip:t},e,n,r){n.forEach(o=>{const s=r[o];e.forEach(a=>{const i=as(a,o);(!i||"value"in i&&i.value===void 0)&&(a===t.Transaction.prototype||a instanceof t.Transaction?Qe(a,o,{get(){return this.table(o)},set(l){ni(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):a[o]=new t.Table(o,s))})})}function xo({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function cf(t,e){return t._cfg.version-e._cfg.version}function uf(t,e,n,r){const o=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,o);s.create(n),s._completion.catch(r);const a=s._reject.bind(s),i=M.transless||M;lt(()=>{M.trans=s,M.transless=i,e===0?(he(o).forEach(l=>{qr(n,l,o[l].primKey,o[l].indexes)}),bo(t,n),A.follow(()=>t.on.populate.fire(s)).catch(a)):function({_novip:l},u,c,d){const f=[],m=l._versions;let b=l._dbSchema=ko(l,l.idbdb,d),h=!1;const w=m.filter(y=>y._cfg.version>=u);function g(){return f.length?A.resolve(f.shift()(c.idbtrans)).then(g):A.resolve()}return w.forEach(y=>{f.push(()=>{const _=b,k=y._cfg.dbschema;Co(l,_,d),Co(l,k,d),b=l._dbSchema=k;const E=Oi(_,k);E.add.forEach(x=>{qr(d,x[0],x[1].primKey,x[1].indexes)}),E.change.forEach(x=>{if(x.recreate)throw new L.Upgrade("Not yet support for changing primary key");{const I=d.objectStore(x.name);x.add.forEach(D=>_o(I,D)),x.change.forEach(D=>{I.deleteIndex(D.name),_o(I,D)}),x.del.forEach(D=>I.deleteIndex(D))}});const C=y._cfg.contentUpgrade;if(C&&y._cfg.version>u){bo(l,d),c._memoizedTables={},h=!0;let x=ai(k);E.del.forEach(N=>{x[N]=_[N]}),xo(l,[l.Transaction.prototype]),cr(l,[l.Transaction.prototype],he(x),x),c.schema=x;const I=is(C);let D;I&&Zt();const P=A.follow(()=>{if(D=C(c),D&&I){var N=nt.bind(null,null);D.then(N,N)}});return D&&typeof D.then=="function"?A.resolve(D):P.then(()=>D)}}),f.push(_=>{(!h||!Zd)&&function(k,E){[].slice.call(E.db.objectStoreNames).forEach(C=>k[C]==null&&E.db.deleteObjectStore(C))}(y._cfg.dbschema,_),xo(l,[l.Transaction.prototype]),cr(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),c.schema=l._dbSchema})}),g().then(()=>{var y,_;_=d,he(y=b).forEach(k=>{_.db.objectStoreNames.contains(k)||qr(_,k,y[k].primKey,y[k].indexes)})})}(t,e,s,n).catch(a)})}function Oi(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const o=t[r],s=e[r];if(o){const a={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||o.primKey.auto!==s.primKey.auto&&!Sr)a.recreate=!0,n.change.push(a);else{const i=o.idxByName,l=s.idxByName;let u;for(u in i)l[u]||a.del.push(u);for(u in l){const c=i[u],d=l[u];c?c.src!==d.src&&a.change.push(d):a.add.push(d)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}else n.add.push([r,s])}return n}function qr(t,e,n,r){const o=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(s=>_o(o,s)),o}function _o(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function ko(t,e,n){const r={};return rr(e.objectStoreNames,0).forEach(o=>{const s=n.objectStore(o);let a=s.keyPath;const i=go(Ii(a),a||"",!1,!1,!!s.autoIncrement,a&&typeof a!="string",!0),l=[];for(let c=0;c<s.indexNames.length;++c){const d=s.index(s.indexNames[c]);a=d.keyPath;var u=go(d.name,a,!!d.unique,!!d.multiEntry,!1,a&&typeof a!="string",!1);l.push(u)}r[o]=Si(o,i,l)}),r}function Co({_novip:t},e,n){const r=n.db.objectStoreNames;for(let o=0;o<r.length;++o){const s=r[o],a=n.objectStore(s);t._hasGetAll="getAll"in a;for(let i=0;i<a.indexNames.length;++i){const l=a.indexNames[i],u=a.index(l).keyPath,c=typeof u=="string"?u:"["+rr(u).join("+")+"]";if(e[s]){const d=e[s].idxByName[c];d&&(d.name=l,delete e[s].idxByName[c],e[s].idxByName[l]=d)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&se.WorkerGlobalScope&&se instanceof se.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class df{_parseStoresSpec(e,n){he(e).forEach(r=>{if(e[r]!==null){var o=e[r].split(",").map((a,i)=>{const l=(a=a.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return go(l,u||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),Ce(u),i===0)}),s=o.shift();if(s.multi)throw new L.Schema("Primary key cannot be multi-valued");o.forEach(a=>{if(a.auto)throw new L.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new L.Schema("Index must have a name and cannot be an empty string")}),n[r]=Si(r,s,o)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?Ie(this._cfg.storesSource,e):e;const r=n._versions,o={};let s={};return r.forEach(a=>{Ie(o,a._cfg.storesSource),s=a._cfg.dbschema={},a._parseStoresSpec(o,s)}),n._dbSchema=s,xo(n,[n._allTables,n,n.Transaction.prototype]),cr(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],he(s),s),n._storeNames=he(s),this}upgrade(e){return this._cfg.contentUpgrade=us(this._cfg.contentUpgrade||ne,e),this}}function ps(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new kt(Or,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function ms(t){return t&&typeof t.databases=="function"}function Eo(t){return lt(function(){return M.letThrough=!0,t()})}function ff(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function hf(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?ge(e.dbOpenError):t);Je&&(e.openCanceller._stackHolder=Ot()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function o(){if(e.openCanceller!==r)throw new L.DatabaseClosed("db.open() was cancelled")}let s=e.dbReadyResolve,a=null,i=!1;return A.race([r,(typeof navigator>"u"?A.resolve():ff()).then(()=>new A((l,u)=>{if(o(),!n)throw new L.MissingAPI;const c=t.name,d=e.autoSchema?n.open(c):n.open(c,Math.round(10*t.verno));if(!d)throw new L.MissingAPI;d.onerror=ze(u),d.onblocked=ae(t._fireOnBlocked),d.onupgradeneeded=ae(f=>{if(a=d.transaction,e.autoSchema&&!t._options.allowEmptyDB){d.onerror=bn,a.abort(),d.result.close();const b=n.deleteDatabase(c);b.onsuccess=b.onerror=ae(()=>{u(new L.NoSuchDatabase(`Database ${c} doesnt exist`))})}else{a.onerror=ze(u);var m=f.oldVersion>Math.pow(2,62)?0:f.oldVersion;i=m<1,t._novip.idbdb=d.result,uf(t,m/10,a,u)}},u),d.onsuccess=ae(()=>{a=null;const f=t._novip.idbdb=d.result,m=rr(f.objectStoreNames);if(m.length>0)try{const h=f.transaction((b=m).length===1?b[0]:b,"readonly");e.autoSchema?function({_novip:w},g,y){w.verno=g.version/10;const _=w._dbSchema=ko(0,g,y);w._storeNames=rr(g.objectStoreNames,0),cr(w,[w._allTables],he(_),_)}(t,f,h):(Co(t,t._dbSchema,h),function(w,g){const y=Oi(ko(0,w.idbdb,g),w._dbSchema);return!(y.add.length||y.change.some(_=>_.add.length||_.change.length))}(t,h)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),bo(t,h)}catch{}var b;fn.push(t),f.onversionchange=ae(h=>{e.vcFired=!0,t.on("versionchange").fire(h)}),f.onclose=ae(h=>{t.on("close").fire(h)}),i&&function({indexedDB:h,IDBKeyRange:w},g){!ms(h)&&g!==Or&&ps(h,w).put({name:g}).catch(ne)}(t._deps,c),l()},u)}))]).then(()=>(o(),e.onReadyBeingFired=[],A.resolve(Eo(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let u=e.onReadyBeingFired.reduce(us,ne);return e.onReadyBeingFired=[],A.resolve(Eo(()=>u(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{a&&a.abort()}catch{}return r===e.openCanceller&&t._close(),ge(l)}).finally(()=>{e.openComplete=!0,s()})}function Do(t){var e=s=>t.next(s),n=o(e),r=o(s=>t.throw(s));function o(s){return a=>{var i=s(a),l=i.value;return i.done?l:l&&typeof l.then=="function"?l.then(n,r):Ce(l)?Promise.all(l).then(n,r):n(l)}}return o(e)()}function pf(t,e,n){var r=arguments.length;if(r<2)throw new L.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return n=o.pop(),[t,ii(o),n]}function Pi(t,e,n,r,o){return A.resolve().then(()=>{const s=M.transless||M,a=t._createTransaction(e,n,t._dbSchema,r),i={trans:a,transless:s};if(r)a.idbtrans=r.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(d){return d.name===cs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Pi(t,e,n,null,o))):ge(d)}const l=is(o);let u;l&&Zt();const c=A.follow(()=>{if(u=o.call(a,a),u)if(l){var d=nt.bind(null,null);u.then(d,d)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=Do(u))},i);return(u&&typeof u.then=="function"?A.resolve(u).then(d=>a.active?d:ge(new L.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>u)).then(d=>(r&&a._resolve(),a._completion.then(()=>d))).catch(d=>(a._reject(d),ge(d)))})}function Kn(t,e,n){const r=Ce(t)?t.slice():[t];for(let o=0;o<n;++o)r.push(e);return r}const mf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,o={},s=[];function a(c,d,f){const m=pn(c),b=o[m]=o[m]||[],h=c==null?0:typeof c=="string"?1:c.length,w=d>0,g={...f,isVirtual:w,keyTail:d,keyLength:h,extractKey:wo(c),unique:!w&&f.unique};return b.push(g),g.isPrimaryKey||s.push(g),h>1&&a(h===2?c[0]:c.slice(0,h-1),d+1,f),b.sort((y,_)=>y.keyTail-_.keyTail),g}const i=a(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[i];for(const c of r.indexes)a(c.keyPath,0,c);function l(c){const d=c.query.index;return d.isVirtual?{...c,query:{index:d,range:(f=c.query.range,m=d.keyTail,{type:f.type===1?2:f.type,lower:Kn(f.lower,f.lowerOpen?t.MAX_KEY:t.MIN_KEY,m),lowerOpen:!0,upper:Kn(f.upper,f.upperOpen?t.MIN_KEY:t.MAX_KEY,m),upperOpen:!0})}}:c;var f,m}return{...n,schema:{...r,primaryKey:i,indexes:s,getIndexByKeyPath:function(c){const d=o[pn(c)];return d&&d[0]}},count:c=>n.count(l(c)),query:c=>n.query(l(c)),openCursor(c){const{keyTail:d,isVirtual:f,keyLength:m}=c.query.index;return f?n.openCursor(l(c)).then(b=>b&&function(h){return Object.create(h,{continue:{value:function(g){g!=null?h.continue(Kn(g,c.reverse?t.MAX_KEY:t.MIN_KEY,d)):c.unique?h.continue(h.key.slice(0,m).concat(c.reverse?t.MIN_KEY:t.MAX_KEY,d)):h.continue()}},continuePrimaryKey:{value(g,y){h.continuePrimaryKey(Kn(g,t.MAX_KEY,d),y)}},primaryKey:{get:()=>h.primaryKey},key:{get(){const g=h.key;return m===1?g[0]:g.slice(0,m)}},value:{get:()=>h.value}})}(b)):n.openCursor(c)}}}}}};function vs(t,e,n,r){return n=n||{},r=r||"",he(t).forEach(o=>{if(Fe(e,o)){var s=t[o],a=e[o];if(typeof s=="object"&&typeof a=="object"&&s&&a){const i=oo(s);i!==oo(a)?n[r+o]=e[o]:i==="Object"?vs(s,a,n,r+o+"."):s!==a&&(n[r+o]=e[o])}else s!==a&&(n[r+o]=e[o])}else n[r+o]=void 0}),he(e).forEach(o=>{Fe(t,o)||(n[r+o]=e[o])}),n}const vf={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(s){const a=M.trans,{deleting:i,creating:l,updating:u}=a.table(e).hook;switch(s.type){case"add":if(l.fire===ne)break;return a._promise("readwrite",()=>c(s),!0);case"put":if(l.fire===ne&&u.fire===ne)break;return a._promise("readwrite",()=>c(s),!0);case"delete":if(i.fire===ne)break;return a._promise("readwrite",()=>c(s),!0);case"deleteRange":if(i.fire===ne)break;return a._promise("readwrite",()=>function(f){return d(f.trans,f.range,1e4)}(s),!0)}return n.mutate(s);function c(f){const m=M.trans,b=f.keys||function(h,w){return w.type==="delete"?w.keys:w.keys||w.values.map(h.extractKey)}(r,f);if(!b)throw new Error("Keys missing");return(f=f.type==="add"||f.type==="put"?{...f,keys:b}:{...f}).type!=="delete"&&(f.values=[...f.values]),f.keys&&(f.keys=[...f.keys]),function(h,w,g){return w.type==="add"?Promise.resolve([]):h.getMany({trans:w.trans,keys:g,cache:"immutable"})}(n,f,b).then(h=>{const w=b.map((g,y)=>{const _=h[y],k={onerror:null,onsuccess:null};if(f.type==="delete")i.fire.call(k,g,_,m);else if(f.type==="add"||_===void 0){const E=l.fire.call(k,g,f.values[y],m);g==null&&E!=null&&(g=E,f.keys[y]=g,r.outbound||Ke(f.values[y],r.keyPath,g))}else{const E=vs(_,f.values[y]),C=u.fire.call(k,E,g,_,m);if(C){const x=f.values[y];Object.keys(C).forEach(I=>{Fe(x,I)?x[I]=C[I]:Ke(x,I,C[I])})}}return k});return n.mutate(f).then(({failures:g,results:y,numFailures:_,lastResult:k})=>{for(let E=0;E<b.length;++E){const C=y?y[E]:b[E],x=w[E];C==null?x.onerror&&x.onerror(g[E]):x.onsuccess&&x.onsuccess(f.type==="put"&&h[E]?f.values[E]:C)}return{failures:g,results:y,numFailures:_,lastResult:k}}).catch(g=>(w.forEach(y=>y.onerror&&y.onerror(g)),Promise.reject(g)))})}function d(f,m,b){return n.query({trans:f,values:!1,query:{index:r,range:m},limit:b}).then(({result:h})=>c({type:"delete",keys:h,trans:f}).then(w=>w.numFailures>0?Promise.reject(w.failures[0]):h.length<b?{failures:[],numFailures:0,lastResult:void 0}:d(f,{...m,lower:h[h.length-1],lowerOpen:!0},b)))}}}}})};function ji(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let o=0,s=0;o<e.keys.length&&s<t.length;++o)De(e.keys[o],t[s])===0&&(r.push(n?On(e.values[o]):e.values[o]),++s);return r.length===t.length?r:null}catch{return null}}const yf={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const o=ji(r.keys,r.trans._cache,r.cache==="clone");return o?A.resolve(o):n.getMany(r).then(s=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?On(s):s},s))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function ys(t){return!("from"in t)}const Ye=function(t,e){if(!this){const n=new Ye;return t&&"d"in t&&Ie(n,t),n}Ie(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function kn(t,e,n){const r=De(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(ys(t))return Ie(t,{from:e,to:n,d:1});const o=t.l,s=t.r;if(De(n,t.from)<0)return o?kn(o,e,n):t.l={from:e,to:n,d:1,l:null,r:null},ea(t);if(De(e,t.to)>0)return s?kn(s,e,n):t.r={from:e,to:n,d:1,l:null,r:null},ea(t);De(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),De(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const a=!t.r;o&&!t.l&&ur(t,o),s&&a&&ur(t,s)}function ur(t,e){ys(e)||function n(r,{from:o,to:s,l:a,r:i}){kn(r,o,s),a&&n(r,a),i&&n(r,i)}(t,e)}function gf(t,e){const n=Io(e);let r=n.next();if(r.done)return!1;let o=r.value;const s=Io(t);let a=s.next(o.from),i=a.value;for(;!r.done&&!a.done;){if(De(i.from,o.to)<=0&&De(i.to,o.from)>=0)return!0;De(o.from,i.from)<0?o=(r=n.next(i.from)).value:i=(a=s.next(o.from)).value}return!1}function Io(t){let e=ys(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&De(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||De(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function ea(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){const s=o==="r"?"l":"r",a={...t},i=t[o];t.from=i.from,t.to=i.to,t[o]=i[o],a[o]=i[s],t[s]=a,a.d=ta(a)}t.d=ta(t)}function ta({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}Gt(Ye.prototype,{add(t){return ur(this,t),this},addKey(t){return kn(this,t,t),this},addKeys(t){return t.forEach(e=>kn(this,e,e)),this},[so](){return Io(this)}});const wf={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new Ye(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const o=t.table(r),{schema:s}=o,{primaryKey:a}=s,{extractKey:i,outbound:l}=a,u={...o,mutate:f=>{const m=f.trans,b=m.mutatedParts||(m.mutatedParts={}),h=C=>{const x=`idb://${e}/${r}/${C}`;return b[x]||(b[x]=new Ye)},w=h(""),g=h(":dels"),{type:y}=f;let[_,k]=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[[],f.values]:[];const E=f.trans._cache;return o.mutate(f).then(C=>{if(Ce(_)){y!=="delete"&&(_=C.results),w.addKeys(_);const x=ji(_,E);x||y==="add"||g.addKeys(_),(x||k)&&function(I,D,P,N){function K(T){const B=I(T.name||"");function Z(O){return O!=null?T.extractKey(O):null}const $=O=>T.multiEntry&&Ce(O)?O.forEach(H=>B.addKey(H)):B.addKey(O);(P||N).forEach((O,H)=>{const G=P&&Z(P[H]),de=N&&Z(N[H]);De(G,de)!==0&&(G!=null&&$(G),de!=null&&$(de))})}D.indexes.forEach(K)}(h,s,x,k)}else if(_){const x={from:_.lower,to:_.upper};g.add(x),w.add(x)}else w.add(n),g.add(n),s.indexes.forEach(x=>h(x.name).add(n));return C})}},c=({query:{index:f,range:m}})=>{var b,h;return[f,new Ye((b=m.lower)!==null&&b!==void 0?b:t.MIN_KEY,(h=m.upper)!==null&&h!==void 0?h:t.MAX_KEY)]},d={get:f=>[a,new Ye(f.key)],getMany:f=>[a,new Ye().addKeys(f.keys)],count:c,query:c,openCursor:c};return he(d).forEach(f=>{u[f]=function(m){const{subscr:b}=M;if(b){const h=k=>{const E=`idb://${e}/${r}/${k}`;return b[E]||(b[E]=new Ye)},w=h(""),g=h(":dels"),[y,_]=d[f](m);if(h(y.name||"").add(_),!y.isPrimaryKey){if(f!=="count"){const k=f==="query"&&l&&m.values&&o.query({...m,values:!1});return o[f].apply(this,arguments).then(E=>{if(f==="query"){if(l&&m.values)return k.then(({result:x})=>(w.addKeys(x),E));const C=m.values?E.result.map(i):E.result;m.values?w.addKeys(C):g.addKeys(C)}else if(f==="openCursor"){const C=E,x=m.values;return C&&Object.create(C,{key:{get:()=>(g.addKey(C.primaryKey),C.key)},primaryKey:{get(){const I=C.primaryKey;return g.addKey(I),I}},value:{get:()=>(x&&w.addKey(C.primaryKey),C.value)}})}return E})}g.add(n)}}return o[f].apply(this,arguments)}}),u}}}};class kt{constructor(e,n){this._middlewares={},this.verno=0;const r=kt.dependencies;this._options=n={addons:kt.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:o}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ne,dbReadyPromise:null,cancelOpen:ne,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;s.dbReadyPromise=new A(i=>{s.dbReadyResolve=i}),s.openCanceller=new A((i,l)=>{s.cancelOpen=l}),this._state=s,this.name=e,this.on=hn(this,"populate","blocked","versionchange","close",{ready:[us,ne]}),this.on.ready.subscribe=ri(this.on.ready.subscribe,i=>(l,u)=>{kt.vip(()=>{const c=this._state;if(c.openComplete)c.dbOpenError||A.resolve().then(l),u&&i(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),u&&i(l);else{i(l);const d=this;u||i(function f(){d.on.ready.unsubscribe(l),d.on.ready.unsubscribe(f)})}})}),this.Collection=(a=this,nn(tf.prototype,function(i,l){this.db=a;let u=Ci,c=null;if(l)try{u=l()}catch(b){c=b}const d=i._ctx,f=d.table,m=f.hook.reading.fire;this._ctx={table:f,index:d.index,isPrimKey:!d.index||f.schema.primKey.keyPath&&d.index===f.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:d.or,valueMapper:m!==gn?m:null}})),this.Table=function(i){return nn(ef.prototype,function(l,u,c){this.db=i,this._tx=c,this.name=l,this.schema=u,this.hook=i._allTables[l]?i._allTables[l].hook:hn(null,{creating:[$d,ne],reading:[Kd,gn],updating:[zd,ne],deleting:[Ud,ne]})})}(this),this.Transaction=function(i){return nn(sf.prototype,function(l,u,c,d,f){this.db=i,this.mode=l,this.storeNames=u,this.schema=c,this.chromeTransactionDurability=d,this.idbtrans=null,this.on=hn(this,"complete","error","abort"),this.parent=f||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new A((m,b)=>{this._resolve=m,this._reject=b}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},m=>{var b=this.active;return this.active=!1,this.on.error.fire(m),this.parent?this.parent._reject(m):b&&this.idbtrans&&this.idbtrans.abort(),ge(m)})})}(this),this.Version=function(i){return nn(df.prototype,function(l){this.db=i,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(i){return nn(Di.prototype,function(l,u,c){this.db=i,this._ctx={table:l,index:u===":id"?null:u,or:c};const d=i._deps.indexedDB;if(!d)throw new L.MissingAPI;this._cmp=this._ascending=d.cmp.bind(d),this._descending=(f,m)=>d.cmp(m,f),this._max=(f,m)=>d.cmp(f,m)>0?f:m,this._min=(f,m)=>d.cmp(f,m)<0?f:m,this._IDBKeyRange=i._deps.IDBKeyRange})}(this),this.on("versionchange",i=>{i.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",i=>{!i.newVersion||i.newVersion<i.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${i.oldVersion/10}`)}),this._maxKey=_n(n.IDBKeyRange),this._createTransaction=(i,l,u,c)=>new this.Transaction(i,l,u,this._options.chromeTransactionDurability,c),this._fireOnBlocked=i=>{this.on("blocked").fire(i),fn.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(i))},this.use(mf),this.use(vf),this.use(wf),this.use(yf),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(i=>i(this))}version(e){if(isNaN(e)||e<.1)throw new L.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new L.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(o=>o._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(cf),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||M.letThrough||this._vip)?e():new A((n,r)=>{if(this._state.openComplete)return r(new L.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new L.DatabaseClosed);this.open().catch(ne)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:o}){o&&this.unuse({stack:e,name:o});const s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:n,level:r??10,name:o}),s.sort((a,i)=>a.level-i.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(o=>r?o.create!==r:!!n&&o.name!==n)),this}open(){return hf(this)}_close(){const e=this._state,n=fn.indexOf(this);if(n>=0&&fn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new A(r=>{e.dbReadyResolve=r}),e.openCanceller=new A((r,o)=>{e.cancelOpen=o})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new L.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new A((r,o)=>{const s=()=>{this.close();var a=this._deps.indexedDB.deleteDatabase(this.name);a.onsuccess=ae(()=>{(function({indexedDB:i,IDBKeyRange:l},u){!ms(i)&&u!==Or&&ps(i,l).delete(u).catch(ne)})(this._deps,this.name),r()}),a.onerror=ze(o),a.onblocked=this._fireOnBlocked};if(e)throw new L.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return he(this._allTables).map(e=>this._allTables[e])}transaction(){const e=pf.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let o=M.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);const s=e.indexOf("?")!==-1;let a,i;e=e.replace("!","").replace("?","");try{if(i=n.map(u=>{var c=u instanceof this.Table?u.name:u;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),e=="r"||e===Wr)a=Wr;else{if(e!="rw"&&e!=Kr)throw new L.InvalidArgument("Invalid transaction mode: "+e);a=Kr}if(o){if(o.mode===Wr&&a===Kr){if(!s)throw new L.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&i.forEach(u=>{if(o&&o.storeNames.indexOf(u)===-1){if(!s)throw new L.SubTransaction("Table "+u+" not included in parent transaction.");o=null}}),s&&o&&!o.active&&(o=null)}}catch(u){return o?o._promise(null,(c,d)=>{d(u)}):ge(u)}const l=Pi.bind(null,this,a,i,o,r);return o?o._promise(a,l,"lock"):M.trans?Qt(M.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!Fe(this._allTables,e))throw new L.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const bf=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class xf{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[bf](){return this}}function Ni(t,e){return he(e).forEach(n=>{ur(t[n]||(t[n]=new Ye),e[n])}),t}function _f(t){let e,n=!1;const r=new xf(o=>{const s=is(t);let a=!1,i={},l={};const u={get closed(){return a},unsubscribe:()=>{a=!0,ut.storagemutated.unsubscribe(m)}};o.start&&o.start(u);let c=!1,d=!1;function f(){return he(l).some(h=>i[h]&&gf(i[h],l[h]))}const m=h=>{Ni(i,h),f()&&b()},b=()=>{if(c||a)return;i={};const h={},w=function(g){s&&Zt();const y=()=>lt(t,{subscr:g,trans:null}),_=M.trans?Qt(M.transless,y):y();return s&&_.then(nt,nt),_}(h);d||(ut(xn,m),d=!0),c=!0,Promise.resolve(w).then(g=>{n=!0,e=g,c=!1,a||(f()?b():(i={},l=h,o.next&&o.next(g)))},g=>{c=!1,n=!1,o.error&&o.error(g),u.unsubscribe()})};return b(),u});return r.hasValue=()=>n,r.getValue=()=>e,r}let So;try{So={indexedDB:se.indexedDB||se.mozIndexedDB||se.webkitIndexedDB||se.msIndexedDB,IDBKeyRange:se.IDBKeyRange||se.webkitIDBKeyRange}}catch{So={indexedDB:null,IDBKeyRange:null}}const ht=kt;function Xn(t){let e=Ze;try{Ze=!0,ut.storagemutated.fire(t)}finally{Ze=e}}Gt(ht,{...qn,delete:t=>new ht(t,{addons:[]}).delete(),exists:t=>new ht(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return ms(e)?Promise.resolve(e.databases()).then(r=>r.map(o=>o.name).filter(o=>o!==Or)):ps(e,n).toCollection().primaryKeys()}(ht.dependencies).then(t)}catch{return ge(new L.MissingAPI)}},defineClass:()=>function(t){Ie(this,t)},ignoreTransaction:t=>M.trans?Qt(M.transless,t):t(),vip:Eo,async:function(t){return function(){try{var e=Do(t.apply(this,arguments));return e&&typeof e.then=="function"?e:A.resolve(e)}catch(n){return ge(n)}}},spawn:function(t,e,n){try{var r=Do(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:A.resolve(r)}catch(o){return ge(o)}},currentTransaction:{get:()=>M.trans||null},waitFor:function(t,e){const n=A.resolve(typeof t=="function"?ht.ignoreTransaction(t):t).timeout(e||6e4);return M.trans?M.trans.waitFor(n):n},Promise:A,debug:{get:()=>Je,set:t=>{ci(t,t==="dexie"?()=>!0:ki)}},derive:Wt,extend:Ie,props:Gt,override:ri,Events:hn,on:ut,liveQuery:_f,extendObservabilitySet:Ni,getByKeyPath:et,setByKeyPath:Ke,delByKeyPath:function(t,e){typeof e=="string"?Ke(t,e,void 0):"length"in e&&[].map.call(e,function(n){Ke(t,n,void 0)})},shallowClone:ai,deepClone:On,getObjectDiff:vs,cmp:De,asap:oi,minKey:yo,addons:[],connections:fn,errnames:cs,dependencies:So,semVer:Js,version:Js.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),ht.maxKey=_n(ht.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ut(xn,t=>{if(!Ze){let e;Sr?(e=document.createEvent("CustomEvent"),e.initCustomEvent(at,!0,!0,t)):e=new CustomEvent(at,{detail:t}),Ze=!0,dispatchEvent(e),Ze=!1}}),addEventListener(at,({detail:t})=>{Ze||Xn(t)}));let Ze=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(at);typeof t.unref=="function"&&t.unref(),ut(xn,e=>{Ze||t.postMessage(e)}),t.onmessage=e=>{e.data&&Xn(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){ut(xn,e=>{try{Ze||(typeof localStorage<"u"&&localStorage.setItem(at,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:at,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===at){const n=JSON.parse(e.newValue);n&&Xn(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===at&&Xn(e.changedParts)})}A.rejectionMapper=function(t,e){if(!t||t instanceof Kt||t instanceof TypeError||t instanceof SyntaxError||!t.name||!zs[t.name])return t;var n=new zs[t.name](e||t.message,t);return"stack"in t&&Qe(n,"stack",{get:function(){return this.inner.stack}}),n},ci(Je,ki);var Zn=(t=>(t.MOVE_TO_ROOT_FOLDER="moveToRootFolder",t.DELETE="delete",t))(Zn||{});const kf="comfyui_workspace_db";class Cf extends kt{constructor(){super(kf);ce(this,"workflows");ce(this,"changelogs");ce(this,"media");ce(this,"folders");ce(this,"tags");ce(this,"userSettings");ce(this,"models");ce(this,"cache");ce(this,"workflowVersions");this.version(1).stores({workflows:"&id, name, parentFolderID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id"}).upgrade(n=>{}),this.version(2).stores({workflows:"&id, name, parentFolderID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id",workflowVersions:"&id, name, workflowID"}).upgrade(n=>{})}}const X=new Cf;class Pt{constructor(e){ce(this,"tableName");this.tableName=e}async saveDiskDB(){const e=await X[this.tableName].toArray(),n={};e.forEach(r=>{r.id?n[r.id]=r:r.name?n[r.name]=r:console.error("TableBaseModel should have id or name")}),kd(this.tableName,JSON.stringify(n))}async add(e){return e.id||(e.id=Jt()),e.createTime||(e.createTime=Date.now()),await X[this.tableName].add(e),await this.saveDiskDB(),e}async put(e){return await X[this.tableName].put(e),await this.saveDiskDB(),e}async update(e,n){return await X[this.tableName].update(e,n),await this.saveDiskDB(),await this.get(e)??null}async listAll(){return await X[this.tableName].toArray()}async batchQuery(e){return await X[this.tableName].bulkGet(e)}async getRecords(){console.warn("[DEPRECATED] getRecords() call, should only be used for one-time backfill for indexdb",this.tableName);const e=await _d(this.tableName);let n;try{n=e!=null?JSON.parse(e):null}catch{}if(n==null){const r=await Pd()??"{}";n=JSON.parse(r)[this.tableName]}return n??{}}async get(e){return await X[this.tableName].get(e)}async delete(e){await X[this.tableName].delete(e),await this.saveDiskDB()}}const fr=class fr extends Pt{constructor(){super("changelogs")}static async load(){return new fr}async listByWorkflowID(e){return await X.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime")}async getLastestByWorkflowID(e){return(await this.listByWorkflowID(e))[0]}async create(e){const n=await this.getLastestByWorkflowID(e.workflowID);if(n!=null&&n.json===e.json)return null;const r={id:Jt(),json:e.json,workflowID:e.workflowID,createTime:Date.now()};return await X.changelogs.add(r),await this.saveDiskDB(),r}};ce(fr,"TABLE_NAME","changelogs");let Oo=fr;const Mh="CWM_WORKFLOWS_SORT_TYPE";var pt=(t=>(t.RECENTLY_MODIFIED="newest",t.OLDEST_MODIFIED="oldest",t.AZ="name A-Z",t.ZA="name Z-A",t))(pt||{});const Rh=[{title:"Import Workflows",type:"file"},{title:"Import Folder",type:"folder"}],Ai="comfyspace_tracking",Fi="workspace_info",Ef=9999999;async function sn(t){const e=await gs(t);if(e==null)return;const n=await ws(t);await(S==null?void 0:S.updateFlow(t.id,{filePath:n??void 0}));const r=t.json,o=JSON.parse(r);o.extra[Fi]={id:t.id,name:t.name},delete o.extra[Ai],await ei(e,JSON.stringify(o))}async function Vr(t){if(t.name==null)return;const e=await gs(t);e!=null&&ti(e)}async function gs(t){let e=If(t.name)+".json",n=t.parentFolderID;for(;n!=null;){const r=await(ee==null?void 0:ee.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??void 0}return e??null}async function ws(t){const e=await gs(t);let n=await(z==null?void 0:z.getSetting("myWorkflowsDir"));return n?(n.endsWith("/")||(n=n+"/"),n+e):(console.error("myWorkflowsDir is not set"),null)}async function Df(t){const e=await(ee==null?void 0:ee.get(t));let n=e==null?void 0:e.parentFolderID,r=e==null?void 0:e.name;for(;n;){const s=await(ee==null?void 0:ee.get(n));if(s==null)break;r=`${s.name}/${r}`,n=s.parentFolderID??void 0}let o=await(z==null?void 0:z.getSetting("myWorkflowsDir"));return o?(o.endsWith("/")||(o=o+"/"),o+r):(console.error("myWorkflowsDir is not set"),null)}async function Th(t){const e=await(S==null?void 0:S.listAll())??[],n=await(ee==null?void 0:ee.listAll())??[],r=[t];let o=0;for(;r.length>0;){const s=r.shift();if(s){for(const i of e)i.parentFolderID===s&&o++;const a=n.filter(i=>i.parentFolderID===s).map(i=>i.id);a.length&&r.push(...a)}}return o}function If(t){return t=t.replace(/[\\/:*?"<>|]/g,"_"),t.trim()}function na(t,e=!0,n=!1){const r=new Date(t),o=String(r.getDate()).padStart(2,"0"),s=String(r.getMonth()+1).padStart(2,"0"),a=r.getFullYear(),i=String(r.getHours()).padStart(2,"0"),l=String(r.getMinutes()).padStart(2,"0"),u=String(r.getSeconds()).padStart(2,"0"),c=`${s}-${o}-${a}`;return e?c+` ${i}:${l}`:n?c+`:${u}`:c}async function Mi(t=!1){const e=await(S==null?void 0:S.listAll())??[];for(const n of e){const r=await ws(n);n.filePath!=r&&(n.filePath!=null&&await ti(n.filePath,t),await sn(n))}}const Sf=(t,e=pt.RECENTLY_MODIFIED)=>{const n=[...t];switch(e){case pt.AZ:n.sort((r,o)=>r.name.localeCompare(o.name));break;case pt.ZA:n.sort((r,o)=>o.name.localeCompare(r.name));break;case pt.RECENTLY_MODIFIED:n.sort((r,o)=>o.updateTime-r.updateTime);break;case pt.OLDEST_MODIFIED:n.sort((r,o)=>r.updateTime-o.updateTime);break}return n},Of=async t=>{const e=await(z==null?void 0:z.getSetting("shortcuts").then(n=>n==null?void 0:n.save));return e?Pf(t,e):!1},Pf=(t,e)=>{const n=e.split("+"),r={Control:t.ctrlKey,Shift:t.shiftKey,Alt:t.altKey,Command:t.metaKey,[t.key.toUpperCase()]:!0};return n.every(o=>r[o])};function Lh(t){const e=["png","jpg","jpeg","gif","bmp","webp"],n=t.split(".").pop();return n!=null&&e.includes(n)}function jf(t){return`/workspace/view_media?filename=${t}`}async function Ri(t,e){const n=t.filter(o=>"json"in o);n.length&&await(S==null?void 0:S.batchCreateFlows(n,!0,e));const r=t.filter(o=>"list"in o);if(r.length){const o=await(ee==null?void 0:ee.listAll());for(const s of r){const a=o==null?void 0:o.find(l=>l.name===s.name);let i;if(a)i=a.id;else{const l=await(ee==null?void 0:ee.create({name:s.name,parentFolderID:e}));i=l==null?void 0:l.id}await Ri(s.list,i)}}}function ra(){const e=window.location.hash.slice(1).split("/").find(n=>n.includes("workspaceId@"));return e?e.split("@")[1]:null}function Ti(t){const e=window.location.hash.slice(1).split("/"),n=e.findIndex(o=>o.includes("workspaceId@")),r=`workspaceId@${t}`;return n>=0?e[n]=r:e.push(r),`${e.join("/")}`}const Nf=t=>{const e=Ti(t);window.open(`${window.location.origin}/#${e}`)};async function Af(){const t=await(S==null?void 0:S.listAll())??[];for(const e of t)try{const n=await ws(e),r=JSON.parse(e.json);r.extra[Fi]={id:e.id,name:e.name},delete r.extra[Ai],n&&await ei(n,JSON.stringify(r))}catch(n){console.error(n)}}const Po={last_node_id:9,last_link_id:9,nodes:[{id:7,type:"CLIPTextEncode",pos:[413,389],size:{0:425.27801513671875,1:180.6060791015625},flags:{},order:3,mode:0,inputs:[{name:"clip",type:"CLIP",link:5}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[6],slot_index:0}],properties:{},widgets_values:["text, watermark"]},{id:6,type:"CLIPTextEncode",pos:[415,186],size:{0:422.84503173828125,1:164.31304931640625},flags:{},order:2,mode:0,inputs:[{name:"clip",type:"CLIP",link:3}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[4],slot_index:0}],properties:{},widgets_values:["beautiful scenery nature glass bottle landscape, , purple galaxy bottle,"]},{id:5,type:"EmptyLatentImage",pos:[473,609],size:{0:315,1:106},flags:{},order:1,mode:0,outputs:[{name:"LATENT",type:"LATENT",links:[2],slot_index:0}],properties:{},widgets_values:[512,512,1]},{id:3,type:"KSampler",pos:[863,186],size:{0:315,1:262},flags:{},order:4,mode:0,inputs:[{name:"model",type:"MODEL",link:1},{name:"positive",type:"CONDITIONING",link:4},{name:"negative",type:"CONDITIONING",link:6},{name:"latent_image",type:"LATENT",link:2}],outputs:[{name:"LATENT",type:"LATENT",links:[7],slot_index:0}],properties:{},widgets_values:[0x8e7ff42ed37e,!0,20,8,"euler","normal",1]},{id:8,type:"VAEDecode",pos:[1209,188],size:{0:210,1:46},flags:{},order:5,mode:0,inputs:[{name:"samples",type:"LATENT",link:7},{name:"vae",type:"VAE",link:8}],outputs:[{name:"IMAGE",type:"IMAGE",links:[9],slot_index:0}],properties:{}},{id:9,type:"SaveImage",pos:[1451,189],size:{0:210,1:26},flags:{},order:6,mode:0,inputs:[{name:"images",type:"IMAGE",link:9}],properties:{}},{id:4,type:"CheckpointLoaderSimple",pos:[26,474],size:{0:315,1:98},flags:{},order:0,mode:0,outputs:[{name:"MODEL",type:"MODEL",links:[1],slot_index:0},{name:"CLIP",type:"CLIP",links:[3,5],slot_index:1},{name:"VAE",type:"VAE",links:[8],slot_index:2}],properties:{},widgets_values:["v1-5-pruned-emaonly.ckpt"]}],links:[[1,4,0,3,0,"MODEL"],[2,5,0,3,3,"LATENT"],[3,4,1,6,0,"CLIP"],[4,6,0,3,1,"CONDITIONING"],[5,4,1,7,0,"CLIP"],[6,7,0,3,2,"CONDITIONING"],[7,3,0,8,0,"LATENT"],[8,4,2,8,1,"VAE"],[9,8,0,9,0,"IMAGE"]],groups:[],config:{},extra:{},version:.4},hr=class hr extends Pt{constructor(){super("workflows");ce(this,"_curWorkflow",null)}get curWorkflow(){return this._curWorkflow}static async load(){return new hr}updateCurWorkflowID(n){if(n==null){this._curWorkflow=null;return}this.get(n).then(r=>{this._curWorkflow=r??null})}async latestVersionCheck(){if(this._curWorkflow){const n=await this.get(this._curWorkflow.id);return n?(n==null?void 0:n.updateTime)===this._curWorkflow.updateTime:!0}return!0}async generateUniqueName(n,r){let o=n??"Untitled Flow";const a=(await this.listAll()??[]).filter(i=>i.parentFolderID==r).map(i=>i.name);if(a.includes(o)){let i=2,l=!0;for(;l;)a.includes(`${o} ${i}`)?i++:(o=`${o} ${i}`,l=!1)}return o}async createFlow(n){const{id:r,json:o,name:s}=n,a=await this.generateUniqueName(s,n.parentFolderID),i=r??Jt(),l=Date.now(),u={...n,id:i,json:o??JSON.stringify(Po),name:a,updateTime:l,createTime:l};return await X.workflows.add(u),this.saveDiskDB(),sn(u),u}async updateFlow(n,r){const o=await this.get(n);if(o==null)return;const s={...o,...r,id:n},a=JSON.stringify(o),i=JSON.stringify(s);if(a===i)return;const l=s,u=Object.keys(r);if(u.length===1&&["tags","parentFolderID"].includes(u[0])||(l.updateTime=Date.now(),l.parentFolderID!=null&&await(ee==null?void 0:ee.update({id:l.parentFolderID,updateTime:Date.now()}))),await X.workflows.update(n,l),this._curWorkflow&&this._curWorkflow.id===n&&(this._curWorkflow=l),await this.saveDiskDB(),"name"in r||"parentFolderID"in r){await Vr(o),await sn(s);return}r.json!=null&&await sn(s)}async batchCreateFlows(n=[],r=!1,o){const s=[];for(const a of n){const i=a.name&&r?a.name:await this.generateUniqueName(a.name,o),l=Jt(),u=Date.now(),c={id:l,name:i,json:a.json,parentFolderID:o,updateTime:u,createTime:u,tags:[]};s.push(c),await sn(c)}await X.workflows.bulkAdd(s),this.saveDiskDB()}async deleteFlow(n){const r=await this.get(n);r&&Vr({...r}),await X.workflows.delete(n),this.saveDiskDB()}async batchDeleteFlow(n){const r=await X.workflows.bulkGet(n);for(const o of r)o&&await Vr(o);await X.workflows.bulkDelete(n),this.saveDiskDB()}async listFolderContent(n,r){const o=await this.listAll().then(i=>i.filter(l=>l.parentFolderID==n))??[],s=await(ee==null?void 0:ee.listAll().then(i=>i.filter(l=>l.parentFolderID==n)))??[],a=[...o,...s];return Sf(a,r??pt.RECENTLY_MODIFIED)}};ce(hr,"TABLE_NAME","workflows");let jo=hr;const pr=class pr extends Pt{constructor(){super("folders")}static async load(){return new pr}async create(e){const n=await this.generateUniqueName(e.name,e.parentFolderID),r={id:Jt(),name:n,parentFolderID:e.parentFolderID??null,updateTime:Date.now(),createTime:Date.now(),type:"folder"};return await X.folders.add(r),this.saveDiskDB(),r}async update(e){const n=await this.get(e.id);if(n==null)return;const r="name"in e&&e.name!=n.name,o="parentFolderID"in e&&e.parentFolderID!=n.parentFolderID,s={...n,...e};e.name!=null&&(s.updateTime=Date.now()),o&&(e.name=await this.generateUniqueName(s.name,s.parentFolderID??void 0)),await X.folders.update(e.id,e),this.saveDiskDB(),(r||o)&&Mi(!0)}async deleteFolder(e,n=Zn.DELETE){const r=await Df(e),o=await(S==null?void 0:S.listAll())??[],s=await this.listAll(),a=[e];for(;a.length>0;){const i=a.shift();if(i){for(const u of o)if(u.parentFolderID===i)switch(n){case Zn.DELETE:await(S==null?void 0:S.deleteFlow(u.id));break;case Zn.MOVE_TO_ROOT_FOLDER:await(S==null?void 0:S.updateFlow(u.id,{parentFolderID:void 0}));break}await X.folders.delete(i);const l=s.filter(u=>u.parentFolderID===i).map(u=>u.id);l.length&&a.push(...l)}}r&&await Dd(r),this.saveDiskDB()}async generateUniqueName(e,n){let r=e??"New folder";const o=await this.listAll().then(s=>s.filter(a=>a.parentFolderID==n).map(a=>a.name));if(o.includes(r)){let s=2,a=!0;for(;a;)o.includes(`${r} ${s}`)?s++:(r=`${r} ${s}`,a=!1)}return r}};ce(pr,"TABLE_NAME","folders");let No=pr;class Li extends Pt{constructor(){super("media")}async listByWorkflowID(e){return await X.media.where("workflowID").equals(e).reverse().sortBy("createTime")}async create(e){const n=e.localPath.split(".").pop();if(n==null)return null;const r={id:Jt(),localPath:e.localPath,workflowID:e.workflowID,createTime:Date.now(),format:n},o=await(S==null?void 0:S.get(e.workflowID)),s=new Set((o==null?void 0:o.mediaIDs)??[]).add(r.id);return await(S==null?void 0:S.updateFlow(e.workflowID,{mediaIDs:Array.from(s),coverMediaPath:r.localPath})),X.media.add(r),this.saveDiskDB(),r}}ce(Li,"TABLE_NAME","media");const mr=class mr extends Pt{constructor(){super("userSettings");ce(this,"defaultSettings");ce(this,"DEFAULT_USER","guest");ce(this,"_autoSave",!1);this.defaultSettings={id:this.DEFAULT_USER,topBarStyle:{top:0,left:0},modelManagerTopBarStyle:{top:0,right:0},myWorkflowsDir:"",shortcuts:{save:"Shift+S"},autoSave:!0,twoWaySync:!1,foldersOnTop:!1,cloudHost:"https://www.comfyspace.art",overwriteCurWorkflowWhenDroppingFileToCanvas:!1}}get autoSave(){return this._autoSave}async getSetting(n){const r=await this.get(this.DEFAULT_USER);return(r==null?void 0:r[n])??this.defaultSettings[n]}async upsert(n){const o={...await this.get(this.DEFAULT_USER)??this.defaultSettings,...n};await this.put(o),Object.hasOwn(n,"autoSave")&&n.autoSave!==void 0&&(this._autoSave=n.autoSave)}static async load(){const n=new mr,r=await Cd();return n.defaultSettings.myWorkflowsDir=`${r.dir_path}/my_workflows`,await n.getSetting("autoSave").then(o=>{n._autoSave=o??!0}),n}};ce(mr,"TABLE_NAME","userSettings");let Ao=mr;const vr=class vr extends Pt{constructor(){super("tags")}static async load(){return new vr}};ce(vr,"TABLE_NAME","tags");let Fo=vr;const yr=class yr extends Pt{constructor(){super("workflowVersions")}static async load(){return new yr}async listByWorkflowID(e){return await X[this.tableName].where("workflowID").equals(e).reverse().sortBy("createTime")??[]}async getLatestByWorkflowID(e){const n=await this.listByWorkflowID(e);return n!=null&&n.length?n[0]:null}};ce(yr,"TABLE_NAME","workflowVersions");let Mo=yr;function Bh(t){return"type"in t&&t.type==="folder"}let S=null,Qn=null,z=null,ee=null,Ve=null,Ct=null,xe=null;async function Ff(){const t=async()=>{S=await jo.load()},e=async()=>{Qn=await Fo.load()},n=async()=>{z=await Ao.load()},r=async()=>{ee=await No.load()},o=async()=>{Ve=await Oo.load()},s=async()=>{Ct=new Li},a=async()=>{xe=await Mo.load()};await Promise.all([t(),e(),n(),r(),o(),s(),a()]),localStorage.getItem("WORKSPACE_INDEXDB_BACKFILL")!=="true"&&(await Mf(),localStorage.setItem("WORKSPACE_INDEXDB_BACKFILL","true"))}async function Mf(){const t=async()=>{try{const i=await(S==null?void 0:S.getRecords());i&&await X.workflows.bulkAdd(Object.values(i))}catch(i){console.error(i)}},e=async()=>{try{const i=await(ee==null?void 0:ee.getRecords());i&&await X.folders.bulkAdd(Object.values(i))}catch(i){console.error(i)}},n=async()=>{try{const i=await(Ct==null?void 0:Ct.getRecords());i&&await X.media.bulkAdd(Object.values(i))}catch(i){console.error(i)}},r=async()=>{try{const i=await(Ve==null?void 0:Ve.getRecords());i&&await X.changelogs.bulkAdd(Object.values(i))}catch(i){console.error(i)}},o=async()=>{try{const i=await(Qn==null?void 0:Qn.getRecords());i&&await X.tags.bulkAdd(Object.values(i))}catch(i){console.error(i)}},s=async()=>{try{const i=z,l=await i.getRecords().then(u=>u[i.DEFAULT_USER]?u[i.DEFAULT_USER]:u);await X.userSettings.put({...i.defaultSettings,...l})}catch(i){console.error(i)}},a=async()=>{try{const i=await(xe==null?void 0:xe.getRecords());i&&await X.workflowVersions.bulkAdd(Object.values(i))}catch(i){console.error(i)}};await Promise.all([t(),e(),n(),r(),o(),s(),a()])}const en=v.createContext({curFlowID:null,loadWorkflowID:()=>{},saveCurWorkflow:()=>{},discardUnsavedChanges:async()=>{},isDirty:!1,loadNewWorkflow:()=>{},loadFilePath:()=>{},setRoute:()=>{}}),Wh=v.createContext({refreshFolderStamp:0,setRefreshFolderStamp:()=>{}}),Hr={x:0,y:0};function Rf({children:t,onDragEnd:e,dragIconId:n}){const r=v.useRef(Hr),o=v.useRef(!1),[s,a]=v.useState(Hr),i=d=>{var f,m,b;if(!(!(d.target instanceof Element)||!(d.target.parentNode instanceof Element))&&[(f=d.target)==null?void 0:f.id,(b=(m=d.target)==null?void 0:m.parentNode)==null?void 0:b.id].includes(n)){r.current={x:d.clientX,y:d.clientY},o.current=!0,window.addEventListener("mousemove",l),window.addEventListener("mouseup",u);const h=document.getElementsByTagName("body")[0];h.style.userSelect="none"}},l=v.useCallback(d=>{const f={x:d.clientX-r.current.x,y:d.clientY-r.current.y};a(f)},[]),u=v.useCallback(()=>{a(f=>(e(f),Hr)),o.current=!1;const d=document.getElementsByTagName("body")[0];d.style.userSelect="auto",window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",u)},[e,l]),c={transform:`translate(${s.x}px, ${s.y}px)`,zIndex:o.current?1e3:1};return p.jsx("div",{style:c,onMouseDown:i,children:t})}var Tf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},Lf=Object.defineProperty,Bf=Object.defineProperties,Wf=Object.getOwnPropertyDescriptors,dr=Object.getOwnPropertySymbols,Bi=Object.prototype.hasOwnProperty,Wi=Object.prototype.propertyIsEnumerable,oa=(t,e,n)=>e in t?Lf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sa=(t,e)=>{for(var n in e||(e={}))Bi.call(e,n)&&oa(t,n,e[n]);if(dr)for(var n of dr(e))Wi.call(e,n)&&oa(t,n,e[n]);return t},Kf=(t,e)=>Bf(t,Wf(e)),$f=(t,e)=>{var n={};for(var r in t)Bi.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&dr)for(var r of dr(t))e.indexOf(r)<0&&Wi.call(t,r)&&(n[r]=t[r]);return n},pe=(t,e,n)=>{const r=v.forwardRef((o,s)=>{var a=o,{color:i="currentColor",size:l=24,stroke:u=2,children:c}=a,d=$f(a,["color","size","stroke","children"]);return v.createElement("svg",sa(Kf(sa({ref:s},Tf),{width:l,height:l,stroke:i,strokeWidth:u,className:`tabler-icon tabler-icon-${t}`}),d),[...n.map(([f,m])=>v.createElement(f,m)),...c||[]])});return r.propTypes={color:ft.string,size:ft.oneOfType([ft.string,ft.number]),stroke:ft.oneOfType([ft.string,ft.number])},r.displayName=`${e}`,r},Uf=pe("arrow-back-up-double","IconArrowBackUpDouble",[["path",{d:"M13 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M8 14l-4 -4l4 -4",key:"svg-1"}],["path",{d:"M9 10h7a4 4 0 1 1 0 8h-1",key:"svg-2"}]]),zf=pe("chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),qf=pe("cloud","IconCloud",[["path",{d:"M6.657 18c-2.572 0 -4.657 -2.007 -4.657 -4.483c0 -2.475 2.085 -4.482 4.657 -4.482c.393 -1.762 1.794 -3.2 3.675 -3.773c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.913 0 3.464 1.56 3.464 3.486c0 1.927 -1.551 3.487 -3.465 3.487h-11.878",key:"svg-0"}]]),Vf=pe("copy","IconCopy",[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]]),Ro=pe("device-floppy","IconDeviceFloppy",[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]]),Hf=pe("download","IconDownload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 11l5 5l5 -5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]),Jf=pe("external-link","IconExternalLink",[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]]),Gf=pe("folder","IconFolder",[["path",{d:"M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2",key:"svg-0"}]]),Yf=pe("grip-vertical","IconGripVertical",[["path",{d:"M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}],["path",{d:"M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-4"}],["path",{d:"M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-5"}]]),Xf=pe("history","IconHistory",[["path",{d:"M12 8l0 4l2 2",key:"svg-0"}],["path",{d:"M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5",key:"svg-1"}]]),Zf=pe("link","IconLink",[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]]),Qf=pe("lock","IconLock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]),eh=pe("photo","IconPhoto",[["path",{d:"M15 8h.01",key:"svg-0"}],["path",{d:"M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z",key:"svg-1"}],["path",{d:"M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5",key:"svg-2"}],["path",{d:"M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3",key:"svg-3"}]]),th=pe("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),nh=pe("share-2","IconShare2",[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]]),rh=pe("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]),oh=pe("triangle-inverted-filled","IconTriangleInvertedFilled",[["path",{d:"M20.118 3h-16.225a2.914 2.914 0 0 0 -2.503 4.371l8.116 13.549a2.917 2.917 0 0 0 4.987 .005l8.11 -13.539a2.914 2.914 0 0 0 -2.486 -4.386z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}]]),sh=pe("versions","IconVersions",[["path",{d:"M10 5m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 7l0 10",key:"svg-1"}],["path",{d:"M4 8l0 8",key:"svg-2"}]]),ah=pe("world","IconWorld",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]]),ih=pe("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);function lh(t){const{promptMessage:e="Are you sure you want to delete this?",variant:n="ghost",onDelete:r,isDisabled:o=!1,tooltipText:s}=t;return p.jsx(Ua,{isLazy:!0,placement:"auto",children:({onClose:a})=>p.jsxs(p.Fragment,{children:[p.jsx($a,{children:p.jsx(it,{children:p.jsx(bt,{hasArrow:!0,label:s,placement:"bottom",children:p.jsx(Ut,{"aria-label":"Delete confirm",size:"sm",icon:p.jsx(rh,{color:"#F56565"}),isDisabled:o,variant:n})})})}),p.jsxs(Ja,{children:[p.jsx(za,{}),p.jsx(Va,{onClick:a}),p.jsxs(qa,{children:[p.jsx(gt,{mb:4,pr:4,fontWeight:600,children:e}),p.jsx(Oe,{colorScheme:"red",size:"sm",onClick:()=>{r(),a()},children:"Yes, delete"})]})]})]})})}function ch({onClose:t}){const e=hl(),{curFlowID:n,isDirty:r}=v.useContext(en),[o,s]=v.useState(0),[a,i]=v.useState(null),[l,u]=v.useState([]),[c,d]=v.useState([]),f=async h=>{var k;const w=await(S==null?void 0:S.get(h)),g=await(Ve==null?void 0:Ve.listByWorkflowID(h));u(g??[]);const y=g==null?void 0:g.filter(E=>E.json===(w==null?void 0:w.lastSavedJson)),_=(k=y==null?void 0:y[0])==null?void 0:k.id;_&&i(_)},m=async()=>{var _;const h=await(xe==null?void 0:xe.listByWorkflowID(n))??[];d(h);const w=JSON.stringify(ye.graph.serialize()),g=h==null?void 0:h.filter(k=>k.json===w),y=(_=g==null?void 0:g[0])==null?void 0:_.id;y&&i(y)},b=h=>{xe==null||xe.delete(h).then(()=>{m()})};return v.useEffect(()=>{switch(o){case 0:m();break;case 1:f(n);break}},[o]),v.useEffect(()=>(ye.canvasEl.addEventListener("click",t),()=>{ye.canvasEl.removeEventListener("click",t)}),[o]),p.jsxs(Cl,{width:400,height:"100vh",gap:0,position:"fixed",top:0,left:0,zIndex:1e3,children:[p.jsx(kl,{pb:1,mb:0,children:p.jsxs($n,{justifyContent:"space-between",alignItems:"center",children:[p.jsx(ka,{size:"md",children:"Version History"}),p.jsx(Ut,{size:"sm",icon:p.jsx(ih,{}),onClick:t,variant:"ghost","aria-label":"close version history"})]})}),p.jsx(_l,{overflowY:"auto",gap:0,children:p.jsxs(Xa,{isFitted:!0,variant:"enclosed",onChange:s,children:[p.jsxs(Za,{mb:"1em",children:[p.jsx(to,{children:"Versions"}),p.jsx(to,{children:"Change History"})]}),p.jsxs(Qa,{children:[p.jsx(eo,{children:p.jsx(an,{divider:p.jsx(Yr,{}),spacing:2,children:c==null?void 0:c.map(h=>p.jsxs($n,{w:"100%",mb:1,justify:"space-between",backgroundColor:h.id===a?"teal.300":void 0,borderRadius:4,children:[p.jsxs(an,{textAlign:"left",gap:0,children:[p.jsx(gt,{fontWeight:"500",children:h.name??"untitled"}),p.jsxs(gt,{color:"GrayText",fontSize:"sm",children:["Created: ",na(h.createTime)]})]}),p.jsxs($n,{alignItems:"center",gap:2,children:[p.jsx(Oe,{size:"sm",onClick:()=>{if(r){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}ye.loadGraphData(JSON.parse(h.json)),S==null||S.updateFlow(n,{lastSavedJson:h.json,json:h.json}),e({title:`Switched to version "${h.name}"`,status:"success",duration:3e3,isClosable:!0}),t()},children:"Load"}),p.jsx(lh,{promptMessage:"Are you sure you want to delete this version?",onDelete:()=>{b(h.id)}})]})]},h.id))})}),p.jsxs(eo,{children:[p.jsx(gt,{mb:4,children:"All the saved changes of this workflow"}),p.jsx(an,{divider:p.jsx(Yr,{}),spacing:2,children:l==null?void 0:l.map(h=>p.jsxs(Oe,{size:"sm",variant:"ghost",onClick:()=>{if(r){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}ye.loadGraphData(JSON.parse(h.json)),S==null||S.updateFlow(n,{lastSavedJson:h.json}),t()},isActive:h.id===a,children:["Saved at ",na(h.createTime,!0)]},h.id))})]})]})]})})]})}function uh({workflowId:t,onClose:e}){const[n,r]=v.useState(""),[o,s]=v.useState(""),a=l=>{r(l.target.value),o&&s("")},i=async()=>{const l=n.trim();if(r(l),(await(xe==null?void 0:xe.listByWorkflowID(t))??[]).some(c=>c.name===l))s("The name is duplicated, please modify it and submit again.");else{const c=JSON.stringify(ye.graph.serialize());await(xe==null?void 0:xe.add({name:n,workflowID:t,createTime:Date.now(),json:c})),e()}};return p.jsxs(Bo,{isOpen:!0,onClose:e,children:[p.jsx(Wo,{}),p.jsxs(Ko,{children:[p.jsx($o,{children:"Create Version"}),p.jsx(Uo,{}),p.jsx(zo,{children:p.jsxs(br,{isInvalid:!!o,children:[p.jsx(_r,{children:"Name"}),p.jsx(En,{value:n,onChange:a,autoFocus:!0,onKeyUp:l=>{l.code==="Enter"&&!o&&n&&i()}}),o&&p.jsx(xr,{children:o})]})}),p.jsxs(qo,{children:[p.jsx(Oe,{colorScheme:"teal",mr:3,onClick:i,isDisabled:!n||!!o,children:"Create"}),p.jsx(Oe,{onClick:e,children:"Cancel"})]})]})]})}function dh({options:t,menuButton:e,isOpen:n,onClose:r}){const o=v.useRef(null);return Gl({ref:o,handler:()=>r()}),p.jsxs(it,{position:"relative",children:[p.jsx(it,{children:e}),n&&p.jsx(it,{ref:o,mt:"8px",shadow:"md",p:"2",position:"absolute",zIndex:"dropdown",children:t})]})}function Ki({menuButton:t,menuContent:e,onClose:n}){const r=v.useRef(),[o,s]=v.useState(!1),a=()=>{r.current=setTimeout(()=>s(!1),400)},i=()=>{s(!0),clearTimeout(r.current),r.current=void 0};return p.jsx(dh,{isOpen:o,onClose:a,menuButton:p.jsx(it,{"aria-label":"menu",onClick:i,onMouseEnter:i,onMouseLeave:a,children:t}),options:p.jsx(os,{isOpen:!0,children:p.jsx(ss,{minWidth:150,zIndex:1e3,onMouseEnter:i,onMouseLeave:a,children:e})})})}const fh=v.lazy(()=>wr(()=>import("./ShareDialog-TS-2UrPz.js"),__vite__mapDeps([0,1,2,3])));function hh(){const{curFlowID:t,loadWorkflowID:e,discardUnsavedChanges:n,saveCurWorkflow:r}=v.useContext(en),[o,s]=v.useState(!1),[a,i]=v.useState(!1),[l,u]=v.useState(!1),[c,d]=v.useState(""),[f,m]=v.useState(""),[b,h]=v.useState(),[w,g]=v.useState(""),[y,_]=v.useState(!1);v.useEffect(()=>{t&&(S==null||S.get(t).then(I=>{d((I==null?void 0:I.name)??""),h(I)})),z==null||z.getSetting("shortcuts").then(I=>{g(I==null?void 0:I.save)})},[t]);const k=I=>{d(I.target.value),f&&m("")},E=async()=>{if(!t){alert("Flow ID is required");return}const I=JSON.stringify(ye.graph.serialize()),D=await(S==null?void 0:S.createFlow({json:I,lastSavedJson:I,name:c,parentFolderID:b==null?void 0:b.parentFolderID}));D&&await e(D.id,!0),C()},C=()=>{i(!1)},x=v.useCallback(async()=>{const I=t?await(S==null?void 0:S.get(t)):null;if(!I){alert("Workspace does not exist");return}const D=new Blob([I.json],{type:"application/json"}),P=URL.createObjectURL(D),N=document.createElement("a");N.href=P,N.download=`${I.name}.json`,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(P)},[t]);return p.jsxs(p.Fragment,{children:[p.jsx(Ki,{menuButton:p.jsx(il,{children:p.jsxs(Oe,{px:1,height:"29px","aria-label":"menu",size:"sm",colorScheme:"gray",backgroundColor:"gray.700",children:["File",p.jsx(zf,{size:20})]})}),menuContent:p.jsx(os,{isOpen:!0,children:p.jsxs(ss,{minWidth:150,zIndex:1e3,children:[p.jsx(rt,{onClick:r,icon:p.jsx(Ro,{size:20}),iconSpacing:1,command:w,children:"Save"}),p.jsx(bt,{label:"Revert workflow to your last saved version. You will lose all changes made since your last save.",children:p.jsx(rt,{onClick:n,icon:p.jsx(Uf,{size:20}),iconSpacing:1,isDisabled:(b==null?void 0:b.lastSavedJson)==null,children:"Discard unsaved changes"})}),p.jsx(rt,{onClick:x,icon:p.jsx(Hf,{size:20}),iconSpacing:1,children:"Download"}),p.jsx(rt,{onClick:()=>i(!0),icon:p.jsx(Ro,{size:20}),iconSpacing:1,children:"Save As"}),p.jsx(rt,{onClick:()=>s(!0),icon:p.jsx(sh,{size:20}),iconSpacing:1,children:"Create Version"}),p.jsx(rt,{onClick:()=>u(!0),icon:p.jsx(Xf,{size:20}),iconSpacing:1,children:"Versions History"}),p.jsx(rt,{onClick:()=>_(!0),icon:p.jsx(nh,{size:20}),iconSpacing:1,children:"Share"})]})})}),y&&p.jsx(fh,{onClose:()=>_(!1)}),l&&p.jsx(ch,{onClose:()=>u(!1)}),a&&p.jsxs(Bo,{isOpen:!0,onClose:C,children:[p.jsx(Wo,{}),p.jsxs(Ko,{children:[p.jsx($o,{children:"Save As"}),p.jsx(Uo,{}),p.jsx(zo,{children:p.jsxs(br,{isInvalid:!!f,children:[p.jsx(_r,{children:"Workflow name"}),p.jsx(En,{value:c,onChange:k,autoFocus:!0,onKeyUp:I=>{I.code==="Enter"&&!f&&c&&E()}}),f&&p.jsx(xr,{children:f})]})}),p.jsxs(qo,{children:[p.jsx(Oe,{colorScheme:"teal",mr:3,onClick:E,isDisabled:!c||!!f,children:"Save"}),p.jsx(Oe,{onClick:C,children:"Cancel"})]})]})]}),o&&p.jsx(uh,{workflowId:t,onClose:()=>s(!1)})]})}function ph({displayName:t,updateFlowName:e,isDirty:n}){const{isOpen:r,onOpen:o,onClose:s}=Zl(),{curFlowID:a}=v.useContext(en),[i,l]=v.useState(t),[u,c]=v.useState(""),d=()=>{l(t),o()},f=h=>{l(h.target.value),u&&c("")},m=async()=>{if(a){const h=i.trim();if(l(h),t===h)return b();const w=await(S==null?void 0:S.listAll())??[];(w==null?void 0:w.map(y=>y.name)).includes(h)?c("The name is duplicated, please modify it and submit again."):(await(S==null?void 0:S.updateFlow(a,{name:h})),e(h),b())}},b=()=>{c(""),s()};return a==null?null:p.jsxs(mt,{children:[p.jsx(bt,{label:t,placement:"bottom",children:p.jsxs(gt,{as:"div",color:"white",onClick:d,maxW:200,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:[p.jsx("div",{style:{width:8,display:"inline-block"},children:p.jsx(gt,{as:"span",children:n&&"* "})}),t]})}),p.jsxs(Bo,{isOpen:r,onClose:b,children:[p.jsx(Wo,{}),p.jsxs(Ko,{children:[p.jsx($o,{children:"Edit workflow name"}),p.jsx(Uo,{}),p.jsx(zo,{children:p.jsxs(br,{isInvalid:!!u,children:[p.jsx(_r,{children:"Workflow name"}),p.jsx(En,{value:i,onChange:f,autoFocus:!0,onKeyUp:h=>{h.code==="Enter"&&!u&&i&&m()}}),u&&p.jsx(xr,{children:u})]})}),p.jsxs(qo,{children:[p.jsx(Oe,{colorScheme:"teal",mr:3,onClick:m,isDisabled:!i||!!u,children:"Save"}),p.jsx(Oe,{onClick:b,children:"Cancel"})]})]})]})]})}function Kh(t){const e=new Uint8Array(t);return window.crypto.getRandomValues(e),Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}const $h=[{label:"Private",value:"PRIVATE",icon:p.jsx(Qf,{})},{label:"Unlisted, anyone with the link can view",value:"UNLISTED",icon:p.jsx(Zf,{})},{label:"Public",value:"PUBLIC",icon:p.jsx(ah,{})}],Uh=()=>{const t=ye.graph._nodes,e={};for(let n of t)if(n.type in LiteGraph.registered_node_types){const r=structuredClone(LiteGraph.registered_node_types[n.type].nodeData);if(r==null)continue;for(let o in r.input){const s=r.input[o];for(let a in s){const i=s[a];Array.isArray(i[0])&&(i[0]=["value_1","value_2"])}}e[n.type]=r}return e};async function mh(t){const e=t.cloudURL;if(!e)throw Error("cloudURL is required");const r=new URL(e).origin;return fetch(r+`/api/getWorkflow?id=${t.cloudID}`).then(o=>o.json()).then(o=>{var a;return((a=o.data)==null?void 0:a.privacy)??"PRIVATE"})}function vh({privacy:t,showEmoji:e=!1}){let n;return t==="PRIVATE"?(n="Private",e&&(n=" Private")):t==="UNLISTED"?(n="Unlisted",e&&(n=" Unlisted")):t==="PUBLIC"&&(n="Public",e&&(n=" Public")),p.jsx("span",{children:n})}function yh({}){const[t,e]=v.useState(),[n,r]=v.useState(),{curFlowID:o}=v.useContext(en);return v.useEffect(()=>{o&&(S==null||S.get(o).then(s=>{s!=null&&s.cloudID?(e(s.cloudURL),mh(s).then(a=>{r(a)})):e(void 0)}))},[o]),t?p.jsx(p.Fragment,{children:p.jsx(Ki,{menuButton:p.jsx(Oe,{onClick:()=>{var s;window.open((s=S==null?void 0:S.curWorkflow)==null?void 0:s.cloudURL)},"aria-label":"Shared",size:"xs",iconSpacing:"2px",leftIcon:p.jsx(qf,{}),height:"26px",px:1,children:n?p.jsx(vh,{privacy:n}):"Shared"}),menuContent:p.jsxs(mt,{width:"200px",p:1,color:"blue.400",children:[p.jsx(xa,{href:t,noOfLines:1,isExternal:!0,children:t}),p.jsx(Ut,{size:"xs",variant:"ghost",icon:p.jsx(Vf,{size:19}),"aria-label":"copy link"})]})})}):null}function gh({updatePanelPosition:t,positionStyle:e,curFlowName:n,setCurFlowName:r}){const{isDirty:o,loadNewWorkflow:s,saveCurWorkflow:a,setRoute:i,curFlowID:l}=v.useContext(en);return p.jsx(Rf,{onDragEnd:u=>{t({top:u.y,left:u.x},!0)},dragIconId:"dragPanelIcon",children:p.jsxs(mt,{style:{padding:2,position:"fixed",...e},justifyContent:"space-between",alignItems:"center",gap:2,draggable:!1,id:"workspaceManagerPanel",className:"workspaceManagerPanel",children:[p.jsx(Oe,{size:"sm","aria-label":"workspace folder",onClick:()=>i("recentFlows"),px:2,children:p.jsxs(mt,{gap:1,children:[p.jsx(Gf,{size:21}),p.jsx(oh,{size:8})]})}),p.jsx(bt,{label:"New workflow",children:p.jsx(Oe,{size:"sm",variant:"outline",colorScheme:"teal","aria-label":"new workflow",onClick:()=>s(),px:2,py:2,children:p.jsx(mt,{gap:0,children:p.jsx(th,{size:16,color:"white"})})})}),p.jsx(ph,{isDirty:o,displayName:n??"",updateFlowName:u=>{r(u),requestAnimationFrame(()=>{t()})}}),l&&p.jsxs(mt,{gap:"4px",children:[p.jsx(bt,{label:"Open gallery",children:p.jsx(Ut,{onClick:()=>i("gallery"),icon:p.jsx(eh,{size:22,color:"white"}),size:"sm","aria-label":"open gallery",variant:"ghost"})}),p.jsx(hh,{})]}),p.jsx(yh,{}),l&&o?p.jsx(bt,{label:"Save workflow",children:p.jsx(Ut,{onClick:a,icon:p.jsx(Ro,{size:23,color:"white"}),size:"xs",paddingY:4,"aria-label":"save workspace",variant:"ghost"})}):p.jsx("div",{style:{width:1}}),p.jsx(Yf,{id:"dragPanelIcon",className:"dragPanelIcon",cursor:"move",size:15,color:"#FFF"})]})})}const wh=Vo.lazy(()=>wr(()=>import("./RecentFilesDrawer-5V6-n8KY.js"),__vite__mapDeps([4,1,3,5,2,6,7]))),bh=Vo.lazy(()=>wr(()=>import("./GalleryModal-u2j2EpOc.js"),__vite__mapDeps([8,1,7,5,2,6]))),xh=Vo.lazy(()=>wr(()=>import("./ModelManagerTopbar-SdEpIAUx.js").then(t=>t.M),__vite__mapDeps([9,1,5,2,10]))),_h=["download_progress","download_error","model_list"];function kh(){const[t,e]=v.useState(null),[n,r]=v.useState("root"),[o,s]=v.useState(!0),[a,i]=v.useState(null),l=v.useRef(null),[u,c]=v.useState(),[d,f]=v.useState(!1),m=v.useRef(null),{showDialog:b}=ll(),[h,w]=v.useState(!1);v.useRef(!1);const g=v.useRef(0),y=v.useRef("hide"),_=v.useCallback(async()=>{if(l.current){const j=JSON.stringify(ye.graph.serialize());await Promise.all([S==null?void 0:S.updateFlow(l.current,{lastSavedJson:j,json:j}),Ve==null?void 0:Ve.create({workflowID:l.current,json:j})])}},[]),k=async()=>{l.current&&confirm("Are you sure you want to delete this workflow?")&&(await(S==null?void 0:S.delete(l.current)),C(null,""))},E=async()=>{if(confirm("Are you sure you want to discard unsaved changes? This will revert current workflow to your last saved version. You will lose all changes made since your last save.")&&l.current){const R=await(S==null?void 0:S.get(l.current));R&&R.lastSavedJson&&await ye.loadGraphData(JSON.parse(R.lastSavedJson))}},C=(j,R)=>{if(l.current=j,i(j),e(R),S==null||S.updateCurWorkflowID(j),j==null){document.title="ComfyUI",window.location.hash="",localStorage.removeItem("curFlowID");return}if(ra()){const F=Ti(j);window.location.hash=F,document.title=R+" - ComfyUI"}else localStorage.setItem("curFlowID",j),document.title="ComfyUI - "+R},x=async()=>{I(),localStorage.removeItem("workspace"),localStorage.removeItem("comfyspace");try{await Ff(),await(z==null?void 0:z.getSetting("topBarStyle").then(F=>{O(F,!1)}))}catch(F){console.error("error loading db",F)}s(!1);let j=null;if(j=ra(),j==null&&(j=localStorage.getItem("curFlowID")),j&&N(j),localStorage.getItem("REWRITTEN_ALL_LOCAL_DISK_FILE")==="true"?await Mi():(await Af(),localStorage.setItem("REWRITTEN_ALL_LOCAL_DISK_FILE","true")),await(z==null?void 0:z.getSetting("twoWaySync"))){const F=await(z==null?void 0:z.getSetting("myWorkflowsDir")),W=await(S==null?void 0:S.listAll()),U=W&&W.map(te=>te.id)||[],q=await Ed(F,U);if(!q||q.length===0)return;await Ri(q)}},I=()=>{_h.forEach(j=>{Es.addEventListener(j,()=>null)})},D=async()=>{if(l.current!=null){const j=await(S==null?void 0:S.get(l.current));return!!j&&P(j)}return!1},P=j=>{if(j.lastSavedJson==null)return!0;const R=ye.graph.serialize()??{};let F={};try{F=j!=null&&j.lastSavedJson?JSON.parse(j==null?void 0:j.lastSavedJson):{}}catch(U){console.error("error parsing json",U)}return!(JSON.stringify(R)===JSON.stringify(F))},N=async j=>{if(ye.graph==null){console.error("app.graph is null cannot load workflow");return}const R=await(S==null?void 0:S.get(j));if(R==null){alert("Error: Workflow not found! id: "+j),C(null,"");return}C(j,R.name),ye.ui.dialog.close(),ye.loadGraphData(JSON.parse(R.json)),r("root")},K=async(j,R=!1)=>{if(j===null){C(null,""),ye.graph.clear();return}if((await(z==null?void 0:z.getSetting("autoSave"))??!0)||!d||R){N(j);return}T(j)},T=async j=>{var F,W;const R=[j?{label:"Open in new tab",icon:p.jsx(Jf,{}),onClick:()=>{Nf(j)}}:null,{label:"Save",colorScheme:"teal",onClick:async()=>{await _(),j&&N(j)}}];((F=S==null?void 0:S.curWorkflow)==null?void 0:F.lastSavedJson)!=null?R.push({label:"Discard",colorScheme:"red",onClick:async()=>{await E(),j&&N(j)}}):R.push({label:"Delete",colorScheme:"red",onClick:async()=>{await k(),j&&N(j)}}),b(`Please save or discard your changes to "${(W=S==null?void 0:S.curWorkflow)==null?void 0:W.name}" before leaving, or your changes will be lost.`,R)},B=async j=>{const R=(j==null?void 0:j.json)??JSON.stringify(Po),F=await(S==null?void 0:S.createFlow({json:R,name:j==null?void 0:j.name}));F&&await K(F.id),r("root")},Z=async(j,R=!1)=>{const F=j.split("/").pop()??j;R?_():B({name:F});const W=await fetch(jf(j)),U=await W.blob(),q=new File([U],F,{type:W.headers.get("Content-Type")||""});await ye.handleFile(q),r("root")},$=async(j,R)=>{const F=await(S==null?void 0:S.get(j));if(F==null)return;const W=await(S==null?void 0:S.createFlow({json:F.json,lastSavedJson:F.lastSavedJson,name:R||F.name,parentFolderID:F.parentFolderID,tags:F.tags}));W&&await K(W.id)},O=v.useCallback((j,R=!1)=>{const{top:F=0,left:W=0}=u||{};let{top:U=0,left:q=0}=j??{};U+=F,q+=W;const te=document.documentElement.clientWidth,oe=document.documentElement.clientHeight,ie=document.getElementById("workspaceManagerPanel"),be=(ie==null?void 0:ie.offsetWidth)||392;U+36>oe&&(U=oe-36),q+be>=te&&(q=te-be),c({top:Math.max(0,U),left:Math.max(0,q)}),R&&(z==null||z.upsert({topBarStyle:{top:U,left:q}}))},[u]),H=async j=>{await Of(j)&&_()},G=v.useCallback(j=>{if(l.current==null)return;let R=j.filename;j.subfolder!=null&&j.subfolder!==""&&(R=j.subfolder+"/"+R),Ct==null||Ct.create({workflowID:l.current,localPath:R})},[]),de=v.useCallback(()=>{r("root")},[]);return v.useEffect(()=>{x(),w(!0),g.current=setInterval(async()=>{const q=await(z==null?void 0:z.getSetting("autoSave"))??!0;if(l.current!=null&&q){const te=await(S==null?void 0:S.latestVersionCheck());if(y.current!=="disabled"&&!te)y.current="show",b(`This notification is to inform you that it appears you've opened the same workflow in multiple tabs. If all tabs are set to auto-save, this may lead to conflicts and potential data loss.

You might want to consider disabling auto-save to prevent this. We will remind you to save changes if you leave a page with unsaved work.`,[{label:"Do Not Remind Again",onClick:()=>{y.current="disabled"}},{label:"Disable Auto-Save",colorScheme:"teal",onClick:()=>{z==null||z.upsert({autoSave:!1})}}],!0);else{const oe=JSON.stringify(ye.graph.serialize());oe!=null&&await(S==null?void 0:S.updateFlow(l.current,{json:oe}))}}D().then(te=>{f(te)})},1e3),window.addEventListener("keydown",H);const j=document.getElementById("comfy-file-input"),R=async()=>{if(j&&j.files&&j.files.length>0){const q=await(S==null?void 0:S.createFlow({name:j.files[0].name,json:JSON.stringify(Po)}));q&&C(q.id,q.name??"Unknown name")}};j==null||j.addEventListener("change",R);const F=q=>{const te=(z==null?void 0:z.autoSave)??!0,oe=!!(S!=null&&S.curWorkflow)&&P(S==null?void 0:S.curWorkflow);!te&&oe&&(q.preventDefault(),q.returnValue="You have unsaved changes!",T())};window.addEventListener("beforeunload",F);const W=q=>{var te,oe,ie,be,Ee,Q;(ie=(oe=(te=q.detail)==null?void 0:te.output)==null?void 0:oe.images)==null||ie.forEach(me=>{me.type==="output"&&G(me)}),(Q=(Ee=(be=q.detail)==null?void 0:be.output)==null?void 0:Ee.gifs)==null||Q.forEach(me=>{me.type==="output"&&G(me)})};Es.addEventListener("executed",W);const U=async q=>{var ie,be;const te=(be=(ie=q.dataTransfer)==null?void 0:ie.files[0])==null?void 0:be.name;if(!(await(z==null?void 0:z.getSetting("overwriteCurWorkflowWhenDroppingFileToCanvas"))??!1)&&te){const Ee=await(S==null?void 0:S.createFlow({name:te}));Ee&&C(Ee.id,Ee.name)}};return ye.canvasEl.addEventListener("drop",U),()=>{window.removeEventListener("keydown",H),window.removeEventListener("change",R),window.removeEventListener("beforeunload",F),window.removeEventListener("executed",W),ye.canvasEl.removeEventListener("drop",U),clearInterval(g.current)}},[]),o||!u?null:p.jsx(en.Provider,{value:{curFlowID:a,onDuplicateWorkflow:$,loadWorkflowID:K,discardUnsavedChanges:E,saveCurWorkflow:_,isDirty:d,loadNewWorkflow:B,loadFilePath:Z,setRoute:r},children:p.jsx("div",{ref:m,className:"workspace_manager",children:p.jsx(la,{containerRef:m,children:p.jsxs(it,{style:{position:"absolute",top:0,right:0,left:0},zIndex:Ef,draggable:!1,children:[p.jsx(gh,{curFlowName:t,setCurFlowName:e,updatePanelPosition:O,positionStyle:u}),h&&p.jsx(v.Suspense,{children:p.jsx(xh,{})}),h&&n==="recentFlows"&&p.jsx(v.Suspense,{children:p.jsx(wh,{onClose:de,onClickNewFlow:()=>{B(),r("root")}})}),n==="gallery"&&p.jsx(bh,{onclose:()=>r("root")})]})})})})}const zh=Object.freeze(Object.defineProperty({__proto__:null,default:kh},Symbol.toStringTag,{value:"Module"}));export{Va as $,zf as A,it as B,Rh as C,lh as D,Gf as E,$n as F,ee as G,mt as H,Ut as I,br as J,_r as K,xr as L,Ka as M,th as N,Po as O,Th as P,Zn as Q,Wh as R,zu as S,gt as T,Bh as U,Mh as V,Nl as W,Ua as X,$a as Y,Ja as Z,za as _,Sh as a,qa as a0,en as a1,Nf as a2,Jf as a3,pt as a4,Cl as a5,Ef as a6,Nh as a7,Sf as a8,Lh as a9,Vf as aa,xa as ab,Ct as ac,ka as ad,ec as ae,fl as af,X as ag,Fh as ah,Zl as ai,Ah as aj,Rf as ak,Yf as al,Al as am,Yt as an,qf as ao,$h as ap,xe as aq,Kh as ar,Uh as as,mh as at,vh as au,kl as av,zh as aw,Ql as b,jh as c,Oh as d,Ph as e,Xt as f,Er as g,pe as h,rh as i,an as j,En as k,z as l,hl as m,Yr as n,bt as o,Cd as p,os as q,ss as r,rt as s,Qn as t,Cr as u,Mi as v,Hf as w,S as x,ih as y,na as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["workspace_web/ShareDialog-TS-2UrPz.js","workspace_web/input.js","workspace_web/index-pz0vT7Or.js","workspace_web/chunk-RPO2WXNL-dt-e86vT.js","workspace_web/RecentFilesDrawer-5V6-n8KY.js","workspace_web/chunk-JARCRF6W-yaymqCZ5.js","workspace_web/chunk-NTCQBYKE-7NPzADNj.js","workspace_web/MediaPreview-Dl36eUT2.js","workspace_web/GalleryModal-u2j2EpOc.js","workspace_web/ModelManagerTopbar-SdEpIAUx.js","workspace_web/assets/ModelManagerTopbar--iv3sdjQ.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}